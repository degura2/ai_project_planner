(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function Hy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ed={exports:{}},wo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fg;function kS(){if(Fg)return wo;Fg=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var u in a)u!=="key"&&(l[u]=a[u])}else l=a;return a=l.ref,{$$typeof:e,type:r,key:c,ref:a!==void 0?a:null,props:l}}return wo.Fragment=t,wo.jsx=n,wo.jsxs=n,wo}var Lg;function NS(){return Lg||(Lg=1,Ed.exports=kS()),Ed.exports}var g=NS(),Sd={exports:{}},ct={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Og;function MS(){if(Og)return ct;Og=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),y=Symbol.iterator;function _(N){return N===null||typeof N!="object"?null:(N=y&&N[y]||N["@@iterator"],typeof N=="function"?N:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,w={};function C(N,j,R){this.props=N,this.context=j,this.refs=w,this.updater=R||E}C.prototype.isReactComponent={},C.prototype.setState=function(N,j){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,j,"setState")},C.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function M(){}M.prototype=C.prototype;function k(N,j,R){this.props=N,this.context=j,this.refs=w,this.updater=R||E}var b=k.prototype=new M;b.constructor=k,S(b,C.prototype),b.isPureReactComponent=!0;var U=Array.isArray,G={H:null,A:null,T:null,S:null,V:null},X=Object.prototype.hasOwnProperty;function F(N,j,R,J,Y,H){return R=H.ref,{$$typeof:e,type:N,key:j,ref:R!==void 0?R:null,props:H}}function W(N,j){return F(N.type,j,void 0,void 0,void 0,N.props)}function O(N){return typeof N=="object"&&N!==null&&N.$$typeof===e}function te(N){var j={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(R){return j[R]})}var ne=/\/+/g;function ee(N,j){return typeof N=="object"&&N!==null&&N.key!=null?te(""+N.key):j.toString(36)}function Se(){}function Fe(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(Se,Se):(N.status="pending",N.then(function(j){N.status==="pending"&&(N.status="fulfilled",N.value=j)},function(j){N.status==="pending"&&(N.status="rejected",N.reason=j)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function we(N,j,R,J,Y){var H=typeof N;(H==="undefined"||H==="boolean")&&(N=null);var se=!1;if(N===null)se=!0;else switch(H){case"bigint":case"string":case"number":se=!0;break;case"object":switch(N.$$typeof){case e:case t:se=!0;break;case x:return se=N._init,we(se(N._payload),j,R,J,Y)}}if(se)return Y=Y(N),se=J===""?"."+ee(N,0):J,U(Y)?(R="",se!=null&&(R=se.replace(ne,"$&/")+"/"),we(Y,j,R,"",function(De){return De})):Y!=null&&(O(Y)&&(Y=W(Y,R+(Y.key==null||N&&N.key===Y.key?"":(""+Y.key).replace(ne,"$&/")+"/")+se)),j.push(Y)),1;se=0;var Ee=J===""?".":J+":";if(U(N))for(var ke=0;ke<N.length;ke++)J=N[ke],H=Ee+ee(J,ke),se+=we(J,j,R,H,Y);else if(ke=_(N),typeof ke=="function")for(N=ke.call(N),ke=0;!(J=N.next()).done;)J=J.value,H=Ee+ee(J,ke++),se+=we(J,j,R,H,Y);else if(H==="object"){if(typeof N.then=="function")return we(Fe(N),j,R,J,Y);throw j=String(N),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return se}function ae(N,j,R){if(N==null)return N;var J=[],Y=0;return we(N,J,"","",function(H){return j.call(R,H,Y++)}),J}function me(N){if(N._status===-1){var j=N._result;j=j(),j.then(function(R){(N._status===0||N._status===-1)&&(N._status=1,N._result=R)},function(R){(N._status===0||N._status===-1)&&(N._status=2,N._result=R)}),N._status===-1&&(N._status=0,N._result=j)}if(N._status===1)return N._result.default;throw N._result}var re=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function q(){}return ct.Children={map:ae,forEach:function(N,j,R){ae(N,function(){j.apply(this,arguments)},R)},count:function(N){var j=0;return ae(N,function(){j++}),j},toArray:function(N){return ae(N,function(j){return j})||[]},only:function(N){if(!O(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},ct.Component=C,ct.Fragment=n,ct.Profiler=a,ct.PureComponent=k,ct.StrictMode=r,ct.Suspense=p,ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=G,ct.__COMPILER_RUNTIME={__proto__:null,c:function(N){return G.H.useMemoCache(N)}},ct.cache=function(N){return function(){return N.apply(null,arguments)}},ct.cloneElement=function(N,j,R){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var J=S({},N.props),Y=N.key,H=void 0;if(j!=null)for(se in j.ref!==void 0&&(H=void 0),j.key!==void 0&&(Y=""+j.key),j)!X.call(j,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&j.ref===void 0||(J[se]=j[se]);var se=arguments.length-2;if(se===1)J.children=R;else if(1<se){for(var Ee=Array(se),ke=0;ke<se;ke++)Ee[ke]=arguments[ke+2];J.children=Ee}return F(N.type,Y,void 0,void 0,H,J)},ct.createContext=function(N){return N={$$typeof:c,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:l,_context:N},N},ct.createElement=function(N,j,R){var J,Y={},H=null;if(j!=null)for(J in j.key!==void 0&&(H=""+j.key),j)X.call(j,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(Y[J]=j[J]);var se=arguments.length-2;if(se===1)Y.children=R;else if(1<se){for(var Ee=Array(se),ke=0;ke<se;ke++)Ee[ke]=arguments[ke+2];Y.children=Ee}if(N&&N.defaultProps)for(J in se=N.defaultProps,se)Y[J]===void 0&&(Y[J]=se[J]);return F(N,H,void 0,void 0,null,Y)},ct.createRef=function(){return{current:null}},ct.forwardRef=function(N){return{$$typeof:u,render:N}},ct.isValidElement=O,ct.lazy=function(N){return{$$typeof:x,_payload:{_status:-1,_result:N},_init:me}},ct.memo=function(N,j){return{$$typeof:m,type:N,compare:j===void 0?null:j}},ct.startTransition=function(N){var j=G.T,R={};G.T=R;try{var J=N(),Y=G.S;Y!==null&&Y(R,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(q,re)}catch(H){re(H)}finally{G.T=j}},ct.unstable_useCacheRefresh=function(){return G.H.useCacheRefresh()},ct.use=function(N){return G.H.use(N)},ct.useActionState=function(N,j,R){return G.H.useActionState(N,j,R)},ct.useCallback=function(N,j){return G.H.useCallback(N,j)},ct.useContext=function(N){return G.H.useContext(N)},ct.useDebugValue=function(){},ct.useDeferredValue=function(N,j){return G.H.useDeferredValue(N,j)},ct.useEffect=function(N,j,R){var J=G.H;if(typeof R=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return J.useEffect(N,j)},ct.useId=function(){return G.H.useId()},ct.useImperativeHandle=function(N,j,R){return G.H.useImperativeHandle(N,j,R)},ct.useInsertionEffect=function(N,j){return G.H.useInsertionEffect(N,j)},ct.useLayoutEffect=function(N,j){return G.H.useLayoutEffect(N,j)},ct.useMemo=function(N,j){return G.H.useMemo(N,j)},ct.useOptimistic=function(N,j){return G.H.useOptimistic(N,j)},ct.useReducer=function(N,j,R){return G.H.useReducer(N,j,R)},ct.useRef=function(N){return G.H.useRef(N)},ct.useState=function(N){return G.H.useState(N)},ct.useSyncExternalStore=function(N,j,R){return G.H.useSyncExternalStore(N,j,R)},ct.useTransition=function(){return G.H.useTransition()},ct.version="19.1.0",ct}var Pg;function _h(){return Pg||(Pg=1,Sd.exports=MS()),Sd.exports}var xe=_h();const Fi=Hy(xe);var wd={exports:{}},Co={},Cd={exports:{}},Ad={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ug;function RS(){return Ug||(Ug=1,function(e){function t(ae,me){var re=ae.length;ae.push(me);e:for(;0<re;){var q=re-1>>>1,N=ae[q];if(0<a(N,me))ae[q]=me,ae[re]=N,re=q;else break e}}function n(ae){return ae.length===0?null:ae[0]}function r(ae){if(ae.length===0)return null;var me=ae[0],re=ae.pop();if(re!==me){ae[0]=re;e:for(var q=0,N=ae.length,j=N>>>1;q<j;){var R=2*(q+1)-1,J=ae[R],Y=R+1,H=ae[Y];if(0>a(J,re))Y<N&&0>a(H,J)?(ae[q]=H,ae[Y]=re,q=Y):(ae[q]=J,ae[R]=re,q=R);else if(Y<N&&0>a(H,re))ae[q]=H,ae[Y]=re,q=Y;else break e}}return me}function a(ae,me){var re=ae.sortIndex-me.sortIndex;return re!==0?re:ae.id-me.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var p=[],m=[],x=1,y=null,_=3,E=!1,S=!1,w=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function U(ae){for(var me=n(m);me!==null;){if(me.callback===null)r(m);else if(me.startTime<=ae)r(m),me.sortIndex=me.expirationTime,t(p,me);else break;me=n(m)}}function G(ae){if(w=!1,U(ae),!S)if(n(p)!==null)S=!0,X||(X=!0,ee());else{var me=n(m);me!==null&&we(G,me.startTime-ae)}}var X=!1,F=-1,W=5,O=-1;function te(){return C?!0:!(e.unstable_now()-O<W)}function ne(){if(C=!1,X){var ae=e.unstable_now();O=ae;var me=!0;try{e:{S=!1,w&&(w=!1,k(F),F=-1),E=!0;var re=_;try{t:{for(U(ae),y=n(p);y!==null&&!(y.expirationTime>ae&&te());){var q=y.callback;if(typeof q=="function"){y.callback=null,_=y.priorityLevel;var N=q(y.expirationTime<=ae);if(ae=e.unstable_now(),typeof N=="function"){y.callback=N,U(ae),me=!0;break t}y===n(p)&&r(p),U(ae)}else r(p);y=n(p)}if(y!==null)me=!0;else{var j=n(m);j!==null&&we(G,j.startTime-ae),me=!1}}break e}finally{y=null,_=re,E=!1}me=void 0}}finally{me?ee():X=!1}}}var ee;if(typeof b=="function")ee=function(){b(ne)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,Fe=Se.port2;Se.port1.onmessage=ne,ee=function(){Fe.postMessage(null)}}else ee=function(){M(ne,0)};function we(ae,me){F=M(function(){ae(e.unstable_now())},me)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ae){ae.callback=null},e.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<ae?Math.floor(1e3/ae):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_next=function(ae){switch(_){case 1:case 2:case 3:var me=3;break;default:me=_}var re=_;_=me;try{return ae()}finally{_=re}},e.unstable_requestPaint=function(){C=!0},e.unstable_runWithPriority=function(ae,me){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var re=_;_=ae;try{return me()}finally{_=re}},e.unstable_scheduleCallback=function(ae,me,re){var q=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?q+re:q):re=q,ae){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=re+N,ae={id:x++,callback:me,priorityLevel:ae,startTime:re,expirationTime:N,sortIndex:-1},re>q?(ae.sortIndex=re,t(m,ae),n(p)===null&&ae===n(m)&&(w?(k(F),F=-1):w=!0,we(G,re-q))):(ae.sortIndex=N,t(p,ae),S||E||(S=!0,X||(X=!0,ee()))),ae},e.unstable_shouldYield=te,e.unstable_wrapCallback=function(ae){var me=_;return function(){var re=_;_=me;try{return ae.apply(this,arguments)}finally{_=re}}}}(Ad)),Ad}var Bg;function DS(){return Bg||(Bg=1,Cd.exports=RS()),Cd.exports}var bd={exports:{}},Wn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vg;function IS(){if(Vg)return Wn;Vg=1;var e=_h();function t(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)m+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(p,m,x){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:p,containerInfo:m,implementation:x}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Wn.createPortal=function(p,m){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(p,m,null,x)},Wn.flushSync=function(p){var m=c.T,x=r.p;try{if(c.T=null,r.p=2,p)return p()}finally{c.T=m,r.p=x,r.d.f()}},Wn.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(p,m))},Wn.prefetchDNS=function(p){typeof p=="string"&&r.d.D(p)},Wn.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var x=m.as,y=u(x,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,E=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;x==="style"?r.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:E}):x==="script"&&r.d.X(p,{crossOrigin:y,integrity:_,fetchPriority:E,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Wn.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var x=u(m.as,m.crossOrigin);r.d.M(p,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(p)},Wn.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var x=m.as,y=u(x,m.crossOrigin);r.d.L(p,x,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Wn.preloadModule=function(p,m){if(typeof p=="string")if(m){var x=u(m.as,m.crossOrigin);r.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(p)},Wn.requestFormReset=function(p){r.d.r(p)},Wn.unstable_batchedUpdates=function(p,m){return p(m)},Wn.useFormState=function(p,m,x){return c.H.useFormState(p,m,x)},Wn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Wn.version="19.1.0",Wn}var Hg;function FS(){if(Hg)return bd.exports;Hg=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),bd.exports=IS(),bd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg;function LS(){if(Gg)return Co;Gg=1;var e=DS(),t=_h(),n=FS();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function l(i){var s=i,o=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(o=s.return),i=s.return;while(i)}return s.tag===3?o:null}function c(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(l(i)!==i)throw Error(r(188))}function p(i){var s=i.alternate;if(!s){if(s=l(i),s===null)throw Error(r(188));return s!==i?null:i}for(var o=i,h=s;;){var v=o.return;if(v===null)break;var T=v.alternate;if(T===null){if(h=v.return,h!==null){o=h;continue}break}if(v.child===T.child){for(T=v.child;T;){if(T===o)return u(v),i;if(T===h)return u(v),s;T=T.sibling}throw Error(r(188))}if(o.return!==h.return)o=v,h=T;else{for(var A=!1,I=v.child;I;){if(I===o){A=!0,o=v,h=T;break}if(I===h){A=!0,h=v,o=T;break}I=I.sibling}if(!A){for(I=T.child;I;){if(I===o){A=!0,o=T,h=v;break}if(I===h){A=!0,h=T,o=v;break}I=I.sibling}if(!A)throw Error(r(189))}}if(o.alternate!==h)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?i:s}function m(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=m(i),s!==null)return s;i=i.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),b=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),te=Symbol.for("react.memo_cache_sentinel"),ne=Symbol.iterator;function ee(i){return i===null||typeof i!="object"?null:(i=ne&&i[ne]||i["@@iterator"],typeof i=="function"?i:null)}var Se=Symbol.for("react.client.reference");function Fe(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Se?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case S:return"Fragment";case C:return"Profiler";case w:return"StrictMode";case G:return"Suspense";case X:return"SuspenseList";case O:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case b:return(i.displayName||"Context")+".Provider";case k:return(i._context.displayName||"Context")+".Consumer";case U:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case F:return s=i.displayName||null,s!==null?s:Fe(i.type)||"Memo";case W:s=i._payload,i=i._init;try{return Fe(i(s))}catch{}}return null}var we=Array.isArray,ae=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},q=[],N=-1;function j(i){return{current:i}}function R(i){0>N||(i.current=q[N],q[N]=null,N--)}function J(i,s){N++,q[N]=i.current,i.current=s}var Y=j(null),H=j(null),se=j(null),Ee=j(null);function ke(i,s){switch(J(se,s),J(H,i),J(Y,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?og(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=og(s),i=cg(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}R(Y),J(Y,i)}function De(){R(Y),R(H),R(se)}function Ce(i){i.memoizedState!==null&&J(Ee,i);var s=Y.current,o=cg(s,i.type);s!==o&&(J(H,i),J(Y,o))}function Je(i){H.current===i&&(R(Y),R(H)),Ee.current===i&&(R(Ee),yo._currentValue=re)}var K=Object.prototype.hasOwnProperty,pt=e.unstable_scheduleCallback,Ke=e.unstable_cancelCallback,ft=e.unstable_shouldYield,Me=e.unstable_requestPaint,Te=e.unstable_now,He=e.unstable_getCurrentPriorityLevel,ze=e.unstable_ImmediatePriority,Ft=e.unstable_UserBlockingPriority,Tt=e.unstable_NormalPriority,ot=e.unstable_LowPriority,fn=e.unstable_IdlePriority,an=e.log,Un=e.unstable_setDisableYieldValue,$t=null,Yt=null;function at(i){if(typeof an=="function"&&Un(i),Yt&&typeof Yt.setStrictMode=="function")try{Yt.setStrictMode($t,i)}catch{}}var Dt=Math.clz32?Math.clz32:jt,Ue=Math.log,dt=Math.LN2;function jt(i){return i>>>=0,i===0?32:31-(Ue(i)/dt|0)|0}var Et=256,Mn=4194304;function Bn(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function $r(i,s,o){var h=i.pendingLanes;if(h===0)return 0;var v=0,T=i.suspendedLanes,A=i.pingedLanes;i=i.warmLanes;var I=h&134217727;return I!==0?(h=I&~T,h!==0?v=Bn(h):(A&=I,A!==0?v=Bn(A):o||(o=I&~i,o!==0&&(v=Bn(o))))):(I=h&~T,I!==0?v=Bn(I):A!==0?v=Bn(A):o||(o=h&~i,o!==0&&(v=Bn(o)))),v===0?0:s!==0&&s!==v&&(s&T)===0&&(T=v&-v,o=s&-s,T>=o||T===32&&(o&4194048)!==0)?s:v}function Yr(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Za(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sa(){var i=Et;return Et<<=1,(Et&4194048)===0&&(Et=256),i}function wa(){var i=Mn;return Mn<<=1,(Mn&62914560)===0&&(Mn=4194304),i}function Ca(i){for(var s=[],o=0;31>o;o++)s.push(i);return s}function Pe(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function st(i,s,o,h,v,T){var A=i.pendingLanes;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=o,i.entangledLanes&=o,i.errorRecoveryDisabledLanes&=o,i.shellSuspendCounter=0;var I=i.entanglements,Q=i.expirationTimes,he=i.hiddenUpdates;for(o=A&~o;0<o;){var Ae=31-Dt(o),Ne=1<<Ae;I[Ae]=0,Q[Ae]=-1;var ge=he[Ae];if(ge!==null)for(he[Ae]=null,Ae=0;Ae<ge.length;Ae++){var ye=ge[Ae];ye!==null&&(ye.lane&=-536870913)}o&=~Ne}h!==0&&xt(i,h,0),T!==0&&v===0&&i.tag!==0&&(i.suspendedLanes|=T&~(A&~s))}function xt(i,s,o){i.pendingLanes|=s,i.suspendedLanes&=~s;var h=31-Dt(s);i.entangledLanes|=s,i.entanglements[h]=i.entanglements[h]|1073741824|o&4194090}function sn(i,s){var o=i.entangledLanes|=s;for(i=i.entanglements;o;){var h=31-Dt(o),v=1<<h;v&s|i[h]&s&&(i[h]|=s),o&=~v}}function Rn(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function En(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Nr(){var i=me.p;return i!==0?i:(i=window.event,i===void 0?32:kg(i.type))}function Aa(i,s){var o=me.p;try{return me.p=i,s()}finally{me.p=o}}var Vn=Math.random().toString(36).slice(2),Zt="__reactFiber$"+Vn,Qt="__reactProps$"+Vn,_t="__reactContainer$"+Vn,Mr="__reactEvents$"+Vn,ba="__reactListeners$"+Vn,D="__reactHandles$"+Vn,V="__reactResources$"+Vn,L="__reactMarker$"+Vn;function P(i){delete i[Zt],delete i[Qt],delete i[Mr],delete i[ba],delete i[D]}function B(i){var s=i[Zt];if(s)return s;for(var o=i.parentNode;o;){if(s=o[_t]||o[Zt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(i=hg(i);i!==null;){if(o=i[Zt])return o;i=hg(i)}return s}i=o,o=i.parentNode}return null}function z(i){if(i=i[Zt]||i[_t]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function fe(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function _e(i){var s=i[V];return s||(s=i[V]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function oe(i){i[L]=!0}var pe=new Set,ve={};function Re(i,s){Oe(i,s),Oe(i+"Capture",s)}function Oe(i,s){for(ve[i]=s,i=0;i<s.length;i++)pe.add(s[i])}var Z=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ce={},de={};function Ie(i){return K.call(de,i)?!0:K.call(ce,i)?!1:Z.test(i)?de[i]=!0:(ce[i]=!0,!1)}function Ge(i,s,o){if(Ie(s))if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+o)}}function $e(i,s,o){if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+o)}}function Ve(i,s,o,h){if(h===null)i.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttributeNS(s,o,""+h)}}var gt,Lt;function Ot(i){if(gt===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);gt=s&&s[1]||"",Lt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+gt+i+Lt}var Pt=!1;function Dn(i,s){if(!i||Pt)return"";Pt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var Ne=function(){throw Error()};if(Object.defineProperty(Ne.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ne,[])}catch(ye){var ge=ye}Reflect.construct(i,[],Ne)}else{try{Ne.call()}catch(ye){ge=ye}i.call(Ne.prototype)}}else{try{throw Error()}catch(ye){ge=ye}(Ne=i())&&typeof Ne.catch=="function"&&Ne.catch(function(){})}}catch(ye){if(ye&&ge&&typeof ye.stack=="string")return[ye.stack,ge.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=h.DetermineComponentFrameRoot(),A=T[0],I=T[1];if(A&&I){var Q=A.split(`
`),he=I.split(`
`);for(v=h=0;h<Q.length&&!Q[h].includes("DetermineComponentFrameRoot");)h++;for(;v<he.length&&!he[v].includes("DetermineComponentFrameRoot");)v++;if(h===Q.length||v===he.length)for(h=Q.length-1,v=he.length-1;1<=h&&0<=v&&Q[h]!==he[v];)v--;for(;1<=h&&0<=v;h--,v--)if(Q[h]!==he[v]){if(h!==1||v!==1)do if(h--,v--,0>v||Q[h]!==he[v]){var Ae=`
`+Q[h].replace(" at new "," at ");return i.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",i.displayName)),Ae}while(1<=h&&0<=v);break}}}finally{Pt=!1,Error.prepareStackTrace=o}return(o=i?i.displayName||i.name:"")?Ot(o):""}function Sn(i){switch(i.tag){case 26:case 27:case 5:return Ot(i.type);case 16:return Ot("Lazy");case 13:return Ot("Suspense");case 19:return Ot("SuspenseList");case 0:case 15:return Dn(i.type,!1);case 11:return Dn(i.type.render,!1);case 1:return Dn(i.type,!0);case 31:return Ot("Activity");default:return""}}function Qa(i){try{var s="";do s+=Sn(i),i=i.return;while(i);return s}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function rr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Bi(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Nl(i){var s=Bi(i)?"checked":"value",o=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),h=""+i[s];if(!i.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var v=o.get,T=o.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return v.call(this)},set:function(A){h=""+A,T.call(this,A)}}),Object.defineProperty(i,s,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(A){h=""+A},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function ei(i){i._valueTracker||(i._valueTracker=Nl(i))}function Ml(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var o=s.getValue(),h="";return i&&(h=Bi(i)?i.checked?"true":"false":i.value),i=h,i!==o?(s.setValue(i),!0):!1}function Wt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var wn=/[\n"\\]/g;function dn(i){return i.replace(wn,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function ti(i,s,o,h,v,T,A,I){i.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.type=A:i.removeAttribute("type"),s!=null?A==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+rr(s)):i.value!==""+rr(s)&&(i.value=""+rr(s)):A!=="submit"&&A!=="reset"||i.removeAttribute("value"),s!=null?Tf(i,A,rr(s)):o!=null?Tf(i,A,rr(o)):h!=null&&i.removeAttribute("value"),v==null&&T!=null&&(i.defaultChecked=!!T),v!=null&&(i.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?i.name=""+rr(I):i.removeAttribute("name")}function ka(i,s,o,h,v,T,A,I){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.type=T),s!=null||o!=null){if(!(T!=="submit"&&T!=="reset"||s!=null))return;o=o!=null?""+rr(o):"",s=s!=null?""+rr(s):o,I||s===i.value||(i.value=s),i.defaultValue=s}h=h??v,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=I?i.checked:!!h,i.defaultChecked=!!h,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.name=A)}function Tf(i,s,o){s==="number"&&Wt(i.ownerDocument)===i||i.defaultValue===""+o||(i.defaultValue=""+o)}function Ss(i,s,o,h){if(i=i.options,s){s={};for(var v=0;v<o.length;v++)s["$"+o[v]]=!0;for(o=0;o<i.length;o++)v=s.hasOwnProperty("$"+i[o].value),i[o].selected!==v&&(i[o].selected=v),v&&h&&(i[o].defaultSelected=!0)}else{for(o=""+rr(o),s=null,v=0;v<i.length;v++){if(i[v].value===o){i[v].selected=!0,h&&(i[v].defaultSelected=!0);return}s!==null||i[v].disabled||(s=i[v])}s!==null&&(s.selected=!0)}}function sm(i,s,o){if(s!=null&&(s=""+rr(s),s!==i.value&&(i.value=s),o==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=o!=null?""+rr(o):""}function lm(i,s,o,h){if(s==null){if(h!=null){if(o!=null)throw Error(r(92));if(we(h)){if(1<h.length)throw Error(r(93));h=h[0]}o=h}o==null&&(o=""),s=o}o=rr(s),i.defaultValue=o,h=i.textContent,h===o&&h!==""&&h!==null&&(i.value=h)}function ws(i,s){if(s){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=s;return}}i.textContent=s}var C_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function om(i,s,o){var h=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?h?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":h?i.setProperty(s,o):typeof o!="number"||o===0||C_.has(s)?s==="float"?i.cssFloat=o:i[s]=(""+o).trim():i[s]=o+"px"}function cm(i,s,o){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,o!=null){for(var h in o)!o.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var v in s)h=s[v],s.hasOwnProperty(v)&&o[v]!==h&&om(i,v,h)}else for(var T in s)s.hasOwnProperty(T)&&om(i,T,s[T])}function _f(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var A_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),b_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pc(i){return b_.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Ef=null;function Sf(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Cs=null,As=null;function um(i){var s=z(i);if(s&&(i=s.stateNode)){var o=i[Qt]||null;e:switch(i=s.stateNode,s.type){case"input":if(ti(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+dn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var h=o[s];if(h!==i&&h.form===i.form){var v=h[Qt]||null;if(!v)throw Error(r(90));ti(h,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(s=0;s<o.length;s++)h=o[s],h.form===i.form&&Ml(h)}break e;case"textarea":sm(i,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&Ss(i,!!o.multiple,s,!1)}}}var wf=!1;function fm(i,s,o){if(wf)return i(s,o);wf=!0;try{var h=i(s);return h}finally{if(wf=!1,(Cs!==null||As!==null)&&(eu(),Cs&&(s=Cs,i=As,As=Cs=null,um(s),i)))for(s=0;s<i.length;s++)um(i[s])}}function Rl(i,s){var o=i.stateNode;if(o===null)return null;var h=o[Qt]||null;if(h===null)return null;o=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(r(231,s,typeof o));return o}var Na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cf=!1;if(Na)try{var Dl={};Object.defineProperty(Dl,"passive",{get:function(){Cf=!0}}),window.addEventListener("test",Dl,Dl),window.removeEventListener("test",Dl,Dl)}catch{Cf=!1}var ni=null,Af=null,xc=null;function dm(){if(xc)return xc;var i,s=Af,o=s.length,h,v="value"in ni?ni.value:ni.textContent,T=v.length;for(i=0;i<o&&s[i]===v[i];i++);var A=o-i;for(h=1;h<=A&&s[o-h]===v[T-h];h++);return xc=v.slice(i,1<h?1-h:void 0)}function gc(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function vc(){return!0}function hm(){return!1}function dr(i){function s(o,h,v,T,A){this._reactName=o,this._targetInst=v,this.type=h,this.nativeEvent=T,this.target=A,this.currentTarget=null;for(var I in i)i.hasOwnProperty(I)&&(o=i[I],this[I]=o?o(T):T[I]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?vc:hm,this.isPropagationStopped=hm,this}return x(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=vc)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=vc)},persist:function(){},isPersistent:vc}),s}var Vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yc=dr(Vi),Il=x({},Vi,{view:0,detail:0}),k_=dr(Il),bf,kf,Fl,Tc=x({},Il,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mf,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Fl&&(Fl&&i.type==="mousemove"?(bf=i.screenX-Fl.screenX,kf=i.screenY-Fl.screenY):kf=bf=0,Fl=i),bf)},movementY:function(i){return"movementY"in i?i.movementY:kf}}),mm=dr(Tc),N_=x({},Tc,{dataTransfer:0}),M_=dr(N_),R_=x({},Il,{relatedTarget:0}),Nf=dr(R_),D_=x({},Vi,{animationName:0,elapsedTime:0,pseudoElement:0}),I_=dr(D_),F_=x({},Vi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),L_=dr(F_),O_=x({},Vi,{data:0}),pm=dr(O_),P_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},U_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},B_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function V_(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=B_[i])?!!s[i]:!1}function Mf(){return V_}var H_=x({},Il,{key:function(i){if(i.key){var s=P_[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=gc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?U_[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mf,charCode:function(i){return i.type==="keypress"?gc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?gc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),G_=dr(H_),z_=x({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xm=dr(z_),j_=x({},Il,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mf}),q_=dr(j_),$_=x({},Vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Y_=dr($_),W_=x({},Tc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),X_=dr(W_),J_=x({},Vi,{newState:0,oldState:0}),K_=dr(J_),Z_=[9,13,27,32],Rf=Na&&"CompositionEvent"in window,Ll=null;Na&&"documentMode"in document&&(Ll=document.documentMode);var Q_=Na&&"TextEvent"in window&&!Ll,gm=Na&&(!Rf||Ll&&8<Ll&&11>=Ll),vm=" ",ym=!1;function Tm(i,s){switch(i){case"keyup":return Z_.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _m(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var bs=!1;function eE(i,s){switch(i){case"compositionend":return _m(s);case"keypress":return s.which!==32?null:(ym=!0,vm);case"textInput":return i=s.data,i===vm&&ym?null:i;default:return null}}function tE(i,s){if(bs)return i==="compositionend"||!Rf&&Tm(i,s)?(i=dm(),xc=Af=ni=null,bs=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return gm&&s.locale!=="ko"?null:s.data;default:return null}}var nE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Em(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!nE[i.type]:s==="textarea"}function Sm(i,s,o,h){Cs?As?As.push(h):As=[h]:Cs=h,s=su(s,"onChange"),0<s.length&&(o=new yc("onChange","change",null,o,h),i.push({event:o,listeners:s}))}var Ol=null,Pl=null;function rE(i){rg(i,0)}function _c(i){var s=fe(i);if(Ml(s))return i}function wm(i,s){if(i==="change")return s}var Cm=!1;if(Na){var Df;if(Na){var If="oninput"in document;if(!If){var Am=document.createElement("div");Am.setAttribute("oninput","return;"),If=typeof Am.oninput=="function"}Df=If}else Df=!1;Cm=Df&&(!document.documentMode||9<document.documentMode)}function bm(){Ol&&(Ol.detachEvent("onpropertychange",km),Pl=Ol=null)}function km(i){if(i.propertyName==="value"&&_c(Pl)){var s=[];Sm(s,Pl,i,Sf(i)),fm(rE,s)}}function aE(i,s,o){i==="focusin"?(bm(),Ol=s,Pl=o,Ol.attachEvent("onpropertychange",km)):i==="focusout"&&bm()}function iE(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return _c(Pl)}function sE(i,s){if(i==="click")return _c(s)}function lE(i,s){if(i==="input"||i==="change")return _c(s)}function oE(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var vr=typeof Object.is=="function"?Object.is:oE;function Ul(i,s){if(vr(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var o=Object.keys(i),h=Object.keys(s);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var v=o[h];if(!K.call(s,v)||!vr(i[v],s[v]))return!1}return!0}function Nm(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Mm(i,s){var o=Nm(i);i=0;for(var h;o;){if(o.nodeType===3){if(h=i+o.textContent.length,i<=s&&h>=s)return{node:o,offset:s-i};i=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Nm(o)}}function Rm(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Rm(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Dm(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Wt(i.document);s instanceof i.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)i=s.contentWindow;else break;s=Wt(i.document)}return s}function Ff(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var cE=Na&&"documentMode"in document&&11>=document.documentMode,ks=null,Lf=null,Bl=null,Of=!1;function Im(i,s,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Of||ks==null||ks!==Wt(h)||(h=ks,"selectionStart"in h&&Ff(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Bl&&Ul(Bl,h)||(Bl=h,h=su(Lf,"onSelect"),0<h.length&&(s=new yc("onSelect","select",null,s,o),i.push({event:s,listeners:h}),s.target=ks)))}function Hi(i,s){var o={};return o[i.toLowerCase()]=s.toLowerCase(),o["Webkit"+i]="webkit"+s,o["Moz"+i]="moz"+s,o}var Ns={animationend:Hi("Animation","AnimationEnd"),animationiteration:Hi("Animation","AnimationIteration"),animationstart:Hi("Animation","AnimationStart"),transitionrun:Hi("Transition","TransitionRun"),transitionstart:Hi("Transition","TransitionStart"),transitioncancel:Hi("Transition","TransitionCancel"),transitionend:Hi("Transition","TransitionEnd")},Pf={},Fm={};Na&&(Fm=document.createElement("div").style,"AnimationEvent"in window||(delete Ns.animationend.animation,delete Ns.animationiteration.animation,delete Ns.animationstart.animation),"TransitionEvent"in window||delete Ns.transitionend.transition);function Gi(i){if(Pf[i])return Pf[i];if(!Ns[i])return i;var s=Ns[i],o;for(o in s)if(s.hasOwnProperty(o)&&o in Fm)return Pf[i]=s[o];return i}var Lm=Gi("animationend"),Om=Gi("animationiteration"),Pm=Gi("animationstart"),uE=Gi("transitionrun"),fE=Gi("transitionstart"),dE=Gi("transitioncancel"),Um=Gi("transitionend"),Bm=new Map,Uf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uf.push("scrollEnd");function Wr(i,s){Bm.set(i,s),Re(s,[i])}var Vm=new WeakMap;function Rr(i,s){if(typeof i=="object"&&i!==null){var o=Vm.get(i);return o!==void 0?o:(s={value:i,source:s,stack:Qa(s)},Vm.set(i,s),s)}return{value:i,source:s,stack:Qa(s)}}var Dr=[],Ms=0,Bf=0;function Ec(){for(var i=Ms,s=Bf=Ms=0;s<i;){var o=Dr[s];Dr[s++]=null;var h=Dr[s];Dr[s++]=null;var v=Dr[s];Dr[s++]=null;var T=Dr[s];if(Dr[s++]=null,h!==null&&v!==null){var A=h.pending;A===null?v.next=v:(v.next=A.next,A.next=v),h.pending=v}T!==0&&Hm(o,v,T)}}function Sc(i,s,o,h){Dr[Ms++]=i,Dr[Ms++]=s,Dr[Ms++]=o,Dr[Ms++]=h,Bf|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function Vf(i,s,o,h){return Sc(i,s,o,h),wc(i)}function Rs(i,s){return Sc(i,null,null,s),wc(i)}function Hm(i,s,o){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o);for(var v=!1,T=i.return;T!==null;)T.childLanes|=o,h=T.alternate,h!==null&&(h.childLanes|=o),T.tag===22&&(i=T.stateNode,i===null||i._visibility&1||(v=!0)),i=T,T=T.return;return i.tag===3?(T=i.stateNode,v&&s!==null&&(v=31-Dt(o),i=T.hiddenUpdates,h=i[v],h===null?i[v]=[s]:h.push(s),s.lane=o|536870912),T):null}function wc(i){if(50<uo)throw uo=0,$0=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Ds={};function hE(i,s,o,h){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yr(i,s,o,h){return new hE(i,s,o,h)}function Hf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ma(i,s){var o=i.alternate;return o===null?(o=yr(i.tag,s,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=s,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&65011712,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,s=i.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o.refCleanup=i.refCleanup,o}function Gm(i,s){i.flags&=65011714;var o=i.alternate;return o===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,s=o.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Cc(i,s,o,h,v,T){var A=0;if(h=i,typeof i=="function")Hf(i)&&(A=1);else if(typeof i=="string")A=pS(i,o,Y.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case O:return i=yr(31,o,s,v),i.elementType=O,i.lanes=T,i;case S:return zi(o.children,v,T,s);case w:A=8,v|=24;break;case C:return i=yr(12,o,s,v|2),i.elementType=C,i.lanes=T,i;case G:return i=yr(13,o,s,v),i.elementType=G,i.lanes=T,i;case X:return i=yr(19,o,s,v),i.elementType=X,i.lanes=T,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case M:case b:A=10;break e;case k:A=9;break e;case U:A=11;break e;case F:A=14;break e;case W:A=16,h=null;break e}A=29,o=Error(r(130,i===null?"null":typeof i,"")),h=null}return s=yr(A,o,s,v),s.elementType=i,s.type=h,s.lanes=T,s}function zi(i,s,o,h){return i=yr(7,i,h,s),i.lanes=o,i}function Gf(i,s,o){return i=yr(6,i,null,s),i.lanes=o,i}function zf(i,s,o){return s=yr(4,i.children!==null?i.children:[],i.key,s),s.lanes=o,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Is=[],Fs=0,Ac=null,bc=0,Ir=[],Fr=0,ji=null,Ra=1,Da="";function qi(i,s){Is[Fs++]=bc,Is[Fs++]=Ac,Ac=i,bc=s}function zm(i,s,o){Ir[Fr++]=Ra,Ir[Fr++]=Da,Ir[Fr++]=ji,ji=i;var h=Ra;i=Da;var v=32-Dt(h)-1;h&=~(1<<v),o+=1;var T=32-Dt(s)+v;if(30<T){var A=v-v%5;T=(h&(1<<A)-1).toString(32),h>>=A,v-=A,Ra=1<<32-Dt(s)+v|o<<v|h,Da=T+i}else Ra=1<<T|o<<v|h,Da=i}function jf(i){i.return!==null&&(qi(i,1),zm(i,1,0))}function qf(i){for(;i===Ac;)Ac=Is[--Fs],Is[Fs]=null,bc=Is[--Fs],Is[Fs]=null;for(;i===ji;)ji=Ir[--Fr],Ir[Fr]=null,Da=Ir[--Fr],Ir[Fr]=null,Ra=Ir[--Fr],Ir[Fr]=null}var ar=null,ln=null,It=!1,$i=null,la=!1,$f=Error(r(519));function Yi(i){var s=Error(r(418,""));throw Gl(Rr(s,i)),$f}function jm(i){var s=i.stateNode,o=i.type,h=i.memoizedProps;switch(s[Zt]=i,s[Qt]=h,o){case"dialog":yt("cancel",s),yt("close",s);break;case"iframe":case"object":case"embed":yt("load",s);break;case"video":case"audio":for(o=0;o<ho.length;o++)yt(ho[o],s);break;case"source":yt("error",s);break;case"img":case"image":case"link":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"input":yt("invalid",s),ka(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),ei(s);break;case"select":yt("invalid",s);break;case"textarea":yt("invalid",s),lm(s,h.value,h.defaultValue,h.children),ei(s)}o=h.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||h.suppressHydrationWarning===!0||lg(s.textContent,o)?(h.popover!=null&&(yt("beforetoggle",s),yt("toggle",s)),h.onScroll!=null&&yt("scroll",s),h.onScrollEnd!=null&&yt("scrollend",s),h.onClick!=null&&(s.onclick=lu),s=!0):s=!1,s||Yi(i)}function qm(i){for(ar=i.return;ar;)switch(ar.tag){case 5:case 13:la=!1;return;case 27:case 3:la=!0;return;default:ar=ar.return}}function Vl(i){if(i!==ar)return!1;if(!It)return qm(i),It=!0,!1;var s=i.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=i.type,o=!(o!=="form"&&o!=="button")||od(i.type,i.memoizedProps)),o=!o),o&&ln&&Yi(i),qm(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(o=i.data,o==="/$"){if(s===0){ln=Jr(i.nextSibling);break e}s--}else o!=="$"&&o!=="$!"&&o!=="$?"||s++;i=i.nextSibling}ln=null}}else s===27?(s=ln,vi(i.type)?(i=dd,dd=null,ln=i):ln=s):ln=ar?Jr(i.stateNode.nextSibling):null;return!0}function Hl(){ln=ar=null,It=!1}function $m(){var i=$i;return i!==null&&(pr===null?pr=i:pr.push.apply(pr,i),$i=null),i}function Gl(i){$i===null?$i=[i]:$i.push(i)}var Yf=j(null),Wi=null,Ia=null;function ri(i,s,o){J(Yf,s._currentValue),s._currentValue=o}function Fa(i){i._currentValue=Yf.current,R(Yf)}function Wf(i,s,o){for(;i!==null;){var h=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),i===o)break;i=i.return}}function Xf(i,s,o,h){var v=i.child;for(v!==null&&(v.return=i);v!==null;){var T=v.dependencies;if(T!==null){var A=v.child;T=T.firstContext;e:for(;T!==null;){var I=T;T=v;for(var Q=0;Q<s.length;Q++)if(I.context===s[Q]){T.lanes|=o,I=T.alternate,I!==null&&(I.lanes|=o),Wf(T.return,o,i),h||(A=null);break e}T=I.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(r(341));A.lanes|=o,T=A.alternate,T!==null&&(T.lanes|=o),Wf(A,o,i),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===i){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function zl(i,s,o,h){i=null;for(var v=s,T=!1;v!==null;){if(!T){if((v.flags&524288)!==0)T=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(r(387));if(A=A.memoizedProps,A!==null){var I=v.type;vr(v.pendingProps.value,A.value)||(i!==null?i.push(I):i=[I])}}else if(v===Ee.current){if(A=v.alternate,A===null)throw Error(r(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(i!==null?i.push(yo):i=[yo])}v=v.return}i!==null&&Xf(s,i,o,h),s.flags|=262144}function kc(i){for(i=i.firstContext;i!==null;){if(!vr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Xi(i){Wi=i,Ia=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Yn(i){return Ym(Wi,i)}function Nc(i,s){return Wi===null&&Xi(i),Ym(i,s)}function Ym(i,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Ia===null){if(i===null)throw Error(r(308));Ia=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Ia=Ia.next=s;return o}var mE=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(o,h){i.push(h)}};this.abort=function(){s.aborted=!0,i.forEach(function(o){return o()})}},pE=e.unstable_scheduleCallback,xE=e.unstable_NormalPriority,Cn={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jf(){return{controller:new mE,data:new Map,refCount:0}}function jl(i){i.refCount--,i.refCount===0&&pE(xE,function(){i.controller.abort()})}var ql=null,Kf=0,Ls=0,Os=null;function gE(i,s){if(ql===null){var o=ql=[];Kf=0,Ls=Q0(),Os={status:"pending",value:void 0,then:function(h){o.push(h)}}}return Kf++,s.then(Wm,Wm),s}function Wm(){if(--Kf===0&&ql!==null){Os!==null&&(Os.status="fulfilled");var i=ql;ql=null,Ls=0,Os=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function vE(i,s){var o=[],h={status:"pending",value:null,reason:null,then:function(v){o.push(v)}};return i.then(function(){h.status="fulfilled",h.value=s;for(var v=0;v<o.length;v++)(0,o[v])(s)},function(v){for(h.status="rejected",h.reason=v,v=0;v<o.length;v++)(0,o[v])(void 0)}),h}var Xm=ae.S;ae.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&gE(i,s),Xm!==null&&Xm(i,s)};var Ji=j(null);function Zf(){var i=Ji.current;return i!==null?i:Xt.pooledCache}function Mc(i,s){s===null?J(Ji,Ji.current):J(Ji,s.pool)}function Jm(){var i=Zf();return i===null?null:{parent:Cn._currentValue,pool:i}}var $l=Error(r(460)),Km=Error(r(474)),Rc=Error(r(542)),Qf={then:function(){}};function Zm(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Dc(){}function Qm(i,s,o){switch(o=i[o],o===void 0?i.push(s):o!==s&&(s.then(Dc,Dc),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,tp(i),i;default:if(typeof s.status=="string")s.then(Dc,Dc);else{if(i=Xt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(h){if(s.status==="pending"){var v=s;v.status="fulfilled",v.value=h}},function(h){if(s.status==="pending"){var v=s;v.status="rejected",v.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,tp(i),i}throw Yl=s,$l}}var Yl=null;function ep(){if(Yl===null)throw Error(r(459));var i=Yl;return Yl=null,i}function tp(i){if(i===$l||i===Rc)throw Error(r(483))}var ai=!1;function e0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function t0(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function ii(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function si(i,s,o){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Ut&2)!==0){var v=h.pending;return v===null?s.next=s:(s.next=v.next,v.next=s),h.pending=s,s=wc(i),Hm(i,null,o),s}return Sc(i,h,s,o),wc(i)}function Wl(i,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var h=s.lanes;h&=i.pendingLanes,o|=h,s.lanes=o,sn(i,o)}}function n0(i,s){var o=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var v=null,T=null;if(o=o.firstBaseUpdate,o!==null){do{var A={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};T===null?v=T=A:T=T.next=A,o=o.next}while(o!==null);T===null?v=T=s:T=T.next=s}else v=T=s;o={baseState:h.baseState,firstBaseUpdate:v,lastBaseUpdate:T,shared:h.shared,callbacks:h.callbacks},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=s:i.next=s,o.lastBaseUpdate=s}var r0=!1;function Xl(){if(r0){var i=Os;if(i!==null)throw i}}function Jl(i,s,o,h){r0=!1;var v=i.updateQueue;ai=!1;var T=v.firstBaseUpdate,A=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var Q=I,he=Q.next;Q.next=null,A===null?T=he:A.next=he,A=Q;var Ae=i.alternate;Ae!==null&&(Ae=Ae.updateQueue,I=Ae.lastBaseUpdate,I!==A&&(I===null?Ae.firstBaseUpdate=he:I.next=he,Ae.lastBaseUpdate=Q))}if(T!==null){var Ne=v.baseState;A=0,Ae=he=Q=null,I=T;do{var ge=I.lane&-536870913,ye=ge!==I.lane;if(ye?(Ct&ge)===ge:(h&ge)===ge){ge!==0&&ge===Ls&&(r0=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var et=i,Ze=I;ge=s;var zt=o;switch(Ze.tag){case 1:if(et=Ze.payload,typeof et=="function"){Ne=et.call(zt,Ne,ge);break e}Ne=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=Ze.payload,ge=typeof et=="function"?et.call(zt,Ne,ge):et,ge==null)break e;Ne=x({},Ne,ge);break e;case 2:ai=!0}}ge=I.callback,ge!==null&&(i.flags|=64,ye&&(i.flags|=8192),ye=v.callbacks,ye===null?v.callbacks=[ge]:ye.push(ge))}else ye={lane:ge,tag:I.tag,payload:I.payload,callback:I.callback,next:null},Ae===null?(he=Ae=ye,Q=Ne):Ae=Ae.next=ye,A|=ge;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;ye=I,I=ye.next,ye.next=null,v.lastBaseUpdate=ye,v.shared.pending=null}}while(!0);Ae===null&&(Q=Ne),v.baseState=Q,v.firstBaseUpdate=he,v.lastBaseUpdate=Ae,T===null&&(v.shared.lanes=0),mi|=A,i.lanes=A,i.memoizedState=Ne}}function np(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function rp(i,s){var o=i.callbacks;if(o!==null)for(i.callbacks=null,i=0;i<o.length;i++)np(o[i],s)}var Ps=j(null),Ic=j(0);function ap(i,s){i=Ha,J(Ic,i),J(Ps,s),Ha=i|s.baseLanes}function a0(){J(Ic,Ha),J(Ps,Ps.current)}function i0(){Ha=Ic.current,R(Ps),R(Ic)}var li=0,ht=null,Ht=null,xn=null,Fc=!1,Us=!1,Ki=!1,Lc=0,Kl=0,Bs=null,yE=0;function hn(){throw Error(r(321))}function s0(i,s){if(s===null)return!1;for(var o=0;o<s.length&&o<i.length;o++)if(!vr(i[o],s[o]))return!1;return!0}function l0(i,s,o,h,v,T){return li=T,ht=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ae.H=i===null||i.memoizedState===null?Hp:Gp,Ki=!1,T=o(h,v),Ki=!1,Us&&(T=sp(s,o,h,v)),ip(i),T}function ip(i){ae.H=Hc;var s=Ht!==null&&Ht.next!==null;if(li=0,xn=Ht=ht=null,Fc=!1,Kl=0,Bs=null,s)throw Error(r(300));i===null||In||(i=i.dependencies,i!==null&&kc(i)&&(In=!0))}function sp(i,s,o,h){ht=i;var v=0;do{if(Us&&(Bs=null),Kl=0,Us=!1,25<=v)throw Error(r(301));if(v+=1,xn=Ht=null,i.updateQueue!=null){var T=i.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}ae.H=AE,T=s(o,h)}while(Us);return T}function TE(){var i=ae.H,s=i.useState()[0];return s=typeof s.then=="function"?Zl(s):s,i=i.useState()[0],(Ht!==null?Ht.memoizedState:null)!==i&&(ht.flags|=1024),s}function o0(){var i=Lc!==0;return Lc=0,i}function c0(i,s,o){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~o}function u0(i){if(Fc){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Fc=!1}li=0,xn=Ht=ht=null,Us=!1,Kl=Lc=0,Bs=null}function hr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?ht.memoizedState=xn=i:xn=xn.next=i,xn}function gn(){if(Ht===null){var i=ht.alternate;i=i!==null?i.memoizedState:null}else i=Ht.next;var s=xn===null?ht.memoizedState:xn.next;if(s!==null)xn=s,Ht=i;else{if(i===null)throw ht.alternate===null?Error(r(467)):Error(r(310));Ht=i,i={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},xn===null?ht.memoizedState=xn=i:xn=xn.next=i}return xn}function f0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zl(i){var s=Kl;return Kl+=1,Bs===null&&(Bs=[]),i=Qm(Bs,i,s),s=ht,(xn===null?s.memoizedState:xn.next)===null&&(s=s.alternate,ae.H=s===null||s.memoizedState===null?Hp:Gp),i}function Oc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Zl(i);if(i.$$typeof===b)return Yn(i)}throw Error(r(438,String(i)))}function d0(i){var s=null,o=ht.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var h=ht.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(v){return v.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=f0(),ht.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(i),h=0;h<i;h++)o[h]=te;return s.index++,o}function La(i,s){return typeof s=="function"?s(i):s}function Pc(i){var s=gn();return h0(s,Ht,i)}function h0(i,s,o){var h=i.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=o;var v=i.baseQueue,T=h.pending;if(T!==null){if(v!==null){var A=v.next;v.next=T.next,T.next=A}s.baseQueue=v=T,h.pending=null}if(T=i.baseState,v===null)i.memoizedState=T;else{s=v.next;var I=A=null,Q=null,he=s,Ae=!1;do{var Ne=he.lane&-536870913;if(Ne!==he.lane?(Ct&Ne)===Ne:(li&Ne)===Ne){var ge=he.revertLane;if(ge===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),Ne===Ls&&(Ae=!0);else if((li&ge)===ge){he=he.next,ge===Ls&&(Ae=!0);continue}else Ne={lane:0,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},Q===null?(I=Q=Ne,A=T):Q=Q.next=Ne,ht.lanes|=ge,mi|=ge;Ne=he.action,Ki&&o(T,Ne),T=he.hasEagerState?he.eagerState:o(T,Ne)}else ge={lane:Ne,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},Q===null?(I=Q=ge,A=T):Q=Q.next=ge,ht.lanes|=Ne,mi|=Ne;he=he.next}while(he!==null&&he!==s);if(Q===null?A=T:Q.next=I,!vr(T,i.memoizedState)&&(In=!0,Ae&&(o=Os,o!==null)))throw o;i.memoizedState=T,i.baseState=A,i.baseQueue=Q,h.lastRenderedState=T}return v===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function m0(i){var s=gn(),o=s.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=i;var h=o.dispatch,v=o.pending,T=s.memoizedState;if(v!==null){o.pending=null;var A=v=v.next;do T=i(T,A.action),A=A.next;while(A!==v);vr(T,s.memoizedState)||(In=!0),s.memoizedState=T,s.baseQueue===null&&(s.baseState=T),o.lastRenderedState=T}return[T,h]}function lp(i,s,o){var h=ht,v=gn(),T=It;if(T){if(o===void 0)throw Error(r(407));o=o()}else o=s();var A=!vr((Ht||v).memoizedState,o);A&&(v.memoizedState=o,In=!0),v=v.queue;var I=up.bind(null,h,v,i);if(Ql(2048,8,I,[i]),v.getSnapshot!==s||A||xn!==null&&xn.memoizedState.tag&1){if(h.flags|=2048,Vs(9,Uc(),cp.bind(null,h,v,o,s),null),Xt===null)throw Error(r(349));T||(li&124)!==0||op(h,s,o)}return o}function op(i,s,o){i.flags|=16384,i={getSnapshot:s,value:o},s=ht.updateQueue,s===null?(s=f0(),ht.updateQueue=s,s.stores=[i]):(o=s.stores,o===null?s.stores=[i]:o.push(i))}function cp(i,s,o,h){s.value=o,s.getSnapshot=h,fp(s)&&dp(i)}function up(i,s,o){return o(function(){fp(s)&&dp(i)})}function fp(i){var s=i.getSnapshot;i=i.value;try{var o=s();return!vr(i,o)}catch{return!0}}function dp(i){var s=Rs(i,2);s!==null&&wr(s,i,2)}function p0(i){var s=hr();if(typeof i=="function"){var o=i;if(i=o(),Ki){at(!0);try{o()}finally{at(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:La,lastRenderedState:i},s}function hp(i,s,o,h){return i.baseState=o,h0(i,Ht,typeof h=="function"?h:La)}function _E(i,s,o,h,v){if(Vc(i))throw Error(r(485));if(i=s.action,i!==null){var T={payload:v,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){T.listeners.push(A)}};ae.T!==null?o(!0):T.isTransition=!1,h(T),o=s.pending,o===null?(T.next=s.pending=T,mp(s,T)):(T.next=o.next,s.pending=o.next=T)}}function mp(i,s){var o=s.action,h=s.payload,v=i.state;if(s.isTransition){var T=ae.T,A={};ae.T=A;try{var I=o(v,h),Q=ae.S;Q!==null&&Q(A,I),pp(i,s,I)}catch(he){x0(i,s,he)}finally{ae.T=T}}else try{T=o(v,h),pp(i,s,T)}catch(he){x0(i,s,he)}}function pp(i,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(h){xp(i,s,h)},function(h){return x0(i,s,h)}):xp(i,s,o)}function xp(i,s,o){s.status="fulfilled",s.value=o,gp(s),i.state=o,s=i.pending,s!==null&&(o=s.next,o===s?i.pending=null:(o=o.next,s.next=o,mp(i,o)))}function x0(i,s,o){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=o,gp(s),s=s.next;while(s!==h)}i.action=null}function gp(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function vp(i,s){return s}function yp(i,s){if(It){var o=Xt.formState;if(o!==null){e:{var h=ht;if(It){if(ln){t:{for(var v=ln,T=la;v.nodeType!==8;){if(!T){v=null;break t}if(v=Jr(v.nextSibling),v===null){v=null;break t}}T=v.data,v=T==="F!"||T==="F"?v:null}if(v){ln=Jr(v.nextSibling),h=v.data==="F!";break e}}Yi(h)}h=!1}h&&(s=o[0])}}return o=hr(),o.memoizedState=o.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vp,lastRenderedState:s},o.queue=h,o=Up.bind(null,ht,h),h.dispatch=o,h=p0(!1),T=_0.bind(null,ht,!1,h.queue),h=hr(),v={state:s,dispatch:null,action:i,pending:null},h.queue=v,o=_E.bind(null,ht,v,T,o),v.dispatch=o,h.memoizedState=i,[s,o,!1]}function Tp(i){var s=gn();return _p(s,Ht,i)}function _p(i,s,o){if(s=h0(i,s,vp)[0],i=Pc(La)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=Zl(s)}catch(A){throw A===$l?Rc:A}else h=s;s=gn();var v=s.queue,T=v.dispatch;return o!==s.memoizedState&&(ht.flags|=2048,Vs(9,Uc(),EE.bind(null,v,o),null)),[h,T,i]}function EE(i,s){i.action=s}function Ep(i){var s=gn(),o=Ht;if(o!==null)return _p(s,o,i);gn(),s=s.memoizedState,o=gn();var h=o.queue.dispatch;return o.memoizedState=i,[s,h,!1]}function Vs(i,s,o,h){return i={tag:i,create:o,deps:h,inst:s,next:null},s=ht.updateQueue,s===null&&(s=f0(),ht.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=i.next=i:(h=o.next,o.next=i,i.next=h,s.lastEffect=i),i}function Uc(){return{destroy:void 0,resource:void 0}}function Sp(){return gn().memoizedState}function Bc(i,s,o,h){var v=hr();h=h===void 0?null:h,ht.flags|=i,v.memoizedState=Vs(1|s,Uc(),o,h)}function Ql(i,s,o,h){var v=gn();h=h===void 0?null:h;var T=v.memoizedState.inst;Ht!==null&&h!==null&&s0(h,Ht.memoizedState.deps)?v.memoizedState=Vs(s,T,o,h):(ht.flags|=i,v.memoizedState=Vs(1|s,T,o,h))}function wp(i,s){Bc(8390656,8,i,s)}function Cp(i,s){Ql(2048,8,i,s)}function Ap(i,s){return Ql(4,2,i,s)}function bp(i,s){return Ql(4,4,i,s)}function kp(i,s){if(typeof s=="function"){i=i();var o=s(i);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function Np(i,s,o){o=o!=null?o.concat([i]):null,Ql(4,4,kp.bind(null,s,i),o)}function g0(){}function Mp(i,s){var o=gn();s=s===void 0?null:s;var h=o.memoizedState;return s!==null&&s0(s,h[1])?h[0]:(o.memoizedState=[i,s],i)}function Rp(i,s){var o=gn();s=s===void 0?null:s;var h=o.memoizedState;if(s!==null&&s0(s,h[1]))return h[0];if(h=i(),Ki){at(!0);try{i()}finally{at(!1)}}return o.memoizedState=[h,s],h}function v0(i,s,o){return o===void 0||(li&1073741824)!==0?i.memoizedState=s:(i.memoizedState=o,i=Fx(),ht.lanes|=i,mi|=i,o)}function Dp(i,s,o,h){return vr(o,s)?o:Ps.current!==null?(i=v0(i,o,h),vr(i,s)||(In=!0),i):(li&42)===0?(In=!0,i.memoizedState=o):(i=Fx(),ht.lanes|=i,mi|=i,s)}function Ip(i,s,o,h,v){var T=me.p;me.p=T!==0&&8>T?T:8;var A=ae.T,I={};ae.T=I,_0(i,!1,s,o);try{var Q=v(),he=ae.S;if(he!==null&&he(I,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var Ae=vE(Q,h);eo(i,s,Ae,Sr(i))}else eo(i,s,h,Sr(i))}catch(Ne){eo(i,s,{then:function(){},status:"rejected",reason:Ne},Sr())}finally{me.p=T,ae.T=A}}function SE(){}function y0(i,s,o,h){if(i.tag!==5)throw Error(r(476));var v=Fp(i).queue;Ip(i,v,s,re,o===null?SE:function(){return Lp(i),o(h)})}function Fp(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:La,lastRenderedState:re},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:La,lastRenderedState:o},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Lp(i){var s=Fp(i).next.queue;eo(i,s,{},Sr())}function T0(){return Yn(yo)}function Op(){return gn().memoizedState}function Pp(){return gn().memoizedState}function wE(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var o=Sr();i=ii(o);var h=si(s,i,o);h!==null&&(wr(h,s,o),Wl(h,s,o)),s={cache:Jf()},i.payload=s;return}s=s.return}}function CE(i,s,o){var h=Sr();o={lane:h,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},Vc(i)?Bp(s,o):(o=Vf(i,s,o,h),o!==null&&(wr(o,i,h),Vp(o,s,h)))}function Up(i,s,o){var h=Sr();eo(i,s,o,h)}function eo(i,s,o,h){var v={lane:h,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(Vc(i))Bp(s,v);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=s.lastRenderedReducer,T!==null))try{var A=s.lastRenderedState,I=T(A,o);if(v.hasEagerState=!0,v.eagerState=I,vr(I,A))return Sc(i,s,v,0),Xt===null&&Ec(),!1}catch{}finally{}if(o=Vf(i,s,v,h),o!==null)return wr(o,i,h),Vp(o,s,h),!0}return!1}function _0(i,s,o,h){if(h={lane:2,revertLane:Q0(),action:h,hasEagerState:!1,eagerState:null,next:null},Vc(i)){if(s)throw Error(r(479))}else s=Vf(i,o,h,2),s!==null&&wr(s,i,2)}function Vc(i){var s=i.alternate;return i===ht||s!==null&&s===ht}function Bp(i,s){Us=Fc=!0;var o=i.pending;o===null?s.next=s:(s.next=o.next,o.next=s),i.pending=s}function Vp(i,s,o){if((o&4194048)!==0){var h=s.lanes;h&=i.pendingLanes,o|=h,s.lanes=o,sn(i,o)}}var Hc={readContext:Yn,use:Oc,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useLayoutEffect:hn,useInsertionEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useSyncExternalStore:hn,useId:hn,useHostTransitionStatus:hn,useFormState:hn,useActionState:hn,useOptimistic:hn,useMemoCache:hn,useCacheRefresh:hn},Hp={readContext:Yn,use:Oc,useCallback:function(i,s){return hr().memoizedState=[i,s===void 0?null:s],i},useContext:Yn,useEffect:wp,useImperativeHandle:function(i,s,o){o=o!=null?o.concat([i]):null,Bc(4194308,4,kp.bind(null,s,i),o)},useLayoutEffect:function(i,s){return Bc(4194308,4,i,s)},useInsertionEffect:function(i,s){Bc(4,2,i,s)},useMemo:function(i,s){var o=hr();s=s===void 0?null:s;var h=i();if(Ki){at(!0);try{i()}finally{at(!1)}}return o.memoizedState=[h,s],h},useReducer:function(i,s,o){var h=hr();if(o!==void 0){var v=o(s);if(Ki){at(!0);try{o(s)}finally{at(!1)}}}else v=s;return h.memoizedState=h.baseState=v,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:v},h.queue=i,i=i.dispatch=CE.bind(null,ht,i),[h.memoizedState,i]},useRef:function(i){var s=hr();return i={current:i},s.memoizedState=i},useState:function(i){i=p0(i);var s=i.queue,o=Up.bind(null,ht,s);return s.dispatch=o,[i.memoizedState,o]},useDebugValue:g0,useDeferredValue:function(i,s){var o=hr();return v0(o,i,s)},useTransition:function(){var i=p0(!1);return i=Ip.bind(null,ht,i.queue,!0,!1),hr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,o){var h=ht,v=hr();if(It){if(o===void 0)throw Error(r(407));o=o()}else{if(o=s(),Xt===null)throw Error(r(349));(Ct&124)!==0||op(h,s,o)}v.memoizedState=o;var T={value:o,getSnapshot:s};return v.queue=T,wp(up.bind(null,h,T,i),[i]),h.flags|=2048,Vs(9,Uc(),cp.bind(null,h,T,o,s),null),o},useId:function(){var i=hr(),s=Xt.identifierPrefix;if(It){var o=Da,h=Ra;o=(h&~(1<<32-Dt(h)-1)).toString(32)+o,s=""+s+"R"+o,o=Lc++,0<o&&(s+="H"+o.toString(32)),s+=""}else o=yE++,s=""+s+"r"+o.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:T0,useFormState:yp,useActionState:yp,useOptimistic:function(i){var s=hr();s.memoizedState=s.baseState=i;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=_0.bind(null,ht,!0,o),o.dispatch=s,[i,s]},useMemoCache:d0,useCacheRefresh:function(){return hr().memoizedState=wE.bind(null,ht)}},Gp={readContext:Yn,use:Oc,useCallback:Mp,useContext:Yn,useEffect:Cp,useImperativeHandle:Np,useInsertionEffect:Ap,useLayoutEffect:bp,useMemo:Rp,useReducer:Pc,useRef:Sp,useState:function(){return Pc(La)},useDebugValue:g0,useDeferredValue:function(i,s){var o=gn();return Dp(o,Ht.memoizedState,i,s)},useTransition:function(){var i=Pc(La)[0],s=gn().memoizedState;return[typeof i=="boolean"?i:Zl(i),s]},useSyncExternalStore:lp,useId:Op,useHostTransitionStatus:T0,useFormState:Tp,useActionState:Tp,useOptimistic:function(i,s){var o=gn();return hp(o,Ht,i,s)},useMemoCache:d0,useCacheRefresh:Pp},AE={readContext:Yn,use:Oc,useCallback:Mp,useContext:Yn,useEffect:Cp,useImperativeHandle:Np,useInsertionEffect:Ap,useLayoutEffect:bp,useMemo:Rp,useReducer:m0,useRef:Sp,useState:function(){return m0(La)},useDebugValue:g0,useDeferredValue:function(i,s){var o=gn();return Ht===null?v0(o,i,s):Dp(o,Ht.memoizedState,i,s)},useTransition:function(){var i=m0(La)[0],s=gn().memoizedState;return[typeof i=="boolean"?i:Zl(i),s]},useSyncExternalStore:lp,useId:Op,useHostTransitionStatus:T0,useFormState:Ep,useActionState:Ep,useOptimistic:function(i,s){var o=gn();return Ht!==null?hp(o,Ht,i,s):(o.baseState=i,[i,o.queue.dispatch])},useMemoCache:d0,useCacheRefresh:Pp},Hs=null,to=0;function Gc(i){var s=to;return to+=1,Hs===null&&(Hs=[]),Qm(Hs,i,s)}function no(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function zc(i,s){throw s.$$typeof===y?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function zp(i){var s=i._init;return s(i._payload)}function jp(i){function s(le,ie){if(i){var ue=le.deletions;ue===null?(le.deletions=[ie],le.flags|=16):ue.push(ie)}}function o(le,ie){if(!i)return null;for(;ie!==null;)s(le,ie),ie=ie.sibling;return null}function h(le){for(var ie=new Map;le!==null;)le.key!==null?ie.set(le.key,le):ie.set(le.index,le),le=le.sibling;return ie}function v(le,ie){return le=Ma(le,ie),le.index=0,le.sibling=null,le}function T(le,ie,ue){return le.index=ue,i?(ue=le.alternate,ue!==null?(ue=ue.index,ue<ie?(le.flags|=67108866,ie):ue):(le.flags|=67108866,ie)):(le.flags|=1048576,ie)}function A(le){return i&&le.alternate===null&&(le.flags|=67108866),le}function I(le,ie,ue,be){return ie===null||ie.tag!==6?(ie=Gf(ue,le.mode,be),ie.return=le,ie):(ie=v(ie,ue),ie.return=le,ie)}function Q(le,ie,ue,be){var je=ue.type;return je===S?Ae(le,ie,ue.props.children,be,ue.key):ie!==null&&(ie.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===W&&zp(je)===ie.type)?(ie=v(ie,ue.props),no(ie,ue),ie.return=le,ie):(ie=Cc(ue.type,ue.key,ue.props,null,le.mode,be),no(ie,ue),ie.return=le,ie)}function he(le,ie,ue,be){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==ue.containerInfo||ie.stateNode.implementation!==ue.implementation?(ie=zf(ue,le.mode,be),ie.return=le,ie):(ie=v(ie,ue.children||[]),ie.return=le,ie)}function Ae(le,ie,ue,be,je){return ie===null||ie.tag!==7?(ie=zi(ue,le.mode,be,je),ie.return=le,ie):(ie=v(ie,ue),ie.return=le,ie)}function Ne(le,ie,ue){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=Gf(""+ie,le.mode,ue),ie.return=le,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:return ue=Cc(ie.type,ie.key,ie.props,null,le.mode,ue),no(ue,ie),ue.return=le,ue;case E:return ie=zf(ie,le.mode,ue),ie.return=le,ie;case W:var be=ie._init;return ie=be(ie._payload),Ne(le,ie,ue)}if(we(ie)||ee(ie))return ie=zi(ie,le.mode,ue,null),ie.return=le,ie;if(typeof ie.then=="function")return Ne(le,Gc(ie),ue);if(ie.$$typeof===b)return Ne(le,Nc(le,ie),ue);zc(le,ie)}return null}function ge(le,ie,ue,be){var je=ie!==null?ie.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return je!==null?null:I(le,ie,""+ue,be);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case _:return ue.key===je?Q(le,ie,ue,be):null;case E:return ue.key===je?he(le,ie,ue,be):null;case W:return je=ue._init,ue=je(ue._payload),ge(le,ie,ue,be)}if(we(ue)||ee(ue))return je!==null?null:Ae(le,ie,ue,be,null);if(typeof ue.then=="function")return ge(le,ie,Gc(ue),be);if(ue.$$typeof===b)return ge(le,ie,Nc(le,ue),be);zc(le,ue)}return null}function ye(le,ie,ue,be,je){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return le=le.get(ue)||null,I(ie,le,""+be,je);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case _:return le=le.get(be.key===null?ue:be.key)||null,Q(ie,le,be,je);case E:return le=le.get(be.key===null?ue:be.key)||null,he(ie,le,be,je);case W:var mt=be._init;return be=mt(be._payload),ye(le,ie,ue,be,je)}if(we(be)||ee(be))return le=le.get(ue)||null,Ae(ie,le,be,je,null);if(typeof be.then=="function")return ye(le,ie,ue,Gc(be),je);if(be.$$typeof===b)return ye(le,ie,ue,Nc(ie,be),je);zc(ie,be)}return null}function et(le,ie,ue,be){for(var je=null,mt=null,Xe=ie,Qe=ie=0,Ln=null;Xe!==null&&Qe<ue.length;Qe++){Xe.index>Qe?(Ln=Xe,Xe=null):Ln=Xe.sibling;var Mt=ge(le,Xe,ue[Qe],be);if(Mt===null){Xe===null&&(Xe=Ln);break}i&&Xe&&Mt.alternate===null&&s(le,Xe),ie=T(Mt,ie,Qe),mt===null?je=Mt:mt.sibling=Mt,mt=Mt,Xe=Ln}if(Qe===ue.length)return o(le,Xe),It&&qi(le,Qe),je;if(Xe===null){for(;Qe<ue.length;Qe++)Xe=Ne(le,ue[Qe],be),Xe!==null&&(ie=T(Xe,ie,Qe),mt===null?je=Xe:mt.sibling=Xe,mt=Xe);return It&&qi(le,Qe),je}for(Xe=h(Xe);Qe<ue.length;Qe++)Ln=ye(Xe,le,Qe,ue[Qe],be),Ln!==null&&(i&&Ln.alternate!==null&&Xe.delete(Ln.key===null?Qe:Ln.key),ie=T(Ln,ie,Qe),mt===null?je=Ln:mt.sibling=Ln,mt=Ln);return i&&Xe.forEach(function(Si){return s(le,Si)}),It&&qi(le,Qe),je}function Ze(le,ie,ue,be){if(ue==null)throw Error(r(151));for(var je=null,mt=null,Xe=ie,Qe=ie=0,Ln=null,Mt=ue.next();Xe!==null&&!Mt.done;Qe++,Mt=ue.next()){Xe.index>Qe?(Ln=Xe,Xe=null):Ln=Xe.sibling;var Si=ge(le,Xe,Mt.value,be);if(Si===null){Xe===null&&(Xe=Ln);break}i&&Xe&&Si.alternate===null&&s(le,Xe),ie=T(Si,ie,Qe),mt===null?je=Si:mt.sibling=Si,mt=Si,Xe=Ln}if(Mt.done)return o(le,Xe),It&&qi(le,Qe),je;if(Xe===null){for(;!Mt.done;Qe++,Mt=ue.next())Mt=Ne(le,Mt.value,be),Mt!==null&&(ie=T(Mt,ie,Qe),mt===null?je=Mt:mt.sibling=Mt,mt=Mt);return It&&qi(le,Qe),je}for(Xe=h(Xe);!Mt.done;Qe++,Mt=ue.next())Mt=ye(Xe,le,Qe,Mt.value,be),Mt!==null&&(i&&Mt.alternate!==null&&Xe.delete(Mt.key===null?Qe:Mt.key),ie=T(Mt,ie,Qe),mt===null?je=Mt:mt.sibling=Mt,mt=Mt);return i&&Xe.forEach(function(bS){return s(le,bS)}),It&&qi(le,Qe),je}function zt(le,ie,ue,be){if(typeof ue=="object"&&ue!==null&&ue.type===S&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case _:e:{for(var je=ue.key;ie!==null;){if(ie.key===je){if(je=ue.type,je===S){if(ie.tag===7){o(le,ie.sibling),be=v(ie,ue.props.children),be.return=le,le=be;break e}}else if(ie.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===W&&zp(je)===ie.type){o(le,ie.sibling),be=v(ie,ue.props),no(be,ue),be.return=le,le=be;break e}o(le,ie);break}else s(le,ie);ie=ie.sibling}ue.type===S?(be=zi(ue.props.children,le.mode,be,ue.key),be.return=le,le=be):(be=Cc(ue.type,ue.key,ue.props,null,le.mode,be),no(be,ue),be.return=le,le=be)}return A(le);case E:e:{for(je=ue.key;ie!==null;){if(ie.key===je)if(ie.tag===4&&ie.stateNode.containerInfo===ue.containerInfo&&ie.stateNode.implementation===ue.implementation){o(le,ie.sibling),be=v(ie,ue.children||[]),be.return=le,le=be;break e}else{o(le,ie);break}else s(le,ie);ie=ie.sibling}be=zf(ue,le.mode,be),be.return=le,le=be}return A(le);case W:return je=ue._init,ue=je(ue._payload),zt(le,ie,ue,be)}if(we(ue))return et(le,ie,ue,be);if(ee(ue)){if(je=ee(ue),typeof je!="function")throw Error(r(150));return ue=je.call(ue),Ze(le,ie,ue,be)}if(typeof ue.then=="function")return zt(le,ie,Gc(ue),be);if(ue.$$typeof===b)return zt(le,ie,Nc(le,ue),be);zc(le,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,ie!==null&&ie.tag===6?(o(le,ie.sibling),be=v(ie,ue),be.return=le,le=be):(o(le,ie),be=Gf(ue,le.mode,be),be.return=le,le=be),A(le)):o(le,ie)}return function(le,ie,ue,be){try{to=0;var je=zt(le,ie,ue,be);return Hs=null,je}catch(Xe){if(Xe===$l||Xe===Rc)throw Xe;var mt=yr(29,Xe,null,le.mode);return mt.lanes=be,mt.return=le,mt}finally{}}}var Gs=jp(!0),qp=jp(!1),Lr=j(null),oa=null;function oi(i){var s=i.alternate;J(An,An.current&1),J(Lr,i),oa===null&&(s===null||Ps.current!==null||s.memoizedState!==null)&&(oa=i)}function $p(i){if(i.tag===22){if(J(An,An.current),J(Lr,i),oa===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(oa=i)}}else ci()}function ci(){J(An,An.current),J(Lr,Lr.current)}function Oa(i){R(Lr),oa===i&&(oa=null),R(An)}var An=j(0);function jc(i){for(var s=i;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||fd(o)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function E0(i,s,o,h){s=i.memoizedState,o=o(h,s),o=o==null?s:x({},s,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var S0={enqueueSetState:function(i,s,o){i=i._reactInternals;var h=Sr(),v=ii(h);v.payload=s,o!=null&&(v.callback=o),s=si(i,v,h),s!==null&&(wr(s,i,h),Wl(s,i,h))},enqueueReplaceState:function(i,s,o){i=i._reactInternals;var h=Sr(),v=ii(h);v.tag=1,v.payload=s,o!=null&&(v.callback=o),s=si(i,v,h),s!==null&&(wr(s,i,h),Wl(s,i,h))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var o=Sr(),h=ii(o);h.tag=2,s!=null&&(h.callback=s),s=si(i,h,o),s!==null&&(wr(s,i,o),Wl(s,i,o))}};function Yp(i,s,o,h,v,T,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,T,A):s.prototype&&s.prototype.isPureReactComponent?!Ul(o,h)||!Ul(v,T):!0}function Wp(i,s,o,h){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,h),s.state!==i&&S0.enqueueReplaceState(s,s.state,null)}function Zi(i,s){var o=s;if("ref"in s){o={};for(var h in s)h!=="ref"&&(o[h]=s[h])}if(i=i.defaultProps){o===s&&(o=x({},o));for(var v in i)o[v]===void 0&&(o[v]=i[v])}return o}var qc=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Xp(i){qc(i)}function Jp(i){console.error(i)}function Kp(i){qc(i)}function $c(i,s){try{var o=i.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function Zp(i,s,o){try{var h=i.onCaughtError;h(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function w0(i,s,o){return o=ii(o),o.tag=3,o.payload={element:null},o.callback=function(){$c(i,s)},o}function Qp(i){return i=ii(i),i.tag=3,i}function ex(i,s,o,h){var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var T=h.value;i.payload=function(){return v(T)},i.callback=function(){Zp(s,o,h)}}var A=o.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(i.callback=function(){Zp(s,o,h),typeof v!="function"&&(pi===null?pi=new Set([this]):pi.add(this));var I=h.stack;this.componentDidCatch(h.value,{componentStack:I!==null?I:""})})}function bE(i,s,o,h,v){if(o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=o.alternate,s!==null&&zl(s,o,v,!0),o=Lr.current,o!==null){switch(o.tag){case 13:return oa===null?W0():o.alternate===null&&on===0&&(on=3),o.flags&=-257,o.flags|=65536,o.lanes=v,h===Qf?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([h]):s.add(h),J0(i,h,v)),!1;case 22:return o.flags|=65536,h===Qf?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([h]):o.add(h)),J0(i,h,v)),!1}throw Error(r(435,o.tag))}return J0(i,h,v),W0(),!1}if(It)return s=Lr.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=v,h!==$f&&(i=Error(r(422),{cause:h}),Gl(Rr(i,o)))):(h!==$f&&(s=Error(r(423),{cause:h}),Gl(Rr(s,o))),i=i.current.alternate,i.flags|=65536,v&=-v,i.lanes|=v,h=Rr(h,o),v=w0(i.stateNode,h,v),n0(i,v),on!==4&&(on=2)),!1;var T=Error(r(520),{cause:h});if(T=Rr(T,o),co===null?co=[T]:co.push(T),on!==4&&(on=2),s===null)return!0;h=Rr(h,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,i=v&-v,o.lanes|=i,i=w0(o.stateNode,h,i),n0(o,i),!1;case 1:if(s=o.type,T=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(pi===null||!pi.has(T))))return o.flags|=65536,v&=-v,o.lanes|=v,v=Qp(v),ex(v,i,o,h),n0(o,v),!1}o=o.return}while(o!==null);return!1}var tx=Error(r(461)),In=!1;function Hn(i,s,o,h){s.child=i===null?qp(s,null,o,h):Gs(s,i.child,o,h)}function nx(i,s,o,h,v){o=o.render;var T=s.ref;if("ref"in h){var A={};for(var I in h)I!=="ref"&&(A[I]=h[I])}else A=h;return Xi(s),h=l0(i,s,o,A,T,v),I=o0(),i!==null&&!In?(c0(i,s,v),Pa(i,s,v)):(It&&I&&jf(s),s.flags|=1,Hn(i,s,h,v),s.child)}function rx(i,s,o,h,v){if(i===null){var T=o.type;return typeof T=="function"&&!Hf(T)&&T.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=T,ax(i,s,T,h,v)):(i=Cc(o.type,null,h,s,s.mode,v),i.ref=s.ref,i.return=s,s.child=i)}if(T=i.child,!D0(i,v)){var A=T.memoizedProps;if(o=o.compare,o=o!==null?o:Ul,o(A,h)&&i.ref===s.ref)return Pa(i,s,v)}return s.flags|=1,i=Ma(T,h),i.ref=s.ref,i.return=s,s.child=i}function ax(i,s,o,h,v){if(i!==null){var T=i.memoizedProps;if(Ul(T,h)&&i.ref===s.ref)if(In=!1,s.pendingProps=h=T,D0(i,v))(i.flags&131072)!==0&&(In=!0);else return s.lanes=i.lanes,Pa(i,s,v)}return C0(i,s,o,h,v)}function ix(i,s,o){var h=s.pendingProps,v=h.children,T=i!==null?i.memoizedState:null;if(h.mode==="hidden"){if((s.flags&128)!==0){if(h=T!==null?T.baseLanes|o:o,i!==null){for(v=s.child=i.child,T=0;v!==null;)T=T|v.lanes|v.childLanes,v=v.sibling;s.childLanes=T&~h}else s.childLanes=0,s.child=null;return sx(i,s,h,o)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Mc(s,T!==null?T.cachePool:null),T!==null?ap(s,T):a0(),$p(s);else return s.lanes=s.childLanes=536870912,sx(i,s,T!==null?T.baseLanes|o:o,o)}else T!==null?(Mc(s,T.cachePool),ap(s,T),ci(),s.memoizedState=null):(i!==null&&Mc(s,null),a0(),ci());return Hn(i,s,v,o),s.child}function sx(i,s,o,h){var v=Zf();return v=v===null?null:{parent:Cn._currentValue,pool:v},s.memoizedState={baseLanes:o,cachePool:v},i!==null&&Mc(s,null),a0(),$p(s),i!==null&&zl(i,s,h,!0),null}function Yc(i,s){var o=s.ref;if(o===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(i===null||i.ref!==o)&&(s.flags|=4194816)}}function C0(i,s,o,h,v){return Xi(s),o=l0(i,s,o,h,void 0,v),h=o0(),i!==null&&!In?(c0(i,s,v),Pa(i,s,v)):(It&&h&&jf(s),s.flags|=1,Hn(i,s,o,v),s.child)}function lx(i,s,o,h,v,T){return Xi(s),s.updateQueue=null,o=sp(s,h,o,v),ip(i),h=o0(),i!==null&&!In?(c0(i,s,T),Pa(i,s,T)):(It&&h&&jf(s),s.flags|=1,Hn(i,s,o,T),s.child)}function ox(i,s,o,h,v){if(Xi(s),s.stateNode===null){var T=Ds,A=o.contextType;typeof A=="object"&&A!==null&&(T=Yn(A)),T=new o(h,T),s.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=S0,s.stateNode=T,T._reactInternals=s,T=s.stateNode,T.props=h,T.state=s.memoizedState,T.refs={},e0(s),A=o.contextType,T.context=typeof A=="object"&&A!==null?Yn(A):Ds,T.state=s.memoizedState,A=o.getDerivedStateFromProps,typeof A=="function"&&(E0(s,o,A,h),T.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(A=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),A!==T.state&&S0.enqueueReplaceState(T,T.state,null),Jl(s,h,T,v),Xl(),T.state=s.memoizedState),typeof T.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(i===null){T=s.stateNode;var I=s.memoizedProps,Q=Zi(o,I);T.props=Q;var he=T.context,Ae=o.contextType;A=Ds,typeof Ae=="object"&&Ae!==null&&(A=Yn(Ae));var Ne=o.getDerivedStateFromProps;Ae=typeof Ne=="function"||typeof T.getSnapshotBeforeUpdate=="function",I=s.pendingProps!==I,Ae||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(I||he!==A)&&Wp(s,T,h,A),ai=!1;var ge=s.memoizedState;T.state=ge,Jl(s,h,T,v),Xl(),he=s.memoizedState,I||ge!==he||ai?(typeof Ne=="function"&&(E0(s,o,Ne,h),he=s.memoizedState),(Q=ai||Yp(s,o,Q,h,ge,he,A))?(Ae||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(s.flags|=4194308)):(typeof T.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=he),T.props=h,T.state=he,T.context=A,h=Q):(typeof T.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{T=s.stateNode,t0(i,s),A=s.memoizedProps,Ae=Zi(o,A),T.props=Ae,Ne=s.pendingProps,ge=T.context,he=o.contextType,Q=Ds,typeof he=="object"&&he!==null&&(Q=Yn(he)),I=o.getDerivedStateFromProps,(he=typeof I=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(A!==Ne||ge!==Q)&&Wp(s,T,h,Q),ai=!1,ge=s.memoizedState,T.state=ge,Jl(s,h,T,v),Xl();var ye=s.memoizedState;A!==Ne||ge!==ye||ai||i!==null&&i.dependencies!==null&&kc(i.dependencies)?(typeof I=="function"&&(E0(s,o,I,h),ye=s.memoizedState),(Ae=ai||Yp(s,o,Ae,h,ge,ye,Q)||i!==null&&i.dependencies!==null&&kc(i.dependencies))?(he||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(h,ye,Q),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(h,ye,Q)),typeof T.componentDidUpdate=="function"&&(s.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof T.componentDidUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(s.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=ye),T.props=h,T.state=ye,T.context=Q,h=Ae):(typeof T.componentDidUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(s.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(s.flags|=1024),h=!1)}return T=h,Yc(i,s),h=(s.flags&128)!==0,T||h?(T=s.stateNode,o=h&&typeof o.getDerivedStateFromError!="function"?null:T.render(),s.flags|=1,i!==null&&h?(s.child=Gs(s,i.child,null,v),s.child=Gs(s,null,o,v)):Hn(i,s,o,v),s.memoizedState=T.state,i=s.child):i=Pa(i,s,v),i}function cx(i,s,o,h){return Hl(),s.flags|=256,Hn(i,s,o,h),s.child}var A0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function b0(i){return{baseLanes:i,cachePool:Jm()}}function k0(i,s,o){return i=i!==null?i.childLanes&~o:0,s&&(i|=Or),i}function ux(i,s,o){var h=s.pendingProps,v=!1,T=(s.flags&128)!==0,A;if((A=T)||(A=i!==null&&i.memoizedState===null?!1:(An.current&2)!==0),A&&(v=!0,s.flags&=-129),A=(s.flags&32)!==0,s.flags&=-33,i===null){if(It){if(v?oi(s):ci(),It){var I=ln,Q;if(Q=I){e:{for(Q=I,I=la;Q.nodeType!==8;){if(!I){I=null;break e}if(Q=Jr(Q.nextSibling),Q===null){I=null;break e}}I=Q}I!==null?(s.memoizedState={dehydrated:I,treeContext:ji!==null?{id:Ra,overflow:Da}:null,retryLane:536870912,hydrationErrors:null},Q=yr(18,null,null,0),Q.stateNode=I,Q.return=s,s.child=Q,ar=s,ln=null,Q=!0):Q=!1}Q||Yi(s)}if(I=s.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return fd(I)?s.lanes=32:s.lanes=536870912,null;Oa(s)}return I=h.children,h=h.fallback,v?(ci(),v=s.mode,I=Wc({mode:"hidden",children:I},v),h=zi(h,v,o,null),I.return=s,h.return=s,I.sibling=h,s.child=I,v=s.child,v.memoizedState=b0(o),v.childLanes=k0(i,A,o),s.memoizedState=A0,h):(oi(s),N0(s,I))}if(Q=i.memoizedState,Q!==null&&(I=Q.dehydrated,I!==null)){if(T)s.flags&256?(oi(s),s.flags&=-257,s=M0(i,s,o)):s.memoizedState!==null?(ci(),s.child=i.child,s.flags|=128,s=null):(ci(),v=h.fallback,I=s.mode,h=Wc({mode:"visible",children:h.children},I),v=zi(v,I,o,null),v.flags|=2,h.return=s,v.return=s,h.sibling=v,s.child=h,Gs(s,i.child,null,o),h=s.child,h.memoizedState=b0(o),h.childLanes=k0(i,A,o),s.memoizedState=A0,s=v);else if(oi(s),fd(I)){if(A=I.nextSibling&&I.nextSibling.dataset,A)var he=A.dgst;A=he,h=Error(r(419)),h.stack="",h.digest=A,Gl({value:h,source:null,stack:null}),s=M0(i,s,o)}else if(In||zl(i,s,o,!1),A=(o&i.childLanes)!==0,In||A){if(A=Xt,A!==null&&(h=o&-o,h=(h&42)!==0?1:Rn(h),h=(h&(A.suspendedLanes|o))!==0?0:h,h!==0&&h!==Q.retryLane))throw Q.retryLane=h,Rs(i,h),wr(A,i,h),tx;I.data==="$?"||W0(),s=M0(i,s,o)}else I.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=Q.treeContext,ln=Jr(I.nextSibling),ar=s,It=!0,$i=null,la=!1,i!==null&&(Ir[Fr++]=Ra,Ir[Fr++]=Da,Ir[Fr++]=ji,Ra=i.id,Da=i.overflow,ji=s),s=N0(s,h.children),s.flags|=4096);return s}return v?(ci(),v=h.fallback,I=s.mode,Q=i.child,he=Q.sibling,h=Ma(Q,{mode:"hidden",children:h.children}),h.subtreeFlags=Q.subtreeFlags&65011712,he!==null?v=Ma(he,v):(v=zi(v,I,o,null),v.flags|=2),v.return=s,h.return=s,h.sibling=v,s.child=h,h=v,v=s.child,I=i.child.memoizedState,I===null?I=b0(o):(Q=I.cachePool,Q!==null?(he=Cn._currentValue,Q=Q.parent!==he?{parent:he,pool:he}:Q):Q=Jm(),I={baseLanes:I.baseLanes|o,cachePool:Q}),v.memoizedState=I,v.childLanes=k0(i,A,o),s.memoizedState=A0,h):(oi(s),o=i.child,i=o.sibling,o=Ma(o,{mode:"visible",children:h.children}),o.return=s,o.sibling=null,i!==null&&(A=s.deletions,A===null?(s.deletions=[i],s.flags|=16):A.push(i)),s.child=o,s.memoizedState=null,o)}function N0(i,s){return s=Wc({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Wc(i,s){return i=yr(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function M0(i,s,o){return Gs(s,i.child,null,o),i=N0(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function fx(i,s,o){i.lanes|=s;var h=i.alternate;h!==null&&(h.lanes|=s),Wf(i.return,s,o)}function R0(i,s,o,h,v){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:v}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=h,T.tail=o,T.tailMode=v)}function dx(i,s,o){var h=s.pendingProps,v=h.revealOrder,T=h.tail;if(Hn(i,s,h.children,o),h=An.current,(h&2)!==0)h=h&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&fx(i,o,s);else if(i.tag===19)fx(i,o,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}switch(J(An,h),v){case"forwards":for(o=s.child,v=null;o!==null;)i=o.alternate,i!==null&&jc(i)===null&&(v=o),o=o.sibling;o=v,o===null?(v=s.child,s.child=null):(v=o.sibling,o.sibling=null),R0(s,!1,v,o,T);break;case"backwards":for(o=null,v=s.child,s.child=null;v!==null;){if(i=v.alternate,i!==null&&jc(i)===null){s.child=v;break}i=v.sibling,v.sibling=o,o=v,v=i}R0(s,!0,o,null,T);break;case"together":R0(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Pa(i,s,o){if(i!==null&&(s.dependencies=i.dependencies),mi|=s.lanes,(o&s.childLanes)===0)if(i!==null){if(zl(i,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,o=Ma(i,i.pendingProps),s.child=o,o.return=s;i.sibling!==null;)i=i.sibling,o=o.sibling=Ma(i,i.pendingProps),o.return=s;o.sibling=null}return s.child}function D0(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&kc(i)))}function kE(i,s,o){switch(s.tag){case 3:ke(s,s.stateNode.containerInfo),ri(s,Cn,i.memoizedState.cache),Hl();break;case 27:case 5:Ce(s);break;case 4:ke(s,s.stateNode.containerInfo);break;case 10:ri(s,s.type,s.memoizedProps.value);break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(oi(s),s.flags|=128,null):(o&s.child.childLanes)!==0?ux(i,s,o):(oi(s),i=Pa(i,s,o),i!==null?i.sibling:null);oi(s);break;case 19:var v=(i.flags&128)!==0;if(h=(o&s.childLanes)!==0,h||(zl(i,s,o,!1),h=(o&s.childLanes)!==0),v){if(h)return dx(i,s,o);s.flags|=128}if(v=s.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),J(An,An.current),h)break;return null;case 22:case 23:return s.lanes=0,ix(i,s,o);case 24:ri(s,Cn,i.memoizedState.cache)}return Pa(i,s,o)}function hx(i,s,o){if(i!==null)if(i.memoizedProps!==s.pendingProps)In=!0;else{if(!D0(i,o)&&(s.flags&128)===0)return In=!1,kE(i,s,o);In=(i.flags&131072)!==0}else In=!1,It&&(s.flags&1048576)!==0&&zm(s,bc,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var h=s.elementType,v=h._init;if(h=v(h._payload),s.type=h,typeof h=="function")Hf(h)?(i=Zi(h,i),s.tag=1,s=ox(null,s,h,i,o)):(s.tag=0,s=C0(null,s,h,i,o));else{if(h!=null){if(v=h.$$typeof,v===U){s.tag=11,s=nx(null,s,h,i,o);break e}else if(v===F){s.tag=14,s=rx(null,s,h,i,o);break e}}throw s=Fe(h)||h,Error(r(306,s,""))}}return s;case 0:return C0(i,s,s.type,s.pendingProps,o);case 1:return h=s.type,v=Zi(h,s.pendingProps),ox(i,s,h,v,o);case 3:e:{if(ke(s,s.stateNode.containerInfo),i===null)throw Error(r(387));h=s.pendingProps;var T=s.memoizedState;v=T.element,t0(i,s),Jl(s,h,null,o);var A=s.memoizedState;if(h=A.cache,ri(s,Cn,h),h!==T.cache&&Xf(s,[Cn],o,!0),Xl(),h=A.element,T.isDehydrated)if(T={element:h,isDehydrated:!1,cache:A.cache},s.updateQueue.baseState=T,s.memoizedState=T,s.flags&256){s=cx(i,s,h,o);break e}else if(h!==v){v=Rr(Error(r(424)),s),Gl(v),s=cx(i,s,h,o);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(ln=Jr(i.firstChild),ar=s,It=!0,$i=null,la=!0,o=qp(s,null,h,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Hl(),h===v){s=Pa(i,s,o);break e}Hn(i,s,h,o)}s=s.child}return s;case 26:return Yc(i,s),i===null?(o=gg(s.type,null,s.pendingProps,null))?s.memoizedState=o:It||(o=s.type,i=s.pendingProps,h=ou(se.current).createElement(o),h[Zt]=s,h[Qt]=i,zn(h,o,i),oe(h),s.stateNode=h):s.memoizedState=gg(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Ce(s),i===null&&It&&(h=s.stateNode=mg(s.type,s.pendingProps,se.current),ar=s,la=!0,v=ln,vi(s.type)?(dd=v,ln=Jr(h.firstChild)):ln=v),Hn(i,s,s.pendingProps.children,o),Yc(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&It&&((v=h=ln)&&(h=nS(h,s.type,s.pendingProps,la),h!==null?(s.stateNode=h,ar=s,ln=Jr(h.firstChild),la=!1,v=!0):v=!1),v||Yi(s)),Ce(s),v=s.type,T=s.pendingProps,A=i!==null?i.memoizedProps:null,h=T.children,od(v,T)?h=null:A!==null&&od(v,A)&&(s.flags|=32),s.memoizedState!==null&&(v=l0(i,s,TE,null,null,o),yo._currentValue=v),Yc(i,s),Hn(i,s,h,o),s.child;case 6:return i===null&&It&&((i=o=ln)&&(o=rS(o,s.pendingProps,la),o!==null?(s.stateNode=o,ar=s,ln=null,i=!0):i=!1),i||Yi(s)),null;case 13:return ux(i,s,o);case 4:return ke(s,s.stateNode.containerInfo),h=s.pendingProps,i===null?s.child=Gs(s,null,h,o):Hn(i,s,h,o),s.child;case 11:return nx(i,s,s.type,s.pendingProps,o);case 7:return Hn(i,s,s.pendingProps,o),s.child;case 8:return Hn(i,s,s.pendingProps.children,o),s.child;case 12:return Hn(i,s,s.pendingProps.children,o),s.child;case 10:return h=s.pendingProps,ri(s,s.type,h.value),Hn(i,s,h.children,o),s.child;case 9:return v=s.type._context,h=s.pendingProps.children,Xi(s),v=Yn(v),h=h(v),s.flags|=1,Hn(i,s,h,o),s.child;case 14:return rx(i,s,s.type,s.pendingProps,o);case 15:return ax(i,s,s.type,s.pendingProps,o);case 19:return dx(i,s,o);case 31:return h=s.pendingProps,o=s.mode,h={mode:h.mode,children:h.children},i===null?(o=Wc(h,o),o.ref=s.ref,s.child=o,o.return=s,s=o):(o=Ma(i.child,h),o.ref=s.ref,s.child=o,o.return=s,s=o),s;case 22:return ix(i,s,o);case 24:return Xi(s),h=Yn(Cn),i===null?(v=Zf(),v===null&&(v=Xt,T=Jf(),v.pooledCache=T,T.refCount++,T!==null&&(v.pooledCacheLanes|=o),v=T),s.memoizedState={parent:h,cache:v},e0(s),ri(s,Cn,v)):((i.lanes&o)!==0&&(t0(i,s),Jl(s,null,null,o),Xl()),v=i.memoizedState,T=s.memoizedState,v.parent!==h?(v={parent:h,cache:h},s.memoizedState=v,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=v),ri(s,Cn,h)):(h=T.cache,ri(s,Cn,h),h!==v.cache&&Xf(s,[Cn],o,!0))),Hn(i,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function Ua(i){i.flags|=4}function mx(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Eg(s)){if(s=Lr.current,s!==null&&((Ct&4194048)===Ct?oa!==null:(Ct&62914560)!==Ct&&(Ct&536870912)===0||s!==oa))throw Yl=Qf,Km;i.flags|=8192}}function Xc(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?wa():536870912,i.lanes|=s,$s|=s)}function ro(i,s){if(!It)switch(i.tailMode){case"hidden":s=i.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function rn(i){var s=i.alternate!==null&&i.alternate.child===i.child,o=0,h=0;if(s)for(var v=i.child;v!==null;)o|=v.lanes|v.childLanes,h|=v.subtreeFlags&65011712,h|=v.flags&65011712,v.return=i,v=v.sibling;else for(v=i.child;v!==null;)o|=v.lanes|v.childLanes,h|=v.subtreeFlags,h|=v.flags,v.return=i,v=v.sibling;return i.subtreeFlags|=h,i.childLanes=o,s}function NE(i,s,o){var h=s.pendingProps;switch(qf(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rn(s),null;case 1:return rn(s),null;case 3:return o=s.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),Fa(Cn),De(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(i===null||i.child===null)&&(Vl(s)?Ua(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,$m())),rn(s),null;case 26:return o=s.memoizedState,i===null?(Ua(s),o!==null?(rn(s),mx(s,o)):(rn(s),s.flags&=-16777217)):o?o!==i.memoizedState?(Ua(s),rn(s),mx(s,o)):(rn(s),s.flags&=-16777217):(i.memoizedProps!==h&&Ua(s),rn(s),s.flags&=-16777217),null;case 27:Je(s),o=se.current;var v=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==h&&Ua(s);else{if(!h){if(s.stateNode===null)throw Error(r(166));return rn(s),null}i=Y.current,Vl(s)?jm(s):(i=mg(v,h,o),s.stateNode=i,Ua(s))}return rn(s),null;case 5:if(Je(s),o=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==h&&Ua(s);else{if(!h){if(s.stateNode===null)throw Error(r(166));return rn(s),null}if(i=Y.current,Vl(s))jm(s);else{switch(v=ou(se.current),i){case 1:i=v.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:i=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":i=v.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":i=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":i=v.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof h.is=="string"?v.createElement("select",{is:h.is}):v.createElement("select"),h.multiple?i.multiple=!0:h.size&&(i.size=h.size);break;default:i=typeof h.is=="string"?v.createElement(o,{is:h.is}):v.createElement(o)}}i[Zt]=s,i[Qt]=h;e:for(v=s.child;v!==null;){if(v.tag===5||v.tag===6)i.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===s)break e;for(;v.sibling===null;){if(v.return===null||v.return===s)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}s.stateNode=i;e:switch(zn(i,o,h),o){case"button":case"input":case"select":case"textarea":i=!!h.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Ua(s)}}return rn(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==h&&Ua(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(r(166));if(i=se.current,Vl(s)){if(i=s.stateNode,o=s.memoizedProps,h=null,v=ar,v!==null)switch(v.tag){case 27:case 5:h=v.memoizedProps}i[Zt]=s,i=!!(i.nodeValue===o||h!==null&&h.suppressHydrationWarning===!0||lg(i.nodeValue,o)),i||Yi(s)}else i=ou(i).createTextNode(h),i[Zt]=s,s.stateNode=i}return rn(s),null;case 13:if(h=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(v=Vl(s),h!==null&&h.dehydrated!==null){if(i===null){if(!v)throw Error(r(318));if(v=s.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(r(317));v[Zt]=s}else Hl(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;rn(s),v=!1}else v=$m(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=v),v=!0;if(!v)return s.flags&256?(Oa(s),s):(Oa(s),null)}if(Oa(s),(s.flags&128)!==0)return s.lanes=o,s;if(o=h!==null,i=i!==null&&i.memoizedState!==null,o){h=s.child,v=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(v=h.alternate.memoizedState.cachePool.pool);var T=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(T=h.memoizedState.cachePool.pool),T!==v&&(h.flags|=2048)}return o!==i&&o&&(s.child.flags|=8192),Xc(s,s.updateQueue),rn(s),null;case 4:return De(),i===null&&rd(s.stateNode.containerInfo),rn(s),null;case 10:return Fa(s.type),rn(s),null;case 19:if(R(An),v=s.memoizedState,v===null)return rn(s),null;if(h=(s.flags&128)!==0,T=v.rendering,T===null)if(h)ro(v,!1);else{if(on!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(T=jc(i),T!==null){for(s.flags|=128,ro(v,!1),i=T.updateQueue,s.updateQueue=i,Xc(s,i),s.subtreeFlags=0,i=o,o=s.child;o!==null;)Gm(o,i),o=o.sibling;return J(An,An.current&1|2),s.child}i=i.sibling}v.tail!==null&&Te()>Zc&&(s.flags|=128,h=!0,ro(v,!1),s.lanes=4194304)}else{if(!h)if(i=jc(T),i!==null){if(s.flags|=128,h=!0,i=i.updateQueue,s.updateQueue=i,Xc(s,i),ro(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!It)return rn(s),null}else 2*Te()-v.renderingStartTime>Zc&&o!==536870912&&(s.flags|=128,h=!0,ro(v,!1),s.lanes=4194304);v.isBackwards?(T.sibling=s.child,s.child=T):(i=v.last,i!==null?i.sibling=T:s.child=T,v.last=T)}return v.tail!==null?(s=v.tail,v.rendering=s,v.tail=s.sibling,v.renderingStartTime=Te(),s.sibling=null,i=An.current,J(An,h?i&1|2:i&1),s):(rn(s),null);case 22:case 23:return Oa(s),i0(),h=s.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(o&536870912)!==0&&(s.flags&128)===0&&(rn(s),s.subtreeFlags&6&&(s.flags|=8192)):rn(s),o=s.updateQueue,o!==null&&Xc(s,o.retryQueue),o=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==o&&(s.flags|=2048),i!==null&&R(Ji),null;case 24:return o=null,i!==null&&(o=i.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Fa(Cn),rn(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function ME(i,s){switch(qf(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Fa(Cn),De(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Je(s),null;case 13:if(Oa(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Hl()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return R(An),null;case 4:return De(),null;case 10:return Fa(s.type),null;case 22:case 23:return Oa(s),i0(),i!==null&&R(Ji),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Fa(Cn),null;case 25:return null;default:return null}}function px(i,s){switch(qf(s),s.tag){case 3:Fa(Cn),De();break;case 26:case 27:case 5:Je(s);break;case 4:De();break;case 13:Oa(s);break;case 19:R(An);break;case 10:Fa(s.type);break;case 22:case 23:Oa(s),i0(),i!==null&&R(Ji);break;case 24:Fa(Cn)}}function ao(i,s){try{var o=s.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var v=h.next;o=v;do{if((o.tag&i)===i){h=void 0;var T=o.create,A=o.inst;h=T(),A.destroy=h}o=o.next}while(o!==v)}}catch(I){qt(s,s.return,I)}}function ui(i,s,o){try{var h=s.updateQueue,v=h!==null?h.lastEffect:null;if(v!==null){var T=v.next;h=T;do{if((h.tag&i)===i){var A=h.inst,I=A.destroy;if(I!==void 0){A.destroy=void 0,v=s;var Q=o,he=I;try{he()}catch(Ae){qt(v,Q,Ae)}}}h=h.next}while(h!==T)}}catch(Ae){qt(s,s.return,Ae)}}function xx(i){var s=i.updateQueue;if(s!==null){var o=i.stateNode;try{rp(s,o)}catch(h){qt(i,i.return,h)}}}function gx(i,s,o){o.props=Zi(i.type,i.memoizedProps),o.state=i.memoizedState;try{o.componentWillUnmount()}catch(h){qt(i,s,h)}}function io(i,s){try{var o=i.ref;if(o!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof o=="function"?i.refCleanup=o(h):o.current=h}}catch(v){qt(i,s,v)}}function ca(i,s){var o=i.ref,h=i.refCleanup;if(o!==null)if(typeof h=="function")try{h()}catch(v){qt(i,s,v)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(v){qt(i,s,v)}else o.current=null}function vx(i){var s=i.type,o=i.memoizedProps,h=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&h.focus();break e;case"img":o.src?h.src=o.src:o.srcSet&&(h.srcset=o.srcSet)}}catch(v){qt(i,i.return,v)}}function I0(i,s,o){try{var h=i.stateNode;KE(h,i.type,o,s),h[Qt]=s}catch(v){qt(i,i.return,v)}}function yx(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&vi(i.type)||i.tag===4}function F0(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||yx(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&vi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function L0(i,s,o){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(i,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(i),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=lu));else if(h!==4&&(h===27&&vi(i.type)&&(o=i.stateNode,s=null),i=i.child,i!==null))for(L0(i,s,o),i=i.sibling;i!==null;)L0(i,s,o),i=i.sibling}function Jc(i,s,o){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?o.insertBefore(i,s):o.appendChild(i);else if(h!==4&&(h===27&&vi(i.type)&&(o=i.stateNode),i=i.child,i!==null))for(Jc(i,s,o),i=i.sibling;i!==null;)Jc(i,s,o),i=i.sibling}function Tx(i){var s=i.stateNode,o=i.memoizedProps;try{for(var h=i.type,v=s.attributes;v.length;)s.removeAttributeNode(v[0]);zn(s,h,o),s[Zt]=i,s[Qt]=o}catch(T){qt(i,i.return,T)}}var Ba=!1,mn=!1,O0=!1,_x=typeof WeakSet=="function"?WeakSet:Set,Fn=null;function RE(i,s){if(i=i.containerInfo,sd=mu,i=Dm(i),Ff(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{o=(o=i.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var v=h.anchorOffset,T=h.focusNode;h=h.focusOffset;try{o.nodeType,T.nodeType}catch{o=null;break e}var A=0,I=-1,Q=-1,he=0,Ae=0,Ne=i,ge=null;t:for(;;){for(var ye;Ne!==o||v!==0&&Ne.nodeType!==3||(I=A+v),Ne!==T||h!==0&&Ne.nodeType!==3||(Q=A+h),Ne.nodeType===3&&(A+=Ne.nodeValue.length),(ye=Ne.firstChild)!==null;)ge=Ne,Ne=ye;for(;;){if(Ne===i)break t;if(ge===o&&++he===v&&(I=A),ge===T&&++Ae===h&&(Q=A),(ye=Ne.nextSibling)!==null)break;Ne=ge,ge=Ne.parentNode}Ne=ye}o=I===-1||Q===-1?null:{start:I,end:Q}}else o=null}o=o||{start:0,end:0}}else o=null;for(ld={focusedElem:i,selectionRange:o},mu=!1,Fn=s;Fn!==null;)if(s=Fn,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,Fn=i;else for(;Fn!==null;){switch(s=Fn,T=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&T!==null){i=void 0,o=s,v=T.memoizedProps,T=T.memoizedState,h=o.stateNode;try{var et=Zi(o.type,v,o.elementType===o.type);i=h.getSnapshotBeforeUpdate(et,T),h.__reactInternalSnapshotBeforeUpdate=i}catch(Ze){qt(o,o.return,Ze)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,o=i.nodeType,o===9)ud(i);else if(o===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":ud(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,Fn=i;break}Fn=s.return}}function Ex(i,s,o){var h=o.flags;switch(o.tag){case 0:case 11:case 15:fi(i,o),h&4&&ao(5,o);break;case 1:if(fi(i,o),h&4)if(i=o.stateNode,s===null)try{i.componentDidMount()}catch(A){qt(o,o.return,A)}else{var v=Zi(o.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(v,s,i.__reactInternalSnapshotBeforeUpdate)}catch(A){qt(o,o.return,A)}}h&64&&xx(o),h&512&&io(o,o.return);break;case 3:if(fi(i,o),h&64&&(i=o.updateQueue,i!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{rp(i,s)}catch(A){qt(o,o.return,A)}}break;case 27:s===null&&h&4&&Tx(o);case 26:case 5:fi(i,o),s===null&&h&4&&vx(o),h&512&&io(o,o.return);break;case 12:fi(i,o);break;case 13:fi(i,o),h&4&&Cx(i,o),h&64&&(i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(o=VE.bind(null,o),aS(i,o))));break;case 22:if(h=o.memoizedState!==null||Ba,!h){s=s!==null&&s.memoizedState!==null||mn,v=Ba;var T=mn;Ba=h,(mn=s)&&!T?di(i,o,(o.subtreeFlags&8772)!==0):fi(i,o),Ba=v,mn=T}break;case 30:break;default:fi(i,o)}}function Sx(i){var s=i.alternate;s!==null&&(i.alternate=null,Sx(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&P(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var tn=null,mr=!1;function Va(i,s,o){for(o=o.child;o!==null;)wx(i,s,o),o=o.sibling}function wx(i,s,o){if(Yt&&typeof Yt.onCommitFiberUnmount=="function")try{Yt.onCommitFiberUnmount($t,o)}catch{}switch(o.tag){case 26:mn||ca(o,s),Va(i,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:mn||ca(o,s);var h=tn,v=mr;vi(o.type)&&(tn=o.stateNode,mr=!1),Va(i,s,o),po(o.stateNode),tn=h,mr=v;break;case 5:mn||ca(o,s);case 6:if(h=tn,v=mr,tn=null,Va(i,s,o),tn=h,mr=v,tn!==null)if(mr)try{(tn.nodeType===9?tn.body:tn.nodeName==="HTML"?tn.ownerDocument.body:tn).removeChild(o.stateNode)}catch(T){qt(o,s,T)}else try{tn.removeChild(o.stateNode)}catch(T){qt(o,s,T)}break;case 18:tn!==null&&(mr?(i=tn,dg(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,o.stateNode),So(i)):dg(tn,o.stateNode));break;case 4:h=tn,v=mr,tn=o.stateNode.containerInfo,mr=!0,Va(i,s,o),tn=h,mr=v;break;case 0:case 11:case 14:case 15:mn||ui(2,o,s),mn||ui(4,o,s),Va(i,s,o);break;case 1:mn||(ca(o,s),h=o.stateNode,typeof h.componentWillUnmount=="function"&&gx(o,s,h)),Va(i,s,o);break;case 21:Va(i,s,o);break;case 22:mn=(h=mn)||o.memoizedState!==null,Va(i,s,o),mn=h;break;default:Va(i,s,o)}}function Cx(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{So(i)}catch(o){qt(s,s.return,o)}}function DE(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new _x),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new _x),s;default:throw Error(r(435,i.tag))}}function P0(i,s){var o=DE(i);s.forEach(function(h){var v=HE.bind(null,i,h);o.has(h)||(o.add(h),h.then(v,v))})}function Tr(i,s){var o=s.deletions;if(o!==null)for(var h=0;h<o.length;h++){var v=o[h],T=i,A=s,I=A;e:for(;I!==null;){switch(I.tag){case 27:if(vi(I.type)){tn=I.stateNode,mr=!1;break e}break;case 5:tn=I.stateNode,mr=!1;break e;case 3:case 4:tn=I.stateNode.containerInfo,mr=!0;break e}I=I.return}if(tn===null)throw Error(r(160));wx(T,A,v),tn=null,mr=!1,T=v.alternate,T!==null&&(T.return=null),v.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Ax(s,i),s=s.sibling}var Xr=null;function Ax(i,s){var o=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Tr(s,i),_r(i),h&4&&(ui(3,i,i.return),ao(3,i),ui(5,i,i.return));break;case 1:Tr(s,i),_r(i),h&512&&(mn||o===null||ca(o,o.return)),h&64&&Ba&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(o=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=o===null?h:o.concat(h))));break;case 26:var v=Xr;if(Tr(s,i),_r(i),h&512&&(mn||o===null||ca(o,o.return)),h&4){var T=o!==null?o.memoizedState:null;if(h=i.memoizedState,o===null)if(h===null)if(i.stateNode===null){e:{h=i.type,o=i.memoizedProps,v=v.ownerDocument||v;t:switch(h){case"title":T=v.getElementsByTagName("title")[0],(!T||T[L]||T[Zt]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=v.createElement(h),v.head.insertBefore(T,v.querySelector("head > title"))),zn(T,h,o),T[Zt]=i,oe(T),h=T;break e;case"link":var A=Tg("link","href",v).get(h+(o.href||""));if(A){for(var I=0;I<A.length;I++)if(T=A[I],T.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&T.getAttribute("rel")===(o.rel==null?null:o.rel)&&T.getAttribute("title")===(o.title==null?null:o.title)&&T.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){A.splice(I,1);break t}}T=v.createElement(h),zn(T,h,o),v.head.appendChild(T);break;case"meta":if(A=Tg("meta","content",v).get(h+(o.content||""))){for(I=0;I<A.length;I++)if(T=A[I],T.getAttribute("content")===(o.content==null?null:""+o.content)&&T.getAttribute("name")===(o.name==null?null:o.name)&&T.getAttribute("property")===(o.property==null?null:o.property)&&T.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&T.getAttribute("charset")===(o.charSet==null?null:o.charSet)){A.splice(I,1);break t}}T=v.createElement(h),zn(T,h,o),v.head.appendChild(T);break;default:throw Error(r(468,h))}T[Zt]=i,oe(T),h=T}i.stateNode=h}else _g(v,i.type,i.stateNode);else i.stateNode=yg(v,h,i.memoizedProps);else T!==h?(T===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):T.count--,h===null?_g(v,i.type,i.stateNode):yg(v,h,i.memoizedProps)):h===null&&i.stateNode!==null&&I0(i,i.memoizedProps,o.memoizedProps)}break;case 27:Tr(s,i),_r(i),h&512&&(mn||o===null||ca(o,o.return)),o!==null&&h&4&&I0(i,i.memoizedProps,o.memoizedProps);break;case 5:if(Tr(s,i),_r(i),h&512&&(mn||o===null||ca(o,o.return)),i.flags&32){v=i.stateNode;try{ws(v,"")}catch(ye){qt(i,i.return,ye)}}h&4&&i.stateNode!=null&&(v=i.memoizedProps,I0(i,v,o!==null?o.memoizedProps:v)),h&1024&&(O0=!0);break;case 6:if(Tr(s,i),_r(i),h&4){if(i.stateNode===null)throw Error(r(162));h=i.memoizedProps,o=i.stateNode;try{o.nodeValue=h}catch(ye){qt(i,i.return,ye)}}break;case 3:if(fu=null,v=Xr,Xr=cu(s.containerInfo),Tr(s,i),Xr=v,_r(i),h&4&&o!==null&&o.memoizedState.isDehydrated)try{So(s.containerInfo)}catch(ye){qt(i,i.return,ye)}O0&&(O0=!1,bx(i));break;case 4:h=Xr,Xr=cu(i.stateNode.containerInfo),Tr(s,i),_r(i),Xr=h;break;case 12:Tr(s,i),_r(i);break;case 13:Tr(s,i),_r(i),i.child.flags&8192&&i.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(z0=Te()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,P0(i,h)));break;case 22:v=i.memoizedState!==null;var Q=o!==null&&o.memoizedState!==null,he=Ba,Ae=mn;if(Ba=he||v,mn=Ae||Q,Tr(s,i),mn=Ae,Ba=he,_r(i),h&8192)e:for(s=i.stateNode,s._visibility=v?s._visibility&-2:s._visibility|1,v&&(o===null||Q||Ba||mn||Qi(i)),o=null,s=i;;){if(s.tag===5||s.tag===26){if(o===null){Q=o=s;try{if(T=Q.stateNode,v)A=T.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{I=Q.stateNode;var Ne=Q.memoizedProps.style,ge=Ne!=null&&Ne.hasOwnProperty("display")?Ne.display:null;I.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(ye){qt(Q,Q.return,ye)}}}else if(s.tag===6){if(o===null){Q=s;try{Q.stateNode.nodeValue=v?"":Q.memoizedProps}catch(ye){qt(Q,Q.return,ye)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=i.updateQueue,h!==null&&(o=h.retryQueue,o!==null&&(h.retryQueue=null,P0(i,o))));break;case 19:Tr(s,i),_r(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,P0(i,h)));break;case 30:break;case 21:break;default:Tr(s,i),_r(i)}}function _r(i){var s=i.flags;if(s&2){try{for(var o,h=i.return;h!==null;){if(yx(h)){o=h;break}h=h.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var v=o.stateNode,T=F0(i);Jc(i,T,v);break;case 5:var A=o.stateNode;o.flags&32&&(ws(A,""),o.flags&=-33);var I=F0(i);Jc(i,I,A);break;case 3:case 4:var Q=o.stateNode.containerInfo,he=F0(i);L0(i,he,Q);break;default:throw Error(r(161))}}catch(Ae){qt(i,i.return,Ae)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function bx(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;bx(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function fi(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Ex(i,s.alternate,s),s=s.sibling}function Qi(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:ui(4,s,s.return),Qi(s);break;case 1:ca(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&gx(s,s.return,o),Qi(s);break;case 27:po(s.stateNode);case 26:case 5:ca(s,s.return),Qi(s);break;case 22:s.memoizedState===null&&Qi(s);break;case 30:Qi(s);break;default:Qi(s)}i=i.sibling}}function di(i,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,v=i,T=s,A=T.flags;switch(T.tag){case 0:case 11:case 15:di(v,T,o),ao(4,T);break;case 1:if(di(v,T,o),h=T,v=h.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(he){qt(h,h.return,he)}if(h=T,v=h.updateQueue,v!==null){var I=h.stateNode;try{var Q=v.shared.hiddenCallbacks;if(Q!==null)for(v.shared.hiddenCallbacks=null,v=0;v<Q.length;v++)np(Q[v],I)}catch(he){qt(h,h.return,he)}}o&&A&64&&xx(T),io(T,T.return);break;case 27:Tx(T);case 26:case 5:di(v,T,o),o&&h===null&&A&4&&vx(T),io(T,T.return);break;case 12:di(v,T,o);break;case 13:di(v,T,o),o&&A&4&&Cx(v,T);break;case 22:T.memoizedState===null&&di(v,T,o),io(T,T.return);break;case 30:break;default:di(v,T,o)}s=s.sibling}}function U0(i,s){var o=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==o&&(i!=null&&i.refCount++,o!=null&&jl(o))}function B0(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&jl(i))}function ua(i,s,o,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)kx(i,s,o,h),s=s.sibling}function kx(i,s,o,h){var v=s.flags;switch(s.tag){case 0:case 11:case 15:ua(i,s,o,h),v&2048&&ao(9,s);break;case 1:ua(i,s,o,h);break;case 3:ua(i,s,o,h),v&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&jl(i)));break;case 12:if(v&2048){ua(i,s,o,h),i=s.stateNode;try{var T=s.memoizedProps,A=T.id,I=T.onPostCommit;typeof I=="function"&&I(A,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Q){qt(s,s.return,Q)}}else ua(i,s,o,h);break;case 13:ua(i,s,o,h);break;case 23:break;case 22:T=s.stateNode,A=s.alternate,s.memoizedState!==null?T._visibility&2?ua(i,s,o,h):so(i,s):T._visibility&2?ua(i,s,o,h):(T._visibility|=2,zs(i,s,o,h,(s.subtreeFlags&10256)!==0)),v&2048&&U0(A,s);break;case 24:ua(i,s,o,h),v&2048&&B0(s.alternate,s);break;default:ua(i,s,o,h)}}function zs(i,s,o,h,v){for(v=v&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var T=i,A=s,I=o,Q=h,he=A.flags;switch(A.tag){case 0:case 11:case 15:zs(T,A,I,Q,v),ao(8,A);break;case 23:break;case 22:var Ae=A.stateNode;A.memoizedState!==null?Ae._visibility&2?zs(T,A,I,Q,v):so(T,A):(Ae._visibility|=2,zs(T,A,I,Q,v)),v&&he&2048&&U0(A.alternate,A);break;case 24:zs(T,A,I,Q,v),v&&he&2048&&B0(A.alternate,A);break;default:zs(T,A,I,Q,v)}s=s.sibling}}function so(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=i,h=s,v=h.flags;switch(h.tag){case 22:so(o,h),v&2048&&U0(h.alternate,h);break;case 24:so(o,h),v&2048&&B0(h.alternate,h);break;default:so(o,h)}s=s.sibling}}var lo=8192;function js(i){if(i.subtreeFlags&lo)for(i=i.child;i!==null;)Nx(i),i=i.sibling}function Nx(i){switch(i.tag){case 26:js(i),i.flags&lo&&i.memoizedState!==null&&gS(Xr,i.memoizedState,i.memoizedProps);break;case 5:js(i);break;case 3:case 4:var s=Xr;Xr=cu(i.stateNode.containerInfo),js(i),Xr=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=lo,lo=16777216,js(i),lo=s):js(i));break;default:js(i)}}function Mx(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function oo(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Fn=h,Dx(h,i)}Mx(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Rx(i),i=i.sibling}function Rx(i){switch(i.tag){case 0:case 11:case 15:oo(i),i.flags&2048&&ui(9,i,i.return);break;case 3:oo(i);break;case 12:oo(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Kc(i)):oo(i);break;default:oo(i)}}function Kc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Fn=h,Dx(h,i)}Mx(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:ui(8,s,s.return),Kc(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Kc(s));break;default:Kc(s)}i=i.sibling}}function Dx(i,s){for(;Fn!==null;){var o=Fn;switch(o.tag){case 0:case 11:case 15:ui(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var h=o.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:jl(o.memoizedState.cache)}if(h=o.child,h!==null)h.return=o,Fn=h;else e:for(o=i;Fn!==null;){h=Fn;var v=h.sibling,T=h.return;if(Sx(h),h===o){Fn=null;break e}if(v!==null){v.return=T,Fn=v;break e}Fn=T}}}var IE={getCacheForType:function(i){var s=Yn(Cn),o=s.data.get(i);return o===void 0&&(o=i(),s.data.set(i,o)),o}},FE=typeof WeakMap=="function"?WeakMap:Map,Ut=0,Xt=null,vt=null,Ct=0,Bt=0,Er=null,hi=!1,qs=!1,V0=!1,Ha=0,on=0,mi=0,es=0,H0=0,Or=0,$s=0,co=null,pr=null,G0=!1,z0=0,Zc=1/0,Qc=null,pi=null,Gn=0,xi=null,Ys=null,Ws=0,j0=0,q0=null,Ix=null,uo=0,$0=null;function Sr(){if((Ut&2)!==0&&Ct!==0)return Ct&-Ct;if(ae.T!==null){var i=Ls;return i!==0?i:Q0()}return Nr()}function Fx(){Or===0&&(Or=(Ct&536870912)===0||It?Sa():536870912);var i=Lr.current;return i!==null&&(i.flags|=32),Or}function wr(i,s,o){(i===Xt&&(Bt===2||Bt===9)||i.cancelPendingCommit!==null)&&(Xs(i,0),gi(i,Ct,Or,!1)),Pe(i,o),((Ut&2)===0||i!==Xt)&&(i===Xt&&((Ut&2)===0&&(es|=o),on===4&&gi(i,Ct,Or,!1)),fa(i))}function Lx(i,s,o){if((Ut&6)!==0)throw Error(r(327));var h=!o&&(s&124)===0&&(s&i.expiredLanes)===0||Yr(i,s),v=h?PE(i,s):X0(i,s,!0),T=h;do{if(v===0){qs&&!h&&gi(i,s,0,!1);break}else{if(o=i.current.alternate,T&&!LE(o)){v=X0(i,s,!1),T=!1;continue}if(v===2){if(T=s,i.errorRecoveryDisabledLanes&T)var A=0;else A=i.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){s=A;e:{var I=i;v=co;var Q=I.current.memoizedState.isDehydrated;if(Q&&(Xs(I,A).flags|=256),A=X0(I,A,!1),A!==2){if(V0&&!Q){I.errorRecoveryDisabledLanes|=T,es|=T,v=4;break e}T=pr,pr=v,T!==null&&(pr===null?pr=T:pr.push.apply(pr,T))}v=A}if(T=!1,v!==2)continue}}if(v===1){Xs(i,0),gi(i,s,0,!0);break}e:{switch(h=i,T=v,T){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:gi(h,s,Or,!hi);break e;case 2:pr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(v=z0+300-Te(),10<v)){if(gi(h,s,Or,!hi),$r(h,0,!0)!==0)break e;h.timeoutHandle=ug(Ox.bind(null,h,o,pr,Qc,G0,s,Or,es,$s,hi,T,2,-0,0),v);break e}Ox(h,o,pr,Qc,G0,s,Or,es,$s,hi,T,0,-0,0)}}break}while(!0);fa(i)}function Ox(i,s,o,h,v,T,A,I,Q,he,Ae,Ne,ge,ye){if(i.timeoutHandle=-1,Ne=s.subtreeFlags,(Ne&8192||(Ne&16785408)===16785408)&&(vo={stylesheets:null,count:0,unsuspend:xS},Nx(s),Ne=vS(),Ne!==null)){i.cancelPendingCommit=Ne(zx.bind(null,i,s,T,o,h,v,A,I,Q,Ae,1,ge,ye)),gi(i,T,A,!he);return}zx(i,s,T,o,h,v,A,I,Q)}function LE(i){for(var s=i;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var h=0;h<o.length;h++){var v=o[h],T=v.getSnapshot;v=v.value;try{if(!vr(T(),v))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function gi(i,s,o,h){s&=~H0,s&=~es,i.suspendedLanes|=s,i.pingedLanes&=~s,h&&(i.warmLanes|=s),h=i.expirationTimes;for(var v=s;0<v;){var T=31-Dt(v),A=1<<T;h[T]=-1,v&=~A}o!==0&&xt(i,o,s)}function eu(){return(Ut&6)===0?(fo(0),!1):!0}function Y0(){if(vt!==null){if(Bt===0)var i=vt.return;else i=vt,Ia=Wi=null,u0(i),Hs=null,to=0,i=vt;for(;i!==null;)px(i.alternate,i),i=i.return;vt=null}}function Xs(i,s){var o=i.timeoutHandle;o!==-1&&(i.timeoutHandle=-1,QE(o)),o=i.cancelPendingCommit,o!==null&&(i.cancelPendingCommit=null,o()),Y0(),Xt=i,vt=o=Ma(i.current,null),Ct=s,Bt=0,Er=null,hi=!1,qs=Yr(i,s),V0=!1,$s=Or=H0=es=mi=on=0,pr=co=null,G0=!1,(s&8)!==0&&(s|=s&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=s;0<h;){var v=31-Dt(h),T=1<<v;s|=i[v],h&=~T}return Ha=s,Ec(),o}function Px(i,s){ht=null,ae.H=Hc,s===$l||s===Rc?(s=ep(),Bt=3):s===Km?(s=ep(),Bt=4):Bt=s===tx?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Er=s,vt===null&&(on=1,$c(i,Rr(s,i.current)))}function Ux(){var i=ae.H;return ae.H=Hc,i===null?Hc:i}function Bx(){var i=ae.A;return ae.A=IE,i}function W0(){on=4,hi||(Ct&4194048)!==Ct&&Lr.current!==null||(qs=!0),(mi&134217727)===0&&(es&134217727)===0||Xt===null||gi(Xt,Ct,Or,!1)}function X0(i,s,o){var h=Ut;Ut|=2;var v=Ux(),T=Bx();(Xt!==i||Ct!==s)&&(Qc=null,Xs(i,s)),s=!1;var A=on;e:do try{if(Bt!==0&&vt!==null){var I=vt,Q=Er;switch(Bt){case 8:Y0(),A=6;break e;case 3:case 2:case 9:case 6:Lr.current===null&&(s=!0);var he=Bt;if(Bt=0,Er=null,Js(i,I,Q,he),o&&qs){A=0;break e}break;default:he=Bt,Bt=0,Er=null,Js(i,I,Q,he)}}OE(),A=on;break}catch(Ae){Px(i,Ae)}while(!0);return s&&i.shellSuspendCounter++,Ia=Wi=null,Ut=h,ae.H=v,ae.A=T,vt===null&&(Xt=null,Ct=0,Ec()),A}function OE(){for(;vt!==null;)Vx(vt)}function PE(i,s){var o=Ut;Ut|=2;var h=Ux(),v=Bx();Xt!==i||Ct!==s?(Qc=null,Zc=Te()+500,Xs(i,s)):qs=Yr(i,s);e:do try{if(Bt!==0&&vt!==null){s=vt;var T=Er;t:switch(Bt){case 1:Bt=0,Er=null,Js(i,s,T,1);break;case 2:case 9:if(Zm(T)){Bt=0,Er=null,Hx(s);break}s=function(){Bt!==2&&Bt!==9||Xt!==i||(Bt=7),fa(i)},T.then(s,s);break e;case 3:Bt=7;break e;case 4:Bt=5;break e;case 7:Zm(T)?(Bt=0,Er=null,Hx(s)):(Bt=0,Er=null,Js(i,s,T,7));break;case 5:var A=null;switch(vt.tag){case 26:A=vt.memoizedState;case 5:case 27:var I=vt;if(!A||Eg(A)){Bt=0,Er=null;var Q=I.sibling;if(Q!==null)vt=Q;else{var he=I.return;he!==null?(vt=he,tu(he)):vt=null}break t}}Bt=0,Er=null,Js(i,s,T,5);break;case 6:Bt=0,Er=null,Js(i,s,T,6);break;case 8:Y0(),on=6;break e;default:throw Error(r(462))}}UE();break}catch(Ae){Px(i,Ae)}while(!0);return Ia=Wi=null,ae.H=h,ae.A=v,Ut=o,vt!==null?0:(Xt=null,Ct=0,Ec(),on)}function UE(){for(;vt!==null&&!ft();)Vx(vt)}function Vx(i){var s=hx(i.alternate,i,Ha);i.memoizedProps=i.pendingProps,s===null?tu(i):vt=s}function Hx(i){var s=i,o=s.alternate;switch(s.tag){case 15:case 0:s=lx(o,s,s.pendingProps,s.type,void 0,Ct);break;case 11:s=lx(o,s,s.pendingProps,s.type.render,s.ref,Ct);break;case 5:u0(s);default:px(o,s),s=vt=Gm(s,Ha),s=hx(o,s,Ha)}i.memoizedProps=i.pendingProps,s===null?tu(i):vt=s}function Js(i,s,o,h){Ia=Wi=null,u0(s),Hs=null,to=0;var v=s.return;try{if(bE(i,v,s,o,Ct)){on=1,$c(i,Rr(o,i.current)),vt=null;return}}catch(T){if(v!==null)throw vt=v,T;on=1,$c(i,Rr(o,i.current)),vt=null;return}s.flags&32768?(It||h===1?i=!0:qs||(Ct&536870912)!==0?i=!1:(hi=i=!0,(h===2||h===9||h===3||h===6)&&(h=Lr.current,h!==null&&h.tag===13&&(h.flags|=16384))),Gx(s,i)):tu(s)}function tu(i){var s=i;do{if((s.flags&32768)!==0){Gx(s,hi);return}i=s.return;var o=NE(s.alternate,s,Ha);if(o!==null){vt=o;return}if(s=s.sibling,s!==null){vt=s;return}vt=s=i}while(s!==null);on===0&&(on=5)}function Gx(i,s){do{var o=ME(i.alternate,i);if(o!==null){o.flags&=32767,vt=o;return}if(o=i.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(i=i.sibling,i!==null)){vt=i;return}vt=i=o}while(i!==null);on=6,vt=null}function zx(i,s,o,h,v,T,A,I,Q){i.cancelPendingCommit=null;do nu();while(Gn!==0);if((Ut&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(T=s.lanes|s.childLanes,T|=Bf,st(i,o,T,A,I,Q),i===Xt&&(vt=Xt=null,Ct=0),Ys=s,xi=i,Ws=o,j0=T,q0=v,Ix=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,GE(Tt,function(){return Wx(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=ae.T,ae.T=null,v=me.p,me.p=2,A=Ut,Ut|=4;try{RE(i,s,o)}finally{Ut=A,me.p=v,ae.T=h}}Gn=1,jx(),qx(),$x()}}function jx(){if(Gn===1){Gn=0;var i=xi,s=Ys,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=ae.T,ae.T=null;var h=me.p;me.p=2;var v=Ut;Ut|=4;try{Ax(s,i);var T=ld,A=Dm(i.containerInfo),I=T.focusedElem,Q=T.selectionRange;if(A!==I&&I&&I.ownerDocument&&Rm(I.ownerDocument.documentElement,I)){if(Q!==null&&Ff(I)){var he=Q.start,Ae=Q.end;if(Ae===void 0&&(Ae=he),"selectionStart"in I)I.selectionStart=he,I.selectionEnd=Math.min(Ae,I.value.length);else{var Ne=I.ownerDocument||document,ge=Ne&&Ne.defaultView||window;if(ge.getSelection){var ye=ge.getSelection(),et=I.textContent.length,Ze=Math.min(Q.start,et),zt=Q.end===void 0?Ze:Math.min(Q.end,et);!ye.extend&&Ze>zt&&(A=zt,zt=Ze,Ze=A);var le=Mm(I,Ze),ie=Mm(I,zt);if(le&&ie&&(ye.rangeCount!==1||ye.anchorNode!==le.node||ye.anchorOffset!==le.offset||ye.focusNode!==ie.node||ye.focusOffset!==ie.offset)){var ue=Ne.createRange();ue.setStart(le.node,le.offset),ye.removeAllRanges(),Ze>zt?(ye.addRange(ue),ye.extend(ie.node,ie.offset)):(ue.setEnd(ie.node,ie.offset),ye.addRange(ue))}}}}for(Ne=[],ye=I;ye=ye.parentNode;)ye.nodeType===1&&Ne.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<Ne.length;I++){var be=Ne[I];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}mu=!!sd,ld=sd=null}finally{Ut=v,me.p=h,ae.T=o}}i.current=s,Gn=2}}function qx(){if(Gn===2){Gn=0;var i=xi,s=Ys,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=ae.T,ae.T=null;var h=me.p;me.p=2;var v=Ut;Ut|=4;try{Ex(i,s.alternate,s)}finally{Ut=v,me.p=h,ae.T=o}}Gn=3}}function $x(){if(Gn===4||Gn===3){Gn=0,Me();var i=xi,s=Ys,o=Ws,h=Ix;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Gn=5:(Gn=0,Ys=xi=null,Yx(i,i.pendingLanes));var v=i.pendingLanes;if(v===0&&(pi=null),En(o),s=s.stateNode,Yt&&typeof Yt.onCommitFiberRoot=="function")try{Yt.onCommitFiberRoot($t,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=ae.T,v=me.p,me.p=2,ae.T=null;try{for(var T=i.onRecoverableError,A=0;A<h.length;A++){var I=h[A];T(I.value,{componentStack:I.stack})}}finally{ae.T=s,me.p=v}}(Ws&3)!==0&&nu(),fa(i),v=i.pendingLanes,(o&4194090)!==0&&(v&42)!==0?i===$0?uo++:(uo=0,$0=i):uo=0,fo(0)}}function Yx(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,jl(s)))}function nu(i){return jx(),qx(),$x(),Wx()}function Wx(){if(Gn!==5)return!1;var i=xi,s=j0;j0=0;var o=En(Ws),h=ae.T,v=me.p;try{me.p=32>o?32:o,ae.T=null,o=q0,q0=null;var T=xi,A=Ws;if(Gn=0,Ys=xi=null,Ws=0,(Ut&6)!==0)throw Error(r(331));var I=Ut;if(Ut|=4,Rx(T.current),kx(T,T.current,A,o),Ut=I,fo(0,!1),Yt&&typeof Yt.onPostCommitFiberRoot=="function")try{Yt.onPostCommitFiberRoot($t,T)}catch{}return!0}finally{me.p=v,ae.T=h,Yx(i,s)}}function Xx(i,s,o){s=Rr(o,s),s=w0(i.stateNode,s,2),i=si(i,s,2),i!==null&&(Pe(i,2),fa(i))}function qt(i,s,o){if(i.tag===3)Xx(i,i,o);else for(;s!==null;){if(s.tag===3){Xx(s,i,o);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(pi===null||!pi.has(h))){i=Rr(o,i),o=Qp(2),h=si(s,o,2),h!==null&&(ex(o,h,s,i),Pe(h,2),fa(h));break}}s=s.return}}function J0(i,s,o){var h=i.pingCache;if(h===null){h=i.pingCache=new FE;var v=new Set;h.set(s,v)}else v=h.get(s),v===void 0&&(v=new Set,h.set(s,v));v.has(o)||(V0=!0,v.add(o),i=BE.bind(null,i,s,o),s.then(i,i))}function BE(i,s,o){var h=i.pingCache;h!==null&&h.delete(s),i.pingedLanes|=i.suspendedLanes&o,i.warmLanes&=~o,Xt===i&&(Ct&o)===o&&(on===4||on===3&&(Ct&62914560)===Ct&&300>Te()-z0?(Ut&2)===0&&Xs(i,0):H0|=o,$s===Ct&&($s=0)),fa(i)}function Jx(i,s){s===0&&(s=wa()),i=Rs(i,s),i!==null&&(Pe(i,s),fa(i))}function VE(i){var s=i.memoizedState,o=0;s!==null&&(o=s.retryLane),Jx(i,o)}function HE(i,s){var o=0;switch(i.tag){case 13:var h=i.stateNode,v=i.memoizedState;v!==null&&(o=v.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(r(314))}h!==null&&h.delete(s),Jx(i,o)}function GE(i,s){return pt(i,s)}var ru=null,Ks=null,K0=!1,au=!1,Z0=!1,ts=0;function fa(i){i!==Ks&&i.next===null&&(Ks===null?ru=Ks=i:Ks=Ks.next=i),au=!0,K0||(K0=!0,jE())}function fo(i,s){if(!Z0&&au){Z0=!0;do for(var o=!1,h=ru;h!==null;){if(i!==0){var v=h.pendingLanes;if(v===0)var T=0;else{var A=h.suspendedLanes,I=h.pingedLanes;T=(1<<31-Dt(42|i)+1)-1,T&=v&~(A&~I),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(o=!0,eg(h,T))}else T=Ct,T=$r(h,h===Xt?T:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(T&3)===0||Yr(h,T)||(o=!0,eg(h,T));h=h.next}while(o);Z0=!1}}function zE(){Kx()}function Kx(){au=K0=!1;var i=0;ts!==0&&(ZE()&&(i=ts),ts=0);for(var s=Te(),o=null,h=ru;h!==null;){var v=h.next,T=Zx(h,s);T===0?(h.next=null,o===null?ru=v:o.next=v,v===null&&(Ks=o)):(o=h,(i!==0||(T&3)!==0)&&(au=!0)),h=v}fo(i)}function Zx(i,s){for(var o=i.suspendedLanes,h=i.pingedLanes,v=i.expirationTimes,T=i.pendingLanes&-62914561;0<T;){var A=31-Dt(T),I=1<<A,Q=v[A];Q===-1?((I&o)===0||(I&h)!==0)&&(v[A]=Za(I,s)):Q<=s&&(i.expiredLanes|=I),T&=~I}if(s=Xt,o=Ct,o=$r(i,i===s?o:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,o===0||i===s&&(Bt===2||Bt===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&Ke(h),i.callbackNode=null,i.callbackPriority=0;if((o&3)===0||Yr(i,o)){if(s=o&-o,s===i.callbackPriority)return s;switch(h!==null&&Ke(h),En(o)){case 2:case 8:o=Ft;break;case 32:o=Tt;break;case 268435456:o=fn;break;default:o=Tt}return h=Qx.bind(null,i),o=pt(o,h),i.callbackPriority=s,i.callbackNode=o,s}return h!==null&&h!==null&&Ke(h),i.callbackPriority=2,i.callbackNode=null,2}function Qx(i,s){if(Gn!==0&&Gn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var o=i.callbackNode;if(nu()&&i.callbackNode!==o)return null;var h=Ct;return h=$r(i,i===Xt?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(Lx(i,h,s),Zx(i,Te()),i.callbackNode!=null&&i.callbackNode===o?Qx.bind(null,i):null)}function eg(i,s){if(nu())return null;Lx(i,s,!0)}function jE(){eS(function(){(Ut&6)!==0?pt(ze,zE):Kx()})}function Q0(){return ts===0&&(ts=Sa()),ts}function tg(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:pc(""+i)}function ng(i,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,i.id&&o.setAttribute("form",i.id),s.parentNode.insertBefore(o,s),i=new FormData(i),o.parentNode.removeChild(o),i}function qE(i,s,o,h,v){if(s==="submit"&&o&&o.stateNode===v){var T=tg((v[Qt]||null).action),A=h.submitter;A&&(s=(s=A[Qt]||null)?tg(s.formAction):A.getAttribute("formAction"),s!==null&&(T=s,A=null));var I=new yc("action","action",null,h,v);i.push({event:I,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(ts!==0){var Q=A?ng(v,A):new FormData(v);y0(o,{pending:!0,data:Q,method:v.method,action:T},null,Q)}}else typeof T=="function"&&(I.preventDefault(),Q=A?ng(v,A):new FormData(v),y0(o,{pending:!0,data:Q,method:v.method,action:T},T,Q))},currentTarget:v}]})}}for(var ed=0;ed<Uf.length;ed++){var td=Uf[ed],$E=td.toLowerCase(),YE=td[0].toUpperCase()+td.slice(1);Wr($E,"on"+YE)}Wr(Lm,"onAnimationEnd"),Wr(Om,"onAnimationIteration"),Wr(Pm,"onAnimationStart"),Wr("dblclick","onDoubleClick"),Wr("focusin","onFocus"),Wr("focusout","onBlur"),Wr(uE,"onTransitionRun"),Wr(fE,"onTransitionStart"),Wr(dE,"onTransitionCancel"),Wr(Um,"onTransitionEnd"),Oe("onMouseEnter",["mouseout","mouseover"]),Oe("onMouseLeave",["mouseout","mouseover"]),Oe("onPointerEnter",["pointerout","pointerover"]),Oe("onPointerLeave",["pointerout","pointerover"]),Re("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Re("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Re("onBeforeInput",["compositionend","keypress","textInput","paste"]),Re("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ho));function rg(i,s){s=(s&4)!==0;for(var o=0;o<i.length;o++){var h=i[o],v=h.event;h=h.listeners;e:{var T=void 0;if(s)for(var A=h.length-1;0<=A;A--){var I=h[A],Q=I.instance,he=I.currentTarget;if(I=I.listener,Q!==T&&v.isPropagationStopped())break e;T=I,v.currentTarget=he;try{T(v)}catch(Ae){qc(Ae)}v.currentTarget=null,T=Q}else for(A=0;A<h.length;A++){if(I=h[A],Q=I.instance,he=I.currentTarget,I=I.listener,Q!==T&&v.isPropagationStopped())break e;T=I,v.currentTarget=he;try{T(v)}catch(Ae){qc(Ae)}v.currentTarget=null,T=Q}}}}function yt(i,s){var o=s[Mr];o===void 0&&(o=s[Mr]=new Set);var h=i+"__bubble";o.has(h)||(ag(s,i,2,!1),o.add(h))}function nd(i,s,o){var h=0;s&&(h|=4),ag(o,i,h,s)}var iu="_reactListening"+Math.random().toString(36).slice(2);function rd(i){if(!i[iu]){i[iu]=!0,pe.forEach(function(o){o!=="selectionchange"&&(WE.has(o)||nd(o,!1,i),nd(o,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[iu]||(s[iu]=!0,nd("selectionchange",!1,s))}}function ag(i,s,o,h){switch(kg(s)){case 2:var v=_S;break;case 8:v=ES;break;default:v=gd}o=v.bind(null,s,o,i),v=void 0,!Cf||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(v=!0),h?v!==void 0?i.addEventListener(s,o,{capture:!0,passive:v}):i.addEventListener(s,o,!0):v!==void 0?i.addEventListener(s,o,{passive:v}):i.addEventListener(s,o,!1)}function ad(i,s,o,h,v){var T=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var A=h.tag;if(A===3||A===4){var I=h.stateNode.containerInfo;if(I===v)break;if(A===4)for(A=h.return;A!==null;){var Q=A.tag;if((Q===3||Q===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;I!==null;){if(A=B(I),A===null)return;if(Q=A.tag,Q===5||Q===6||Q===26||Q===27){h=T=A;continue e}I=I.parentNode}}h=h.return}fm(function(){var he=T,Ae=Sf(o),Ne=[];e:{var ge=Bm.get(i);if(ge!==void 0){var ye=yc,et=i;switch(i){case"keypress":if(gc(o)===0)break e;case"keydown":case"keyup":ye=G_;break;case"focusin":et="focus",ye=Nf;break;case"focusout":et="blur",ye=Nf;break;case"beforeblur":case"afterblur":ye=Nf;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=mm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=M_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=q_;break;case Lm:case Om:case Pm:ye=I_;break;case Um:ye=Y_;break;case"scroll":case"scrollend":ye=k_;break;case"wheel":ye=X_;break;case"copy":case"cut":case"paste":ye=L_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=xm;break;case"toggle":case"beforetoggle":ye=K_}var Ze=(s&4)!==0,zt=!Ze&&(i==="scroll"||i==="scrollend"),le=Ze?ge!==null?ge+"Capture":null:ge;Ze=[];for(var ie=he,ue;ie!==null;){var be=ie;if(ue=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||ue===null||le===null||(be=Rl(ie,le),be!=null&&Ze.push(mo(ie,be,ue))),zt)break;ie=ie.return}0<Ze.length&&(ge=new ye(ge,et,null,o,Ae),Ne.push({event:ge,listeners:Ze}))}}if((s&7)===0){e:{if(ge=i==="mouseover"||i==="pointerover",ye=i==="mouseout"||i==="pointerout",ge&&o!==Ef&&(et=o.relatedTarget||o.fromElement)&&(B(et)||et[_t]))break e;if((ye||ge)&&(ge=Ae.window===Ae?Ae:(ge=Ae.ownerDocument)?ge.defaultView||ge.parentWindow:window,ye?(et=o.relatedTarget||o.toElement,ye=he,et=et?B(et):null,et!==null&&(zt=l(et),Ze=et.tag,et!==zt||Ze!==5&&Ze!==27&&Ze!==6)&&(et=null)):(ye=null,et=he),ye!==et)){if(Ze=mm,be="onMouseLeave",le="onMouseEnter",ie="mouse",(i==="pointerout"||i==="pointerover")&&(Ze=xm,be="onPointerLeave",le="onPointerEnter",ie="pointer"),zt=ye==null?ge:fe(ye),ue=et==null?ge:fe(et),ge=new Ze(be,ie+"leave",ye,o,Ae),ge.target=zt,ge.relatedTarget=ue,be=null,B(Ae)===he&&(Ze=new Ze(le,ie+"enter",et,o,Ae),Ze.target=ue,Ze.relatedTarget=zt,be=Ze),zt=be,ye&&et)t:{for(Ze=ye,le=et,ie=0,ue=Ze;ue;ue=Zs(ue))ie++;for(ue=0,be=le;be;be=Zs(be))ue++;for(;0<ie-ue;)Ze=Zs(Ze),ie--;for(;0<ue-ie;)le=Zs(le),ue--;for(;ie--;){if(Ze===le||le!==null&&Ze===le.alternate)break t;Ze=Zs(Ze),le=Zs(le)}Ze=null}else Ze=null;ye!==null&&ig(Ne,ge,ye,Ze,!1),et!==null&&zt!==null&&ig(Ne,zt,et,Ze,!0)}}e:{if(ge=he?fe(he):window,ye=ge.nodeName&&ge.nodeName.toLowerCase(),ye==="select"||ye==="input"&&ge.type==="file")var je=wm;else if(Em(ge))if(Cm)je=lE;else{je=iE;var mt=aE}else ye=ge.nodeName,!ye||ye.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?he&&_f(he.elementType)&&(je=wm):je=sE;if(je&&(je=je(i,he))){Sm(Ne,je,o,Ae);break e}mt&&mt(i,ge,he),i==="focusout"&&he&&ge.type==="number"&&he.memoizedProps.value!=null&&Tf(ge,"number",ge.value)}switch(mt=he?fe(he):window,i){case"focusin":(Em(mt)||mt.contentEditable==="true")&&(ks=mt,Lf=he,Bl=null);break;case"focusout":Bl=Lf=ks=null;break;case"mousedown":Of=!0;break;case"contextmenu":case"mouseup":case"dragend":Of=!1,Im(Ne,o,Ae);break;case"selectionchange":if(cE)break;case"keydown":case"keyup":Im(Ne,o,Ae)}var Xe;if(Rf)e:{switch(i){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else bs?Tm(i,o)&&(Qe="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(Qe="onCompositionStart");Qe&&(gm&&o.locale!=="ko"&&(bs||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&bs&&(Xe=dm()):(ni=Ae,Af="value"in ni?ni.value:ni.textContent,bs=!0)),mt=su(he,Qe),0<mt.length&&(Qe=new pm(Qe,i,null,o,Ae),Ne.push({event:Qe,listeners:mt}),Xe?Qe.data=Xe:(Xe=_m(o),Xe!==null&&(Qe.data=Xe)))),(Xe=Q_?eE(i,o):tE(i,o))&&(Qe=su(he,"onBeforeInput"),0<Qe.length&&(mt=new pm("onBeforeInput","beforeinput",null,o,Ae),Ne.push({event:mt,listeners:Qe}),mt.data=Xe)),qE(Ne,i,he,o,Ae)}rg(Ne,s)})}function mo(i,s,o){return{instance:i,listener:s,currentTarget:o}}function su(i,s){for(var o=s+"Capture",h=[];i!==null;){var v=i,T=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||T===null||(v=Rl(i,o),v!=null&&h.unshift(mo(i,v,T)),v=Rl(i,s),v!=null&&h.push(mo(i,v,T))),i.tag===3)return h;i=i.return}return[]}function Zs(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function ig(i,s,o,h,v){for(var T=s._reactName,A=[];o!==null&&o!==h;){var I=o,Q=I.alternate,he=I.stateNode;if(I=I.tag,Q!==null&&Q===h)break;I!==5&&I!==26&&I!==27||he===null||(Q=he,v?(he=Rl(o,T),he!=null&&A.unshift(mo(o,he,Q))):v||(he=Rl(o,T),he!=null&&A.push(mo(o,he,Q)))),o=o.return}A.length!==0&&i.push({event:s,listeners:A})}var XE=/\r\n?/g,JE=/\u0000|\uFFFD/g;function sg(i){return(typeof i=="string"?i:""+i).replace(XE,`
`).replace(JE,"")}function lg(i,s){return s=sg(s),sg(i)===s}function lu(){}function Gt(i,s,o,h,v,T){switch(o){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||ws(i,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&ws(i,""+h);break;case"className":$e(i,"class",h);break;case"tabIndex":$e(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":$e(i,o,h);break;case"style":cm(i,h,T);break;case"data":if(s!=="object"){$e(i,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||o!=="href")){i.removeAttribute(o);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(o);break}h=pc(""+h),i.setAttribute(o,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(o==="formAction"?(s!=="input"&&Gt(i,s,"name",v.name,v,null),Gt(i,s,"formEncType",v.formEncType,v,null),Gt(i,s,"formMethod",v.formMethod,v,null),Gt(i,s,"formTarget",v.formTarget,v,null)):(Gt(i,s,"encType",v.encType,v,null),Gt(i,s,"method",v.method,v,null),Gt(i,s,"target",v.target,v,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(o);break}h=pc(""+h),i.setAttribute(o,h);break;case"onClick":h!=null&&(i.onclick=lu);break;case"onScroll":h!=null&&yt("scroll",i);break;case"onScrollEnd":h!=null&&yt("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(o=h.__html,o!=null){if(v.children!=null)throw Error(r(60));i.innerHTML=o}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}o=pc(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(o,""+h):i.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(o,""):i.removeAttribute(o);break;case"capture":case"download":h===!0?i.setAttribute(o,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(o,h):i.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(o,h):i.removeAttribute(o);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(o):i.setAttribute(o,h);break;case"popover":yt("beforetoggle",i),yt("toggle",i),Ge(i,"popover",h);break;case"xlinkActuate":Ve(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Ve(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Ve(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Ve(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Ve(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Ve(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Ve(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Ve(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Ve(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Ge(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=A_.get(o)||o,Ge(i,o,h))}}function id(i,s,o,h,v,T){switch(o){case"style":cm(i,h,T);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(o=h.__html,o!=null){if(v.children!=null)throw Error(r(60));i.innerHTML=o}}break;case"children":typeof h=="string"?ws(i,h):(typeof h=="number"||typeof h=="bigint")&&ws(i,""+h);break;case"onScroll":h!=null&&yt("scroll",i);break;case"onScrollEnd":h!=null&&yt("scrollend",i);break;case"onClick":h!=null&&(i.onclick=lu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ve.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(v=o.endsWith("Capture"),s=o.slice(2,v?o.length-7:void 0),T=i[Qt]||null,T=T!=null?T[o]:null,typeof T=="function"&&i.removeEventListener(s,T,v),typeof h=="function")){typeof T!="function"&&T!==null&&(o in i?i[o]=null:i.hasAttribute(o)&&i.removeAttribute(o)),i.addEventListener(s,h,v);break e}o in i?i[o]=h:h===!0?i.setAttribute(o,""):Ge(i,o,h)}}}function zn(i,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",i),yt("load",i);var h=!1,v=!1,T;for(T in o)if(o.hasOwnProperty(T)){var A=o[T];if(A!=null)switch(T){case"src":h=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Gt(i,s,T,A,o,null)}}v&&Gt(i,s,"srcSet",o.srcSet,o,null),h&&Gt(i,s,"src",o.src,o,null);return;case"input":yt("invalid",i);var I=T=A=v=null,Q=null,he=null;for(h in o)if(o.hasOwnProperty(h)){var Ae=o[h];if(Ae!=null)switch(h){case"name":v=Ae;break;case"type":A=Ae;break;case"checked":Q=Ae;break;case"defaultChecked":he=Ae;break;case"value":T=Ae;break;case"defaultValue":I=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(r(137,s));break;default:Gt(i,s,h,Ae,o,null)}}ka(i,T,I,Q,he,A,v,!1),ei(i);return;case"select":yt("invalid",i),h=A=T=null;for(v in o)if(o.hasOwnProperty(v)&&(I=o[v],I!=null))switch(v){case"value":T=I;break;case"defaultValue":A=I;break;case"multiple":h=I;default:Gt(i,s,v,I,o,null)}s=T,o=A,i.multiple=!!h,s!=null?Ss(i,!!h,s,!1):o!=null&&Ss(i,!!h,o,!0);return;case"textarea":yt("invalid",i),T=v=h=null;for(A in o)if(o.hasOwnProperty(A)&&(I=o[A],I!=null))switch(A){case"value":h=I;break;case"defaultValue":v=I;break;case"children":T=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(r(91));break;default:Gt(i,s,A,I,o,null)}lm(i,h,v,T),ei(i);return;case"option":for(Q in o)if(o.hasOwnProperty(Q)&&(h=o[Q],h!=null))switch(Q){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Gt(i,s,Q,h,o,null)}return;case"dialog":yt("beforetoggle",i),yt("toggle",i),yt("cancel",i),yt("close",i);break;case"iframe":case"object":yt("load",i);break;case"video":case"audio":for(h=0;h<ho.length;h++)yt(ho[h],i);break;case"image":yt("error",i),yt("load",i);break;case"details":yt("toggle",i);break;case"embed":case"source":case"link":yt("error",i),yt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in o)if(o.hasOwnProperty(he)&&(h=o[he],h!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Gt(i,s,he,h,o,null)}return;default:if(_f(s)){for(Ae in o)o.hasOwnProperty(Ae)&&(h=o[Ae],h!==void 0&&id(i,s,Ae,h,o,void 0));return}}for(I in o)o.hasOwnProperty(I)&&(h=o[I],h!=null&&Gt(i,s,I,h,o,null))}function KE(i,s,o,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,T=null,A=null,I=null,Q=null,he=null,Ae=null;for(ye in o){var Ne=o[ye];if(o.hasOwnProperty(ye)&&Ne!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":Q=Ne;default:h.hasOwnProperty(ye)||Gt(i,s,ye,null,h,Ne)}}for(var ge in h){var ye=h[ge];if(Ne=o[ge],h.hasOwnProperty(ge)&&(ye!=null||Ne!=null))switch(ge){case"type":T=ye;break;case"name":v=ye;break;case"checked":he=ye;break;case"defaultChecked":Ae=ye;break;case"value":A=ye;break;case"defaultValue":I=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(r(137,s));break;default:ye!==Ne&&Gt(i,s,ge,ye,h,Ne)}}ti(i,A,I,Q,he,Ae,T,v);return;case"select":ye=A=I=ge=null;for(T in o)if(Q=o[T],o.hasOwnProperty(T)&&Q!=null)switch(T){case"value":break;case"multiple":ye=Q;default:h.hasOwnProperty(T)||Gt(i,s,T,null,h,Q)}for(v in h)if(T=h[v],Q=o[v],h.hasOwnProperty(v)&&(T!=null||Q!=null))switch(v){case"value":ge=T;break;case"defaultValue":I=T;break;case"multiple":A=T;default:T!==Q&&Gt(i,s,v,T,h,Q)}s=I,o=A,h=ye,ge!=null?Ss(i,!!o,ge,!1):!!h!=!!o&&(s!=null?Ss(i,!!o,s,!0):Ss(i,!!o,o?[]:"",!1));return;case"textarea":ye=ge=null;for(I in o)if(v=o[I],o.hasOwnProperty(I)&&v!=null&&!h.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:Gt(i,s,I,null,h,v)}for(A in h)if(v=h[A],T=o[A],h.hasOwnProperty(A)&&(v!=null||T!=null))switch(A){case"value":ge=v;break;case"defaultValue":ye=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(r(91));break;default:v!==T&&Gt(i,s,A,v,h,T)}sm(i,ge,ye);return;case"option":for(var et in o)if(ge=o[et],o.hasOwnProperty(et)&&ge!=null&&!h.hasOwnProperty(et))switch(et){case"selected":i.selected=!1;break;default:Gt(i,s,et,null,h,ge)}for(Q in h)if(ge=h[Q],ye=o[Q],h.hasOwnProperty(Q)&&ge!==ye&&(ge!=null||ye!=null))switch(Q){case"selected":i.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:Gt(i,s,Q,ge,h,ye)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ze in o)ge=o[Ze],o.hasOwnProperty(Ze)&&ge!=null&&!h.hasOwnProperty(Ze)&&Gt(i,s,Ze,null,h,ge);for(he in h)if(ge=h[he],ye=o[he],h.hasOwnProperty(he)&&ge!==ye&&(ge!=null||ye!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,s));break;default:Gt(i,s,he,ge,h,ye)}return;default:if(_f(s)){for(var zt in o)ge=o[zt],o.hasOwnProperty(zt)&&ge!==void 0&&!h.hasOwnProperty(zt)&&id(i,s,zt,void 0,h,ge);for(Ae in h)ge=h[Ae],ye=o[Ae],!h.hasOwnProperty(Ae)||ge===ye||ge===void 0&&ye===void 0||id(i,s,Ae,ge,h,ye);return}}for(var le in o)ge=o[le],o.hasOwnProperty(le)&&ge!=null&&!h.hasOwnProperty(le)&&Gt(i,s,le,null,h,ge);for(Ne in h)ge=h[Ne],ye=o[Ne],!h.hasOwnProperty(Ne)||ge===ye||ge==null&&ye==null||Gt(i,s,Ne,ge,h,ye)}var sd=null,ld=null;function ou(i){return i.nodeType===9?i:i.ownerDocument}function og(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cg(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function od(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var cd=null;function ZE(){var i=window.event;return i&&i.type==="popstate"?i===cd?!1:(cd=i,!0):(cd=null,!1)}var ug=typeof setTimeout=="function"?setTimeout:void 0,QE=typeof clearTimeout=="function"?clearTimeout:void 0,fg=typeof Promise=="function"?Promise:void 0,eS=typeof queueMicrotask=="function"?queueMicrotask:typeof fg<"u"?function(i){return fg.resolve(null).then(i).catch(tS)}:ug;function tS(i){setTimeout(function(){throw i})}function vi(i){return i==="head"}function dg(i,s){var o=s,h=0,v=0;do{var T=o.nextSibling;if(i.removeChild(o),T&&T.nodeType===8)if(o=T.data,o==="/$"){if(0<h&&8>h){o=h;var A=i.ownerDocument;if(o&1&&po(A.documentElement),o&2&&po(A.body),o&4)for(o=A.head,po(o),A=o.firstChild;A;){var I=A.nextSibling,Q=A.nodeName;A[L]||Q==="SCRIPT"||Q==="STYLE"||Q==="LINK"&&A.rel.toLowerCase()==="stylesheet"||o.removeChild(A),A=I}}if(v===0){i.removeChild(T),So(s);return}v--}else o==="$"||o==="$?"||o==="$!"?v++:h=o.charCodeAt(0)-48;else h=0;o=T}while(o);So(s)}function ud(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":ud(o),P(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}i.removeChild(o)}}function nS(i,s,o,h){for(;i.nodeType===1;){var v=o;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[L])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(T=i.getAttribute("rel"),T==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(T!==v.rel||i.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||i.getAttribute("title")!==(v.title==null?null:v.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(T=i.getAttribute("src"),(T!==(v.src==null?null:v.src)||i.getAttribute("type")!==(v.type==null?null:v.type)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&T&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var T=v.name==null?null:""+v.name;if(v.type==="hidden"&&i.getAttribute("name")===T)return i}else return i;if(i=Jr(i.nextSibling),i===null)break}return null}function rS(i,s,o){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Jr(i.nextSibling),i===null))return null;return i}function fd(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function aS(i,s){var o=i.ownerDocument;if(i.data!=="$?"||o.readyState==="complete")s();else{var h=function(){s(),o.removeEventListener("DOMContentLoaded",h)};o.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function Jr(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var dd=null;function hg(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"){if(s===0)return i;s--}else o==="/$"&&s++}i=i.previousSibling}return null}function mg(i,s,o){switch(s=ou(o),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function po(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);P(i)}var Pr=new Map,pg=new Set;function cu(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ga=me.d;me.d={f:iS,r:sS,D:lS,C:oS,L:cS,m:uS,X:dS,S:fS,M:hS};function iS(){var i=Ga.f(),s=eu();return i||s}function sS(i){var s=z(i);s!==null&&s.tag===5&&s.type==="form"?Lp(s):Ga.r(i)}var Qs=typeof document>"u"?null:document;function xg(i,s,o){var h=Qs;if(h&&typeof s=="string"&&s){var v=dn(s);v='link[rel="'+i+'"][href="'+v+'"]',typeof o=="string"&&(v+='[crossorigin="'+o+'"]'),pg.has(v)||(pg.add(v),i={rel:i,crossOrigin:o,href:s},h.querySelector(v)===null&&(s=h.createElement("link"),zn(s,"link",i),oe(s),h.head.appendChild(s)))}}function lS(i){Ga.D(i),xg("dns-prefetch",i,null)}function oS(i,s){Ga.C(i,s),xg("preconnect",i,s)}function cS(i,s,o){Ga.L(i,s,o);var h=Qs;if(h&&i&&s){var v='link[rel="preload"][as="'+dn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(v+='[imagesrcset="'+dn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(v+='[imagesizes="'+dn(o.imageSizes)+'"]')):v+='[href="'+dn(i)+'"]';var T=v;switch(s){case"style":T=el(i);break;case"script":T=tl(i)}Pr.has(T)||(i=x({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:i,as:s},o),Pr.set(T,i),h.querySelector(v)!==null||s==="style"&&h.querySelector(xo(T))||s==="script"&&h.querySelector(go(T))||(s=h.createElement("link"),zn(s,"link",i),oe(s),h.head.appendChild(s)))}}function uS(i,s){Ga.m(i,s);var o=Qs;if(o&&i){var h=s&&typeof s.as=="string"?s.as:"script",v='link[rel="modulepreload"][as="'+dn(h)+'"][href="'+dn(i)+'"]',T=v;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=tl(i)}if(!Pr.has(T)&&(i=x({rel:"modulepreload",href:i},s),Pr.set(T,i),o.querySelector(v)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(go(T)))return}h=o.createElement("link"),zn(h,"link",i),oe(h),o.head.appendChild(h)}}}function fS(i,s,o){Ga.S(i,s,o);var h=Qs;if(h&&i){var v=_e(h).hoistableStyles,T=el(i);s=s||"default";var A=v.get(T);if(!A){var I={loading:0,preload:null};if(A=h.querySelector(xo(T)))I.loading=5;else{i=x({rel:"stylesheet",href:i,"data-precedence":s},o),(o=Pr.get(T))&&hd(i,o);var Q=A=h.createElement("link");oe(Q),zn(Q,"link",i),Q._p=new Promise(function(he,Ae){Q.onload=he,Q.onerror=Ae}),Q.addEventListener("load",function(){I.loading|=1}),Q.addEventListener("error",function(){I.loading|=2}),I.loading|=4,uu(A,s,h)}A={type:"stylesheet",instance:A,count:1,state:I},v.set(T,A)}}}function dS(i,s){Ga.X(i,s);var o=Qs;if(o&&i){var h=_e(o).hoistableScripts,v=tl(i),T=h.get(v);T||(T=o.querySelector(go(v)),T||(i=x({src:i,async:!0},s),(s=Pr.get(v))&&md(i,s),T=o.createElement("script"),oe(T),zn(T,"link",i),o.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(v,T))}}function hS(i,s){Ga.M(i,s);var o=Qs;if(o&&i){var h=_e(o).hoistableScripts,v=tl(i),T=h.get(v);T||(T=o.querySelector(go(v)),T||(i=x({src:i,async:!0,type:"module"},s),(s=Pr.get(v))&&md(i,s),T=o.createElement("script"),oe(T),zn(T,"link",i),o.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(v,T))}}function gg(i,s,o,h){var v=(v=se.current)?cu(v):null;if(!v)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=el(o.href),o=_e(v).hoistableStyles,h=o.get(s),h||(h={type:"style",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){i=el(o.href);var T=_e(v).hoistableStyles,A=T.get(i);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(i,A),(T=v.querySelector(xo(i)))&&!T._p&&(A.instance=T,A.state.loading=5),Pr.has(i)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Pr.set(i,o),T||mS(v,i,o,A.state))),s&&h===null)throw Error(r(528,""));return A}if(s&&h!==null)throw Error(r(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=tl(o),o=_e(v).hoistableScripts,h=o.get(s),h||(h={type:"script",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function el(i){return'href="'+dn(i)+'"'}function xo(i){return'link[rel="stylesheet"]['+i+"]"}function vg(i){return x({},i,{"data-precedence":i.precedence,precedence:null})}function mS(i,s,o,h){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=i.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),zn(s,"link",o),oe(s),i.head.appendChild(s))}function tl(i){return'[src="'+dn(i)+'"]'}function go(i){return"script[async]"+i}function yg(i,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var h=i.querySelector('style[data-href~="'+dn(o.href)+'"]');if(h)return s.instance=h,oe(h),h;var v=x({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),oe(h),zn(h,"style",v),uu(h,o.precedence,i),s.instance=h;case"stylesheet":v=el(o.href);var T=i.querySelector(xo(v));if(T)return s.state.loading|=4,s.instance=T,oe(T),T;h=vg(o),(v=Pr.get(v))&&hd(h,v),T=(i.ownerDocument||i).createElement("link"),oe(T);var A=T;return A._p=new Promise(function(I,Q){A.onload=I,A.onerror=Q}),zn(T,"link",h),s.state.loading|=4,uu(T,o.precedence,i),s.instance=T;case"script":return T=tl(o.src),(v=i.querySelector(go(T)))?(s.instance=v,oe(v),v):(h=o,(v=Pr.get(T))&&(h=x({},o),md(h,v)),i=i.ownerDocument||i,v=i.createElement("script"),oe(v),zn(v,"link",h),i.head.appendChild(v),s.instance=v);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,uu(h,o.precedence,i));return s.instance}function uu(i,s,o){for(var h=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=h.length?h[h.length-1]:null,T=v,A=0;A<h.length;A++){var I=h[A];if(I.dataset.precedence===s)T=I;else if(T!==v)break}T?T.parentNode.insertBefore(i,T.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(i,s.firstChild))}function hd(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function md(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var fu=null;function Tg(i,s,o){if(fu===null){var h=new Map,v=fu=new Map;v.set(o,h)}else v=fu,h=v.get(o),h||(h=new Map,v.set(o,h));if(h.has(i))return h;for(h.set(i,null),o=o.getElementsByTagName(i),v=0;v<o.length;v++){var T=o[v];if(!(T[L]||T[Zt]||i==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var A=T.getAttribute(s)||"";A=i+A;var I=h.get(A);I?I.push(T):h.set(A,[T])}}return h}function _g(i,s,o){i=i.ownerDocument||i,i.head.insertBefore(o,s==="title"?i.querySelector("head > title"):null)}function pS(i,s,o){if(o===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Eg(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var vo=null;function xS(){}function gS(i,s,o){if(vo===null)throw Error(r(475));var h=vo;if(s.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var v=el(o.href),T=i.querySelector(xo(v));if(T){i=T._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(h.count++,h=du.bind(h),i.then(h,h)),s.state.loading|=4,s.instance=T,oe(T);return}T=i.ownerDocument||i,o=vg(o),(v=Pr.get(v))&&hd(o,v),T=T.createElement("link"),oe(T);var A=T;A._p=new Promise(function(I,Q){A.onload=I,A.onerror=Q}),zn(T,"link",o),s.instance=T}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(h.count++,s=du.bind(h),i.addEventListener("load",s),i.addEventListener("error",s))}}function vS(){if(vo===null)throw Error(r(475));var i=vo;return i.stylesheets&&i.count===0&&pd(i,i.stylesheets),0<i.count?function(s){var o=setTimeout(function(){if(i.stylesheets&&pd(i,i.stylesheets),i.unsuspend){var h=i.unsuspend;i.unsuspend=null,h()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(o)}}:null}function du(){if(this.count--,this.count===0){if(this.stylesheets)pd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var hu=null;function pd(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,hu=new Map,s.forEach(yS,i),hu=null,du.call(i))}function yS(i,s){if(!(s.state.loading&4)){var o=hu.get(i);if(o)var h=o.get(null);else{o=new Map,hu.set(i,o);for(var v=i.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<v.length;T++){var A=v[T];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(o.set(A.dataset.precedence,A),h=A)}h&&o.set(null,h)}v=s.instance,A=v.getAttribute("data-precedence"),T=o.get(A)||h,T===h&&o.set(null,v),o.set(A,v),this.count++,h=du.bind(this),v.addEventListener("load",h),v.addEventListener("error",h),T?T.parentNode.insertBefore(v,T.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(v,i.firstChild)),s.state.loading|=4}}var yo={$$typeof:b,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function TS(i,s,o,h,v,T,A,I){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ca(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ca(0),this.hiddenUpdates=Ca(null),this.identifierPrefix=h,this.onUncaughtError=v,this.onCaughtError=T,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function Sg(i,s,o,h,v,T,A,I,Q,he,Ae,Ne){return i=new TS(i,s,o,A,I,Q,he,Ne),s=1,T===!0&&(s|=24),T=yr(3,null,null,s),i.current=T,T.stateNode=i,s=Jf(),s.refCount++,i.pooledCache=s,s.refCount++,T.memoizedState={element:h,isDehydrated:o,cache:s},e0(T),i}function wg(i){return i?(i=Ds,i):Ds}function Cg(i,s,o,h,v,T){v=wg(v),h.context===null?h.context=v:h.pendingContext=v,h=ii(s),h.payload={element:o},T=T===void 0?null:T,T!==null&&(h.callback=T),o=si(i,h,s),o!==null&&(wr(o,i,s),Wl(o,i,s))}function Ag(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<s?o:s}}function xd(i,s){Ag(i,s),(i=i.alternate)&&Ag(i,s)}function bg(i){if(i.tag===13){var s=Rs(i,67108864);s!==null&&wr(s,i,67108864),xd(i,67108864)}}var mu=!0;function _S(i,s,o,h){var v=ae.T;ae.T=null;var T=me.p;try{me.p=2,gd(i,s,o,h)}finally{me.p=T,ae.T=v}}function ES(i,s,o,h){var v=ae.T;ae.T=null;var T=me.p;try{me.p=8,gd(i,s,o,h)}finally{me.p=T,ae.T=v}}function gd(i,s,o,h){if(mu){var v=vd(h);if(v===null)ad(i,s,h,pu,o),Ng(i,h);else if(wS(v,i,s,o,h))h.stopPropagation();else if(Ng(i,h),s&4&&-1<SS.indexOf(i)){for(;v!==null;){var T=z(v);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var A=Bn(T.pendingLanes);if(A!==0){var I=T;for(I.pendingLanes|=2,I.entangledLanes|=2;A;){var Q=1<<31-Dt(A);I.entanglements[1]|=Q,A&=~Q}fa(T),(Ut&6)===0&&(Zc=Te()+500,fo(0))}}break;case 13:I=Rs(T,2),I!==null&&wr(I,T,2),eu(),xd(T,2)}if(T=vd(h),T===null&&ad(i,s,h,pu,o),T===v)break;v=T}v!==null&&h.stopPropagation()}else ad(i,s,h,null,o)}}function vd(i){return i=Sf(i),yd(i)}var pu=null;function yd(i){if(pu=null,i=B(i),i!==null){var s=l(i);if(s===null)i=null;else{var o=s.tag;if(o===13){if(i=c(s),i!==null)return i;i=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return pu=i,null}function kg(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(He()){case ze:return 2;case Ft:return 8;case Tt:case ot:return 32;case fn:return 268435456;default:return 32}default:return 32}}var Td=!1,yi=null,Ti=null,_i=null,To=new Map,_o=new Map,Ei=[],SS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ng(i,s){switch(i){case"focusin":case"focusout":yi=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":_i=null;break;case"pointerover":case"pointerout":To.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":_o.delete(s.pointerId)}}function Eo(i,s,o,h,v,T){return i===null||i.nativeEvent!==T?(i={blockedOn:s,domEventName:o,eventSystemFlags:h,nativeEvent:T,targetContainers:[v]},s!==null&&(s=z(s),s!==null&&bg(s)),i):(i.eventSystemFlags|=h,s=i.targetContainers,v!==null&&s.indexOf(v)===-1&&s.push(v),i)}function wS(i,s,o,h,v){switch(s){case"focusin":return yi=Eo(yi,i,s,o,h,v),!0;case"dragenter":return Ti=Eo(Ti,i,s,o,h,v),!0;case"mouseover":return _i=Eo(_i,i,s,o,h,v),!0;case"pointerover":var T=v.pointerId;return To.set(T,Eo(To.get(T)||null,i,s,o,h,v)),!0;case"gotpointercapture":return T=v.pointerId,_o.set(T,Eo(_o.get(T)||null,i,s,o,h,v)),!0}return!1}function Mg(i){var s=B(i.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){i.blockedOn=s,Aa(i.priority,function(){if(o.tag===13){var h=Sr();h=Rn(h);var v=Rs(o,h);v!==null&&wr(v,o,h),xd(o,h)}});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function xu(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var o=vd(i.nativeEvent);if(o===null){o=i.nativeEvent;var h=new o.constructor(o.type,o);Ef=h,o.target.dispatchEvent(h),Ef=null}else return s=z(o),s!==null&&bg(s),i.blockedOn=o,!1;s.shift()}return!0}function Rg(i,s,o){xu(i)&&o.delete(s)}function CS(){Td=!1,yi!==null&&xu(yi)&&(yi=null),Ti!==null&&xu(Ti)&&(Ti=null),_i!==null&&xu(_i)&&(_i=null),To.forEach(Rg),_o.forEach(Rg)}function gu(i,s){i.blockedOn===s&&(i.blockedOn=null,Td||(Td=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,CS)))}var vu=null;function Dg(i){vu!==i&&(vu=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){vu===i&&(vu=null);for(var s=0;s<i.length;s+=3){var o=i[s],h=i[s+1],v=i[s+2];if(typeof h!="function"){if(yd(h||o)===null)continue;break}var T=z(o);T!==null&&(i.splice(s,3),s-=3,y0(T,{pending:!0,data:v,method:o.method,action:h},h,v))}}))}function So(i){function s(Q){return gu(Q,i)}yi!==null&&gu(yi,i),Ti!==null&&gu(Ti,i),_i!==null&&gu(_i,i),To.forEach(s),_o.forEach(s);for(var o=0;o<Ei.length;o++){var h=Ei[o];h.blockedOn===i&&(h.blockedOn=null)}for(;0<Ei.length&&(o=Ei[0],o.blockedOn===null);)Mg(o),o.blockedOn===null&&Ei.shift();if(o=(i.ownerDocument||i).$$reactFormReplay,o!=null)for(h=0;h<o.length;h+=3){var v=o[h],T=o[h+1],A=v[Qt]||null;if(typeof T=="function")A||Dg(o);else if(A){var I=null;if(T&&T.hasAttribute("formAction")){if(v=T,A=T[Qt]||null)I=A.formAction;else if(yd(v)!==null)continue}else I=A.action;typeof I=="function"?o[h+1]=I:(o.splice(h,3),h-=3),Dg(o)}}}function _d(i){this._internalRoot=i}yu.prototype.render=_d.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var o=s.current,h=Sr();Cg(o,h,i,s,null,null)},yu.prototype.unmount=_d.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Cg(i.current,2,null,i,null,null),eu(),s[_t]=null}};function yu(i){this._internalRoot=i}yu.prototype.unstable_scheduleHydration=function(i){if(i){var s=Nr();i={blockedOn:null,target:i,priority:s};for(var o=0;o<Ei.length&&s!==0&&s<Ei[o].priority;o++);Ei.splice(o,0,i),o===0&&Mg(i)}};var Ig=t.version;if(Ig!=="19.1.0")throw Error(r(527,Ig,"19.1.0"));me.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=p(s),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var AS={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tu.isDisabled&&Tu.supportsFiber)try{$t=Tu.inject(AS),Yt=Tu}catch{}}return Co.createRoot=function(i,s){if(!a(i))throw Error(r(299));var o=!1,h="",v=Xp,T=Jp,A=Kp,I=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(v=s.onUncaughtError),s.onCaughtError!==void 0&&(T=s.onCaughtError),s.onRecoverableError!==void 0&&(A=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(I=s.unstable_transitionCallbacks)),s=Sg(i,1,!1,null,null,o,h,v,T,A,I,null),i[_t]=s.current,rd(i),new _d(s)},Co.hydrateRoot=function(i,s,o){if(!a(i))throw Error(r(299));var h=!1,v="",T=Xp,A=Jp,I=Kp,Q=null,he=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onUncaughtError!==void 0&&(T=o.onUncaughtError),o.onCaughtError!==void 0&&(A=o.onCaughtError),o.onRecoverableError!==void 0&&(I=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(Q=o.unstable_transitionCallbacks),o.formState!==void 0&&(he=o.formState)),s=Sg(i,1,!0,s,o??null,h,v,T,A,I,Q,he),s.context=wg(null),o=s.current,h=Sr(),h=Rn(h),v=ii(h),v.callback=null,si(o,v,h),o=h,s.current.lanes=o,Pe(s,o),fa(s),i[_t]=s.current,rd(i),new yu(s)},Co.version="19.1.0",Co}var zg;function OS(){if(zg)return wd.exports;zg=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),wd.exports=LS(),wd.exports}var PS=OS();const US=Hy(PS);var ir=(e=>(e.NOT_STARTED="Not Started",e.IN_PROGRESS="In Progress",e.COMPLETED="Completed",e))(ir||{}),jd=(e=>(e.PENDING="pending",e.ACHIEVED="achieved",e.MISSED="missed",e))(jd||{}),bt=(e=>(e.NOT_STARTED="Not Started",e.IN_PROGRESS="In Progress",e.COMPLETED="Completed",e.BLOCKED="Blocked",e))(bt||{}),Br=(e=>(e[e.INPUT_FORM=0]="INPUT_FORM",e[e.PROJECT_FLOW=1]="PROJECT_FLOW",e[e.TASK_DETAIL=2]="TASK_DETAIL",e))(Br||{}),Rt;(function(e){e.assertEqual=a=>{};function t(a){}e.assertIs=t;function n(a){throw new Error}e.assertNever=n,e.arrayToEnum=a=>{const l={};for(const c of a)l[c]=c;return l},e.getValidEnumValues=a=>{const l=e.objectKeys(a).filter(u=>typeof a[a[u]]!="number"),c={};for(const u of l)c[u]=a[u];return e.objectValues(c)},e.objectValues=a=>e.objectKeys(a).map(function(l){return a[l]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const l=[];for(const c in a)Object.prototype.hasOwnProperty.call(a,c)&&l.push(c);return l},e.find=(a,l)=>{for(const c of a)if(l(c))return c},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,l=" | "){return a.map(c=>typeof c=="string"?`'${c}'`:c).join(l)}e.joinValues=r,e.jsonStringifyReplacer=(a,l)=>typeof l=="bigint"?l.toString():l})(Rt||(Rt={}));var jg;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(jg||(jg={}));const qe=Rt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ci=e=>{switch(typeof e){case"undefined":return qe.undefined;case"string":return qe.string;case"number":return Number.isNaN(e)?qe.nan:qe.number;case"boolean":return qe.boolean;case"function":return qe.function;case"bigint":return qe.bigint;case"symbol":return qe.symbol;case"object":return Array.isArray(e)?qe.array:e===null?qe.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?qe.promise:typeof Map<"u"&&e instanceof Map?qe.map:typeof Set<"u"&&e instanceof Set?qe.set:typeof Date<"u"&&e instanceof Date?qe.date:qe.object;default:return qe.unknown}},Le=Rt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class $a extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(l){return l.message},r={_errors:[]},a=l=>{for(const c of l.issues)if(c.code==="invalid_union")c.unionErrors.map(a);else if(c.code==="invalid_return_type")a(c.returnTypeError);else if(c.code==="invalid_arguments")a(c.argumentsError);else if(c.path.length===0)r._errors.push(n(c));else{let u=r,p=0;for(;p<c.path.length;){const m=c.path[p];p===c.path.length-1?(u[m]=u[m]||{_errors:[]},u[m]._errors.push(n(c))):u[m]=u[m]||{_errors:[]},u=u[m],p++}}};return a(this),r}static assert(t){if(!(t instanceof $a))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Rt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const a of this.issues)if(a.path.length>0){const l=a.path[0];n[l]=n[l]||[],n[l].push(t(a))}else r.push(t(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}$a.create=e=>new $a(e);const qd=(e,t)=>{let n;switch(e.code){case Le.invalid_type:e.received===qe.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Le.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Rt.jsonStringifyReplacer)}`;break;case Le.unrecognized_keys:n=`Unrecognized key(s) in object: ${Rt.joinValues(e.keys,", ")}`;break;case Le.invalid_union:n="Invalid input";break;case Le.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Rt.joinValues(e.options)}`;break;case Le.invalid_enum_value:n=`Invalid enum value. Expected ${Rt.joinValues(e.options)}, received '${e.received}'`;break;case Le.invalid_arguments:n="Invalid function arguments";break;case Le.invalid_return_type:n="Invalid function return type";break;case Le.invalid_date:n="Invalid date";break;case Le.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Rt.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Le.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Le.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Le.custom:n="Invalid input";break;case Le.invalid_intersection_types:n="Intersection results could not be merged";break;case Le.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Le.not_finite:n="Number must be finite";break;default:n=t.defaultError,Rt.assertNever(e)}return{message:n}};let BS=qd;function VS(){return BS}const HS=e=>{const{data:t,path:n,errorMaps:r,issueData:a}=e,l=[...n,...a.path||[]],c={...a,path:l};if(a.message!==void 0)return{...a,path:l,message:a.message};let u="";const p=r.filter(m=>!!m).slice().reverse();for(const m of p)u=m(c,{data:t,defaultError:u}).message;return{...a,path:l,message:u}};function Be(e,t){const n=VS(),r=HS({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===qd?void 0:qd].filter(a=>!!a)});e.common.issues.push(r)}class ur{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const a of n){if(a.status==="aborted")return rt;a.status==="dirty"&&t.dirty(),r.push(a.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const a of n){const l=await a.key,c=await a.value;r.push({key:l,value:c})}return ur.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const a of n){const{key:l,value:c}=a;if(l.status==="aborted"||c.status==="aborted")return rt;l.status==="dirty"&&t.dirty(),c.status==="dirty"&&t.dirty(),l.value!=="__proto__"&&(typeof c.value<"u"||a.alwaysSet)&&(r[l.value]=c.value)}return{status:t.value,value:r}}}const rt=Object.freeze({status:"aborted"}),bo=e=>({status:"dirty",value:e}),jr=e=>({status:"valid",value:e}),qg=e=>e.status==="aborted",$g=e=>e.status==="dirty",pl=e=>e.status==="valid",Ou=e=>typeof Promise<"u"&&e instanceof Promise;var Ye;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Ye||(Ye={}));class va{constructor(t,n,r,a){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Yg=(e,t)=>{if(pl(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new $a(e.common.issues);return this._error=n,this._error}}};function ut(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(c,u)=>{const{message:p}=e;return c.code==="invalid_enum_value"?{message:p??u.defaultError}:typeof u.data>"u"?{message:p??r??u.defaultError}:c.code!=="invalid_type"?{message:u.defaultError}:{message:p??n??u.defaultError}},description:a}}class wt{get description(){return this._def.description}_getType(t){return Ci(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Ci(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ur,ctx:{common:t.parent.common,data:t.data,parsedType:Ci(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Ou(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ci(t)},a=this._parseSync({data:t,path:r.path,parent:r});return Yg(r,a)}"~validate"(t){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ci(t)};if(!this["~standard"].async)try{const l=this._parseSync({data:t,path:[],parent:n});return pl(l)?{value:l.value}:{issues:n.common.issues}}catch(l){(a=(r=l==null?void 0:l.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(l=>pl(l)?{value:l.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ci(t)},a=this._parse({data:t,path:r.path,parent:r}),l=await(Ou(a)?a:Promise.resolve(a));return Yg(r,l)}refine(t,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,l)=>{const c=t(a),u=()=>l.addIssue({code:Le.custom,...r(a)});return typeof Promise<"u"&&c instanceof Promise?c.then(p=>p?!0:(u(),!1)):c?!0:(u(),!1)})}refinement(t,n){return this._refinement((r,a)=>t(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(t){return new vl({schema:this,typeName:nt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Ni.create(this,this._def)}nullable(){return yl.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ga.create(this)}promise(){return Hu.create(this,this._def)}or(t){return Uu.create([this,t],this._def)}and(t){return Bu.create(this,t,this._def)}transform(t){return new vl({...ut(this._def),schema:this,typeName:nt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Xd({...ut(this._def),innerType:this,defaultValue:n,typeName:nt.ZodDefault})}brand(){return new uw({typeName:nt.ZodBranded,type:this,...ut(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Jd({...ut(this._def),innerType:this,catchValue:n,typeName:nt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Eh.create(this,t)}readonly(){return Kd.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const GS=/^c[^\s-]{8,}$/i,zS=/^[0-9a-z]+$/,jS=/^[0-9A-HJKMNP-TV-Z]{26}$/i,qS=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$S=/^[a-z0-9_-]{21}$/i,YS=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,WS=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,XS=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,JS="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let kd;const KS=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ZS=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,QS=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ew=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,tw=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nw=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Gy="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",rw=new RegExp(`^${Gy}$`);function zy(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function aw(e){return new RegExp(`^${zy(e)}$`)}function iw(e){let t=`${Gy}T${zy(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function sw(e,t){return!!((t==="v4"||!t)&&KS.test(e)||(t==="v6"||!t)&&QS.test(e))}function lw(e,t){if(!YS.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function ow(e,t){return!!((t==="v4"||!t)&&ZS.test(e)||(t==="v6"||!t)&&ew.test(e))}class pa extends wt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==qe.string){const l=this._getOrReturnCtx(t);return Be(l,{code:Le.invalid_type,expected:qe.string,received:l.parsedType}),rt}const r=new ur;let a;for(const l of this._def.checks)if(l.kind==="min")t.data.length<l.value&&(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),r.dirty());else if(l.kind==="max")t.data.length>l.value&&(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),r.dirty());else if(l.kind==="length"){const c=t.data.length>l.value,u=t.data.length<l.value;(c||u)&&(a=this._getOrReturnCtx(t,a),c?Be(a,{code:Le.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):u&&Be(a,{code:Le.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),r.dirty())}else if(l.kind==="email")XS.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"email",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="emoji")kd||(kd=new RegExp(JS,"u")),kd.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"emoji",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="uuid")qS.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"uuid",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="nanoid")$S.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"nanoid",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="cuid")GS.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"cuid",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="cuid2")zS.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"cuid2",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="ulid")jS.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"ulid",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Be(a,{validation:"url",code:Le.invalid_string,message:l.message}),r.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"regex",code:Le.invalid_string,message:l.message}),r.dirty())):l.kind==="trim"?t.data=t.data.trim():l.kind==="includes"?t.data.includes(l.value,l.position)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),r.dirty()):l.kind==="toLowerCase"?t.data=t.data.toLowerCase():l.kind==="toUpperCase"?t.data=t.data.toUpperCase():l.kind==="startsWith"?t.data.startsWith(l.value)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.invalid_string,validation:{startsWith:l.value},message:l.message}),r.dirty()):l.kind==="endsWith"?t.data.endsWith(l.value)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.invalid_string,validation:{endsWith:l.value},message:l.message}),r.dirty()):l.kind==="datetime"?iw(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.invalid_string,validation:"datetime",message:l.message}),r.dirty()):l.kind==="date"?rw.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.invalid_string,validation:"date",message:l.message}),r.dirty()):l.kind==="time"?aw(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.invalid_string,validation:"time",message:l.message}),r.dirty()):l.kind==="duration"?WS.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"duration",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="ip"?sw(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"ip",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="jwt"?lw(t.data,l.alg)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"jwt",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="cidr"?ow(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"cidr",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="base64"?tw.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"base64",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="base64url"?nw.test(t.data)||(a=this._getOrReturnCtx(t,a),Be(a,{validation:"base64url",code:Le.invalid_string,message:l.message}),r.dirty()):Rt.assertNever(l);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(a=>t.test(a),{validation:n,code:Le.invalid_string,...Ye.errToObj(r)})}_addCheck(t){return new pa({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ye.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ye.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ye.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ye.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ye.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ye.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ye.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ye.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ye.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Ye.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Ye.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ye.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Ye.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Ye.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Ye.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Ye.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Ye.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Ye.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Ye.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Ye.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Ye.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Ye.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Ye.errToObj(n)})}nonempty(t){return this.min(1,Ye.errToObj(t))}trim(){return new pa({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new pa({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new pa({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}pa.create=e=>new pa({checks:[],typeName:nt.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...ut(e)});function cw(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r,l=Number.parseInt(e.toFixed(a).replace(".","")),c=Number.parseInt(t.toFixed(a).replace(".",""));return l%c/10**a}class ls extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==qe.number){const l=this._getOrReturnCtx(t);return Be(l,{code:Le.invalid_type,expected:qe.number,received:l.parsedType}),rt}let r;const a=new ur;for(const l of this._def.checks)l.kind==="int"?Rt.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{code:Le.invalid_type,expected:"integer",received:"float",message:l.message}),a.dirty()):l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(r=this._getOrReturnCtx(t,r),Be(r,{code:Le.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(r=this._getOrReturnCtx(t,r),Be(r,{code:Le.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="multipleOf"?cw(t.data,l.value)!==0&&(r=this._getOrReturnCtx(t,r),Be(r,{code:Le.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):l.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{code:Le.not_finite,message:l.message}),a.dirty()):Rt.assertNever(l);return{status:a.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Ye.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ye.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ye.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ye.toString(n))}setLimit(t,n,r,a){return new ls({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ye.toString(a)}]})}_addCheck(t){return new ls({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ye.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ye.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ye.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ye.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ye.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ye.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Ye.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ye.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ye.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Rt.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}ls.create=e=>new ls({checks:[],typeName:nt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...ut(e)});class os extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==qe.bigint)return this._getInvalidInput(t);let r;const a=new ur;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(r=this._getOrReturnCtx(t,r),Be(r,{code:Le.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(r=this._getOrReturnCtx(t,r),Be(r,{code:Le.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="multipleOf"?t.data%l.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),Be(r,{code:Le.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):Rt.assertNever(l);return{status:a.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return Be(n,{code:Le.invalid_type,expected:qe.bigint,received:n.parsedType}),rt}gte(t,n){return this.setLimit("min",t,!0,Ye.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ye.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ye.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ye.toString(n))}setLimit(t,n,r,a){return new os({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ye.toString(a)}]})}_addCheck(t){return new os({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ye.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ye.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ye.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ye.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ye.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}os.create=e=>new os({checks:[],typeName:nt.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...ut(e)});class Pu extends wt{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==qe.boolean){const r=this._getOrReturnCtx(t);return Be(r,{code:Le.invalid_type,expected:qe.boolean,received:r.parsedType}),rt}return jr(t.data)}}Pu.create=e=>new Pu({typeName:nt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...ut(e)});class xl extends wt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==qe.date){const l=this._getOrReturnCtx(t);return Be(l,{code:Le.invalid_type,expected:qe.date,received:l.parsedType}),rt}if(Number.isNaN(t.data.getTime())){const l=this._getOrReturnCtx(t);return Be(l,{code:Le.invalid_date}),rt}const r=new ur;let a;for(const l of this._def.checks)l.kind==="min"?t.data.getTime()<l.value&&(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),r.dirty()):l.kind==="max"?t.data.getTime()>l.value&&(a=this._getOrReturnCtx(t,a),Be(a,{code:Le.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),r.dirty()):Rt.assertNever(l);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new xl({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Ye.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Ye.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}xl.create=e=>new xl({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:nt.ZodDate,...ut(e)});class Wg extends wt{_parse(t){if(this._getType(t)!==qe.symbol){const r=this._getOrReturnCtx(t);return Be(r,{code:Le.invalid_type,expected:qe.symbol,received:r.parsedType}),rt}return jr(t.data)}}Wg.create=e=>new Wg({typeName:nt.ZodSymbol,...ut(e)});class Xg extends wt{_parse(t){if(this._getType(t)!==qe.undefined){const r=this._getOrReturnCtx(t);return Be(r,{code:Le.invalid_type,expected:qe.undefined,received:r.parsedType}),rt}return jr(t.data)}}Xg.create=e=>new Xg({typeName:nt.ZodUndefined,...ut(e)});class Jg extends wt{_parse(t){if(this._getType(t)!==qe.null){const r=this._getOrReturnCtx(t);return Be(r,{code:Le.invalid_type,expected:qe.null,received:r.parsedType}),rt}return jr(t.data)}}Jg.create=e=>new Jg({typeName:nt.ZodNull,...ut(e)});class Kg extends wt{constructor(){super(...arguments),this._any=!0}_parse(t){return jr(t.data)}}Kg.create=e=>new Kg({typeName:nt.ZodAny,...ut(e)});class $d extends wt{constructor(){super(...arguments),this._unknown=!0}_parse(t){return jr(t.data)}}$d.create=e=>new $d({typeName:nt.ZodUnknown,...ut(e)});class Li extends wt{_parse(t){const n=this._getOrReturnCtx(t);return Be(n,{code:Le.invalid_type,expected:qe.never,received:n.parsedType}),rt}}Li.create=e=>new Li({typeName:nt.ZodNever,...ut(e)});class Zg extends wt{_parse(t){if(this._getType(t)!==qe.undefined){const r=this._getOrReturnCtx(t);return Be(r,{code:Le.invalid_type,expected:qe.void,received:r.parsedType}),rt}return jr(t.data)}}Zg.create=e=>new Zg({typeName:nt.ZodVoid,...ut(e)});class ga extends wt{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),a=this._def;if(n.parsedType!==qe.array)return Be(n,{code:Le.invalid_type,expected:qe.array,received:n.parsedType}),rt;if(a.exactLength!==null){const c=n.data.length>a.exactLength.value,u=n.data.length<a.exactLength.value;(c||u)&&(Be(n,{code:c?Le.too_big:Le.too_small,minimum:u?a.exactLength.value:void 0,maximum:c?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Be(n,{code:Le.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Be(n,{code:Le.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((c,u)=>a.type._parseAsync(new va(n,c,n.path,u)))).then(c=>ur.mergeArray(r,c));const l=[...n.data].map((c,u)=>a.type._parseSync(new va(n,c,n.path,u)));return ur.mergeArray(r,l)}get element(){return this._def.type}min(t,n){return new ga({...this._def,minLength:{value:t,message:Ye.toString(n)}})}max(t,n){return new ga({...this._def,maxLength:{value:t,message:Ye.toString(n)}})}length(t,n){return new ga({...this._def,exactLength:{value:t,message:Ye.toString(n)}})}nonempty(t){return this.min(1,t)}}ga.create=(e,t)=>new ga({type:e,minLength:null,maxLength:null,exactLength:null,typeName:nt.ZodArray,...ut(t)});function sl(e){if(e instanceof _n){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Ni.create(sl(r))}return new _n({...e._def,shape:()=>t})}else return e instanceof ga?new ga({...e._def,type:sl(e.element)}):e instanceof Ni?Ni.create(sl(e.unwrap())):e instanceof yl?yl.create(sl(e.unwrap())):e instanceof cs?cs.create(e.items.map(t=>sl(t))):e}class _n extends wt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Rt.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==qe.object){const m=this._getOrReturnCtx(t);return Be(m,{code:Le.invalid_type,expected:qe.object,received:m.parsedType}),rt}const{status:r,ctx:a}=this._processInputParams(t),{shape:l,keys:c}=this._getCached(),u=[];if(!(this._def.catchall instanceof Li&&this._def.unknownKeys==="strip"))for(const m in a.data)c.includes(m)||u.push(m);const p=[];for(const m of c){const x=l[m],y=a.data[m];p.push({key:{status:"valid",value:m},value:x._parse(new va(a,y,a.path,m)),alwaysSet:m in a.data})}if(this._def.catchall instanceof Li){const m=this._def.unknownKeys;if(m==="passthrough")for(const x of u)p.push({key:{status:"valid",value:x},value:{status:"valid",value:a.data[x]}});else if(m==="strict")u.length>0&&(Be(a,{code:Le.unrecognized_keys,keys:u}),r.dirty());else if(m!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const m=this._def.catchall;for(const x of u){const y=a.data[x];p.push({key:{status:"valid",value:x},value:m._parse(new va(a,y,a.path,x)),alwaysSet:x in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const m=[];for(const x of p){const y=await x.key,_=await x.value;m.push({key:y,value:_,alwaysSet:x.alwaysSet})}return m}).then(m=>ur.mergeObjectSync(r,m)):ur.mergeObjectSync(r,p)}get shape(){return this._def.shape()}strict(t){return Ye.errToObj,new _n({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var l,c;const a=((c=(l=this._def).errorMap)==null?void 0:c.call(l,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Ye.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new _n({...this._def,unknownKeys:"strip"})}passthrough(){return new _n({...this._def,unknownKeys:"passthrough"})}extend(t){return new _n({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new _n({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:nt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new _n({...this._def,catchall:t})}pick(t){const n={};for(const r of Rt.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new _n({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Rt.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new _n({...this._def,shape:()=>n})}deepPartial(){return sl(this)}partial(t){const n={};for(const r of Rt.objectKeys(this.shape)){const a=this.shape[r];t&&!t[r]?n[r]=a:n[r]=a.optional()}return new _n({...this._def,shape:()=>n})}required(t){const n={};for(const r of Rt.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let l=this.shape[r];for(;l instanceof Ni;)l=l._def.innerType;n[r]=l}return new _n({...this._def,shape:()=>n})}keyof(){return jy(Rt.objectKeys(this.shape))}}_n.create=(e,t)=>new _n({shape:()=>e,unknownKeys:"strip",catchall:Li.create(),typeName:nt.ZodObject,...ut(t)});_n.strictCreate=(e,t)=>new _n({shape:()=>e,unknownKeys:"strict",catchall:Li.create(),typeName:nt.ZodObject,...ut(t)});_n.lazycreate=(e,t)=>new _n({shape:e,unknownKeys:"strip",catchall:Li.create(),typeName:nt.ZodObject,...ut(t)});class Uu extends wt{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function a(l){for(const u of l)if(u.result.status==="valid")return u.result;for(const u of l)if(u.result.status==="dirty")return n.common.issues.push(...u.ctx.common.issues),u.result;const c=l.map(u=>new $a(u.ctx.common.issues));return Be(n,{code:Le.invalid_union,unionErrors:c}),rt}if(n.common.async)return Promise.all(r.map(async l=>{const c={...n,common:{...n.common,issues:[]},parent:null};return{result:await l._parseAsync({data:n.data,path:n.path,parent:c}),ctx:c}})).then(a);{let l;const c=[];for(const p of r){const m={...n,common:{...n.common,issues:[]},parent:null},x=p._parseSync({data:n.data,path:n.path,parent:m});if(x.status==="valid")return x;x.status==="dirty"&&!l&&(l={result:x,ctx:m}),m.common.issues.length&&c.push(m.common.issues)}if(l)return n.common.issues.push(...l.ctx.common.issues),l.result;const u=c.map(p=>new $a(p));return Be(n,{code:Le.invalid_union,unionErrors:u}),rt}}get options(){return this._def.options}}Uu.create=(e,t)=>new Uu({options:e,typeName:nt.ZodUnion,...ut(t)});function Yd(e,t){const n=Ci(e),r=Ci(t);if(e===t)return{valid:!0,data:e};if(n===qe.object&&r===qe.object){const a=Rt.objectKeys(t),l=Rt.objectKeys(e).filter(u=>a.indexOf(u)!==-1),c={...e,...t};for(const u of l){const p=Yd(e[u],t[u]);if(!p.valid)return{valid:!1};c[u]=p.data}return{valid:!0,data:c}}else if(n===qe.array&&r===qe.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let l=0;l<e.length;l++){const c=e[l],u=t[l],p=Yd(c,u);if(!p.valid)return{valid:!1};a.push(p.data)}return{valid:!0,data:a}}else return n===qe.date&&r===qe.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Bu extends wt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=(l,c)=>{if(qg(l)||qg(c))return rt;const u=Yd(l.value,c.value);return u.valid?(($g(l)||$g(c))&&n.dirty(),{status:n.value,value:u.data}):(Be(r,{code:Le.invalid_intersection_types}),rt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([l,c])=>a(l,c)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Bu.create=(e,t,n)=>new Bu({left:e,right:t,typeName:nt.ZodIntersection,...ut(n)});class cs extends wt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==qe.array)return Be(r,{code:Le.invalid_type,expected:qe.array,received:r.parsedType}),rt;if(r.data.length<this._def.items.length)return Be(r,{code:Le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),rt;!this._def.rest&&r.data.length>this._def.items.length&&(Be(r,{code:Le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const l=[...r.data].map((c,u)=>{const p=this._def.items[u]||this._def.rest;return p?p._parse(new va(r,c,r.path,u)):null}).filter(c=>!!c);return r.common.async?Promise.all(l).then(c=>ur.mergeArray(n,c)):ur.mergeArray(n,l)}get items(){return this._def.items}rest(t){return new cs({...this._def,rest:t})}}cs.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new cs({items:e,typeName:nt.ZodTuple,rest:null,...ut(t)})};class Vu extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==qe.object)return Be(r,{code:Le.invalid_type,expected:qe.object,received:r.parsedType}),rt;const a=[],l=this._def.keyType,c=this._def.valueType;for(const u in r.data)a.push({key:l._parse(new va(r,u,r.path,u)),value:c._parse(new va(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?ur.mergeObjectAsync(n,a):ur.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof wt?new Vu({keyType:t,valueType:n,typeName:nt.ZodRecord,...ut(r)}):new Vu({keyType:pa.create(),valueType:t,typeName:nt.ZodRecord,...ut(n)})}}class Qg extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==qe.map)return Be(r,{code:Le.invalid_type,expected:qe.map,received:r.parsedType}),rt;const a=this._def.keyType,l=this._def.valueType,c=[...r.data.entries()].map(([u,p],m)=>({key:a._parse(new va(r,u,r.path,[m,"key"])),value:l._parse(new va(r,p,r.path,[m,"value"]))}));if(r.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const p of c){const m=await p.key,x=await p.value;if(m.status==="aborted"||x.status==="aborted")return rt;(m.status==="dirty"||x.status==="dirty")&&n.dirty(),u.set(m.value,x.value)}return{status:n.value,value:u}})}else{const u=new Map;for(const p of c){const m=p.key,x=p.value;if(m.status==="aborted"||x.status==="aborted")return rt;(m.status==="dirty"||x.status==="dirty")&&n.dirty(),u.set(m.value,x.value)}return{status:n.value,value:u}}}}Qg.create=(e,t,n)=>new Qg({valueType:t,keyType:e,typeName:nt.ZodMap,...ut(n)});class qo extends wt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==qe.set)return Be(r,{code:Le.invalid_type,expected:qe.set,received:r.parsedType}),rt;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Be(r,{code:Le.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Be(r,{code:Le.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const l=this._def.valueType;function c(p){const m=new Set;for(const x of p){if(x.status==="aborted")return rt;x.status==="dirty"&&n.dirty(),m.add(x.value)}return{status:n.value,value:m}}const u=[...r.data.values()].map((p,m)=>l._parse(new va(r,p,r.path,m)));return r.common.async?Promise.all(u).then(p=>c(p)):c(u)}min(t,n){return new qo({...this._def,minSize:{value:t,message:Ye.toString(n)}})}max(t,n){return new qo({...this._def,maxSize:{value:t,message:Ye.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}qo.create=(e,t)=>new qo({valueType:e,minSize:null,maxSize:null,typeName:nt.ZodSet,...ut(t)});class Wd extends wt{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Wd.create=(e,t)=>new Wd({getter:e,typeName:nt.ZodLazy,...ut(t)});class e1 extends wt{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Be(n,{received:n.data,code:Le.invalid_literal,expected:this._def.value}),rt}return{status:"valid",value:t.data}}get value(){return this._def.value}}e1.create=(e,t)=>new e1({value:e,typeName:nt.ZodLiteral,...ut(t)});function jy(e,t){return new gl({values:e,typeName:nt.ZodEnum,...ut(t)})}class gl extends wt{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return Be(n,{expected:Rt.joinValues(r),received:n.parsedType,code:Le.invalid_type}),rt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return Be(n,{received:n.data,code:Le.invalid_enum_value,options:r}),rt}return jr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return gl.create(t,{...this._def,...n})}exclude(t,n=this._def){return gl.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}gl.create=jy;class t1 extends wt{_parse(t){const n=Rt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==qe.string&&r.parsedType!==qe.number){const a=Rt.objectValues(n);return Be(r,{expected:Rt.joinValues(a),received:r.parsedType,code:Le.invalid_type}),rt}if(this._cache||(this._cache=new Set(Rt.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=Rt.objectValues(n);return Be(r,{received:r.data,code:Le.invalid_enum_value,options:a}),rt}return jr(t.data)}get enum(){return this._def.values}}t1.create=(e,t)=>new t1({values:e,typeName:nt.ZodNativeEnum,...ut(t)});class Hu extends wt{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==qe.promise&&n.common.async===!1)return Be(n,{code:Le.invalid_type,expected:qe.promise,received:n.parsedType}),rt;const r=n.parsedType===qe.promise?n.data:Promise.resolve(n.data);return jr(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Hu.create=(e,t)=>new Hu({type:e,typeName:nt.ZodPromise,...ut(t)});class vl extends wt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===nt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=this._def.effect||null,l={addIssue:c=>{Be(r,c),c.fatal?n.abort():n.dirty()},get path(){return r.path}};if(l.addIssue=l.addIssue.bind(l),a.type==="preprocess"){const c=a.transform(r.data,l);if(r.common.async)return Promise.resolve(c).then(async u=>{if(n.value==="aborted")return rt;const p=await this._def.schema._parseAsync({data:u,path:r.path,parent:r});return p.status==="aborted"?rt:p.status==="dirty"||n.value==="dirty"?bo(p.value):p});{if(n.value==="aborted")return rt;const u=this._def.schema._parseSync({data:c,path:r.path,parent:r});return u.status==="aborted"?rt:u.status==="dirty"||n.value==="dirty"?bo(u.value):u}}if(a.type==="refinement"){const c=u=>{const p=a.refinement(u,l);if(r.common.async)return Promise.resolve(p);if(p instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(r.common.async===!1){const u=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return u.status==="aborted"?rt:(u.status==="dirty"&&n.dirty(),c(u.value),{status:n.value,value:u.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(u=>u.status==="aborted"?rt:(u.status==="dirty"&&n.dirty(),c(u.value).then(()=>({status:n.value,value:u.value}))))}if(a.type==="transform")if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!pl(c))return rt;const u=a.transform(c.value,l);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:u}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>pl(c)?Promise.resolve(a.transform(c.value,l)).then(u=>({status:n.value,value:u})):rt);Rt.assertNever(a)}}vl.create=(e,t,n)=>new vl({schema:e,typeName:nt.ZodEffects,effect:t,...ut(n)});vl.createWithPreprocess=(e,t,n)=>new vl({schema:t,effect:{type:"preprocess",transform:e},typeName:nt.ZodEffects,...ut(n)});class Ni extends wt{_parse(t){return this._getType(t)===qe.undefined?jr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ni.create=(e,t)=>new Ni({innerType:e,typeName:nt.ZodOptional,...ut(t)});class yl extends wt{_parse(t){return this._getType(t)===qe.null?jr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}yl.create=(e,t)=>new yl({innerType:e,typeName:nt.ZodNullable,...ut(t)});class Xd extends wt{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===qe.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Xd.create=(e,t)=>new Xd({innerType:e,typeName:nt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ut(t)});class Jd extends wt{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Ou(a)?a.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new $a(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new $a(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Jd.create=(e,t)=>new Jd({innerType:e,typeName:nt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ut(t)});class n1 extends wt{_parse(t){if(this._getType(t)!==qe.nan){const r=this._getOrReturnCtx(t);return Be(r,{code:Le.invalid_type,expected:qe.nan,received:r.parsedType}),rt}return{status:"valid",value:t.data}}}n1.create=e=>new n1({typeName:nt.ZodNaN,...ut(e)});class uw extends wt{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Eh extends wt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?rt:l.status==="dirty"?(n.dirty(),bo(l.value)):this._def.out._parseAsync({data:l.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?rt:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(t,n){return new Eh({in:t,out:n,typeName:nt.ZodPipeline})}}class Kd extends wt{_parse(t){const n=this._def.innerType._parse(t),r=a=>(pl(a)&&(a.value=Object.freeze(a.value)),a);return Ou(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}Kd.create=(e,t)=>new Kd({innerType:e,typeName:nt.ZodReadonly,...ut(t)});var nt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(nt||(nt={}));const ns=pa.create,r1=ls.create;os.create;const fw=Pu.create;xl.create;const a1=$d.create;Li.create;const ko=ga.create,dw=_n.create,hw=Uu.create;Bu.create;cs.create;const mw=Vu.create,pw=Wd.create,xw=gl.create;Hu.create;Ni.create;yl.create;const nl={string:e=>pa.create({...e,coerce:!0}),number:e=>ls.create({...e,coerce:!0}),boolean:e=>Pu.create({...e,coerce:!0}),bigint:e=>os.create({...e,coerce:!0}),date:e=>xl.create({...e,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let gw,vw;function yw(){return{geminiUrl:gw,vertexUrl:vw}}function Tw(e,t,n){var r,a,l;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const c=yw();return e.vertexai?(a=c.vertexUrl)!==null&&a!==void 0?a:t:(l=c.geminiUrl)!==null&&l!==void 0?l:n}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ps{}function We(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(t,a)){const l=t[a];return l!=null?String(l):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function d(e,t,n){for(let l=0;l<t.length-1;l++){const c=t[l];if(c.endsWith("[]")){const u=c.slice(0,-2);if(!(u in e))if(Array.isArray(n))e[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(e[u])){const p=e[u];if(Array.isArray(n))for(let m=0;m<p.length;m++){const x=p[m];d(x,t.slice(l+1),n[m])}else for(const m of p)d(m,t.slice(l+1),n)}return}else if(c.endsWith("[0]")){const u=c.slice(0,-3);u in e||(e[u]=[{}]);const p=e[u];d(p[0],t.slice(l+1),n);return}(!e[c]||typeof e[c]!="object")&&(e[c]={}),e=e[c]}const r=t[t.length-1],a=e[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=n}function f(e,t){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return;const r=t[n];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const l=e[a];return Array.isArray(l)?l.map(c=>f(c,t.slice(n+1))):void 0}else return}else e=e[r]}return e}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var i1;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(i1||(i1={}));var s1;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(s1||(s1={}));var xa;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(xa||(xa={}));var l1;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(l1||(l1={}));var o1;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(o1||(o1={}));var c1;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(c1||(c1={}));var u1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(u1||(u1={}));var f1;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(f1||(f1={}));var d1;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(d1||(d1={}));var h1;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(h1||(h1={}));var m1;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(m1||(m1={}));var p1;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(p1||(p1={}));var x1;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(x1||(x1={}));var g1;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(g1||(g1={}));var v1;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"})(v1||(v1={}));var y1;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(y1||(y1={}));var Gu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Gu||(Gu={}));var T1;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(T1||(T1={}));var Zd;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Zd||(Zd={}));var _1;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(_1||(_1={}));var E1;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(E1||(E1={}));var S1;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(S1||(S1={}));var w1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(w1||(w1={}));var C1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(C1||(C1={}));var A1;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(A1||(A1={}));var b1;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(b1||(b1={}));var k1;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(k1||(k1={}));var N1;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(N1||(N1={}));var M1;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(M1||(M1={}));var R1;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(R1||(R1={}));var D1;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(D1||(D1={}));var I1;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(I1||(I1={}));var F1;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(F1||(F1={}));var L1;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(L1||(L1={}));var O1;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(O1||(O1={}));var P1;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(P1||(P1={}));var U1;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(U1||(U1={}));var B1;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(B1||(B1={}));var V1;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(V1||(V1={}));var H1;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(H1||(H1={}));var G1;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(G1||(G1={}));var ol;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(ol||(ol={}));class Qd{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class Ao{get text(){var t,n,r,a,l,c,u,p;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",x=!1;const y=[];for(const _ of(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)!==null&&p!==void 0?p:[]){for(const[E,S]of Object.entries(_))E!=="text"&&E!=="thought"&&(S!==null||S!==void 0)&&y.push(E);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;x=!0,m+=_.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),x?m:void 0}get data(){var t,n,r,a,l,c,u,p;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const x=[];for(const y of(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)!==null&&p!==void 0?p:[]){for(const[_,E]of Object.entries(y))_!=="inlineData"&&(E!==null||E!==void 0)&&x.push(_);y.inlineData&&typeof y.inlineData.data=="string"&&(m+=atob(y.inlineData.data))}return x.length>0&&console.warn(`there are non-data parts ${x} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var t,n,r,a,l,c,u,p;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)===null||p===void 0?void 0:p.filter(x=>x.functionCall).map(x=>x.functionCall).filter(x=>x!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var t,n,r,a,l,c,u,p,m;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const x=(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)===null||p===void 0?void 0:p.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((x==null?void 0:x.length)!==0)return(m=x==null?void 0:x[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var t,n,r,a,l,c,u,p,m;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const x=(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)===null||p===void 0?void 0:p.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((x==null?void 0:x.length)!==0)return(m=x==null?void 0:x[0])===null||m===void 0?void 0:m.output}}class z1{}class j1{}class _w{}class Ew{}class q1{}class $1{}class Y1{}class Sw{}class W1{}class X1{}class J1{}class ww{}class Cw{}class Aw{}class K1{}class bw{get text(){var t,n,r;let a="",l=!1;const c=[];for(const u of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[p,m]of Object.entries(u))p!=="text"&&p!=="thought"&&m!==null&&c.push(p);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,a+=u.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?a:void 0}get data(){var t,n,r;let a="";const l=[];for(const c of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,p]of Object.entries(c))u!=="inlineData"&&p!==null&&l.push(u);c.inlineData&&typeof c.inlineData.data=="string"&&(a+=atob(c.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class kw{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vt(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function qy(e,t){const n=Vt(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function $y(e){return Array.isArray(e)?e.map(t=>zu(t)):[zu(e)]}function zu(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Yy(e){const t=zu(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Wy(e){const t=zu(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Z1(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function Xy(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Z1(t)):[Z1(e)]}function eh(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function Q1(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function ev(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Zn(e){if(e==null)throw new Error("ContentUnion is required");return eh(e)?e:{role:"user",parts:Xy(e)}}function Jy(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=Zn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=Zn(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Zn(n)):[Zn(t)]}function Gr(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(Q1(e)||ev(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Zn(e)]}const t=[],n=[],r=eh(e[0]);for(const a of e){const l=eh(a);if(l!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(a);else{if(Q1(a)||ev(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||t.push({role:"user",parts:Xy(n)}),t}const Nw=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),tv=xw(["string","number","integer","object","array","boolean","null"]),Mw=hw([tv,ko(tv)]);function Rw(e=!0){const t=pw(()=>{const n=dw({type:Mw.optional(),format:ns().optional(),title:ns().optional(),description:ns().optional(),default:a1().optional(),items:t.optional(),minItems:nl.string().optional(),maxItems:nl.string().optional(),enum:ko(a1()).optional(),properties:mw(ns(),t).optional(),required:ko(ns()).optional(),minProperties:nl.string().optional(),maxProperties:nl.string().optional(),propertyOrdering:ko(ns()).optional(),minimum:r1().optional(),maximum:r1().optional(),minLength:nl.string().optional(),maxLength:nl.string().optional(),pattern:ns().optional(),anyOf:ko(t).optional(),additionalProperties:fw().optional()});return e?n.strict():n});return t}function Dw(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(xa).includes(n[0].toUpperCase())?n[0].toUpperCase():xa.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(xa).includes(r.toUpperCase())?r.toUpperCase():xa.TYPE_UNSPECIFIED})}}function ul(e){const t={},n=["items"],r=["anyOf"],a=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=e.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(t.nullable=!0,e=l[1]):l[1].type==="null"&&(t.nullable=!0,e=l[0])),e.type instanceof Array&&Dw(e.type,t);for(const[c,u]of Object.entries(e))if(u!=null)if(c=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;t.type=Object.values(xa).includes(u.toUpperCase())?u.toUpperCase():xa.TYPE_UNSPECIFIED}else if(n.includes(c))t[c]=ul(u);else if(r.includes(c)){const p=[];for(const m of u){if(m.type=="null"){t.nullable=!0;continue}p.push(ul(m))}t[c]=p}else if(a.includes(c)){const p={};for(const[m,x]of Object.entries(u))p[m]=ul(x);t[c]=p}else{if(c==="additionalProperties")continue;t[c]=u}return t}function $o(e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=Rw().parse(e);return ul(t)}else return ul(e)}function Sh(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function wh(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function El(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=$o(t.parameters)),t.response&&(t.response=$o(t.response));return e}function Sl(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function Iw(e,t,n,r=1){const a=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:a?`${n}/${t}`:t}function Xa(e,t){if(typeof t!="string")throw new Error("name must be a string");return Iw(e,t,"cachedContents")}function Ky(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Ja(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function Fw(e){return e!=null&&typeof e=="object"&&"name"in e}function Lw(e){return e!=null&&typeof e=="object"&&"video"in e}function Ow(e){return e!=null&&typeof e=="object"&&"uri"in e}function Zy(e){var t;let n;if(Fw(e)&&(n=e.name),!(Ow(e)&&(n=e.uri,n===void 0))&&!(Lw(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Qy(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function e2(e){for(const t of["models","tunedModels","publisherModels"])if(Pw(e,t))return e[t];return[]}function Pw(e,t){return e!==null&&typeof e=="object"&&t in e}function Uw(e,t={}){const n=e,r={name:n.name,description:n.description,parameters:ul(af(n.inputSchema))};return t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function Bw(e,t={}){const n=[],r=new Set;for(const a of e){const l=a.name;if(r.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);r.add(l);const c=Uw(a,t);c.functionDeclarations&&n.push(...c.functionDeclarations)}return{functionDeclarations:n}}function Vw(e){const t=[];for(const n of e)t.push(af(n));return t}function Hw(e){const t={};for(const[n,r]of Object.entries(e)){const a=r;t[n]=af(a)}return t}function af(e){const t=new Set(["items"]),n=new Set(["anyOf"]),r=new Set(["properties"]),a={};for(const[l,c]of Object.entries(e))if(t.has(l))a[l]=af(c);else if(n.has(l))a[l]=Vw(c);else if(r.has(l))a[l]=Hw(c);else if(l==="type"){const u=c.toUpperCase();a[l]=Object.values(xa).includes(u)?u:xa.TYPE_UNSPECIFIED}else Nw.has(l)&&(a[l]=c);return a}function t2(e,t){if(typeof t!="string"&&!Array.isArray(t)){if(e&&e.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}else{if(Array.isArray(t))return{inlinedRequests:t};if(typeof t=="string"){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}}throw new Error(`Unsupported source: ${t}`)}function Gw(e){const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function wl(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function n2(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zw(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function jw(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function qw(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function $w(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],zw(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],jw(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],qw(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function r2(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>$w(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Yw(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["enum"]);l!=null&&d(t,["enum"],l);const c=f(e,["example"]);c!=null&&d(t,["example"],c);const u=f(e,["format"]);u!=null&&d(t,["format"],u);const p=f(e,["items"]);p!=null&&d(t,["items"],p);const m=f(e,["maxItems"]);m!=null&&d(t,["maxItems"],m);const x=f(e,["maxLength"]);x!=null&&d(t,["maxLength"],x);const y=f(e,["maxProperties"]);y!=null&&d(t,["maxProperties"],y);const _=f(e,["maximum"]);_!=null&&d(t,["maximum"],_);const E=f(e,["minItems"]);E!=null&&d(t,["minItems"],E);const S=f(e,["minLength"]);S!=null&&d(t,["minLength"],S);const w=f(e,["minProperties"]);w!=null&&d(t,["minProperties"],w);const C=f(e,["minimum"]);C!=null&&d(t,["minimum"],C);const M=f(e,["nullable"]);M!=null&&d(t,["nullable"],M);const k=f(e,["pattern"]);k!=null&&d(t,["pattern"],k);const b=f(e,["properties"]);b!=null&&d(t,["properties"],b);const U=f(e,["propertyOrdering"]);U!=null&&d(t,["propertyOrdering"],U);const G=f(e,["required"]);G!=null&&d(t,["required"],G);const X=f(e,["title"]);X!=null&&d(t,["title"],X);const F=f(e,["type"]);return F!=null&&d(t,["type"],F),t}function Ww(e){const t={};if(f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(e,["category"]);n!=null&&d(t,["category"],n);const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function Xw(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function Jw(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function Kw(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Jw(n)),t}function Zw(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Qw(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Zw(n)),t}function eC(){return{}}function tC(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>Xw(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],Kw(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],Qw(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],eC());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function nC(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function rC(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function aC(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],rC(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function iC(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],nC(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],aC(r)),t}function sC(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function a2(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],sC(n)),t}function lC(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],a2(r)),t}function oC(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>lC(a))),d(t,["speakerVoiceConfigs"],r)}return t}function cC(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],a2(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],oC(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function uC(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function fC(e,t,n){const r={},a=f(t,["systemInstruction"]);n!==void 0&&a!=null&&d(n,["systemInstruction"],r2(Zn(a)));const l=f(t,["temperature"]);l!=null&&d(r,["temperature"],l);const c=f(t,["topP"]);c!=null&&d(r,["topP"],c);const u=f(t,["topK"]);u!=null&&d(r,["topK"],u);const p=f(t,["candidateCount"]);p!=null&&d(r,["candidateCount"],p);const m=f(t,["maxOutputTokens"]);m!=null&&d(r,["maxOutputTokens"],m);const x=f(t,["stopSequences"]);x!=null&&d(r,["stopSequences"],x);const y=f(t,["responseLogprobs"]);y!=null&&d(r,["responseLogprobs"],y);const _=f(t,["logprobs"]);_!=null&&d(r,["logprobs"],_);const E=f(t,["presencePenalty"]);E!=null&&d(r,["presencePenalty"],E);const S=f(t,["frequencyPenalty"]);S!=null&&d(r,["frequencyPenalty"],S);const w=f(t,["seed"]);w!=null&&d(r,["seed"],w);const C=f(t,["responseMimeType"]);C!=null&&d(r,["responseMimeType"],C);const M=f(t,["responseSchema"]);M!=null&&d(r,["responseSchema"],Yw($o(M)));const k=f(t,["responseJsonSchema"]);if(k!=null&&d(r,["responseJsonSchema"],k),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=f(t,["safetySettings"]);if(n!==void 0&&b!=null){let ne=b;Array.isArray(ne)&&(ne=ne.map(ee=>Ww(ee))),d(n,["safetySettings"],ne)}const U=f(t,["tools"]);if(n!==void 0&&U!=null){let ne=Sl(U);Array.isArray(ne)&&(ne=ne.map(ee=>tC(El(ee)))),d(n,["tools"],ne)}const G=f(t,["toolConfig"]);if(n!==void 0&&G!=null&&d(n,["toolConfig"],iC(G)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const X=f(t,["cachedContent"]);n!==void 0&&X!=null&&d(n,["cachedContent"],Xa(e,X));const F=f(t,["responseModalities"]);F!=null&&d(r,["responseModalities"],F);const W=f(t,["mediaResolution"]);W!=null&&d(r,["mediaResolution"],W);const O=f(t,["speechConfig"]);if(O!=null&&d(r,["speechConfig"],cC(Sh(O))),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const te=f(t,["thinkingConfig"]);return te!=null&&d(r,["thinkingConfig"],uC(te)),r}function dC(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["request","model"],Vt(e,r));const a=f(t,["contents"]);if(a!=null){let c=Gr(a);Array.isArray(c)&&(c=c.map(u=>r2(u))),d(n,["request","contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["request","generationConfig"],fC(e,l,n)),n}function hC(e,t){const n={};if(f(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=f(t,["fileName"]);r!=null&&d(n,["fileName"],r);const a=f(t,["inlinedRequests"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>dC(e,c))),d(n,["requests","requests"],l)}return n}function mC(e,t){const n={},r=f(e,["displayName"]);if(t!==void 0&&r!=null&&d(t,["batch","displayName"],r),f(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function pC(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["src"]);a!=null&&d(n,["batch","inputConfig"],hC(e,t2(e,a)));const l=f(t,["config"]);return l!=null&&d(n,["config"],mC(l,n)),n}function xC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],wl(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function gC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],wl(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function vC(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);if(t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),f(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function yC(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],vC(n,t)),t}function TC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],wl(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function _C(e){const t={},n=f(e,["format"]);n!=null&&d(t,["instancesFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsSource","uris"],r);const a=f(e,["bigqueryUri"]);if(a!=null&&d(t,["bigquerySource","inputUri"],a),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function EC(e){const t={},n=f(e,["format"]);n!=null&&d(t,["predictionsFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsDestination","outputUriPrefix"],r);const a=f(e,["bigqueryUri"]);if(a!=null&&d(t,["bigqueryDestination","outputUri"],a),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}function SC(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const a=f(e,["dest"]);return t!==void 0&&a!=null&&d(t,["outputConfig"],EC(Gw(a))),n}function wC(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],Vt(e,r));const a=f(t,["src"]);a!=null&&d(n,["inputConfig"],_C(t2(e,a)));const l=f(t,["config"]);return l!=null&&d(n,["config"],SC(l,n)),n}function CC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],wl(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function AC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],wl(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function bC(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const l=f(e,["filter"]);return t!==void 0&&l!=null&&d(t,["_query","filter"],l),n}function kC(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],bC(n,t)),t}function NC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],wl(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function i2(){return{}}function MC(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function RC(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function DC(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function IC(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],MC(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],RC(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],DC(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function FC(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>IC(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function LC(e){const t={},n=f(e,["citationSources"]);return n!=null&&d(t,["citations"],n),t}function OC(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function PC(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>OC(a))),d(t,["urlMetadata"],r)}return t}function UC(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],FC(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],LC(r));const a=f(e,["tokenCount"]);a!=null&&d(t,["tokenCount"],a);const l=f(e,["finishReason"]);l!=null&&d(t,["finishReason"],l);const c=f(e,["urlContextMetadata"]);c!=null&&d(t,["urlContextMetadata"],PC(c));const u=f(e,["avgLogprobs"]);u!=null&&d(t,["avgLogprobs"],u);const p=f(e,["groundingMetadata"]);p!=null&&d(t,["groundingMetadata"],p);const m=f(e,["index"]);m!=null&&d(t,["index"],m);const x=f(e,["logprobsResult"]);x!=null&&d(t,["logprobsResult"],x);const y=f(e,["safetyRatings"]);return y!=null&&d(t,["safetyRatings"],y),t}function BC(e){const t={},n=f(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>UC(u))),d(t,["candidates"],c)}const r=f(e,["modelVersion"]);r!=null&&d(t,["modelVersion"],r);const a=f(e,["promptFeedback"]);a!=null&&d(t,["promptFeedback"],a);const l=f(e,["usageMetadata"]);return l!=null&&d(t,["usageMetadata"],l),t}function VC(e){const t={},n=f(e,["response"]);return n!=null&&d(t,["response"],BC(n)),f(e,["error"])!=null&&d(t,["error"],i2()),t}function HC(e){const t={},n=f(e,["responsesFile"]);n!=null&&d(t,["fileName"],n);const r=f(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>VC(l))),d(t,["inlinedResponses"],a)}return t}function th(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata","displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["metadata","state"]);a!=null&&d(t,["state"],n2(a));const l=f(e,["metadata","createTime"]);l!=null&&d(t,["createTime"],l);const c=f(e,["metadata","endTime"]);c!=null&&d(t,["endTime"],c);const u=f(e,["metadata","updateTime"]);u!=null&&d(t,["updateTime"],u);const p=f(e,["metadata","model"]);p!=null&&d(t,["model"],p);const m=f(e,["metadata","output"]);return m!=null&&d(t,["dest"],HC(m)),t}function GC(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>th(l))),d(t,["batchJobs"],a)}return t}function zC(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["done"]);return r!=null&&d(t,["done"],r),f(e,["error"])!=null&&d(t,["error"],i2()),t}function s2(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["code"]);r!=null&&d(t,["code"],r);const a=f(e,["message"]);return a!=null&&d(t,["message"],a),t}function jC(e){const t={},n=f(e,["instancesFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsSource","uris"]);r!=null&&d(t,["gcsUri"],r);const a=f(e,["bigquerySource","inputUri"]);return a!=null&&d(t,["bigqueryUri"],a),t}function qC(e){const t={},n=f(e,["predictionsFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsDestination","outputUriPrefix"]);r!=null&&d(t,["gcsUri"],r);const a=f(e,["bigqueryDestination","outputUri"]);return a!=null&&d(t,["bigqueryUri"],a),t}function nh(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["state"]);a!=null&&d(t,["state"],n2(a));const l=f(e,["error"]);l!=null&&d(t,["error"],s2(l));const c=f(e,["createTime"]);c!=null&&d(t,["createTime"],c);const u=f(e,["startTime"]);u!=null&&d(t,["startTime"],u);const p=f(e,["endTime"]);p!=null&&d(t,["endTime"],p);const m=f(e,["updateTime"]);m!=null&&d(t,["updateTime"],m);const x=f(e,["model"]);x!=null&&d(t,["model"],x);const y=f(e,["inputConfig"]);y!=null&&d(t,["src"],jC(y));const _=f(e,["outputConfig"]);return _!=null&&d(t,["dest"],qC(_)),t}function $C(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>nh(l))),d(t,["batchJobs"],a)}return t}function YC(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["done"]);r!=null&&d(t,["done"],r);const a=f(e,["error"]);return a!=null&&d(t,["error"],s2(a)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var us;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(us||(us={}));class sc{constructor(t,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,a)}init(t,n,r){var a,l;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let c={config:{}};r?typeof r=="object"?c=Object.assign({},r):c=r:c={config:{}},c.config&&(c.config.pageToken=n.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(l=(a=c.config)===null||a===void 0?void 0:a.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WC extends ps{constructor(t){super(),this.apiClient=t,this.create=async n=>{if(this.apiClient.isVertexAI()){const a=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${a}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new sc(us.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=wC(this.apiClient,t);return u=We("batchPredictionJobs",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>nh(x))}else{const m=pC(this.apiClient,t);return u=We("{model}:batchGenerateContent",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>th(x))}}async get(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=CC(this.apiClient,t);return u=We("batchPredictionJobs/{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>nh(x))}else{const m=xC(this.apiClient,t);return u=We("batches/{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>th(x))}}async cancel(t){var n,r,a,l;let c="",u={};if(this.apiClient.isVertexAI()){const p=AC(this.apiClient,t);c=We("batchPredictionJobs/{name}:cancel",p._url),u=p._query,delete p.config,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const p=gC(this.apiClient,t);c=We("batches/{name}:cancel",p._url),u=p._query,delete p.config,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=kC(t);return u=We("batchPredictionJobs",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=$C(x),_=new K1;return Object.assign(_,y),_})}else{const m=yC(t);return u=We("batches",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=GC(x),_=new K1;return Object.assign(_,y),_})}}async delete(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=NC(this.apiClient,t);return u=We("batchPredictionJobs/{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>YC(x))}else{const m=TC(this.apiClient,t);return u=We("batches/{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>zC(x))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XC(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function JC(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function KC(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function ZC(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],XC(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],JC(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],KC(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function nv(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>ZC(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function QC(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function eA(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function tA(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],eA(n)),t}function nA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function rA(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],nA(n)),t}function aA(){return{}}function iA(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>QC(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],tA(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],rA(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],aA());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function sA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function lA(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function oA(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],lA(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function cA(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],sA(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],oA(r)),t}function uA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);t!==void 0&&a!=null&&d(t,["expireTime"],a);const l=f(e,["displayName"]);t!==void 0&&l!=null&&d(t,["displayName"],l);const c=f(e,["contents"]);if(t!==void 0&&c!=null){let x=Gr(c);Array.isArray(x)&&(x=x.map(y=>nv(y))),d(t,["contents"],x)}const u=f(e,["systemInstruction"]);t!==void 0&&u!=null&&d(t,["systemInstruction"],nv(Zn(u)));const p=f(e,["tools"]);if(t!==void 0&&p!=null){let x=p;Array.isArray(x)&&(x=x.map(y=>iA(y))),d(t,["tools"],x)}const m=f(e,["toolConfig"]);if(t!==void 0&&m!=null&&d(t,["toolConfig"],cA(m)),f(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function fA(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],qy(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],uA(a,n)),n}function dA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Xa(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function hA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Xa(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function mA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);return t!==void 0&&a!=null&&d(t,["expireTime"],a),n}function pA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Xa(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],mA(a,n)),n}function xA(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);return t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),n}function gA(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],xA(n,t)),t}function vA(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function yA(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function TA(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function _A(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],vA(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],yA(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],TA(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function rv(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>_A(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function EA(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const a=f(e,["parameters"]);a!=null&&d(t,["parameters"],a);const l=f(e,["parametersJsonSchema"]);l!=null&&d(t,["parametersJsonSchema"],l);const c=f(e,["response"]);c!=null&&d(t,["response"],c);const u=f(e,["responseJsonSchema"]);return u!=null&&d(t,["responseJsonSchema"],u),t}function SA(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function wA(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],SA(n)),t}function CA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function AA(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],CA(n)),t}function bA(){return{}}function kA(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function NA(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],kA(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const a=f(e,["googleServiceAccountConfig"]);a!=null&&d(t,["googleServiceAccountConfig"],a);const l=f(e,["httpBasicAuthConfig"]);l!=null&&d(t,["httpBasicAuthConfig"],l);const c=f(e,["oauthConfig"]);c!=null&&d(t,["oauthConfig"],c);const u=f(e,["oidcConfig"]);return u!=null&&d(t,["oidcConfig"],u),t}function MA(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],NA(n)),t}function RA(){return{}}function DA(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>EA(_))),d(t,["functionDeclarations"],y)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const a=f(e,["googleSearch"]);a!=null&&d(t,["googleSearch"],wA(a));const l=f(e,["googleSearchRetrieval"]);l!=null&&d(t,["googleSearchRetrieval"],AA(l)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],bA());const u=f(e,["googleMaps"]);u!=null&&d(t,["googleMaps"],MA(u)),f(e,["urlContext"])!=null&&d(t,["urlContext"],RA());const m=f(e,["codeExecution"]);m!=null&&d(t,["codeExecution"],m);const x=f(e,["computerUse"]);return x!=null&&d(t,["computerUse"],x),t}function IA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function FA(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function LA(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],FA(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function OA(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],IA(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],LA(r)),t}function PA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);t!==void 0&&a!=null&&d(t,["expireTime"],a);const l=f(e,["displayName"]);t!==void 0&&l!=null&&d(t,["displayName"],l);const c=f(e,["contents"]);if(t!==void 0&&c!=null){let y=Gr(c);Array.isArray(y)&&(y=y.map(_=>rv(_))),d(t,["contents"],y)}const u=f(e,["systemInstruction"]);t!==void 0&&u!=null&&d(t,["systemInstruction"],rv(Zn(u)));const p=f(e,["tools"]);if(t!==void 0&&p!=null){let y=p;Array.isArray(y)&&(y=y.map(_=>DA(_))),d(t,["tools"],y)}const m=f(e,["toolConfig"]);t!==void 0&&m!=null&&d(t,["toolConfig"],OA(m));const x=f(e,["kmsKeyName"]);return t!==void 0&&x!=null&&d(t,["encryption_spec","kmsKeyName"],x),n}function UA(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],qy(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],PA(a,n)),n}function BA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Xa(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function VA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Xa(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function HA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);return t!==void 0&&a!=null&&d(t,["expireTime"],a),n}function GA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Xa(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],HA(a,n)),n}function zA(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);return t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),n}function jA(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],zA(n,t)),t}function Iu(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["model"]);a!=null&&d(t,["model"],a);const l=f(e,["createTime"]);l!=null&&d(t,["createTime"],l);const c=f(e,["updateTime"]);c!=null&&d(t,["updateTime"],c);const u=f(e,["expireTime"]);u!=null&&d(t,["expireTime"],u);const p=f(e,["usageMetadata"]);return p!=null&&d(t,["usageMetadata"],p),t}function qA(){return{}}function $A(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>Iu(l))),d(t,["cachedContents"],a)}return t}function Fu(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["model"]);a!=null&&d(t,["model"],a);const l=f(e,["createTime"]);l!=null&&d(t,["createTime"],l);const c=f(e,["updateTime"]);c!=null&&d(t,["updateTime"],c);const u=f(e,["expireTime"]);u!=null&&d(t,["expireTime"],u);const p=f(e,["usageMetadata"]);return p!=null&&d(t,["usageMetadata"],p),t}function YA(){return{}}function WA(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>Fu(l))),d(t,["cachedContents"],a)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XA extends ps{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new sc(us.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=UA(this.apiClient,t);return u=We("cachedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>Fu(x))}else{const m=fA(this.apiClient,t);return u=We("cachedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>Iu(x))}}async get(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=BA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>Fu(x))}else{const m=dA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>Iu(x))}}async delete(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=VA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(()=>{const x=YA(),y=new X1;return Object.assign(y,x),y})}else{const m=hA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(()=>{const x=qA(),y=new X1;return Object.assign(y,x),y})}}async update(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=GA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>Fu(x))}else{const m=pA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>Iu(x))}}async listInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=jA(t);return u=We("cachedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=WA(x),_=new J1;return Object.assign(_,y),_})}else{const m=gA(t);return u=We("cachedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=$A(x),_=new J1;return Object.assign(_,y),_})}}}function av(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function en(e){return this instanceof en?(this.v=e,this):new en(e)}function fl(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(E){return function(S){return Promise.resolve(S).then(E,y)}}function u(E,S){r[E]&&(a[E]=function(w){return new Promise(function(C,M){l.push([E,w,C,M])>1||p(E,w)})},S&&(a[E]=S(a[E])))}function p(E,S){try{m(r[E](S))}catch(w){_(l[0][3],w)}}function m(E){E.value instanceof en?Promise.resolve(E.value.v).then(x,y):_(l[0][2],E)}function x(E){p("next",E)}function y(E){p("throw",E)}function _(E,S){E(S),l.shift(),l.length&&p(l[0][0],l[0][1])}}function Fo(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof av=="function"?av(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(l){n[l]=e[l]&&function(c){return new Promise(function(u,p){c=e[l](c),a(u,p,c.done,c.value)})}}function a(l,c,u,p){Promise.resolve(p).then(function(m){l({value:m,done:u})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JA(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:l2(n)}function l2(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0||!t.thought&&t.text!==void 0&&t.text==="")return!1;return!0}function KA(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function iv(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const a=[];let l=!0;for(;r<n&&e[r].role==="model";)a.push(e[r]),l&&!l2(e[r])&&(l=!1),r++;l?t.push(...a):t.pop()}return t}class ZA{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new QA(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class QA{constructor(t,n,r,a={},l=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=a,this.history=l,this.sendPromise=Promise.resolve(),KA(l)}async sendMessage(t){var n;await this.sendPromise;const r=Zn(t.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var l,c,u;const p=await a,m=(c=(l=p.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content,x=p.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let _=[];x!=null&&(_=(u=x.slice(y))!==null&&u!==void 0?u:[]);const E=m?[m]:[];this.recordHistory(r,E,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(t){var n;await this.sendPromise;const r=Zn(t.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const l=await a;return this.processStreamResponse(l,r)}getHistory(t=!1){const n=t?iv(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,a;return fl(this,arguments,function*(){var c,u,p,m;const x=[];try{for(var y=!0,_=Fo(t),E;E=yield en(_.next()),c=E.done,!c;y=!0){m=E.value,y=!1;const S=m;if(JA(S)){const w=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;w!==void 0&&x.push(w)}yield yield en(S)}}catch(S){u={error:S}}finally{try{!y&&!c&&(p=_.return)&&(yield en(p.call(_)))}finally{if(u)throw u.error}}this.recordHistory(n,x)})}recordHistory(t,n,r){let a=[];n.length>0&&n.every(l=>l.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...iv(r)):this.history.push(t),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sf extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,sf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eb(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);return t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),n}function tb(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],eb(n,t)),t}function nb(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["message"]);r!=null&&d(t,["message"],r);const a=f(e,["code"]);return a!=null&&d(t,["code"],a),t}function rb(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["mimeType"]);a!=null&&d(t,["mimeType"],a);const l=f(e,["sizeBytes"]);l!=null&&d(t,["sizeBytes"],l);const c=f(e,["createTime"]);c!=null&&d(t,["createTime"],c);const u=f(e,["expirationTime"]);u!=null&&d(t,["expirationTime"],u);const p=f(e,["updateTime"]);p!=null&&d(t,["updateTime"],p);const m=f(e,["sha256Hash"]);m!=null&&d(t,["sha256Hash"],m);const x=f(e,["uri"]);x!=null&&d(t,["uri"],x);const y=f(e,["downloadUri"]);y!=null&&d(t,["downloadUri"],y);const _=f(e,["state"]);_!=null&&d(t,["state"],_);const E=f(e,["source"]);E!=null&&d(t,["source"],E);const S=f(e,["videoMetadata"]);S!=null&&d(t,["videoMetadata"],S);const w=f(e,["error"]);return w!=null&&d(t,["error"],nb(w)),t}function ab(e){const t={},n=f(e,["file"]);n!=null&&d(t,["file"],rb(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function ib(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","file"],Zy(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function sb(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","file"],Zy(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function lb(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["message"]);r!=null&&d(t,["message"],r);const a=f(e,["code"]);return a!=null&&d(t,["code"],a),t}function rh(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["mimeType"]);a!=null&&d(t,["mimeType"],a);const l=f(e,["sizeBytes"]);l!=null&&d(t,["sizeBytes"],l);const c=f(e,["createTime"]);c!=null&&d(t,["createTime"],c);const u=f(e,["expirationTime"]);u!=null&&d(t,["expirationTime"],u);const p=f(e,["updateTime"]);p!=null&&d(t,["updateTime"],p);const m=f(e,["sha256Hash"]);m!=null&&d(t,["sha256Hash"],m);const x=f(e,["uri"]);x!=null&&d(t,["uri"],x);const y=f(e,["downloadUri"]);y!=null&&d(t,["downloadUri"],y);const _=f(e,["state"]);_!=null&&d(t,["state"],_);const E=f(e,["source"]);E!=null&&d(t,["source"],E);const S=f(e,["videoMetadata"]);S!=null&&d(t,["videoMetadata"],S);const w=f(e,["error"]);return w!=null&&d(t,["error"],lb(w)),t}function ob(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>rh(l))),d(t,["files"],a)}return t}function cb(){return{}}function ub(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fb extends ps{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new sc(us.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>rh(n))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=tb(t);return l=We("files",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const m=ob(p),x=new ww;return Object.assign(x,m),x})}}async createInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ab(t);return l=We("upload/v1beta/files",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(()=>{const p=cb(),m=new Cw;return Object.assign(m,p),m})}}async get(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ib(t);return l=We("files/{file}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>rh(p))}}async delete(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=sb(t);return l=We("files/{file}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(()=>{const p=ub(),m=new Aw;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function db(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function hb(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function o2(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],db(n)),t}function mb(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],hb(n)),t}function pb(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],o2(r)),t}function xb(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>pb(a))),d(t,["speakerVoiceConfigs"],r)}return t}function gb(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],o2(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],xb(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function vb(e){const t={},n=f(e,["voiceConfig"]);if(n!=null&&d(t,["voiceConfig"],mb(n)),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function yb(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function Tb(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function _b(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Eb(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function Sb(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function wb(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function Cb(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],yb(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],_b(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],Sb(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function Ab(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Tb(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],Eb(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],wb(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function bb(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Cb(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function kb(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Ab(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Nb(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function Mb(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const a=f(e,["parameters"]);a!=null&&d(t,["parameters"],a);const l=f(e,["parametersJsonSchema"]);l!=null&&d(t,["parametersJsonSchema"],l);const c=f(e,["response"]);c!=null&&d(t,["response"],c);const u=f(e,["responseJsonSchema"]);return u!=null&&d(t,["responseJsonSchema"],u),t}function Rb(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function Db(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function Ib(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Rb(n)),t}function Fb(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Db(n)),t}function Lb(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Ob(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Pb(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Lb(n)),t}function Ub(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Ob(n)),t}function Bb(){return{}}function Vb(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function Hb(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],Vb(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const a=f(e,["googleServiceAccountConfig"]);a!=null&&d(t,["googleServiceAccountConfig"],a);const l=f(e,["httpBasicAuthConfig"]);l!=null&&d(t,["httpBasicAuthConfig"],l);const c=f(e,["oauthConfig"]);c!=null&&d(t,["oauthConfig"],c);const u=f(e,["oidcConfig"]);return u!=null&&d(t,["oidcConfig"],u),t}function Gb(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],Hb(n)),t}function zb(){return{}}function jb(){return{}}function qb(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>Nb(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],Ib(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],Pb(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],zb());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function $b(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>Mb(_))),d(t,["functionDeclarations"],y)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const a=f(e,["googleSearch"]);a!=null&&d(t,["googleSearch"],Fb(a));const l=f(e,["googleSearchRetrieval"]);l!=null&&d(t,["googleSearchRetrieval"],Ub(l)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],Bb());const u=f(e,["googleMaps"]);u!=null&&d(t,["googleMaps"],Gb(u)),f(e,["urlContext"])!=null&&d(t,["urlContext"],jb());const m=f(e,["codeExecution"]);m!=null&&d(t,["codeExecution"],m);const x=f(e,["computerUse"]);return x!=null&&d(t,["computerUse"],x),t}function Yb(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Wb(e){const t={},n=f(e,["handle"]);n!=null&&d(t,["handle"],n);const r=f(e,["transparent"]);return r!=null&&d(t,["transparent"],r),t}function sv(){return{}}function lv(){return{}}function Xb(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const a=f(e,["endOfSpeechSensitivity"]);a!=null&&d(t,["endOfSpeechSensitivity"],a);const l=f(e,["prefixPaddingMs"]);l!=null&&d(t,["prefixPaddingMs"],l);const c=f(e,["silenceDurationMs"]);return c!=null&&d(t,["silenceDurationMs"],c),t}function Jb(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const a=f(e,["endOfSpeechSensitivity"]);a!=null&&d(t,["endOfSpeechSensitivity"],a);const l=f(e,["prefixPaddingMs"]);l!=null&&d(t,["prefixPaddingMs"],l);const c=f(e,["silenceDurationMs"]);return c!=null&&d(t,["silenceDurationMs"],c),t}function Kb(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],Xb(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const a=f(e,["turnCoverage"]);return a!=null&&d(t,["turnCoverage"],a),t}function Zb(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],Jb(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const a=f(e,["turnCoverage"]);return a!=null&&d(t,["turnCoverage"],a),t}function Qb(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function ek(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function tk(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],Qb(r)),t}function nk(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],ek(r)),t}function rk(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function ak(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function ik(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const a=f(e,["responseModalities"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","responseModalities"],a);const l=f(e,["temperature"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","temperature"],l);const c=f(e,["topP"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","topP"],c);const u=f(e,["topK"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","topK"],u);const p=f(e,["maxOutputTokens"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","maxOutputTokens"],p);const m=f(e,["mediaResolution"]);t!==void 0&&m!=null&&d(t,["setup","generationConfig","mediaResolution"],m);const x=f(e,["seed"]);t!==void 0&&x!=null&&d(t,["setup","generationConfig","seed"],x);const y=f(e,["speechConfig"]);t!==void 0&&y!=null&&d(t,["setup","generationConfig","speechConfig"],gb(wh(y)));const _=f(e,["enableAffectiveDialog"]);t!==void 0&&_!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],_);const E=f(e,["systemInstruction"]);t!==void 0&&E!=null&&d(t,["setup","systemInstruction"],bb(Zn(E)));const S=f(e,["tools"]);if(t!==void 0&&S!=null){let G=Sl(S);Array.isArray(G)&&(G=G.map(X=>qb(El(X)))),d(t,["setup","tools"],G)}const w=f(e,["sessionResumption"]);t!==void 0&&w!=null&&d(t,["setup","sessionResumption"],Yb(w));const C=f(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&d(t,["setup","inputAudioTranscription"],sv());const M=f(e,["outputAudioTranscription"]);t!==void 0&&M!=null&&d(t,["setup","outputAudioTranscription"],sv());const k=f(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&d(t,["setup","realtimeInputConfig"],Kb(k));const b=f(e,["contextWindowCompression"]);t!==void 0&&b!=null&&d(t,["setup","contextWindowCompression"],tk(b));const U=f(e,["proactivity"]);return t!==void 0&&U!=null&&d(t,["setup","proactivity"],rk(U)),n}function sk(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const a=f(e,["responseModalities"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","responseModalities"],a);const l=f(e,["temperature"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","temperature"],l);const c=f(e,["topP"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","topP"],c);const u=f(e,["topK"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","topK"],u);const p=f(e,["maxOutputTokens"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","maxOutputTokens"],p);const m=f(e,["mediaResolution"]);t!==void 0&&m!=null&&d(t,["setup","generationConfig","mediaResolution"],m);const x=f(e,["seed"]);t!==void 0&&x!=null&&d(t,["setup","generationConfig","seed"],x);const y=f(e,["speechConfig"]);t!==void 0&&y!=null&&d(t,["setup","generationConfig","speechConfig"],vb(wh(y)));const _=f(e,["enableAffectiveDialog"]);t!==void 0&&_!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],_);const E=f(e,["systemInstruction"]);t!==void 0&&E!=null&&d(t,["setup","systemInstruction"],kb(Zn(E)));const S=f(e,["tools"]);if(t!==void 0&&S!=null){let G=Sl(S);Array.isArray(G)&&(G=G.map(X=>$b(El(X)))),d(t,["setup","tools"],G)}const w=f(e,["sessionResumption"]);t!==void 0&&w!=null&&d(t,["setup","sessionResumption"],Wb(w));const C=f(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&d(t,["setup","inputAudioTranscription"],lv());const M=f(e,["outputAudioTranscription"]);t!==void 0&&M!=null&&d(t,["setup","outputAudioTranscription"],lv());const k=f(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&d(t,["setup","realtimeInputConfig"],Zb(k));const b=f(e,["contextWindowCompression"]);t!==void 0&&b!=null&&d(t,["setup","contextWindowCompression"],nk(b));const U=f(e,["proactivity"]);return t!==void 0&&U!=null&&d(t,["setup","proactivity"],ak(U)),n}function lk(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],Vt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],ik(a,n)),n}function ok(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],Vt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],sk(a,n)),n}function ck(){return{}}function uk(){return{}}function fk(){return{}}function dk(){return{}}function hk(e){const t={},n=f(e,["media"]);n!=null&&d(t,["mediaChunks"],$y(n));const r=f(e,["audio"]);r!=null&&d(t,["audio"],Wy(r));const a=f(e,["audioStreamEnd"]);a!=null&&d(t,["audioStreamEnd"],a);const l=f(e,["video"]);l!=null&&d(t,["video"],Yy(l));const c=f(e,["text"]);return c!=null&&d(t,["text"],c),f(e,["activityStart"])!=null&&d(t,["activityStart"],ck()),f(e,["activityEnd"])!=null&&d(t,["activityEnd"],fk()),t}function mk(e){const t={},n=f(e,["media"]);n!=null&&d(t,["mediaChunks"],$y(n));const r=f(e,["audio"]);r!=null&&d(t,["audio"],Wy(r));const a=f(e,["audioStreamEnd"]);a!=null&&d(t,["audioStreamEnd"],a);const l=f(e,["video"]);l!=null&&d(t,["video"],Yy(l));const c=f(e,["text"]);return c!=null&&d(t,["text"],c),f(e,["activityStart"])!=null&&d(t,["activityStart"],uk()),f(e,["activityEnd"])!=null&&d(t,["activityEnd"],dk()),t}function c2(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["weight"]);return r!=null&&d(t,["weight"],r),t}function pk(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>c2(a))),d(t,["weightedPrompts"],r)}return t}function u2(e){const t={},n=f(e,["temperature"]);n!=null&&d(t,["temperature"],n);const r=f(e,["topK"]);r!=null&&d(t,["topK"],r);const a=f(e,["seed"]);a!=null&&d(t,["seed"],a);const l=f(e,["guidance"]);l!=null&&d(t,["guidance"],l);const c=f(e,["bpm"]);c!=null&&d(t,["bpm"],c);const u=f(e,["density"]);u!=null&&d(t,["density"],u);const p=f(e,["brightness"]);p!=null&&d(t,["brightness"],p);const m=f(e,["scale"]);m!=null&&d(t,["scale"],m);const x=f(e,["muteBass"]);x!=null&&d(t,["muteBass"],x);const y=f(e,["muteDrums"]);y!=null&&d(t,["muteDrums"],y);const _=f(e,["onlyBassAndDrums"]);return _!=null&&d(t,["onlyBassAndDrums"],_),t}function xk(e){const t={},n=f(e,["musicGenerationConfig"]);return n!=null&&d(t,["musicGenerationConfig"],u2(n)),t}function f2(e){const t={},n=f(e,["model"]);return n!=null&&d(t,["model"],n),t}function d2(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>c2(a))),d(t,["weightedPrompts"],r)}return t}function ah(e){const t={},n=f(e,["setup"]);n!=null&&d(t,["setup"],f2(n));const r=f(e,["clientContent"]);r!=null&&d(t,["clientContent"],d2(r));const a=f(e,["musicGenerationConfig"]);a!=null&&d(t,["musicGenerationConfig"],u2(a));const l=f(e,["playbackControl"]);return l!=null&&d(t,["playbackControl"],l),t}function gk(){return{}}function vk(e){const t={},n=f(e,["sessionId"]);return n!=null&&d(t,["sessionId"],n),t}function yk(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function Tk(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function _k(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Ek(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function Sk(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function wk(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function Ck(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],yk(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],_k(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],Sk(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function Ak(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Tk(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],Ek(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],wk(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function bk(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Ck(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function kk(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Ak(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function ov(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["finished"]);return r!=null&&d(t,["finished"],r),t}function cv(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["finished"]);return r!=null&&d(t,["finished"],r),t}function Nk(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function Mk(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Nk(a))),d(t,["urlMetadata"],r)}return t}function Rk(e){const t={},n=f(e,["modelTurn"]);n!=null&&d(t,["modelTurn"],bk(n));const r=f(e,["turnComplete"]);r!=null&&d(t,["turnComplete"],r);const a=f(e,["interrupted"]);a!=null&&d(t,["interrupted"],a);const l=f(e,["groundingMetadata"]);l!=null&&d(t,["groundingMetadata"],l);const c=f(e,["generationComplete"]);c!=null&&d(t,["generationComplete"],c);const u=f(e,["inputTranscription"]);u!=null&&d(t,["inputTranscription"],ov(u));const p=f(e,["outputTranscription"]);p!=null&&d(t,["outputTranscription"],ov(p));const m=f(e,["urlContextMetadata"]);return m!=null&&d(t,["urlContextMetadata"],Mk(m)),t}function Dk(e){const t={},n=f(e,["modelTurn"]);n!=null&&d(t,["modelTurn"],kk(n));const r=f(e,["turnComplete"]);r!=null&&d(t,["turnComplete"],r);const a=f(e,["interrupted"]);a!=null&&d(t,["interrupted"],a);const l=f(e,["groundingMetadata"]);l!=null&&d(t,["groundingMetadata"],l);const c=f(e,["generationComplete"]);c!=null&&d(t,["generationComplete"],c);const u=f(e,["inputTranscription"]);u!=null&&d(t,["inputTranscription"],cv(u));const p=f(e,["outputTranscription"]);return p!=null&&d(t,["outputTranscription"],cv(p)),t}function Ik(e){const t={},n=f(e,["id"]);n!=null&&d(t,["id"],n);const r=f(e,["args"]);r!=null&&d(t,["args"],r);const a=f(e,["name"]);return a!=null&&d(t,["name"],a),t}function Fk(e){const t={},n=f(e,["args"]);n!=null&&d(t,["args"],n);const r=f(e,["name"]);return r!=null&&d(t,["name"],r),t}function Lk(e){const t={},n=f(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Ik(a))),d(t,["functionCalls"],r)}return t}function Ok(e){const t={},n=f(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Fk(a))),d(t,["functionCalls"],r)}return t}function Pk(e){const t={},n=f(e,["ids"]);return n!=null&&d(t,["ids"],n),t}function Uk(e){const t={},n=f(e,["ids"]);return n!=null&&d(t,["ids"],n),t}function _u(e){const t={},n=f(e,["modality"]);n!=null&&d(t,["modality"],n);const r=f(e,["tokenCount"]);return r!=null&&d(t,["tokenCount"],r),t}function Eu(e){const t={},n=f(e,["modality"]);n!=null&&d(t,["modality"],n);const r=f(e,["tokenCount"]);return r!=null&&d(t,["tokenCount"],r),t}function Bk(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&d(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&d(t,["cachedContentTokenCount"],r);const a=f(e,["responseTokenCount"]);a!=null&&d(t,["responseTokenCount"],a);const l=f(e,["toolUsePromptTokenCount"]);l!=null&&d(t,["toolUsePromptTokenCount"],l);const c=f(e,["thoughtsTokenCount"]);c!=null&&d(t,["thoughtsTokenCount"],c);const u=f(e,["totalTokenCount"]);u!=null&&d(t,["totalTokenCount"],u);const p=f(e,["promptTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(E=>_u(E))),d(t,["promptTokensDetails"],_)}const m=f(e,["cacheTokensDetails"]);if(m!=null){let _=m;Array.isArray(_)&&(_=_.map(E=>_u(E))),d(t,["cacheTokensDetails"],_)}const x=f(e,["responseTokensDetails"]);if(x!=null){let _=x;Array.isArray(_)&&(_=_.map(E=>_u(E))),d(t,["responseTokensDetails"],_)}const y=f(e,["toolUsePromptTokensDetails"]);if(y!=null){let _=y;Array.isArray(_)&&(_=_.map(E=>_u(E))),d(t,["toolUsePromptTokensDetails"],_)}return t}function Vk(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&d(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&d(t,["cachedContentTokenCount"],r);const a=f(e,["candidatesTokenCount"]);a!=null&&d(t,["responseTokenCount"],a);const l=f(e,["toolUsePromptTokenCount"]);l!=null&&d(t,["toolUsePromptTokenCount"],l);const c=f(e,["thoughtsTokenCount"]);c!=null&&d(t,["thoughtsTokenCount"],c);const u=f(e,["totalTokenCount"]);u!=null&&d(t,["totalTokenCount"],u);const p=f(e,["promptTokensDetails"]);if(p!=null){let E=p;Array.isArray(E)&&(E=E.map(S=>Eu(S))),d(t,["promptTokensDetails"],E)}const m=f(e,["cacheTokensDetails"]);if(m!=null){let E=m;Array.isArray(E)&&(E=E.map(S=>Eu(S))),d(t,["cacheTokensDetails"],E)}const x=f(e,["candidatesTokensDetails"]);if(x!=null){let E=x;Array.isArray(E)&&(E=E.map(S=>Eu(S))),d(t,["responseTokensDetails"],E)}const y=f(e,["toolUsePromptTokensDetails"]);if(y!=null){let E=y;Array.isArray(E)&&(E=E.map(S=>Eu(S))),d(t,["toolUsePromptTokensDetails"],E)}const _=f(e,["trafficType"]);return _!=null&&d(t,["trafficType"],_),t}function Hk(e){const t={},n=f(e,["timeLeft"]);return n!=null&&d(t,["timeLeft"],n),t}function Gk(e){const t={},n=f(e,["timeLeft"]);return n!=null&&d(t,["timeLeft"],n),t}function zk(e){const t={},n=f(e,["newHandle"]);n!=null&&d(t,["newHandle"],n);const r=f(e,["resumable"]);r!=null&&d(t,["resumable"],r);const a=f(e,["lastConsumedClientMessageIndex"]);return a!=null&&d(t,["lastConsumedClientMessageIndex"],a),t}function jk(e){const t={},n=f(e,["newHandle"]);n!=null&&d(t,["newHandle"],n);const r=f(e,["resumable"]);r!=null&&d(t,["resumable"],r);const a=f(e,["lastConsumedClientMessageIndex"]);return a!=null&&d(t,["lastConsumedClientMessageIndex"],a),t}function qk(e){const t={};f(e,["setupComplete"])!=null&&d(t,["setupComplete"],gk());const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],Rk(r));const a=f(e,["toolCall"]);a!=null&&d(t,["toolCall"],Lk(a));const l=f(e,["toolCallCancellation"]);l!=null&&d(t,["toolCallCancellation"],Pk(l));const c=f(e,["usageMetadata"]);c!=null&&d(t,["usageMetadata"],Bk(c));const u=f(e,["goAway"]);u!=null&&d(t,["goAway"],Hk(u));const p=f(e,["sessionResumptionUpdate"]);return p!=null&&d(t,["sessionResumptionUpdate"],zk(p)),t}function $k(e){const t={},n=f(e,["setupComplete"]);n!=null&&d(t,["setupComplete"],vk(n));const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],Dk(r));const a=f(e,["toolCall"]);a!=null&&d(t,["toolCall"],Ok(a));const l=f(e,["toolCallCancellation"]);l!=null&&d(t,["toolCallCancellation"],Uk(l));const c=f(e,["usageMetadata"]);c!=null&&d(t,["usageMetadata"],Vk(c));const u=f(e,["goAway"]);u!=null&&d(t,["goAway"],Gk(u));const p=f(e,["sessionResumptionUpdate"]);return p!=null&&d(t,["sessionResumptionUpdate"],jk(p)),t}function Yk(){return{}}function Wk(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["weight"]);return r!=null&&d(t,["weight"],r),t}function Xk(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Wk(a))),d(t,["weightedPrompts"],r)}return t}function Jk(e){const t={},n=f(e,["temperature"]);n!=null&&d(t,["temperature"],n);const r=f(e,["topK"]);r!=null&&d(t,["topK"],r);const a=f(e,["seed"]);a!=null&&d(t,["seed"],a);const l=f(e,["guidance"]);l!=null&&d(t,["guidance"],l);const c=f(e,["bpm"]);c!=null&&d(t,["bpm"],c);const u=f(e,["density"]);u!=null&&d(t,["density"],u);const p=f(e,["brightness"]);p!=null&&d(t,["brightness"],p);const m=f(e,["scale"]);m!=null&&d(t,["scale"],m);const x=f(e,["muteBass"]);x!=null&&d(t,["muteBass"],x);const y=f(e,["muteDrums"]);y!=null&&d(t,["muteDrums"],y);const _=f(e,["onlyBassAndDrums"]);return _!=null&&d(t,["onlyBassAndDrums"],_),t}function Kk(e){const t={},n=f(e,["clientContent"]);n!=null&&d(t,["clientContent"],Xk(n));const r=f(e,["musicGenerationConfig"]);return r!=null&&d(t,["musicGenerationConfig"],Jk(r)),t}function Zk(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);r!=null&&d(t,["mimeType"],r);const a=f(e,["sourceMetadata"]);return a!=null&&d(t,["sourceMetadata"],Kk(a)),t}function Qk(e){const t={},n=f(e,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Zk(a))),d(t,["audioChunks"],r)}return t}function e4(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["filteredReason"]);return r!=null&&d(t,["filteredReason"],r),t}function t4(e){const t={};f(e,["setupComplete"])!=null&&d(t,["setupComplete"],Yk());const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],Qk(r));const a=f(e,["filteredPrompt"]);return a!=null&&d(t,["filteredPrompt"],e4(a)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n4(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function r4(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function a4(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function i4(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],n4(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],r4(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],a4(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function lf(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>i4(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function s4(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["enum"]);l!=null&&d(t,["enum"],l);const c=f(e,["example"]);c!=null&&d(t,["example"],c);const u=f(e,["format"]);u!=null&&d(t,["format"],u);const p=f(e,["items"]);p!=null&&d(t,["items"],p);const m=f(e,["maxItems"]);m!=null&&d(t,["maxItems"],m);const x=f(e,["maxLength"]);x!=null&&d(t,["maxLength"],x);const y=f(e,["maxProperties"]);y!=null&&d(t,["maxProperties"],y);const _=f(e,["maximum"]);_!=null&&d(t,["maximum"],_);const E=f(e,["minItems"]);E!=null&&d(t,["minItems"],E);const S=f(e,["minLength"]);S!=null&&d(t,["minLength"],S);const w=f(e,["minProperties"]);w!=null&&d(t,["minProperties"],w);const C=f(e,["minimum"]);C!=null&&d(t,["minimum"],C);const M=f(e,["nullable"]);M!=null&&d(t,["nullable"],M);const k=f(e,["pattern"]);k!=null&&d(t,["pattern"],k);const b=f(e,["properties"]);b!=null&&d(t,["properties"],b);const U=f(e,["propertyOrdering"]);U!=null&&d(t,["propertyOrdering"],U);const G=f(e,["required"]);G!=null&&d(t,["required"],G);const X=f(e,["title"]);X!=null&&d(t,["title"],X);const F=f(e,["type"]);return F!=null&&d(t,["type"],F),t}function l4(e){const t={};if(f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(e,["category"]);n!=null&&d(t,["category"],n);const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function o4(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function c4(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function u4(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],c4(n)),t}function f4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function d4(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],f4(n)),t}function h4(){return{}}function m4(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>o4(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],u4(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],d4(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],h4());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function p4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function x4(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function g4(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],x4(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function v4(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],p4(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],g4(r)),t}function y4(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function h2(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],y4(n)),t}function T4(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],h2(r)),t}function _4(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>T4(a))),d(t,["speakerVoiceConfigs"],r)}return t}function E4(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],h2(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],_4(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function S4(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function w4(e,t,n){const r={},a=f(t,["systemInstruction"]);n!==void 0&&a!=null&&d(n,["systemInstruction"],lf(Zn(a)));const l=f(t,["temperature"]);l!=null&&d(r,["temperature"],l);const c=f(t,["topP"]);c!=null&&d(r,["topP"],c);const u=f(t,["topK"]);u!=null&&d(r,["topK"],u);const p=f(t,["candidateCount"]);p!=null&&d(r,["candidateCount"],p);const m=f(t,["maxOutputTokens"]);m!=null&&d(r,["maxOutputTokens"],m);const x=f(t,["stopSequences"]);x!=null&&d(r,["stopSequences"],x);const y=f(t,["responseLogprobs"]);y!=null&&d(r,["responseLogprobs"],y);const _=f(t,["logprobs"]);_!=null&&d(r,["logprobs"],_);const E=f(t,["presencePenalty"]);E!=null&&d(r,["presencePenalty"],E);const S=f(t,["frequencyPenalty"]);S!=null&&d(r,["frequencyPenalty"],S);const w=f(t,["seed"]);w!=null&&d(r,["seed"],w);const C=f(t,["responseMimeType"]);C!=null&&d(r,["responseMimeType"],C);const M=f(t,["responseSchema"]);M!=null&&d(r,["responseSchema"],s4($o(M)));const k=f(t,["responseJsonSchema"]);if(k!=null&&d(r,["responseJsonSchema"],k),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=f(t,["safetySettings"]);if(n!==void 0&&b!=null){let ne=b;Array.isArray(ne)&&(ne=ne.map(ee=>l4(ee))),d(n,["safetySettings"],ne)}const U=f(t,["tools"]);if(n!==void 0&&U!=null){let ne=Sl(U);Array.isArray(ne)&&(ne=ne.map(ee=>m4(El(ee)))),d(n,["tools"],ne)}const G=f(t,["toolConfig"]);if(n!==void 0&&G!=null&&d(n,["toolConfig"],v4(G)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const X=f(t,["cachedContent"]);n!==void 0&&X!=null&&d(n,["cachedContent"],Xa(e,X));const F=f(t,["responseModalities"]);F!=null&&d(r,["responseModalities"],F);const W=f(t,["mediaResolution"]);W!=null&&d(r,["mediaResolution"],W);const O=f(t,["speechConfig"]);if(O!=null&&d(r,["speechConfig"],E4(Sh(O))),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const te=f(t,["thinkingConfig"]);return te!=null&&d(r,["thinkingConfig"],S4(te)),r}function uv(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["contents"]);if(a!=null){let c=Gr(a);Array.isArray(c)&&(c=c.map(u=>lf(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["generationConfig"],w4(e,l,n)),n}function C4(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["requests[]","taskType"],r);const a=f(e,["title"]);t!==void 0&&a!=null&&d(t,["requests[]","title"],a);const l=f(e,["outputDimensionality"]);if(t!==void 0&&l!=null&&d(t,["requests[]","outputDimensionality"],l),f(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function A4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["contents"]);a!=null&&d(n,["requests[]","content"],Jy(e,a));const l=f(t,["config"]);l!=null&&d(n,["config"],C4(l,n));const c=f(t,["model"]);return c!==void 0&&d(n,["requests[]","model"],Vt(e,c)),n}function b4(e,t){const n={};if(f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=f(e,["numberOfImages"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const a=f(e,["aspectRatio"]);t!==void 0&&a!=null&&d(t,["parameters","aspectRatio"],a);const l=f(e,["guidanceScale"]);if(t!==void 0&&l!=null&&d(t,["parameters","guidanceScale"],l),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=f(e,["safetyFilterLevel"]);t!==void 0&&c!=null&&d(t,["parameters","safetySetting"],c);const u=f(e,["personGeneration"]);t!==void 0&&u!=null&&d(t,["parameters","personGeneration"],u);const p=f(e,["includeSafetyAttributes"]);t!==void 0&&p!=null&&d(t,["parameters","includeSafetyAttributes"],p);const m=f(e,["includeRaiReason"]);t!==void 0&&m!=null&&d(t,["parameters","includeRaiReason"],m);const x=f(e,["language"]);t!==void 0&&x!=null&&d(t,["parameters","language"],x);const y=f(e,["outputMimeType"]);t!==void 0&&y!=null&&d(t,["parameters","outputOptions","mimeType"],y);const _=f(e,["outputCompressionQuality"]);if(t!==void 0&&_!=null&&d(t,["parameters","outputOptions","compressionQuality"],_),f(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function k4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["config"]);return l!=null&&d(n,["config"],b4(l,n)),n}function N4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Vt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function M4(e,t,n){const r={},a=f(t,["pageSize"]);n!==void 0&&a!=null&&d(n,["_query","pageSize"],a);const l=f(t,["pageToken"]);n!==void 0&&l!=null&&d(n,["_query","pageToken"],l);const c=f(t,["filter"]);n!==void 0&&c!=null&&d(n,["_query","filter"],c);const u=f(t,["queryBase"]);return n!==void 0&&u!=null&&d(n,["_url","models_url"],Qy(e,u)),r}function R4(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],M4(e,r,n)),n}function D4(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);t!==void 0&&a!=null&&d(t,["description"],a);const l=f(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&d(t,["defaultCheckpointId"],l),n}function I4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Vt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],D4(a,n)),n}function F4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Vt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function L4(e){const t={};if(f(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function O4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["contents"]);if(a!=null){let c=Gr(a);Array.isArray(c)&&(c=c.map(u=>lf(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["config"],L4(l)),n}function P4(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=f(e,["imageBytes"]);n!=null&&d(t,["bytesBase64Encoded"],Ja(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function U4(e,t){const n={},r=f(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r),f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=f(e,["durationSeconds"]);if(t!==void 0&&a!=null&&d(t,["parameters","durationSeconds"],a),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=f(e,["aspectRatio"]);if(t!==void 0&&l!=null&&d(t,["parameters","aspectRatio"],l),f(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const c=f(e,["personGeneration"]);if(t!==void 0&&c!=null&&d(t,["parameters","personGeneration"],c),f(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=f(e,["negativePrompt"]);t!==void 0&&u!=null&&d(t,["parameters","negativePrompt"],u);const p=f(e,["enhancePrompt"]);if(t!==void 0&&p!=null&&d(t,["parameters","enhancePrompt"],p),f(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(f(e,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(f(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function B4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["image"]);if(l!=null&&d(n,["instances[0]","image"],P4(l)),f(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const c=f(t,["config"]);return c!=null&&d(n,["config"],U4(c,n)),n}function V4(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function H4(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function G4(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function z4(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],V4(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],H4(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],G4(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function Cl(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>z4(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function j4(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["enum"]);l!=null&&d(t,["enum"],l);const c=f(e,["example"]);c!=null&&d(t,["example"],c);const u=f(e,["format"]);u!=null&&d(t,["format"],u);const p=f(e,["items"]);p!=null&&d(t,["items"],p);const m=f(e,["maxItems"]);m!=null&&d(t,["maxItems"],m);const x=f(e,["maxLength"]);x!=null&&d(t,["maxLength"],x);const y=f(e,["maxProperties"]);y!=null&&d(t,["maxProperties"],y);const _=f(e,["maximum"]);_!=null&&d(t,["maximum"],_);const E=f(e,["minItems"]);E!=null&&d(t,["minItems"],E);const S=f(e,["minLength"]);S!=null&&d(t,["minLength"],S);const w=f(e,["minProperties"]);w!=null&&d(t,["minProperties"],w);const C=f(e,["minimum"]);C!=null&&d(t,["minimum"],C);const M=f(e,["nullable"]);M!=null&&d(t,["nullable"],M);const k=f(e,["pattern"]);k!=null&&d(t,["pattern"],k);const b=f(e,["properties"]);b!=null&&d(t,["properties"],b);const U=f(e,["propertyOrdering"]);U!=null&&d(t,["propertyOrdering"],U);const G=f(e,["required"]);G!=null&&d(t,["required"],G);const X=f(e,["title"]);X!=null&&d(t,["title"],X);const F=f(e,["type"]);return F!=null&&d(t,["type"],F),t}function q4(e){const t={},n=f(e,["featureSelectionPreference"]);return n!=null&&d(t,["featureSelectionPreference"],n),t}function $4(e){const t={},n=f(e,["method"]);n!=null&&d(t,["method"],n);const r=f(e,["category"]);r!=null&&d(t,["category"],r);const a=f(e,["threshold"]);return a!=null&&d(t,["threshold"],a),t}function Y4(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const a=f(e,["parameters"]);a!=null&&d(t,["parameters"],a);const l=f(e,["parametersJsonSchema"]);l!=null&&d(t,["parametersJsonSchema"],l);const c=f(e,["response"]);c!=null&&d(t,["response"],c);const u=f(e,["responseJsonSchema"]);return u!=null&&d(t,["responseJsonSchema"],u),t}function W4(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function X4(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],W4(n)),t}function J4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function K4(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],J4(n)),t}function Z4(){return{}}function Q4(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function eN(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],Q4(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const a=f(e,["googleServiceAccountConfig"]);a!=null&&d(t,["googleServiceAccountConfig"],a);const l=f(e,["httpBasicAuthConfig"]);l!=null&&d(t,["httpBasicAuthConfig"],l);const c=f(e,["oauthConfig"]);c!=null&&d(t,["oauthConfig"],c);const u=f(e,["oidcConfig"]);return u!=null&&d(t,["oidcConfig"],u),t}function tN(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],eN(n)),t}function nN(){return{}}function m2(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>Y4(_))),d(t,["functionDeclarations"],y)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const a=f(e,["googleSearch"]);a!=null&&d(t,["googleSearch"],X4(a));const l=f(e,["googleSearchRetrieval"]);l!=null&&d(t,["googleSearchRetrieval"],K4(l)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],Z4());const u=f(e,["googleMaps"]);u!=null&&d(t,["googleMaps"],tN(u)),f(e,["urlContext"])!=null&&d(t,["urlContext"],nN());const m=f(e,["codeExecution"]);m!=null&&d(t,["codeExecution"],m);const x=f(e,["computerUse"]);return x!=null&&d(t,["computerUse"],x),t}function rN(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function aN(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function iN(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],aN(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function sN(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],rN(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],iN(r)),t}function lN(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function oN(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],lN(n)),t}function cN(e){const t={},n=f(e,["voiceConfig"]);if(n!=null&&d(t,["voiceConfig"],oN(n)),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function uN(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function fN(e,t,n){const r={},a=f(t,["systemInstruction"]);n!==void 0&&a!=null&&d(n,["systemInstruction"],Cl(Zn(a)));const l=f(t,["temperature"]);l!=null&&d(r,["temperature"],l);const c=f(t,["topP"]);c!=null&&d(r,["topP"],c);const u=f(t,["topK"]);u!=null&&d(r,["topK"],u);const p=f(t,["candidateCount"]);p!=null&&d(r,["candidateCount"],p);const m=f(t,["maxOutputTokens"]);m!=null&&d(r,["maxOutputTokens"],m);const x=f(t,["stopSequences"]);x!=null&&d(r,["stopSequences"],x);const y=f(t,["responseLogprobs"]);y!=null&&d(r,["responseLogprobs"],y);const _=f(t,["logprobs"]);_!=null&&d(r,["logprobs"],_);const E=f(t,["presencePenalty"]);E!=null&&d(r,["presencePenalty"],E);const S=f(t,["frequencyPenalty"]);S!=null&&d(r,["frequencyPenalty"],S);const w=f(t,["seed"]);w!=null&&d(r,["seed"],w);const C=f(t,["responseMimeType"]);C!=null&&d(r,["responseMimeType"],C);const M=f(t,["responseSchema"]);M!=null&&d(r,["responseSchema"],j4($o(M)));const k=f(t,["responseJsonSchema"]);k!=null&&d(r,["responseJsonSchema"],k);const b=f(t,["routingConfig"]);b!=null&&d(r,["routingConfig"],b);const U=f(t,["modelSelectionConfig"]);U!=null&&d(r,["modelConfig"],q4(U));const G=f(t,["safetySettings"]);if(n!==void 0&&G!=null){let we=G;Array.isArray(we)&&(we=we.map(ae=>$4(ae))),d(n,["safetySettings"],we)}const X=f(t,["tools"]);if(n!==void 0&&X!=null){let we=Sl(X);Array.isArray(we)&&(we=we.map(ae=>m2(El(ae)))),d(n,["tools"],we)}const F=f(t,["toolConfig"]);n!==void 0&&F!=null&&d(n,["toolConfig"],sN(F));const W=f(t,["labels"]);n!==void 0&&W!=null&&d(n,["labels"],W);const O=f(t,["cachedContent"]);n!==void 0&&O!=null&&d(n,["cachedContent"],Xa(e,O));const te=f(t,["responseModalities"]);te!=null&&d(r,["responseModalities"],te);const ne=f(t,["mediaResolution"]);ne!=null&&d(r,["mediaResolution"],ne);const ee=f(t,["speechConfig"]);ee!=null&&d(r,["speechConfig"],cN(Sh(ee)));const Se=f(t,["audioTimestamp"]);Se!=null&&d(r,["audioTimestamp"],Se);const Fe=f(t,["thinkingConfig"]);return Fe!=null&&d(r,["thinkingConfig"],uN(Fe)),r}function fv(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["contents"]);if(a!=null){let c=Gr(a);Array.isArray(c)&&(c=c.map(u=>Cl(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["generationConfig"],fN(e,l,n)),n}function dN(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["instances[]","task_type"],r);const a=f(e,["title"]);t!==void 0&&a!=null&&d(t,["instances[]","title"],a);const l=f(e,["outputDimensionality"]);t!==void 0&&l!=null&&d(t,["parameters","outputDimensionality"],l);const c=f(e,["mimeType"]);t!==void 0&&c!=null&&d(t,["instances[]","mimeType"],c);const u=f(e,["autoTruncate"]);return t!==void 0&&u!=null&&d(t,["parameters","autoTruncate"],u),n}function hN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["contents"]);a!=null&&d(n,["instances[]","content"],Jy(e,a));const l=f(t,["config"]);return l!=null&&d(n,["config"],dN(l,n)),n}function mN(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const a=f(e,["negativePrompt"]);t!==void 0&&a!=null&&d(t,["parameters","negativePrompt"],a);const l=f(e,["numberOfImages"]);t!==void 0&&l!=null&&d(t,["parameters","sampleCount"],l);const c=f(e,["aspectRatio"]);t!==void 0&&c!=null&&d(t,["parameters","aspectRatio"],c);const u=f(e,["guidanceScale"]);t!==void 0&&u!=null&&d(t,["parameters","guidanceScale"],u);const p=f(e,["seed"]);t!==void 0&&p!=null&&d(t,["parameters","seed"],p);const m=f(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&d(t,["parameters","safetySetting"],m);const x=f(e,["personGeneration"]);t!==void 0&&x!=null&&d(t,["parameters","personGeneration"],x);const y=f(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&d(t,["parameters","includeSafetyAttributes"],y);const _=f(e,["includeRaiReason"]);t!==void 0&&_!=null&&d(t,["parameters","includeRaiReason"],_);const E=f(e,["language"]);t!==void 0&&E!=null&&d(t,["parameters","language"],E);const S=f(e,["outputMimeType"]);t!==void 0&&S!=null&&d(t,["parameters","outputOptions","mimeType"],S);const w=f(e,["outputCompressionQuality"]);t!==void 0&&w!=null&&d(t,["parameters","outputOptions","compressionQuality"],w);const C=f(e,["addWatermark"]);t!==void 0&&C!=null&&d(t,["parameters","addWatermark"],C);const M=f(e,["enhancePrompt"]);return t!==void 0&&M!=null&&d(t,["parameters","enhancePrompt"],M),n}function pN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["config"]);return l!=null&&d(n,["config"],mN(l,n)),n}function of(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["imageBytes"]);r!=null&&d(t,["bytesBase64Encoded"],Ja(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function xN(e){const t={},n=f(e,["maskMode"]);n!=null&&d(t,["maskMode"],n);const r=f(e,["segmentationClasses"]);r!=null&&d(t,["maskClasses"],r);const a=f(e,["maskDilation"]);return a!=null&&d(t,["dilation"],a),t}function gN(e){const t={},n=f(e,["controlType"]);n!=null&&d(t,["controlType"],n);const r=f(e,["enableControlImageComputation"]);return r!=null&&d(t,["computeControl"],r),t}function vN(e){const t={},n=f(e,["styleDescription"]);return n!=null&&d(t,["styleDescription"],n),t}function yN(e){const t={},n=f(e,["subjectType"]);n!=null&&d(t,["subjectType"],n);const r=f(e,["subjectDescription"]);return r!=null&&d(t,["subjectDescription"],r),t}function TN(e){const t={},n=f(e,["referenceImage"]);n!=null&&d(t,["referenceImage"],of(n));const r=f(e,["referenceId"]);r!=null&&d(t,["referenceId"],r);const a=f(e,["referenceType"]);a!=null&&d(t,["referenceType"],a);const l=f(e,["maskImageConfig"]);l!=null&&d(t,["maskImageConfig"],xN(l));const c=f(e,["controlImageConfig"]);c!=null&&d(t,["controlImageConfig"],gN(c));const u=f(e,["styleImageConfig"]);u!=null&&d(t,["styleImageConfig"],vN(u));const p=f(e,["subjectImageConfig"]);return p!=null&&d(t,["subjectImageConfig"],yN(p)),t}function _N(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const a=f(e,["negativePrompt"]);t!==void 0&&a!=null&&d(t,["parameters","negativePrompt"],a);const l=f(e,["numberOfImages"]);t!==void 0&&l!=null&&d(t,["parameters","sampleCount"],l);const c=f(e,["aspectRatio"]);t!==void 0&&c!=null&&d(t,["parameters","aspectRatio"],c);const u=f(e,["guidanceScale"]);t!==void 0&&u!=null&&d(t,["parameters","guidanceScale"],u);const p=f(e,["seed"]);t!==void 0&&p!=null&&d(t,["parameters","seed"],p);const m=f(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&d(t,["parameters","safetySetting"],m);const x=f(e,["personGeneration"]);t!==void 0&&x!=null&&d(t,["parameters","personGeneration"],x);const y=f(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&d(t,["parameters","includeSafetyAttributes"],y);const _=f(e,["includeRaiReason"]);t!==void 0&&_!=null&&d(t,["parameters","includeRaiReason"],_);const E=f(e,["language"]);t!==void 0&&E!=null&&d(t,["parameters","language"],E);const S=f(e,["outputMimeType"]);t!==void 0&&S!=null&&d(t,["parameters","outputOptions","mimeType"],S);const w=f(e,["outputCompressionQuality"]);t!==void 0&&w!=null&&d(t,["parameters","outputOptions","compressionQuality"],w);const C=f(e,["editMode"]);t!==void 0&&C!=null&&d(t,["parameters","editMode"],C);const M=f(e,["baseSteps"]);return t!==void 0&&M!=null&&d(t,["parameters","editConfig","baseSteps"],M),n}function EN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["referenceImages"]);if(l!=null){let u=l;Array.isArray(u)&&(u=u.map(p=>TN(p))),d(n,["instances[0]","referenceImages"],u)}const c=f(t,["config"]);return c!=null&&d(n,["config"],_N(c,n)),n}function SN(e,t){const n={},r=f(e,["includeRaiReason"]);t!==void 0&&r!=null&&d(t,["parameters","includeRaiReason"],r);const a=f(e,["outputMimeType"]);t!==void 0&&a!=null&&d(t,["parameters","outputOptions","mimeType"],a);const l=f(e,["outputCompressionQuality"]);t!==void 0&&l!=null&&d(t,["parameters","outputOptions","compressionQuality"],l);const c=f(e,["enhanceInputImage"]);t!==void 0&&c!=null&&d(t,["parameters","upscaleConfig","enhanceInputImage"],c);const u=f(e,["imagePreservationFactor"]);t!==void 0&&u!=null&&d(t,["parameters","upscaleConfig","imagePreservationFactor"],u);const p=f(e,["numberOfImages"]);t!==void 0&&p!=null&&d(t,["parameters","sampleCount"],p);const m=f(e,["mode"]);return t!==void 0&&m!=null&&d(t,["parameters","mode"],m),n}function wN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["image"]);a!=null&&d(n,["instances[0]","image"],of(a));const l=f(t,["upscaleFactor"]);l!=null&&d(n,["parameters","upscaleConfig","upscaleFactor"],l);const c=f(t,["config"]);return c!=null&&d(n,["config"],SN(c,n)),n}function CN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Vt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function AN(e,t,n){const r={},a=f(t,["pageSize"]);n!==void 0&&a!=null&&d(n,["_query","pageSize"],a);const l=f(t,["pageToken"]);n!==void 0&&l!=null&&d(n,["_query","pageToken"],l);const c=f(t,["filter"]);n!==void 0&&c!=null&&d(n,["_query","filter"],c);const u=f(t,["queryBase"]);return n!==void 0&&u!=null&&d(n,["_url","models_url"],Qy(e,u)),r}function bN(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],AN(e,r,n)),n}function kN(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);t!==void 0&&a!=null&&d(t,["description"],a);const l=f(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&d(t,["defaultCheckpointId"],l),n}function NN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],kN(a,n)),n}function MN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Vt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function RN(e,t){const n={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&d(t,["systemInstruction"],Cl(Zn(r)));const a=f(e,["tools"]);if(t!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(u=>m2(u))),d(t,["tools"],c)}const l=f(e,["generationConfig"]);return t!==void 0&&l!=null&&d(t,["generationConfig"],l),n}function DN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["contents"]);if(a!=null){let c=Gr(a);Array.isArray(c)&&(c=c.map(u=>Cl(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["config"],RN(l,n)),n}function IN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["contents"]);if(a!=null){let c=Gr(a);Array.isArray(c)&&(c=c.map(u=>Cl(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["config"],l),n}function FN(e){const t={},n=f(e,["uri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["videoBytes"]);r!=null&&d(t,["bytesBase64Encoded"],Ja(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function LN(e,t){const n={},r=f(e,["numberOfVideos"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const a=f(e,["outputGcsUri"]);t!==void 0&&a!=null&&d(t,["parameters","storageUri"],a);const l=f(e,["fps"]);t!==void 0&&l!=null&&d(t,["parameters","fps"],l);const c=f(e,["durationSeconds"]);t!==void 0&&c!=null&&d(t,["parameters","durationSeconds"],c);const u=f(e,["seed"]);t!==void 0&&u!=null&&d(t,["parameters","seed"],u);const p=f(e,["aspectRatio"]);t!==void 0&&p!=null&&d(t,["parameters","aspectRatio"],p);const m=f(e,["resolution"]);t!==void 0&&m!=null&&d(t,["parameters","resolution"],m);const x=f(e,["personGeneration"]);t!==void 0&&x!=null&&d(t,["parameters","personGeneration"],x);const y=f(e,["pubsubTopic"]);t!==void 0&&y!=null&&d(t,["parameters","pubsubTopic"],y);const _=f(e,["negativePrompt"]);t!==void 0&&_!=null&&d(t,["parameters","negativePrompt"],_);const E=f(e,["enhancePrompt"]);t!==void 0&&E!=null&&d(t,["parameters","enhancePrompt"],E);const S=f(e,["generateAudio"]);t!==void 0&&S!=null&&d(t,["parameters","generateAudio"],S);const w=f(e,["lastFrame"]);t!==void 0&&w!=null&&d(t,["instances[0]","lastFrame"],of(w));const C=f(e,["compressionQuality"]);return t!==void 0&&C!=null&&d(t,["parameters","compressionQuality"],C),n}function ON(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Vt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["image"]);l!=null&&d(n,["instances[0]","image"],of(l));const c=f(t,["video"]);c!=null&&d(n,["instances[0]","video"],FN(c));const u=f(t,["config"]);return u!=null&&d(n,["config"],LN(u,n)),n}function PN(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function UN(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function BN(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function VN(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],PN(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],UN(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],BN(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function HN(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>VN(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function GN(e){const t={},n=f(e,["citationSources"]);return n!=null&&d(t,["citations"],n),t}function zN(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function jN(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>zN(a))),d(t,["urlMetadata"],r)}return t}function qN(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],HN(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],GN(r));const a=f(e,["tokenCount"]);a!=null&&d(t,["tokenCount"],a);const l=f(e,["finishReason"]);l!=null&&d(t,["finishReason"],l);const c=f(e,["urlContextMetadata"]);c!=null&&d(t,["urlContextMetadata"],jN(c));const u=f(e,["avgLogprobs"]);u!=null&&d(t,["avgLogprobs"],u);const p=f(e,["groundingMetadata"]);p!=null&&d(t,["groundingMetadata"],p);const m=f(e,["index"]);m!=null&&d(t,["index"],m);const x=f(e,["logprobsResult"]);x!=null&&d(t,["logprobsResult"],x);const y=f(e,["safetyRatings"]);return y!=null&&d(t,["safetyRatings"],y),t}function dv(e){const t={},n=f(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>qN(u))),d(t,["candidates"],c)}const r=f(e,["modelVersion"]);r!=null&&d(t,["modelVersion"],r);const a=f(e,["promptFeedback"]);a!=null&&d(t,["promptFeedback"],a);const l=f(e,["usageMetadata"]);return l!=null&&d(t,["usageMetadata"],l),t}function $N(e){const t={},n=f(e,["values"]);return n!=null&&d(t,["values"],n),t}function YN(){return{}}function WN(e){const t={},n=f(e,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>$N(l))),d(t,["embeddings"],a)}return f(e,["metadata"])!=null&&d(t,["metadata"],YN()),t}function XN(e){const t={},n=f(e,["bytesBase64Encoded"]);n!=null&&d(t,["imageBytes"],Ja(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function p2(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const a=f(e,["contentType"]);return a!=null&&d(t,["contentType"],a),t}function JN(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],XN(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const a=f(e,["_self"]);return a!=null&&d(t,["safetyAttributes"],p2(a)),t}function KN(e){const t={},n=f(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>JN(l))),d(t,["generatedImages"],a)}const r=f(e,["positivePromptSafetyAttributes"]);return r!=null&&d(t,["positivePromptSafetyAttributes"],p2(r)),t}function ZN(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const a=f(e,["updateTime"]);return a!=null&&d(t,["updateTime"],a),t}function ih(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["version"]);l!=null&&d(t,["version"],l);const c=f(e,["_self"]);c!=null&&d(t,["tunedModelInfo"],ZN(c));const u=f(e,["inputTokenLimit"]);u!=null&&d(t,["inputTokenLimit"],u);const p=f(e,["outputTokenLimit"]);p!=null&&d(t,["outputTokenLimit"],p);const m=f(e,["supportedGenerationMethods"]);return m!=null&&d(t,["supportedActions"],m),t}function QN(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["_self"]);if(r!=null){let a=e2(r);Array.isArray(a)&&(a=a.map(l=>ih(l))),d(t,["models"],a)}return t}function e3(){return{}}function t3(e){const t={},n=f(e,["totalTokens"]);n!=null&&d(t,["totalTokens"],n);const r=f(e,["cachedContentTokenCount"]);return r!=null&&d(t,["cachedContentTokenCount"],r),t}function n3(e){const t={},n=f(e,["video","uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["video","encodedVideo"]);r!=null&&d(t,["videoBytes"],Ja(r));const a=f(e,["encoding"]);return a!=null&&d(t,["mimeType"],a),t}function r3(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],n3(n)),t}function a3(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>r3(c))),d(t,["generatedVideos"],l)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function i3(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);l!=null&&d(t,["error"],l);const c=f(e,["response","generateVideoResponse"]);return c!=null&&d(t,["response"],a3(c)),t}function s3(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function l3(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function o3(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function c3(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],s3(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],l3(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],o3(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function u3(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>c3(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function f3(e){const t={},n=f(e,["citations"]);return n!=null&&d(t,["citations"],n),t}function d3(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function h3(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>d3(a))),d(t,["urlMetadata"],r)}return t}function m3(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],u3(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],f3(r));const a=f(e,["finishMessage"]);a!=null&&d(t,["finishMessage"],a);const l=f(e,["finishReason"]);l!=null&&d(t,["finishReason"],l);const c=f(e,["urlContextMetadata"]);c!=null&&d(t,["urlContextMetadata"],h3(c));const u=f(e,["avgLogprobs"]);u!=null&&d(t,["avgLogprobs"],u);const p=f(e,["groundingMetadata"]);p!=null&&d(t,["groundingMetadata"],p);const m=f(e,["index"]);m!=null&&d(t,["index"],m);const x=f(e,["logprobsResult"]);x!=null&&d(t,["logprobsResult"],x);const y=f(e,["safetyRatings"]);return y!=null&&d(t,["safetyRatings"],y),t}function hv(e){const t={},n=f(e,["candidates"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>m3(m))),d(t,["candidates"],p)}const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const a=f(e,["responseId"]);a!=null&&d(t,["responseId"],a);const l=f(e,["modelVersion"]);l!=null&&d(t,["modelVersion"],l);const c=f(e,["promptFeedback"]);c!=null&&d(t,["promptFeedback"],c);const u=f(e,["usageMetadata"]);return u!=null&&d(t,["usageMetadata"],u),t}function p3(e){const t={},n=f(e,["truncated"]);n!=null&&d(t,["truncated"],n);const r=f(e,["token_count"]);return r!=null&&d(t,["tokenCount"],r),t}function x3(e){const t={},n=f(e,["values"]);n!=null&&d(t,["values"],n);const r=f(e,["statistics"]);return r!=null&&d(t,["statistics"],p3(r)),t}function g3(e){const t={},n=f(e,["billableCharacterCount"]);return n!=null&&d(t,["billableCharacterCount"],n),t}function v3(e){const t={},n=f(e,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>x3(l))),d(t,["embeddings"],a)}const r=f(e,["metadata"]);return r!=null&&d(t,["metadata"],g3(r)),t}function y3(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["imageBytes"],Ja(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function x2(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const a=f(e,["contentType"]);return a!=null&&d(t,["contentType"],a),t}function Ch(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],y3(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const a=f(e,["_self"]);a!=null&&d(t,["safetyAttributes"],x2(a));const l=f(e,["prompt"]);return l!=null&&d(t,["enhancedPrompt"],l),t}function T3(e){const t={},n=f(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Ch(l))),d(t,["generatedImages"],a)}const r=f(e,["positivePromptSafetyAttributes"]);return r!=null&&d(t,["positivePromptSafetyAttributes"],x2(r)),t}function _3(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Ch(a))),d(t,["generatedImages"],r)}return t}function E3(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Ch(a))),d(t,["generatedImages"],r)}return t}function S3(e){const t={},n=f(e,["endpoint"]);n!=null&&d(t,["name"],n);const r=f(e,["deployedModelId"]);return r!=null&&d(t,["deployedModelId"],r),t}function w3(e){const t={},n=f(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const a=f(e,["updateTime"]);return a!=null&&d(t,["updateTime"],a),t}function C3(e){const t={},n=f(e,["checkpointId"]);n!=null&&d(t,["checkpointId"],n);const r=f(e,["epoch"]);r!=null&&d(t,["epoch"],r);const a=f(e,["step"]);return a!=null&&d(t,["step"],a),t}function sh(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["versionId"]);l!=null&&d(t,["version"],l);const c=f(e,["deployedModels"]);if(c!=null){let y=c;Array.isArray(y)&&(y=y.map(_=>S3(_))),d(t,["endpoints"],y)}const u=f(e,["labels"]);u!=null&&d(t,["labels"],u);const p=f(e,["_self"]);p!=null&&d(t,["tunedModelInfo"],w3(p));const m=f(e,["defaultCheckpointId"]);m!=null&&d(t,["defaultCheckpointId"],m);const x=f(e,["checkpoints"]);if(x!=null){let y=x;Array.isArray(y)&&(y=y.map(_=>C3(_))),d(t,["checkpoints"],y)}return t}function A3(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["_self"]);if(r!=null){let a=e2(r);Array.isArray(a)&&(a=a.map(l=>sh(l))),d(t,["models"],a)}return t}function b3(){return{}}function k3(e){const t={},n=f(e,["totalTokens"]);return n!=null&&d(t,["totalTokens"],n),t}function N3(e){const t={},n=f(e,["tokensInfo"]);return n!=null&&d(t,["tokensInfo"],n),t}function M3(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["videoBytes"],Ja(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function R3(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],M3(n)),t}function D3(e){const t={},n=f(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>R3(c))),d(t,["generatedVideos"],l)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function I3(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);l!=null&&d(t,["error"],l);const c=f(e,["response"]);return c!=null&&d(t,["response"],D3(c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const F3="Content-Type",L3="X-Server-Timeout",O3="User-Agent",lh="x-goog-api-client",P3="1.8.0",U3=`google-genai-sdk/${P3}`,B3="v1beta1",V3="v1beta",mv=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class H3{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:B3,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:V3,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),t!==""&&a.push(t),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),a=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[c,u]of Object.entries(t.queryParams))a.searchParams.append(c,String(u));let l={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=t.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,n,t.abortSignal),this.unaryApiCall(a,l,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[a,l]of Object.entries(n))typeof l=="object"?r[a]=Object.assign(Object.assign({},r[a]),l):l!==void 0&&(r[a]=l);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),a=this.constructUrl(t.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let l={};return l.body=t.body,l=await this.includeExtraHttpOptionsToRequestInit(l,n,t.abortSignal),this.streamApiCall(a,l,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r){if(n&&n.timeout||r){const a=new AbortController,l=a.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>a.abort(),n.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),t.signal=l}return n&&n.extraBody!==null&&G3(t,n.extraBody),t.headers=await this.getHeadersInternal(n),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await pv(a),new Qd(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await pv(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(t){var n;return fl(this,arguments,function*(){const a=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),l=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let c="";for(;;){const{done:u,value:p}=yield en(a.read());if(u){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=l.decode(p);try{const y=JSON.parse(m);if("error"in y){const _=JSON.parse(JSON.stringify(y.error)),E=_.status,S=_.code,w=`got status: ${E}. ${JSON.stringify(y)}`;if(S>=400&&S<600)throw new sf({message:w,status:S})}}catch(y){if(y.name==="ApiError")throw y}c+=m;let x=c.match(mv);for(;x;){const y=x[1];try{const _=new Response(y,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield en(new Qd(_)),c=c.slice(x[0].length),x=c.match(mv)}catch(_){throw new Error(`exception parsing stream chunk ${y}. ${_}`)}}}}finally{a.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=U3+" "+this.clientOptions.userAgentExtra;return t[O3]=n,t[lh]=n,t[F3]="application/json",t}async getHeadersInternal(t){const n=new Headers;if(t&&t.headers){for(const[r,a]of Object.entries(t.headers))n.append(r,a);t.timeout&&t.timeout>0&&n.append(L3,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(t,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const l=this.clientOptions.uploader,c=await l.stat(t);a.sizeBytes=String(c.size);const u=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:c.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=u;const p=await this.fetchUploadUrl(a,n);return l.upload(t,p,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n){var r;let a={};n!=null&&n.httpOptions?a=n.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const l={file:t},c=await this.request({path:We("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:a});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(r=c==null?void 0:c.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function pv(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new sf({message:a,status:n}):new Error(a)}}function G3(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const l=JSON.parse(e.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))n=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(l,c){const u=Object.assign({},l);for(const p in c)if(Object.prototype.hasOwnProperty.call(c,p)){const m=c[p],x=u[p];m&&typeof m=="object"&&!Array.isArray(m)&&x&&typeof x=="object"&&!Array.isArray(x)?u[p]=r(x,m):(x&&m&&typeof x!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${p}". Original type: ${typeof x}, New type: ${typeof m}. Overwriting.`),u[p]=m)}return u}const a=r(n,t);e.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const z3="mcp_used/unknown";function g2(e){for(const t of e)if(Ah(t)||typeof t=="object"&&"inputSchema"in t)return!0;return!1}function v2(e){var t;const n=(t=e[lh])!==null&&t!==void 0?t:"";e[lh]=(n+` ${z3}`).trimStart()}function j3(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(a=>Ah(a)))!==null&&r!==void 0?r:!1}function q3(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(a=>!Ah(a)))!==null&&r!==void 0?r:!1}function Ah(e){return e!==null&&typeof e=="object"&&e instanceof bh}function $3(e,t=100){return fl(this,arguments,function*(){let r,a=0;for(;a<t;){const l=yield en(e.listTools({cursor:r}));for(const c of l.tools)yield yield en(c),a++;if(!l.nextCursor)break;r=l.nextCursor}})}class bh{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new bh(t,n)}async initialize(){var t,n,r,a;if(this.mcpTools.length>0)return;const l={},c=[];for(const x of this.mcpClients)try{for(var u=!0,p=(n=void 0,Fo($3(x))),m;m=await p.next(),t=m.done,!t;u=!0){a=m.value,u=!1;const y=a;c.push(y);const _=y.name;if(l[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);l[_]=x}}catch(y){n={error:y}}finally{try{!u&&!t&&(r=p.return)&&await r.call(p)}finally{if(n)throw n.error}}this.mcpTools=c,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),Bw(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const c=await a.callTool({name:r.name,arguments:r.args},void 0,l);n.push({functionResponse:{name:r.name,response:c.isError?{error:c}:c}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Y3(e,t,n){const r=new kw;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data);const l=t4(a);Object.assign(r,l),t(r)}class W3{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),c=K3(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),p=`${a}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${u}`;let m=()=>{};const x=new Promise(b=>{m=b}),y=t.callbacks,_=function(){m({})},E=this.apiClient,S={onopen:_,onmessage:b=>{Y3(E,y.onmessage,b)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(b){},onclose:(r=y==null?void 0:y.onclose)!==null&&r!==void 0?r:function(b){}},w=this.webSocketFactory.create(p,J3(c),S);w.connect(),await x;const C=Vt(this.apiClient,t.model),M=f2({model:C}),k=ah({setup:M});return w.send(JSON.stringify(k)),new X3(w,this.apiClient)}}class X3{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=pk(t),r=d2(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=xk(t),r=ah(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const n=ah({playbackControl:t});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(ol.PLAY)}pause(){this.sendPlaybackControl(ol.PAUSE)}stop(){this.sendPlaybackControl(ol.STOP)}resetContext(){this.sendPlaybackControl(ol.RESET_CONTEXT)}close(){this.conn.close()}}function J3(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function K3(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Z3="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Q3(e,t,n){const r=new bw;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const l=JSON.parse(a);if(e.isVertexAI()){const c=$k(l);Object.assign(r,c)}else{const c=qk(l);Object.assign(r,c)}t(r)}class e5{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new W3(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,a,l,c,u;const p=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let x;const y=this.apiClient.getDefaultHeaders();t.config&&t.config.tools&&g2(t.config.tools)&&v2(y);const _=a5(y);if(this.apiClient.isVertexAI())x=`${p}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_);else{const O=this.apiClient.getApiKey();let te="BidiGenerateContent",ne="key";O!=null&&O.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),te="BidiGenerateContentConstrained",ne="access_token"),x=`${p}/ws/google.ai.generativelanguage.${m}.GenerativeService.${te}?${ne}=${O}`}let E=()=>{};const S=new Promise(O=>{E=O}),w=t.callbacks,C=function(){var O;(O=w==null?void 0:w.onopen)===null||O===void 0||O.call(w),E({})},M=this.apiClient,k={onopen:C,onmessage:O=>{Q3(M,w.onmessage,O)},onerror:(n=w==null?void 0:w.onerror)!==null&&n!==void 0?n:function(O){},onclose:(r=w==null?void 0:w.onclose)!==null&&r!==void 0?r:function(O){}},b=this.webSocketFactory.create(x,r5(_),k);b.connect(),await S;let U=Vt(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&U.startsWith("publishers/")){const O=this.apiClient.getProject(),te=this.apiClient.getLocation();U=`projects/${O}/locations/${te}/`+U}let G={};this.apiClient.isVertexAI()&&((a=t.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Gu.AUDIO]}:t.config.responseModalities=[Gu.AUDIO]),!((l=t.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const X=(u=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&u!==void 0?u:[],F=[];for(const O of X)if(this.isCallableTool(O)){const te=O;F.push(await te.tool())}else F.push(O);F.length>0&&(t.config.tools=F);const W={model:U,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?G=ok(this.apiClient,W):G=lk(this.apiClient,W),delete G.config,b.send(JSON.stringify(G)),new n5(b,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const t5={turnComplete:!0};class n5{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Gr(n.turns),t.isVertexAI()?r=r.map(a=>Cl(a)):r=r.map(a=>lf(a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const l of r){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!t.isVertexAI()&&!("id"in l))throw new Error(Z3)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},t5),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:mk(t)}:n={realtimeInput:hk(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function r5(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function a5(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xv=10;function gv(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let a=!1;for(const c of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Lu(c)){a=!0;break}if(!a)return!0;const l=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function Lu(e){return"callTool"in e&&typeof e.callTool=="function"}function vv(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i5 extends ps{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,a,l,c,u;const p=await this.processParamsForMcpUsage(n);if(!j3(n)||gv(n.config))return await this.generateContentInternal(p);if(q3(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let m,x;const y=Gr(p.contents),_=(l=(a=(r=p.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&l!==void 0?l:xv;let E=0;for(;E<_&&(m=await this.generateContentInternal(p),!(!m.functionCalls||m.functionCalls.length===0));){const S=m.candidates[0].content,w=[];for(const C of(u=(c=n.config)===null||c===void 0?void 0:c.tools)!==null&&u!==void 0?u:[])if(Lu(C)){const k=await C.callTool(m.functionCalls);w.push(...k)}E++,x={role:"user",parts:w},p.contents=Gr(p.contents),p.contents.push(S),p.contents.push(x),vv(p.config)&&(y.push(S),y.push(x))}return vv(p.config)&&(m.automaticFunctionCallingHistory=y),m},this.generateContentStream=async n=>{if(gv(n.config)){const r=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let l;const c=[];if(r!=null&&r.generatedImages)for(const p of r.generatedImages)p&&(p!=null&&p.safetyAttributes)&&((a=p==null?void 0:p.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?l=p==null?void 0:p.safetyAttributes:c.push(p);let u;return l?u={generatedImages:c,positivePromptSafetyAttributes:l}:u={generatedImages:c},u}),this.list=async n=>{var r;const c={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((r=c.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new sc(us.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(c),c)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async processParamsForMcpUsage(t){var n,r,a;const l=(n=t.config)===null||n===void 0?void 0:n.tools;if(!l)return t;const c=await Promise.all(l.map(async p=>Lu(p)?await p.tool():p)),u={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:c})};if(u.config.tools=c,t.config&&t.config.tools&&g2(t.config.tools)){const p=(a=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let m=Object.assign({},p);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),v2(m),u.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:m})}return u}async initAfcToolsMap(t){var n,r,a;const l=new Map;for(const c of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Lu(c)){const u=c,p=await u.tool();for(const m of(a=p.functionDeclarations)!==null&&a!==void 0?a:[]){if(!m.name)throw new Error("Function declaration name is required.");if(l.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);l.set(m.name,u)}}return l}async processAfcStream(t){var n,r,a;const l=(a=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:xv;let c=!1,u=0;const p=await this.initAfcToolsMap(t);return function(m,x,y){var _,E;return fl(this,arguments,function*(){for(var S,w,C,M;u<l;){c&&(u++,c=!1);const G=yield en(m.processParamsForMcpUsage(y)),X=yield en(m.generateContentStreamInternal(G)),F=[],W=[];try{for(var k=!0,b=(w=void 0,Fo(X)),U;U=yield en(b.next()),S=U.done,!S;k=!0){M=U.value,k=!1;const O=M;if(yield yield en(O),O.candidates&&(!((_=O.candidates[0])===null||_===void 0)&&_.content)){W.push(O.candidates[0].content);for(const te of(E=O.candidates[0].content.parts)!==null&&E!==void 0?E:[])if(u<l&&te.functionCall){if(!te.functionCall.name)throw new Error("Function call name was not returned by the model.");if(x.has(te.functionCall.name)){const ne=yield en(x.get(te.functionCall.name).callTool([te.functionCall]));F.push(...ne)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${x.keys()}, mising tool: ${te.functionCall.name}`)}}}}catch(O){w={error:O}}finally{try{!k&&!S&&(C=b.return)&&(yield en(C.call(b)))}finally{if(w)throw w.error}}if(F.length>0){c=!0;const O=new Ao;O.candidates=[{content:{role:"user",parts:F}}],yield yield en(O);const te=[];te.push(...W),te.push({role:"user",parts:F});const ne=Gr(y.contents).concat(te);y.contents=ne}else break}})}(this,p,t)}async generateContentInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=fv(this.apiClient,t);return u=We("{model}:generateContent",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=hv(x),_=new Ao;return Object.assign(_,y),_})}else{const m=uv(this.apiClient,t);return u=We("{model}:generateContent",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=dv(x),_=new Ao;return Object.assign(_,y),_})}}async generateContentStreamInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=fv(this.apiClient,t);return u=We("{model}:streamGenerateContent?alt=sse",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.requestStream({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),c.then(function(y){return fl(this,arguments,function*(){var _,E,S,w;try{for(var C=!0,M=Fo(y),k;k=yield en(M.next()),_=k.done,!_;C=!0){w=k.value,C=!1;const U=hv(yield en(w.json())),G=new Ao;Object.assign(G,U),yield yield en(G)}}catch(b){E={error:b}}finally{try{!C&&!_&&(S=M.return)&&(yield en(S.call(M)))}finally{if(E)throw E.error}}})})}else{const m=uv(this.apiClient,t);return u=We("{model}:streamGenerateContent?alt=sse",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.requestStream({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}),c.then(function(y){return fl(this,arguments,function*(){var _,E,S,w;try{for(var C=!0,M=Fo(y),k;k=yield en(M.next()),_=k.done,!_;C=!0){w=k.value,C=!1;const U=dv(yield en(w.json())),G=new Ao;Object.assign(G,U),yield yield en(G)}}catch(b){E={error:b}}finally{try{!C&&!_&&(S=M.return)&&(yield en(S.call(M)))}finally{if(E)throw E.error}}})})}}async embedContent(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=hN(this.apiClient,t);return u=We("{model}:predict",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=v3(x),_=new z1;return Object.assign(_,y),_})}else{const m=A4(this.apiClient,t);return u=We("{model}:batchEmbedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=WN(x),_=new z1;return Object.assign(_,y),_})}}async generateImagesInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=pN(this.apiClient,t);return u=We("{model}:predict",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=T3(x),_=new j1;return Object.assign(_,y),_})}else{const m=k4(this.apiClient,t);return u=We("{model}:predict",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=KN(x),_=new j1;return Object.assign(_,y),_})}}async editImageInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=EN(this.apiClient,t);return l=We("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const m=_3(p),x=new _w;return Object.assign(x,m),x})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=wN(this.apiClient,t);return l=We("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const m=E3(p),x=new Ew;return Object.assign(x,m),x})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=CN(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>sh(x))}else{const m=N4(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>ih(x))}}async listInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=bN(this.apiClient,t);return u=We("{models_url}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=A3(x),_=new q1;return Object.assign(_,y),_})}else{const m=R4(this.apiClient,t);return u=We("{models_url}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=QN(x),_=new q1;return Object.assign(_,y),_})}}async update(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=NN(this.apiClient,t);return u=We("{model}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>sh(x))}else{const m=I4(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>ih(x))}}async delete(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=MN(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(()=>{const x=b3(),y=new $1;return Object.assign(y,x),y})}else{const m=F4(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(()=>{const x=e3(),y=new $1;return Object.assign(y,x),y})}}async countTokens(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=DN(this.apiClient,t);return u=We("{model}:countTokens",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=k3(x),_=new Y1;return Object.assign(_,y),_})}else{const m=O4(this.apiClient,t);return u=We("{model}:countTokens",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=t3(x),_=new Y1;return Object.assign(_,y),_})}}async computeTokens(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=IN(this.apiClient,t);return l=We("{model}:computeTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const m=N3(p),x=new Sw;return Object.assign(x,m),x})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=ON(this.apiClient,t);return u=We("{model}:predictLongRunning",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>I3(x))}else{const m=B4(this.apiClient,t);return u=We("{model}:predictLongRunning",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>i3(x))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function s5(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["_url","operationName"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function l5(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["_url","operationName"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function o5(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["operationName"],n);const r=f(e,["resourceName"]);r!=null&&d(t,["_url","resourceName"],r);const a=f(e,["config"]);return a!=null&&d(t,["config"],a),t}function c5(e){const t={},n=f(e,["video","uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["video","encodedVideo"]);r!=null&&d(t,["videoBytes"],Ja(r));const a=f(e,["encoding"]);return a!=null&&d(t,["mimeType"],a),t}function u5(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],c5(n)),t}function f5(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>u5(c))),d(t,["generatedVideos"],l)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function d5(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);l!=null&&d(t,["error"],l);const c=f(e,["response","generateVideoResponse"]);return c!=null&&d(t,["response"],f5(c)),t}function h5(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["videoBytes"],Ja(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function m5(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],h5(n)),t}function p5(e){const t={},n=f(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>m5(c))),d(t,["generatedVideos"],l)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function yv(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);l!=null&&d(t,["error"],l);const c=f(e,["response"]);return c!=null&&d(t,["response"],p5(c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class x5 extends ps{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let l;return r&&"httpOptions"in r&&(l=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=l5(t);return u=We("{operationName}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>yv(x))}else{const m=s5(t);return u=We("{operationName}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>d5(x))}}async fetchPredictVideosOperationInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=o5(t);return l=We("{resourceName}:fetchPredictOperation",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>yv(p))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function g5(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function y2(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],g5(n)),t}function v5(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],y2(r)),t}function y5(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>v5(a))),d(t,["speakerVoiceConfigs"],r)}return t}function T5(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],y2(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],y5(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function _5(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function E5(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function S5(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function w5(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],_5(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],E5(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],S5(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function C5(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>w5(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function A5(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function b5(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function k5(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],b5(n)),t}function N5(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function M5(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],N5(n)),t}function R5(){return{}}function D5(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>A5(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],k5(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],M5(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],R5());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function I5(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Tv(){return{}}function F5(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const a=f(e,["endOfSpeechSensitivity"]);a!=null&&d(t,["endOfSpeechSensitivity"],a);const l=f(e,["prefixPaddingMs"]);l!=null&&d(t,["prefixPaddingMs"],l);const c=f(e,["silenceDurationMs"]);return c!=null&&d(t,["silenceDurationMs"],c),t}function L5(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],F5(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const a=f(e,["turnCoverage"]);return a!=null&&d(t,["turnCoverage"],a),t}function O5(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function P5(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],O5(r)),t}function U5(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function B5(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const a=f(e,["responseModalities"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","responseModalities"],a);const l=f(e,["temperature"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","temperature"],l);const c=f(e,["topP"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","topP"],c);const u=f(e,["topK"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","topK"],u);const p=f(e,["maxOutputTokens"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","maxOutputTokens"],p);const m=f(e,["mediaResolution"]);t!==void 0&&m!=null&&d(t,["setup","generationConfig","mediaResolution"],m);const x=f(e,["seed"]);t!==void 0&&x!=null&&d(t,["setup","generationConfig","seed"],x);const y=f(e,["speechConfig"]);t!==void 0&&y!=null&&d(t,["setup","generationConfig","speechConfig"],T5(wh(y)));const _=f(e,["enableAffectiveDialog"]);t!==void 0&&_!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],_);const E=f(e,["systemInstruction"]);t!==void 0&&E!=null&&d(t,["setup","systemInstruction"],C5(Zn(E)));const S=f(e,["tools"]);if(t!==void 0&&S!=null){let G=Sl(S);Array.isArray(G)&&(G=G.map(X=>D5(El(X)))),d(t,["setup","tools"],G)}const w=f(e,["sessionResumption"]);t!==void 0&&w!=null&&d(t,["setup","sessionResumption"],I5(w));const C=f(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&d(t,["setup","inputAudioTranscription"],Tv());const M=f(e,["outputAudioTranscription"]);t!==void 0&&M!=null&&d(t,["setup","outputAudioTranscription"],Tv());const k=f(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&d(t,["setup","realtimeInputConfig"],L5(k));const b=f(e,["contextWindowCompression"]);t!==void 0&&b!=null&&d(t,["setup","contextWindowCompression"],P5(b));const U=f(e,["proactivity"]);return t!==void 0&&U!=null&&d(t,["setup","proactivity"],U5(U)),n}function V5(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],Vt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],B5(a,n)),n}function H5(e,t,n){const r={},a=f(t,["expireTime"]);n!==void 0&&a!=null&&d(n,["expireTime"],a);const l=f(t,["newSessionExpireTime"]);n!==void 0&&l!=null&&d(n,["newSessionExpireTime"],l);const c=f(t,["uses"]);n!==void 0&&c!=null&&d(n,["uses"],c);const u=f(t,["liveConnectConstraints"]);n!==void 0&&u!=null&&d(n,["bidiGenerateContentSetup"],V5(e,u));const p=f(t,["lockAdditionalFields"]);return n!==void 0&&p!=null&&d(n,["fieldMask"],p),r}function G5(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],H5(e,r,n)),n}function z5(e){const t={},n=f(e,["name"]);return n!=null&&d(t,["name"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function j5(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(l=>`${n}.${l}`);t.push(...a)}else t.push(n)}return t.join(",")}function q5(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const l=r.setup;typeof l=="object"&&l!==null?(e.bidiGenerateContentSetup=l,n=l):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const a=e.fieldMask;if(n){const l=j5(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)l?e.fieldMask=l:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];a.length>0&&(u=a.map(m=>c.includes(m)?`generationConfig.${m}`:m));const p=[];l&&p.push(l),u.length>0&&p.push(...u),p.length>0?e.fieldMask=p.join(","):delete e.fieldMask}else delete e.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?e.fieldMask=a.join(","):delete e.fieldMask;return e}class $5 extends ps{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=G5(this.apiClient,t);l=We("auth_tokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const p=q5(u,t.config);return a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),a.then(m=>z5(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Y5(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function W5(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const l=f(e,["filter"]);return t!==void 0&&l!=null&&d(t,["_query","filter"],l),n}function X5(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],W5(n,t)),t}function J5(e){const t={},n=f(e,["textInput"]);n!=null&&d(t,["textInput"],n);const r=f(e,["output"]);return r!=null&&d(t,["output"],r),t}function K5(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=f(e,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>J5(a))),d(t,["examples","examples"],r)}return t}function Z5(e,t){const n={};if(f(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=f(e,["tunedModelDisplayName"]);if(t!==void 0&&r!=null&&d(t,["displayName"],r),f(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=f(e,["epochCount"]);t!==void 0&&a!=null&&d(t,["tuningTask","hyperparameters","epochCount"],a);const l=f(e,["learningRateMultiplier"]);if(l!=null&&d(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),f(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=f(e,["batchSize"]);t!==void 0&&c!=null&&d(t,["tuningTask","hyperparameters","batchSize"],c);const u=f(e,["learningRate"]);return t!==void 0&&u!=null&&d(t,["tuningTask","hyperparameters","learningRate"],u),n}function Q5(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["trainingDataset"]);r!=null&&d(t,["tuningTask","trainingData"],K5(r));const a=f(e,["config"]);return a!=null&&d(t,["config"],Z5(a,t)),t}function eM(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function tM(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const l=f(e,["filter"]);return t!==void 0&&l!=null&&d(t,["_query","filter"],l),n}function nM(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],tM(n,t)),t}function rM(e,t){const n={},r=f(e,["gcsUri"]);t!==void 0&&r!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],r);const a=f(e,["vertexDatasetResource"]);if(t!==void 0&&a!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],a),f(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function aM(e,t){const n={},r=f(e,["gcsUri"]);r!=null&&d(n,["validationDatasetUri"],r);const a=f(e,["vertexDatasetResource"]);return t!==void 0&&a!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],a),n}function iM(e,t){const n={},r=f(e,["validationDataset"]);t!==void 0&&r!=null&&d(t,["supervisedTuningSpec"],aM(r,n));const a=f(e,["tunedModelDisplayName"]);t!==void 0&&a!=null&&d(t,["tunedModelDisplayName"],a);const l=f(e,["description"]);t!==void 0&&l!=null&&d(t,["description"],l);const c=f(e,["epochCount"]);t!==void 0&&c!=null&&d(t,["supervisedTuningSpec","hyperParameters","epochCount"],c);const u=f(e,["learningRateMultiplier"]);t!==void 0&&u!=null&&d(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const p=f(e,["exportLastCheckpointOnly"]);t!==void 0&&p!=null&&d(t,["supervisedTuningSpec","exportLastCheckpointOnly"],p);const m=f(e,["adapterSize"]);if(t!==void 0&&m!=null&&d(t,["supervisedTuningSpec","hyperParameters","adapterSize"],m),f(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function sM(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["trainingDataset"]);r!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],rM(r,t));const a=f(e,["config"]);return a!=null&&d(t,["config"],iM(a,t)),t}function lM(e){const t={},n=f(e,["name"]);n!=null&&d(t,["model"],n);const r=f(e,["name"]);return r!=null&&d(t,["endpoint"],r),t}function T2(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["state"]);r!=null&&d(t,["state"],Ky(r));const a=f(e,["createTime"]);a!=null&&d(t,["createTime"],a);const l=f(e,["tuningTask","startTime"]);l!=null&&d(t,["startTime"],l);const c=f(e,["tuningTask","completeTime"]);c!=null&&d(t,["endTime"],c);const u=f(e,["updateTime"]);u!=null&&d(t,["updateTime"],u);const p=f(e,["description"]);p!=null&&d(t,["description"],p);const m=f(e,["baseModel"]);m!=null&&d(t,["baseModel"],m);const x=f(e,["_self"]);x!=null&&d(t,["tunedModel"],lM(x));const y=f(e,["distillationSpec"]);y!=null&&d(t,["distillationSpec"],y);const _=f(e,["experiment"]);_!=null&&d(t,["experiment"],_);const E=f(e,["labels"]);E!=null&&d(t,["labels"],E);const S=f(e,["pipelineJob"]);S!=null&&d(t,["pipelineJob"],S);const w=f(e,["satisfiesPzi"]);w!=null&&d(t,["satisfiesPzi"],w);const C=f(e,["satisfiesPzs"]);C!=null&&d(t,["satisfiesPzs"],C);const M=f(e,["serviceAccount"]);M!=null&&d(t,["serviceAccount"],M);const k=f(e,["tunedModelDisplayName"]);return k!=null&&d(t,["tunedModelDisplayName"],k),t}function oM(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>T2(l))),d(t,["tuningJobs"],a)}return t}function cM(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);return l!=null&&d(t,["error"],l),t}function uM(e){const t={},n=f(e,["checkpointId"]);n!=null&&d(t,["checkpointId"],n);const r=f(e,["epoch"]);r!=null&&d(t,["epoch"],r);const a=f(e,["step"]);a!=null&&d(t,["step"],a);const l=f(e,["endpoint"]);return l!=null&&d(t,["endpoint"],l),t}function fM(e){const t={},n=f(e,["model"]);n!=null&&d(t,["model"],n);const r=f(e,["endpoint"]);r!=null&&d(t,["endpoint"],r);const a=f(e,["checkpoints"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>uM(c))),d(t,["checkpoints"],l)}return t}function oh(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["state"]);r!=null&&d(t,["state"],Ky(r));const a=f(e,["createTime"]);a!=null&&d(t,["createTime"],a);const l=f(e,["startTime"]);l!=null&&d(t,["startTime"],l);const c=f(e,["endTime"]);c!=null&&d(t,["endTime"],c);const u=f(e,["updateTime"]);u!=null&&d(t,["updateTime"],u);const p=f(e,["error"]);p!=null&&d(t,["error"],p);const m=f(e,["description"]);m!=null&&d(t,["description"],m);const x=f(e,["baseModel"]);x!=null&&d(t,["baseModel"],x);const y=f(e,["tunedModel"]);y!=null&&d(t,["tunedModel"],fM(y));const _=f(e,["supervisedTuningSpec"]);_!=null&&d(t,["supervisedTuningSpec"],_);const E=f(e,["tuningDataStats"]);E!=null&&d(t,["tuningDataStats"],E);const S=f(e,["encryptionSpec"]);S!=null&&d(t,["encryptionSpec"],S);const w=f(e,["partnerModelTuningSpec"]);w!=null&&d(t,["partnerModelTuningSpec"],w);const C=f(e,["distillationSpec"]);C!=null&&d(t,["distillationSpec"],C);const M=f(e,["experiment"]);M!=null&&d(t,["experiment"],M);const k=f(e,["labels"]);k!=null&&d(t,["labels"],k);const b=f(e,["pipelineJob"]);b!=null&&d(t,["pipelineJob"],b);const U=f(e,["satisfiesPzi"]);U!=null&&d(t,["satisfiesPzi"],U);const G=f(e,["satisfiesPzs"]);G!=null&&d(t,["satisfiesPzs"],G);const X=f(e,["serviceAccount"]);X!=null&&d(t,["serviceAccount"],X);const F=f(e,["tunedModelDisplayName"]);return F!=null&&d(t,["tunedModelDisplayName"],F),t}function dM(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>oh(l))),d(t,["tuningJobs"],a)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hM extends ps{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new sc(us.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:Zd.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=eM(t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>oh(x))}else{const m=Y5(t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>T2(x))}}async listInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=nM(t);return u=We("tuningJobs",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=dM(x),_=new W1;return Object.assign(_,y),_})}else{const m=X5(t);return u=We("tunedModels",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=oM(x),_=new W1;return Object.assign(_,y),_})}}async tuneInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=sM(t);return l=We("tuningJobs",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>oh(p))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Q5(t);return l=We("tunedModels",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>cM(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mM{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const pM=1024*1024*8,xM=3,gM=1e3,vM=2,Nd="x-goog-upload-status";async function yM(e,t,n){var r,a,l;let c=0,u=0,p=new Qd(new Response),m="upload";for(c=e.size;u<c;){const y=Math.min(pM,c-u),_=e.slice(u,u+y);u+y>=c&&(m+=", finalize");let E=0,S=gM;for(;E<xM&&(p=await n.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":String(u),"Content-Length":String(y)}}}),!(!((r=p==null?void 0:p.headers)===null||r===void 0)&&r[Nd]));)E++,await _M(S),S=S*vM;if(u+=y,((a=p==null?void 0:p.headers)===null||a===void 0?void 0:a[Nd])!=="active")break;if(c<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const x=await(p==null?void 0:p.json());if(((l=p==null?void 0:p.headers)===null||l===void 0?void 0:l[Nd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return x.file}async function TM(e){return{size:e.size,type:e.type}}function _M(e){return new Promise(t=>setTimeout(t,e))}class EM{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await yM(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await TM(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SM{create(t,n,r){return new wM(t,n,r)}}class wM{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _v="x-goog-api-key";class CM{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(t.get(_v)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(_v,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const AM="gl-node/";class bM{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=Tw(t,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const a=new CM(this.apiKey);this.apiClient=new H3({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:AM+"web",uploader:new EM,downloader:new mM}),this.models=new i5(this.apiClient),this.live=new e5(this.apiClient,a,new SM),this.batches=new WC(this.apiClient),this.chats=new ZA(this.models,this.apiClient),this.caches=new XA(this.apiClient),this.files=new fb(this.apiClient),this.operations=new x5(this.apiClient),this.authTokens=new $5(this.apiClient),this.tunings=new hM(this.apiClient)}}const aa="gemini-2.5-flash-preview-04-17";let Kt=null;const Ev=e=>{if(!e){Kt=null;return}try{Kt=new bM({apiKey:e})}catch(t){console.error("Failed to initialize Gemini AI:",t),Kt=null}},xs=e=>{const t=n=>{const{position:r,extendedDetails:a,...l}=n,c={...l};if(a){const{reportDeck:u,attachments:p,subSteps:m,decisions:x,...y}=a,_={...y};u&&u.slides.length>0&&(_.reportDeckExists=!0,_.reportDeckSlideCount=u.slides.length),p&&p.length>0&&(_.attachments=p.map(E=>({id:E.id,name:E.name,type:E.type}))),m&&m.length>0&&(_.subSteps=m.map(E=>{const{position:S,attachments:w,actionItems:C,...M}=E,k={...M};return w&&w.length>0&&(k.attachments=w.map(b=>({id:b.id,name:b.name,type:b.type}))),C&&C.length>0&&(k.actionItems=C.map(b=>{const{report:U,...G}=b,X={...G};if(U){const{attachments:F,...W}=U,O={...W};F&&F.length>0&&(O.attachments=F.map(te=>({id:te.id,name:te.name,type:te.type}))),X.report=O}return X})),k})),c.extendedDetails=_}return c};return Array.isArray(e)?e.map(t):t(e)},cf=e=>({...e,slides:e.slides.map(t=>{if(t.isLocked)return{id:t.id,isLocked:!0,summary:`Locked Slide: Contains ${t.elements.length} elements. Content is preserved and must not be changed.`,elements:[]};const{elements:n,...r}=t;return{...r,elements:n.map(a=>{var l;if(a.type==="flowchart"&&((l=a.data)!=null&&l.subSteps)){const c=a;return{...c,data:{subStepCount:c.data.subSteps.length,subSteps:`[Sub-step data omitted for brevity, count: ${c.data.subSteps.length}]`}}}return a})}})}),kM=e=>{const t=/"dependencies"\s*:\s*\[([\s\S]*?)\]/g;return e.replace(t,(n,r)=>{const a=r.match(/"[^"]*"/g);return`"dependencies": [${a?a.join(", "):""}]`})},Ta=e=>{let t=e.trim();const n=/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s,r=t.match(n);if(r&&r[1]&&(t=r[1].trim()),t=kM(t),t=t.replace(/"((?:\\.|[^"\\])*)"/g,(a,l)=>`"${l.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`),!r){const a=t.indexOf("{"),l=t.indexOf("[");if(a===-1&&l===-1)throw console.error("No JSON object or array found in the response string.",e),new Error(`AI response did not contain a valid JSON structure. Raw response: ${e.substring(0,500)}...`);const c=a===-1?l:l===-1?a:Math.min(a,l),u=t.lastIndexOf("}"),p=t.lastIndexOf("]"),m=Math.max(u,p);c>-1&&m>c&&(t=t.substring(c,m+1))}try{return JSON.parse(t)}catch(a){throw console.error("Failed to parse JSON response:",a,`
Original text:`,e,`
Processed string:`,t),new Error(`Failed to parse AI response as JSON. Raw response: ${e.substring(0,500)}...`)}},ia=(e,t)=>{console.error(`Error in Gemini API call during ${t}:`,e);let n=`AI (${t})`;if(e instanceof Error){const r=e.message.toLowerCase();r.includes("api key not valid")||r.includes("api key is invalid")?n="API(API key not valid. Please pass a valid API key.)":r.includes("quota")?n="APIGoogle AI Platform(You have exceeded your API quota.)":n=`AI (${t}): ${e.message}`}throw new Error(n)},NM=async(e,t)=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
    You are an expert project planner. Your task is to break down a high-level project goal into a sequence of actionable tasks.
    CONTEXT:
    - Project Goal: "${e}"
    - Target Completion Date: "${t}"
    INSTRUCTIONS:
    1.  Generate a sequence of 3 to 7 high-level, actionable tasks.
    2.  Provide a concise title (max 10 words) and a brief description (1-2 sentences) for each.
    3.  Your response MUST be a single, valid JSON array of objects. Do NOT include any explanations or markdown fences.
    4.  The language of the output should match the language of the input goal.
    5.  Each object MUST have this structure: { "id": "unique_string_id", "title": "Task Title", "description": "Task Description" }
  `;try{const r=await Kt.models.generateContent({model:aa,contents:n,config:{responseMimeType:"application/json"}}),a=Ta(r.text);if(!a||!Array.isArray(a)||a.some(l=>!l.id||!l.title||!l.description))throw new Error("AI returned an unexpected format for project tasks.");return a}catch(r){ia(r,"project plan generation")}},MM=async e=>{var n;if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const t=`
    You are a project management expert. Analyze the given task and propose a list of concrete next steps to accomplish it.
    CONTEXT:
    - Task Title: "${e.title}"
    - Task Description: "${e.description}"
    - Required Resources: "${((n=e.extendedDetails)==null?void 0:n.resources)||"Not specified"}"
    INSTRUCTIONS:
    1.  Generate a list of 3 to 6 actionable proposals (sub-steps).
    2.  Each proposal must have a concise 'title' and a 'description'.
    3.  Focus on breaking down the main task into logical phases or components.
    4.  Your response MUST be a single, valid JSON array of objects. Do not include any explanations.
    5.  The language must match the input task language.
    6.  The JSON structure for each item must be: { "title": "...", "description": "..." }
  `;try{const r=await Kt.models.generateContent({model:aa,contents:t,config:{responseMimeType:"application/json"}}),a=Ta(r.text);if(!a||!Array.isArray(a)||a.some(l=>!l.title||!l.description))throw new Error("AI returned an unexpected format for step proposals.");if(a.length===0)throw new Error("AI did not generate any proposals. The task might be too abstract.");return a}catch(r){ia(r,"step proposal generation")}},RM=async(e,t)=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a senior project analyst AI. Your task is to intelligently update a list of critical project decisions based on the latest task data. You will merge new findings with an existing list.

        CONTEXT:
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(xs(e))}
        - Existing Decisions List: ${JSON.stringify(t)}
        - Today's Date: ${new Date().toISOString().split("T")[0]}

        INSTRUCTIONS:
        1.  **Analyze Task Data**: Holistically review the 'Full Task Data' to understand the current state, including sub-steps, action items, and notes.
        2.  **Review Existing Decisions**: Go through each item in the 'Existing Decisions List'.
        3.  **Merge and Update**:
            *   **For each existing decision**: Check if the latest task data provides new information.
                *   If an 'undecided' item now has a clear answer in the task data, update its 'status' to 'decided', fill in the 'decision' and 'reasoning', and set the 'date'.
                *   You may also refine the 'question' or 'reasoning' of existing items if the new data provides more clarity.
                *   Keep the original 'id' for all existing items.
            *   **Identify New Decisions**: Look for any *new* critical questions or decision points in the task data that are NOT present in the existing list.
            *   For each new decision you find, create a new decision object.
        4.  **Construct Final List**: Your output MUST be a single JSON array containing the complete, merged list of decisions. This list must include:
            *   All the original decisions, updated as necessary.
            *   All the newly identified decisions.
        5.  **JSON Structure**: Every object in the output array MUST strictly follow this structure. For new items, you MUST set the 'id' field to 'NEW'. For existing items, you MUST preserve their original 'id'.
            {
              "id": "string (original ID or 'NEW' for new items)",
              "question": "The question that needs a decision.",
              "decision": "The final outcome (string, or empty string for 'undecided').",
              "reasoning": "Justification for the decision, or explanation of importance for 'undecided'.",
              "date": "YYYY-MM-DD (string, or empty string for 'undecided').",
              "status": "'decided' or 'undecided'."
            }
        6.  **Language and Format**: The output language must match the input task language. The response must be only the JSON array, without any markdown or explanations.
    `;try{const r=await Kt.models.generateContent({model:aa,contents:n,config:{responseMimeType:"application/json"}}),a=Ta(r.text);if(!a||!Array.isArray(a)||a.some(l=>!l.question||!l.status||!l.id))throw new Error("AI returned an unexpected format for decisions. Expected fields: id, question, status.");return a}catch(r){ia(r,"decision generation")}},DM=async(e,t,n)=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a presentation designer and project analyst. Your task is to update a project status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Updated Full Task Data (JSON, pruned for brevity): ${JSON.stringify(xs(t))}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(cf(e))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked), REGENERATE their content from scratch based on the 'updatedTaskData'.
      3.  This includes regenerating 'flowchart' slides to reflect the latest sub-step data.
      4.  **ACTION ITEM FOCUS**: When regenerating, pay close attention to the progress and reports within each sub-step's 'actionItems'.
      5.  The final output MUST be a single, valid JSON object representing the complete slide deck, with all slides (locked and regenerated) in their original order.
      6.  Follow the same JSON structure and rules as the initial generation.
    `;try{const a=await Kt.models.generateContent({model:aa,contents:r,config:{responseMimeType:"application/json"}}),l=Ta(a.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the regenerated slide deck.");return l}catch(a){ia(a,"slide deck regeneration")}},IM=async e=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const t=`
        You are an expert presentation designer. The following JSON represents a slide deck.
        Analyze its content and structure. Your task is to improve the layout, wording, and visual hierarchy for maximum clarity and impact.
        You can rephrase text for conciseness, change element positions and sizes, and adjust font properties. Do not change element types or IDs.
        Return the updated slide deck as a valid JSON object with the exact same structure as the input. Do not use markdown.
        CRITICAL: Textbox elements use a "content" field, NOT a "text" field.
        
        Input Deck (pruned for brevity):
        ${JSON.stringify(cf(e))}
    `;try{const n=await Kt.models.generateContent({model:aa,contents:t,config:{responseMimeType:"application/json"}}),r=Ta(n.text);if(!r||!Array.isArray(r.slides))throw new Error("AI returned an invalid format for the optimized slide deck.");return r}catch(n){ia(n,"slide layout optimization")}},FM=async(e,t,n)=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a senior project manager AI. Your task is to conduct a holistic health check of the entire project.
      CONTEXT:
      - Overall Project Goal: "${t}"
      - Final Target Date: "${n}"
      - Current Date: "${new Date().toISOString().split("T")[0]}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(xs(e),null,2)}

      INSTRUCTIONS:
      1.  **Holistic Analysis**: Review ALL provided data. Compare task/sub-step due dates with the current date. Analyze dependencies, blockers, and the completion rate of action items.
      2.  **Determine Overall Status**: Categorize the project's health as 'On Track', 'At Risk', or 'Off Track'.
      3.  **Identify Positives**: List 2-3 key accomplishments or areas that are progressing well.
      4.  **Identify Concerns**: List the most critical risks or issues. For each, explain WHY it's a concern (e.g., "Task 'X' is 2 weeks overdue and blocking 3 other tasks"). Note the related task IDs.
      5.  **Propose Solutions**: For each major concern, provide concrete, actionable suggestions for improvement. (e.g., "Re-allocate resources from Task Y to Task X", "Hold a risk mitigation meeting for Z").
      6.  **Summarize**: Write a concise, executive-level summary of the project's current state.
      7.  **JSON Output**: Your response MUST be a single, valid JSON object following the ProjectHealthReport structure. Do not include markdown or explanations.
      8.  **The output language MUST be Japanese.**

      JSON Structure to follow:
      {
        "overallStatus": "'On Track' | 'At Risk' | 'Off Track'",
        "summary": "string",
        "positivePoints": ["string"],
        "areasOfConcern": [{ "description": "string", "relatedTaskIds": ["string"] }],
        "suggestions": ["string"]
      }
    `;try{const a=await Kt.models.generateContent({model:aa,contents:r,config:{responseMimeType:"application/json"}}),l=Ta(a.text);if(!l||!l.overallStatus||!l.summary)throw new Error("AI returned an invalid format for the project health report.");return l}catch(a){ia(a,"project health report generation")}},LM=async(e,t,n)=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
        You are a senior project analyst AI. Your task is to create a comprehensive slide deck summarizing the ENTIRE project status.
        CONTEXT:
        - Overall Project Goal: "${t}"
        - Final Target Date: "${n}"
        - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(xs(e),null,2)}
        INSTRUCTIONS:
        1.  Synthesize a comprehensive slide deck (6-10 slides) summarizing the entire project.
        2.  The response MUST be a single, valid JSON object following the SlideDeck structure. Do NOT use markdown.
        3.  The output language MUST be Japanese.
        4.  **CRITICAL SYNTHESIS**:
            - **Title & Overview**: Create a title slide and a project overview slide.
            - **Task Summary & Flowchart**: For each major task in the 'tasks' array, create one or two summary slides. One slide should show a \`flowchart\` of its sub-steps if they exist, following the structure \`{"type": "flowchart", "data": {"subSteps": [...]}}\`. You MUST copy the task's specific \`subSteps\` array from the input JSON into the \`data.subSteps\` field. Another slide can summarize the task's status and outcomes.
            - **Key Project Decisions**: Analyze the 'decisions' data from all tasks. Create a dedicated slide titled "". List the top 3-5 most important 'decided' items and their outcomes. Separately, list any critical 'undecided' questions that pose a risk to the project timeline or goals.
            - **Key Achievements & Risks**: Create dedicated slides for significant achievements and project-level risks.
            - **Conclusion**: A final slide summarizing the project's outlook and next steps.
        5.  Use the standard JSON format for slides and elements. Remember "content" for textboxes.
    `;try{const a=await Kt.models.generateContent({model:aa,contents:r,config:{responseMimeType:"application/json"}}),l=Ta(a.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the project slide deck.");return l}catch(a){ia(a,"project report deck generation")}},OM=async(e,t,n,r)=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const a=`
      You are a senior project analyst AI. Your task is to update a project-wide status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Final Target Date: "${r}"
      - Updated Full Project Data (JSON, pruned for brevity): ${JSON.stringify(xs(t),null,2)}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(cf(e))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked slides), REGENERATE their content from scratch based on the updated project data.
      3.  This includes regenerating any 'flowchart' elements on unlocked slides to show the latest sub-step data.
      4.  Synthesize information across all tasks to provide a holistic project view in the regenerated slides.
      5.  The final output MUST be a single, valid JSON object for the complete slide deck, in the original slide order.
      6.  The output language MUST be Japanese.
    `;try{const l=await Kt.models.generateContent({model:aa,contents:a,config:{responseMimeType:"application/json"}}),c=Ta(l.text);if(!c||!Array.isArray(c.slides))throw new Error("AI returned an invalid format for the regenerated project slide deck.");return c}catch(l){ia(l,"project report deck regeneration")}},PM=e=>{const t=e.match(/^data:(.+);base64,(.*)$/);return t?{mimeType:t[1],data:t[2]}:null},_2=e=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const t=[];for(const n of e){if(t.push({text:`
--- START OF SOURCE: ${n.name} ---
`}),n.type==="image"&&typeof n.content=="string"){const r=PM(n.content);r?t.push({inlineData:{mimeType:r.mimeType,data:r.data}}):t.push({text:"[Image data was invalid or in wrong format]"})}else if(n.type==="json"){const r=n.content.slides?cf(n.content):xs(n.content);t.push({text:`Type: JSON Data
Content: ${JSON.stringify(r,null,2)}`})}else t.push({text:`Type: Text
Content: ${n.content}`});t.push({text:`
--- END OF SOURCE: ${n.name} ---
`})}return t},E2=async(e,t)=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are a professional presentation designer AI. Your task is to create a slide deck based on a user's objective and provided source materials.

        **USER OBJECTIVE**: "${t}"

        **CRITICAL INSTRUCTIONS**:
        1.  **Strict JSON Output**: Your entire response MUST be a single, valid JSON object. Do NOT include any text, explanations, or markdown fences (like \`\`\`json\`) outside of the JSON object. Your response should start with \`{\` and end with \`}\`.
        2.  **Schema Adherence**: The JSON object MUST strictly conform to the following TypeScript interfaces for \`SlideDeck\`, \`Slide\`, and \`SlideElement\`.
            \`\`\`typescript
            // The main container for the presentation
            interface SlideDeck {
              slides: Slide[];
              theme?: 'light' | 'dark' | 'business';
            }

            // Represents a single slide in the deck
            interface Slide {
              id: string; // A unique identifier for the slide
              layout: 'title_slide' | 'title_and_content' | 'section_header' | 'two_column' | 'blank';
              elements: SlideElement[];
              isLocked?: boolean; // Must be false for all generated slides
              notes?: string; // Optional speaker notes
            }

            // Union type for all possible elements on a slide
            type SlideElement = TextboxElement | ImageElement | TableElement | ChartElement | FlowchartElement;

            // Base interface for all elements
            interface BaseSlideElement {
              id: string; // A unique identifier for the element
              type: 'textbox' | 'image' | 'table' | 'chart' | 'flowchart';
              position: { x: number; y: number; width: number; height: number; }; // Position in percentages
            }

            // For displaying text
            interface TextboxElement extends BaseSlideElement {
              type: 'textbox';
              content: string; // IMPORTANT: The text content field MUST be named "content".
            }
            
            // For displaying an image from the source materials
            interface ImageElement extends BaseSlideElement {
              type: 'image';
              // You MUST find a relevant image from the source materials and reference its properties here.
              // These IDs must correspond to actual data in the sources provided.
              subStepId: string;
              actionItemId: string; 
              attachmentId: string;
            }

            // For displaying a flowchart of sub-steps
            interface FlowchartElement extends BaseSlideElement {
                type: 'flowchart';
                // You MUST copy the entire 'subSteps' array from the source task data into this field.
                data: {
                    subSteps: any[]; 
                };
            }
            \`\`\`
        3.  **Content Synthesis**:
            *   Analyze ALL provided source materials to create a coherent 4-7 slide presentation that directly addresses the user's objective.
            *   If image sources are provided, you MUST incorporate them into the slides using the 'image' element type.
            *   Do not just copy-paste. Interpret, summarize, and visualize the information effectively.
        4.  **Language**: The output language MUST be Japanese.
        5.  **IDs**: Generate unique string IDs for all 'id' fields in slides and elements.

        **SOURCE MATERIALS FOLLOW**:
    `},..._2(e)];r.push({text:`
Reminder: Create the slide deck now based on the objective and all the sources provided above. The response must be only the JSON object.`});try{const a=await Kt.models.generateContent({model:aa,contents:{parts:r},config:{responseMimeType:"application/json"}}),l=Ta(a.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the custom slide deck.");return l}catch(a){ia(a,"custom slide deck generation")}},UM=async(e,t)=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are an expert project analyst. Your task is to write a text-based report based on a specific user objective and a collection of source materials.
        USER OBJECTIVE:
        "${t}"
        INSTRUCTIONS:
        1.  Synthesize the information from ALL provided source materials to create a coherent and insightful report that directly addresses the user's objective.
        2.  Do not simply copy-paste data. Interpret and summarize the information in a clear, professional manner.
        3.  Format the output using Markdown for readability (e.g., use headings, bullet points, bold text).
        4.  If image sources are provided, reference them by name in your report (e.g., "(see image: 'chart.png')"). Do not try to embed them.
        5.  The language of the output should be Japanese.
        6.  Your response MUST be only the text report. Do not include any other explanations.
        SOURCE MATERIALS FOLLOW:
    `},..._2(e)];r.push({text:`
Reminder: Write the report now based on the objective and all the sources provided above. The response must be only the text report.`});try{return(await Kt.models.generateContent({model:aa,contents:{parts:r}})).text}catch(a){ia(a,"custom text report generation")}},Sv=async(e,t,n)=>{if(!Kt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a project management assistant AI. Your task is to convert a project structure into data for a Gantt chart.
      CONTEXT:
      - Project Goal: "${t}"
      - Project Start Date: "${new Date().toISOString().split("T")[0]}"
      - Project Target End Date: "${n}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(xs(e),null,2)}

      INSTRUCTIONS:
      1.  Create a flat list of items for the Gantt chart. Include every ProjectTask, every SubStep, and every ActionItem from all tasks.
      2.  For each item, generate a JSON object with this exact structure:
          { "id": "string", "name": "string", "start": "YYYY-MM-DD", "end": "YYYY-MM-DD", "progress": number, "dependencies": ["string"], "type": "'task' | 'substep' | 'actionitem'", "parentId": "string | null" }
      3.  **Date Estimation**:
          - The project must fit between the start and target dates.
          - Use an item's \`dueDate\` as its 'end' date if available for tasks and sub-steps.
          - Estimate 'start' and 'end' dates logically. An item must start after its dependencies end.
          - For 'actionitem', estimate a short duration (e.g., 1-2 days) within the parent sub-step's timeframe.
      4.  **Progress Calculation**:
          - For a 'task': 'Completed' is 100, 'Not Started' is 0. For 'In Progress' or 'Blocked', average the progress of its sub-steps. If no sub-steps, 'In Progress' is 50.
          - For a 'substep': Calculate progress from its \`actionItems\` (% of completed items). If no action items, use its \`status\`: 'Completed' is 100, 'In Progress' is 50, 'Not Started' is 0.
          - For an 'actionitem': 'completed: true' is 100, 'completed: false' is 0.
      5.  **Dependencies & Parent ID**:
          - **Rule**: The 'dependencies' array models the sequential workflow. A dependency can ONLY exist between items of the SAME \`type\` AND with the SAME \`parentId\`.
          - **Tasks**: A task's 'parentId' is ALWAYS null. Use \`nextTaskIds\` to establish dependencies between tasks.
          - **Sub-steps**: A sub-step's 'parentId' MUST BE the ID of its parent ProjectTask. Use \`nextSubStepIds\` to establish dependencies ONLY between sub-steps within the same task.
          - **Action Items**: An action item's 'parentId' MUST BE the ID of its parent SubStep. Create sequential dependencies ONLY between action items within the same sub-step (item 2 depends on item 1, etc.).
          - **CRITICAL**: Do NOT create dependencies across different parents (e.g., from a sub-step in Task A to one in Task B) or across different types (e.g., from a task to a sub-step).
      6.  Your response MUST be a single, valid JSON array of GanttItem objects. Do not use markdown.
    `;try{const a=await Kt.models.generateContent({model:aa,contents:r,config:{responseMimeType:"application/json"}}),l=Ta(a.text);if(!l||!Array.isArray(l))throw new Error("AI returned an invalid format for the Gantt chart data.");return l}catch(a){ia(a,"Gantt chart data generation")}},na=({size:e="md",color:t="border-blue-500",text:n})=>{const r={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return g.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[g.jsx("div",{className:`animate-spin rounded-full border-4 ${t} border-t-transparent ${r[e]}`}),n&&g.jsx("p",{className:"text-slate-600 text-sm",children:n})]})},S2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18.75h.008v.008H9.75v-.008ZM7.5 18.75h.008v.008H7.5v-.008ZM14.25 15h.008v.008H14.25v-.008ZM16.5 15h.008v.008H16.5v-.008ZM14.25 18.75h.008v.008H14.25v-.008ZM16.5 18.75h.008v.008H16.5v-.008Z"})}),w2=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m12 12 4.243 4.243"})]}),BM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),VM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),sa=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),C2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),A2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),uf=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),kh=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Ya=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),ff=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Lo=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),Nh=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a15.055 15.055 0 0 1-3 0M12.75 4.5v-.75a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75m0 0A2.25 2.25 0 0 0 9.75 6.75h4.5A2.25 2.25 0 0 0 12.75 4.5M12 18.75h.008v.008H12v-.008Z"})}),ju=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),HM=({title:e,...t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[e&&g.jsx("title",{children:e}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75V12m0 0H9.75M12 12h2.25m-2.25 0V9.75M12 12v2.25m0 0H9.75M12 14.25h2.25M12 6.75a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Zm0 0V3m0 3.75h.008v.008H12V6.75Zm-5.25 0H3.75m0 0V3m0 3.75h.008v.008H3.75V6.75Zm10.5 0h2.25m0 0V3m0 3.75h.008v.008H16.5V6.75Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),df=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75h16.5v16.5H3.75V3.75Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3 6-6"})]}),hf=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25-2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"})}),GM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),mf=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),b2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),zM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),jM=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113A.375.375 0 0 1 9.75 15.113V8.887c0-.286.307-.466.557-.332l5.603 3.118Z"})]}),qM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),$M=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),YM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125A3.375 3.375 0 005.625 4.5h12.75c1.72 0 3.125 1.119 3.375 2.625M9.75 10.5h4.5m-4.5 3h4.5M11.25 3v1.5m0 15V21m0-16.5a1.5 1.5 0 00-3 0V21a1.5 1.5 0 003 0V3.062A3.375 3.375 0 0112 2.25c.465 0 .91.095 1.312.281M14.25 9a3 3 0 10-6 0 3 3 0 006 0z"})}),wv=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),k2=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008H16.5V3.75zm-3.75 0h.008v.008H12.75V3.75zm-3.75 0h.008v.008H9V3.75zm-3.75 0h.008v.008H5.25V3.75z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.5h18M9.75 16.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-4.5z"})]}),WM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),N2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),M2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15 6-6m0 0-6-6m6 6H3a6 6 0 0 0 0 12h3"})}),Mi=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81"})}),Yo=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m0 0H3.375c-.621 0-1.125-.504-1.125-1.125v-12.75c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v12.75c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m17.25 0v-12.75a1.125 1.125 0 0 0-1.125-1.125H3.375A1.125 1.125 0 0 0 2.25 4.5v12.75c0 .621.504 1.125 1.125 1.125M12 4.5v15m0 0H9m3 0h3"})}),XM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...e,children:g.jsx("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z",clipRule:"evenodd"})}),JM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...e,children:g.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2.5a2.5 2.5 0 00-2.5 2.5V9h5V7a2.5 2.5 0 00-2.5-2.5z"})}),lc=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.5 17.25l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 13.5l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 17.25l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),R2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5H18v2.25H6.75V7.5zM3 12h3v6.75a2.25 2.25 0 002.25 2.25h9.75a2.25 2.25 0 002.25-2.25V12h3m-3.498 6.75H15"})}),Md=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 11.25v-4.5m0 4.5h-4.5m4.5 0L15 15"})}),Rd=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9V4.5M15 9h4.5M15 9l5.25-5.25M15 15v4.5M15 15h4.5M15 15l5.25 5.25"})}),D2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),Wo=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),Xo=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...e,children:g.jsx("path",{d:"M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),fs=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...e,children:g.jsx("path",{d:"M7.247 11.14l-4.796-5.481c-.566-.647-.106-1.659.753-1.659h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}),I2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25z"})}),KM=({onSubmit:e,isLoading:t,onImportProject:n,onLoadTemplate:r,initialGoal:a="",initialDate:l=""})=>{const[c,u]=xe.useState(a),[p,m]=xe.useState(l),x=xe.useRef(null);Fi.useEffect(()=>{u(a)},[a]),Fi.useEffect(()=>{m(l)},[l]);const y=new Date().toISOString().split("T")[0],_=M=>{if(M.preventDefault(),!c.trim()||!p){alert("");return}e(c,p)},E=()=>{var M;(M=x.current)==null||M.click()},S=M=>{var b;const k=(b=M.target.files)==null?void 0:b[0];k&&(n(k),M.target.value="")},w=M=>{if(!c.trim()||!p){alert("");return}r(M,c,p)},C=({template:M,title:k,description:b,disabled:U})=>g.jsxs("button",{type:"button",onClick:()=>w(M),disabled:U,className:"text-left p-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105",children:[g.jsx("div",{className:"font-semibold text-md",children:k}),g.jsx("div",{className:"text-xs text-purple-200 mt-1",children:b})]});return g.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[g.jsxs("div",{className:"w-full max-w-2xl bg-white shadow-2xl rounded-xl p-8 md:p-12",children:[g.jsxs("div",{className:"text-center mb-10",children:[g.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"AI"}),g.jsx("p",{className:"text-slate-600 text-lg",children:"AI"})]}),g.jsxs("form",{onSubmit:_,className:"space-y-6",children:[g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"projectGoal",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[g.jsx(w2,{className:"w-5 h-5 mr-2 text-blue-600"})," ()"]}),g.jsx("textarea",{id:"projectGoal",value:c,onChange:M=>u(M.target.value),placeholder:": E1000",rows:3,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100 placeholder-slate-400"})]}),g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"targetDate",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[g.jsx(S2,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),g.jsx("input",{type:"date",id:"targetDate",value:p,onChange:M=>m(M.target.value),min:y,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100",style:{colorScheme:"dark"}})]}),g.jsx("p",{className:"text-sm text-slate-500 text-center",children:""}),g.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[g.jsx("button",{type:"submit",disabled:t,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:t?g.jsx(na,{size:"sm",color:"border-white"}):"AI"}),g.jsxs("button",{type:"button",onClick:E,disabled:t,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:[g.jsx(A2,{className:"w-5 h-5 mr-2"})," (.json)"]}),g.jsx("input",{type:"file",ref:x,onChange:S,accept:".json",className:"hidden","aria-hidden":"true"})]}),g.jsxs("div",{className:"sm:col-span-2 pt-4",children:[g.jsx("p",{className:"text-center text-sm font-semibold text-slate-600 mb-3",children:":"}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[g.jsx(C,{template:"process-design",disabled:t,title:" (APQP)",description:"APQP"}),g.jsx(C,{template:"process-change",disabled:t,title:" (ISO/IATF)",description:""}),g.jsx(C,{template:"new-product-eval",disabled:t,title:"",description:""}),g.jsx(C,{template:"improvement-project",disabled:t,title:"",description:"DMAIC"}),g.jsx(C,{template:"equipment-modification",disabled:t,title:"",description:""})]})]})]})]}),g.jsx("footer",{className:"mt-12 text-center",children:g.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},Su=e=>{switch(e){case bt.IN_PROGRESS:return{icon:g.jsx(jM,{className:"w-3.5 h-3.5"}),color:"text-blue-700",text:"",bgColor:"bg-blue-100"};case bt.COMPLETED:return{icon:g.jsx(ff,{className:"w-3.5 h-3.5"}),color:"text-green-700",text:"",bgColor:"bg-green-100"};case bt.BLOCKED:return{icon:g.jsx(qM,{className:"w-3.5 h-3.5"}),color:"text-red-700",text:"",bgColor:"bg-red-100"};case bt.NOT_STARTED:default:return{icon:g.jsx(zM,{className:"w-3.5 h-3.5"}),color:"text-slate-600",text:"",bgColor:"bg-slate-100"}}},ZM=({task:e,onSelectTask:t,onRemoveTask:n,onUpdateStatus:r,onDragCardStart:a,index:l,cardRef:c,onStartConnection:u,onEndConnection:p})=>{var X,F,W,O;const[m,x]=xe.useState(!1),y=xe.useRef(null);xe.useEffect(()=>{const te=ne=>{y.current&&!y.current.contains(ne.target)&&x(!1)};return document.addEventListener("mousedown",te),()=>{document.removeEventListener("mousedown",te)}},[y]);const _=te=>{r(e.id,te),x(!1)},E=(X=e.extendedDetails)==null?void 0:X.numericalTarget;let S="text-slate-500";E&&(E.status===jd.ACHIEVED?S="text-green-600":E.status===jd.MISSED?S="text-red-600":S="text-yellow-600");const w=Su(e.status),C=(F=e.extendedDetails)==null?void 0:F.dueDate,M=C?new Date(C+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"short",day:"numeric"}):null,k=e.status===bt.IN_PROGRESS,b="task-card-in-flow bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 w-80 md:w-96 m-1 cursor-grab active:cursor-grabbing",U=k?"border-4 border-blue-500 ring-2 ring-blue-500 ring-offset-1":"border border-transparent",G=te=>{te.stopPropagation(),u(e.id,te)};return g.jsxs("div",{ref:c,id:`taskcard-${e.id}`,draggable:"true",onDragStart:te=>a(te,e.id),onMouseUp:()=>p(e.id),className:`${b} ${U}`,style:{position:"absolute",left:((W=e.position)==null?void 0:W.x)||0,top:((O=e.position)==null?void 0:O.y)||0,touchAction:"none"},children:[g.jsxs("div",{className:"p-5 relative",children:[g.jsx("div",{onMouseDown:G,className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-500 border-2 border-white rounded-full cursor-crosshair hover:scale-125 transition-transform z-10",title:""}),g.jsxs("div",{className:"flex items-start justify-between mb-2",children:[g.jsxs("div",{className:"flex items-center flex-grow min-w-0 mr-2",children:[g.jsx("span",{className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-xs mr-3 flex-shrink-0",children:l+1}),g.jsx("div",{className:"flex-grow min-w-0",children:g.jsx("div",{className:"text-lg font-bold text-slate-900 break-words","aria-label":`task title for ${e.title}`,children:e.title})})]}),g.jsxs("div",{className:"flex space-x-1 flex-shrink-0 items-center",children:[E&&g.jsx(HM,{className:`w-5 h-5 ${S}`,title:`: ${E.description} (${E.status})`}),g.jsx("button",{onClick:te=>{te.stopPropagation(),t(e)},className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded-full hover:bg-blue-100",title:"","aria-label":`: ${e.title}`,children:g.jsx(VM,{className:"w-5 h-5"})}),g.jsx("button",{onClick:te=>{te.stopPropagation(),n(e.id)},className:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-100",title:"","aria-label":`: ${e.title}`,children:g.jsx(Ya,{className:"w-5 h-5"})})]})]}),g.jsx("div",{className:"h-20 mb-3",children:g.jsx("p",{className:"text-slate-800 text-sm leading-relaxed line-clamp-4 overflow-hidden h-full",children:e.description})}),g.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2",children:[g.jsxs("div",{className:"relative",ref:y,children:[g.jsxs("button",{onClick:()=>x(te=>!te),className:`inline-flex items-center px-2 py-0.5 rounded-full cursor-pointer ${w.bgColor} ${w.color} hover:ring-2 hover:ring-offset-1 hover:ring-blue-400 transition-all`,title:"",children:[Fi.cloneElement(w.icon,{className:`w-3 h-3 mr-1 ${w.color}`}),w.text]}),m&&g.jsx("div",{className:"absolute bottom-full mb-1 w-36 bg-white border border-slate-200 rounded-md shadow-lg z-20 py-1",children:Object.values(bt).map(te=>g.jsxs("button",{onClick:()=>_(te),className:"w-full text-left px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 flex items-center",children:[Fi.cloneElement(Su(te).icon,{className:`w-3.5 h-3.5 mr-2 ${Su(te).color}`}),Su(te).text]},te))})]}),M&&g.jsxs("div",{className:"flex items-center text-orange-600",children:[g.jsx(b2,{className:"w-3.5 h-3.5 mr-1"}),": ",M]})]})]}),g.jsx("button",{onClick:te=>{te.stopPropagation(),t(e)},className:"block w-full text-left bg-slate-100 hover:bg-slate-200 text-blue-700 font-medium py-3 px-5 transition-colors text-xs border-t border-slate-200",children:" "})]})},QM=xe.memo(ZM),Jo=({from:e,to:t,id:n,onDelete:r})=>{const c=e.x,u=t.x,p=(c+u)/2,m=(e.y+t.y)/2,x=`M${c},${e.y} C${c+50},${e.y} ${u-50},${t.y} ${u},${t.y}`;return g.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},"aria-hidden":"true",children:[g.jsx("defs",{children:g.jsx("marker",{id:`arrowhead-${n}`,markerWidth:8,markerHeight:8*.7,refX:8,refY:8*.35,orient:"auto",markerUnits:"strokeWidth",children:g.jsx("path",{d:`M0,0 L8,${8*.35} L0,${8*.7} Z`,fill:"#64748b"})})}),g.jsxs("g",{style:{pointerEvents:r?"auto":"none"},children:[g.jsx("path",{d:x,stroke:"#64748b",strokeWidth:2,markerEnd:`url(#arrowhead-${n})`,fill:"none"}),g.jsx("path",{d:x,stroke:"transparent",strokeWidth:"16",fill:"none",className:r?"cursor-pointer group":"",onClick:r}),r&&g.jsxs("g",{transform:`translate(${p}, ${m})`,className:"opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:r,children:[g.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"white",stroke:"#ef4444",strokeWidth:"1"}),g.jsx("path",{d:"M -3.5 -3.5 L 3.5 3.5 M -3.5 3.5 L 3.5 -3.5",stroke:"#ef4444",strokeWidth:"1.5",strokeLinecap:"round"})]})]})]})},eR=({tasks:e,onClose:t})=>{const[n,r]=xe.useState("all"),[a,l]=xe.useState(""),[c,u]=xe.useState(null),p=xe.useMemo(()=>{const S=[];return e.forEach(w=>{var C,M;(M=(C=w.extendedDetails)==null?void 0:C.subSteps)==null||M.forEach(k=>{var b;(b=k.actionItems)==null||b.forEach(U=>{S.push({actionItem:U,subStep:k,task:w})})})}),S},[e]),m=xe.useMemo(()=>p.filter(S=>n==="completed"?S.actionItem.completed:n==="pending"?!S.actionItem.completed:!0).filter(S=>{const w=a.toLowerCase();return S.actionItem.text.toLowerCase().includes(w)||S.subStep.text.toLowerCase().includes(w)||(S.subStep.responsible||"").toLowerCase().includes(w)||S.task.title.toLowerCase().includes(w)}),[p,n,a]),x=xe.useMemo(()=>{let S=[...m];return c!==null&&S.sort((w,C)=>{let M="",k="";switch(c.key){case"status":M=w.actionItem.completed,k=C.actionItem.completed;break;case"actionItem":M=w.actionItem.text.toLowerCase(),k=C.actionItem.text.toLowerCase();break;case"responsible":M=(w.subStep.responsible||"").toLowerCase(),k=(C.subStep.responsible||"").toLowerCase();break;case"subStep":M=w.subStep.text.toLowerCase(),k=C.subStep.text.toLowerCase();break;case"task":M=w.task.title.toLowerCase(),k=C.task.title.toLowerCase();break;case"dueDate":M=w.actionItem.dueDate||w.subStep.dueDate||"9999-12-31",k=C.actionItem.dueDate||C.subStep.dueDate||"9999-12-31";break}return M<k?c.direction==="ascending"?-1:1:M>k?c.direction==="ascending"?1:-1:0}),S},[m,c]),y=S=>{let w="ascending";c&&c.key===S&&c.direction==="ascending"&&(w="descending"),u({key:S,direction:w})},_=S=>!c||c.key!==S?g.jsx(Xo,{className:"w-3 h-3 ml-1 opacity-20"}):c.direction==="ascending"?g.jsx(Xo,{className:"w-3 h-3 ml-1 text-blue-600"}):g.jsx(fs,{className:"w-3 h-3 ml-1 text-blue-600"}),E=({sortKey:S,label:w,className:C})=>g.jsx("th",{scope:"col",className:`px-6 py-3 ${C||""}`,children:g.jsxs("button",{onClick:()=>y(S),className:"flex items-center gap-1 hover:text-blue-600 transition-colors",children:[w,_(S)]})});return g.jsxs("div",{className:"fixed inset-0 bg-slate-100 z-[60] flex flex-col",children:[g.jsx("header",{className:"flex-shrink-0 bg-white shadow-md",children:g.jsxs("div",{className:"flex items-center justify-between p-4 border-b w-full max-w-7xl mx-auto",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[g.jsx(C2,{className:"w-5 h-5"}),""]})]})}),g.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden p-4 w-full max-w-7xl mx-auto",children:[g.jsx("div",{className:"p-4 flex-shrink-0 bg-white rounded-t-lg border-x border-t",children:g.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[g.jsx("input",{type:"text",placeholder:"...",value:a,onChange:S=>l(S.target.value),className:"px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm w-full sm:w-auto flex-grow"}),g.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 p-1",children:[g.jsx("button",{onClick:()=>r("all"),className:`px-3 py-1 text-sm rounded-md ${n==="all"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),g.jsx("button",{onClick:()=>r("pending"),className:`px-3 py-1 text-sm rounded-md ${n==="pending"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),g.jsx("button",{onClick:()=>r("completed"),className:`px-3 py-1 text-sm rounded-md ${n==="completed"?"bg-white shadow":"hover:bg-slate-200"}`,children:""})]})]})}),g.jsx("div",{className:"flex-grow overflow-y-auto bg-white rounded-b-lg border",children:g.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[g.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-100 sticky top-0 z-10",children:g.jsxs("tr",{children:[g.jsx(E,{sortKey:"status",label:"",className:"w-24"}),g.jsx(E,{sortKey:"actionItem",label:""}),g.jsx(E,{sortKey:"responsible",label:""}),g.jsx(E,{sortKey:"subStep",label:""}),g.jsx(E,{sortKey:"task",label:""}),g.jsx(E,{sortKey:"dueDate",label:""})]})}),g.jsxs("tbody",{className:"divide-y divide-slate-200",children:[x.map(({actionItem:S,subStep:w,task:C},M)=>g.jsxs("tr",{className:"hover:bg-slate-50",children:[g.jsx("td",{className:"px-6 py-3",children:S.completed?g.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[g.jsx(df,{className:"w-4 h-4 mr-1"}),""]}):g.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[g.jsx(hf,{className:"w-4 h-4 mr-1"}),""]})}),g.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:S.text}),g.jsx("td",{className:"px-6 py-3",children:w.responsible||""}),g.jsx("td",{className:"px-6 py-3",children:w.text}),g.jsx("td",{className:"px-6 py-3",children:C.title}),g.jsx("td",{className:"px-6 py-3",children:S.dueDate||w.dueDate?new Date((S.dueDate||w.dueDate)+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):""})]},S.id+M)),x.length===0&&g.jsx("tr",{children:g.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:""})})]})]})})]})]})},Cv={"On Track":{bgColor:"bg-green-100",textColor:"text-green-800",icon:g.jsx(ff,{className:"w-12 h-12 text-green-500"})},"At Risk":{bgColor:"bg-yellow-100",textColor:"text-yellow-800",icon:g.jsx(Lo,{className:"w-12 h-12 text-yellow-500"})},"Off Track":{bgColor:"bg-red-100",textColor:"text-red-800",icon:g.jsx(Lo,{className:"w-12 h-12 text-red-500"})},Unknown:{bgColor:"bg-slate-100",textColor:"text-slate-800",icon:g.jsx(Lo,{className:"w-12 h-12 text-slate-500"})}},tR=({report:e,onClose:t})=>{if(!e)return null;const n=Cv[e.overallStatus]||Cv.Unknown;return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),g.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-slate-100",children:g.jsx(sa,{className:"w-6 h-6 text-slate-500"})})]}),g.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[g.jsxs("section",{className:`p-6 rounded-lg flex items-center gap-6 ${n.bgColor}`,children:[g.jsx("div",{className:"flex-shrink-0",children:n.icon}),g.jsxs("div",{children:[g.jsx("h4",{className:`text-2xl font-bold ${n.textColor}`,children:e.overallStatus}),g.jsx("p",{className:`mt-1 text-base ${n.textColor}`,children:e.summary})]})]}),g.jsxs("section",{children:[g.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[g.jsx(ff,{className:"w-5 h-5 mr-2 text-green-500"}),""]}),g.jsx("ul",{className:"list-disc list-inside space-y-2 text-slate-600 pl-2",children:e.positivePoints.map((r,a)=>g.jsx("li",{children:r},a))})]}),g.jsxs("section",{children:[g.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[g.jsx(Lo,{className:"w-5 h-5 mr-2 text-yellow-500"}),""]}),g.jsx("div",{className:"space-y-3",children:e.areasOfConcern.map((r,a)=>g.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[g.jsx("p",{className:"font-semibold text-yellow-800",children:r.description}),r.relatedTaskIds.length>0&&g.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["ID: ",r.relatedTaskIds.join(", ")]})]},a))})]}),g.jsxs("section",{children:[g.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[g.jsx(Nh,{className:"w-5 h-5 mr-2 text-blue-500"}),"AI"]}),g.jsx("div",{className:"space-y-3",children:e.suggestions.map((r,a)=>g.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:g.jsx("p",{className:"text-blue-800",children:r})},a))})]})]}),g.jsx("footer",{className:"p-4 bg-slate-50 border-t flex justify-end",children:g.jsx("button",{onClick:t,className:"px-5 py-2 text-sm font-medium text-white bg-slate-600 rounded-md hover:bg-slate-700",children:""})})]})})},Av=e=>{const t=Math.cos(2*Math.PI*e),n=Math.sin(2*Math.PI*e);return[t,n]},nR=({data:e,title:t})=>{const n=e.reduce((c,u)=>c+u.value,0);if(n===0)return g.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data to display"});let r=0;const a=["#4a90e2","#50e3c2","#f5a623","#f8e71c","#7ed321","#9013fe"],l=e.map((c,u)=>{const p=c.value/n,[m,x]=Av(r);r+=p;const[y,_]=Av(r),E=p>.5?1:0;return{path:[`M ${m} ${x}`,`A 1 1 0 ${E} 1 ${y} ${_}`,"L 0 0"].join(" "),color:a[u%a.length],label:c.label}});return g.jsxs("div",{className:"w-full h-full flex flex-col bg-white p-2",children:[g.jsx("text",{x:"50%",y:"10",textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",className:"block text-center",children:t}),g.jsxs("div",{className:"flex-grow flex items-center",children:[g.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-2/3 h-full",children:l.map((c,u)=>g.jsx("path",{d:c.path,fill:c.color},u))}),g.jsx("div",{className:"w-1/3 text-[8px] space-y-1",children:l.map((c,u)=>g.jsxs("div",{className:"flex items-center",children:[g.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:c.color}}),g.jsx("span",{className:"truncate",children:c.label})]},u))})]})]})},rR=({data:e,title:t})=>{const n=Math.max(...e.map(m=>m.value),0),r=300,a=150,l={top:20,right:10,bottom:30,left:30},c=r-l.left-l.right,u=a-l.top-l.bottom,p=e.map((m,x)=>{const y=x/(e.length-1)*c,_=u-m.value/n*u;return`${y},${_}`}).join(" ");return g.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[g.jsx("text",{x:r/2,y:l.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:t}),g.jsxs("g",{transform:`translate(${l.left}, ${l.top})`,children:[g.jsx("line",{x1:"0",y1:"0",x2:"0",y2:u,stroke:"#ddd",strokeWidth:"0.5"}),g.jsx("line",{x1:"0",y1:u,x2:c,y2:u,stroke:"#ddd",strokeWidth:"0.5"}),g.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1.5",points:p}),e.map((m,x)=>{const y=x/(e.length-1)*c,_=u-m.value/n*u;return g.jsx("circle",{cx:y,cy:_,r:"2",fill:"#4a90e2"},x)})]})]})},aR=({data:e,title:t})=>{const n=Math.max(...e.map(m=>m.value),0),r=300,a=150,l={top:20,right:10,bottom:30,left:30},c=r-l.left-l.right,u=a-l.top-l.bottom,p=e.length>0?c/e.length*.8:0;return g.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[g.jsx("text",{x:r/2,y:l.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:t}),g.jsxs("g",{transform:`translate(${l.left}, ${l.top})`,children:[g.jsx("line",{x1:"0",y1:"0",x2:"0",y2:u,stroke:"#999",strokeWidth:"0.5"}),[0,n/2,n].map(m=>g.jsxs("g",{transform:`translate(0, ${u-m/n*u})`,children:[g.jsx("line",{x1:"-3",y1:"0",x2:"0",y2:"0",stroke:"#999",strokeWidth:"0.5"}),g.jsx("text",{x:"-5",y:"3",textAnchor:"end",fontSize:"6",fill:"#666",children:m.toFixed(0)})]},m)),e.map((m,x)=>g.jsxs("g",{transform:`translate(${x*c/e.length+c/e.length*.1}, 0)`,children:[g.jsx("rect",{x:"0",y:u-m.value/n*u,width:p,height:m.value/n*u,fill:"#4a90e2"}),g.jsx("text",{x:p/2,y:u+8,textAnchor:"middle",fontSize:"6",fill:"#666",transform:`rotate(-45, ${p/2}, ${u+8})`,children:m.label})]},m.label))]})]})},iR=({subStep:e,statusColor:t})=>{var n,r;return g.jsx("div",{style:{position:"absolute",left:((n=e.position)==null?void 0:n.x)||0,top:((r=e.position)==null?void 0:r.y)||0,width:192,minHeight:76,padding:"8px",borderRadius:"8px",backgroundColor:"white",borderLeft:`4px solid ${t}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px",fontFamily:"sans-serif",color:"#333",display:"flex",flexDirection:"column",justifyContent:"center"},children:g.jsx("p",{className:`font-bold break-words ${e.status===ir.COMPLETED?"line-through text-slate-500":""}`,children:e.text})})},sR=({subSteps:e})=>{if(!e||e.length===0)return g.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 text-slate-500 text-sm",children:"No sub-steps to display."});const t=c=>{switch(c){case ir.COMPLETED:return"#22c55e";case ir.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},n=192,r=76,a=xe.useMemo(()=>{const c=[];return(e||[]).forEach(u=>{var p;if((p=u==null?void 0:u.nextSubStepIds)!=null&&p.length&&u.position){const m={x:u.position.x+n,y:u.position.y+r/2};u.nextSubStepIds.forEach(x=>{const y=e.find(_=>_.id===x);if(y&&y.position){const _={x:y.position.x,y:y.position.y+r/2};c.push({id:`fc-render-${u.id}-${x}`,from:m,to:_,sourceId:u.id,targetId:x})}})}}),c},[e,n,r]),l=xe.useMemo(()=>{if(!e||e.length===0)return{minX:0,minY:0,width:400,height:300};let c=0,u=0;return e.forEach(p=>{p.position&&(c=Math.max(c,p.position.x+n),u=Math.max(u,p.position.y+r))}),{minX:0,minY:0,width:c+20,height:u+20}},[e,n,r]);return g.jsx("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{fontFamily:"Inter, sans-serif"},children:g.jsxs("svg",{width:"100%",height:"100%",viewBox:`${l.minX} ${l.minY} ${l.width} ${l.height}`,children:[g.jsx("style",{children:`
                    .flowchart-card-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        font-family: Inter, sans-serif;
                    }
                    `}),g.jsx("foreignObject",{x:"0",y:"0",width:l.width,height:l.height,children:g.jsx("div",{className:"flowchart-card-container",children:(e||[]).map(c=>g.jsx(iR,{subStep:c,statusColor:t(c.status)},c.id))})}),a.map(c=>g.jsx(Jo,{from:c.from,to:c.to,id:c.id},c.id))]})})},lR=({el:e,onUpdate:t,children:n,isSelected:r,onClick:a})=>g.jsx("div",{onClick:l=>{l.stopPropagation(),a()},style:{position:"absolute",left:`${e.position.x}%`,top:`${e.position.y}%`,width:`${e.position.width}%`,height:`${e.position.height}%`,outline:r?"2px solid #3b82f6":"1px dashed transparent",cursor:"move"},className:"transition-all duration-150 hover:outline-dashed hover:outline-slate-400",children:n}),Mh=({tasks:e,initialDeck:t,onSave:n,onClose:r,generateUniqueId:a,projectGoal:l,targetDate:c,reportScope:u})=>{const[p,m]=xe.useState(t),[x,y]=xe.useState(0),[_,E]=xe.useState(null),[S,w]=xe.useState(!1),[C,M]=xe.useState(null),[k,b]=xe.useState(!1),U=xe.useRef(null),G=(re,q)=>{m(N=>({...N,slides:N.slides.map(j=>j.id===re?{...j,...typeof q=="function"?q(j):j}:j)}))},X=re=>{const q=p.slides[re];G(q.id,{isLocked:!q.isLocked})},F=(re,q,N)=>{G(re,j=>({elements:j.elements.map(R=>R.id===q?{...R,...N}:R)}))},W=async()=>{w(!0),M(null);try{const re={...p,slides:p.slides.map(j=>j.isLocked?j:{...j,isLocked:void 0})},q=await IM(re),N={...q,slides:q.slides.map((j,R)=>({...j,isLocked:p.slides[R].isLocked}))};m(N)}catch(re){M(re instanceof Error?re.message:"")}finally{w(!1)}},O=async()=>{w(!0),M(null);try{let re;u==="project"?re=await OM(p,e,l,c):re=await DM(p,e[0],l),m(re)}catch(re){M(re instanceof Error?re.message:"")}finally{w(!1)}},te=(re,q)=>{var N,j,R;for(const J of e){const Y=(j=(N=J.extendedDetails)==null?void 0:N.subSteps)==null?void 0:j.find(H=>H.id===re);if(Y){const H=(R=Y==null?void 0:Y.actionItems)==null?void 0:R.find(se=>se.id===q);if(H)return H}}},ne=re=>{var q,N,j,R,J;switch(re.type){case"textbox":const Y=re;return g.jsx("textarea",{value:Y.content,onChange:H=>F(p.slides[x].id,re.id,{content:H.target.value}),className:"w-full h-full bg-transparent resize-none border-none outline-none p-2",style:{fontSize:Y.fontSize,fontWeight:Y.fontWeight,textAlign:Y.textAlign,color:"#333"}});case"image":{const H=re,se=te(H.subStepId,H.actionItemId),Ee=(N=(q=se==null?void 0:se.report)==null?void 0:q.attachments)==null?void 0:N.find(ke=>ke.id===H.attachmentId);return Ee?g.jsx("img",{src:Ee.dataUrl,className:"w-full h-full object-contain",alt:Ee.name}):g.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"table":{const H=re,se=te(H.subStepId,H.actionItemId),Ee=(j=se==null?void 0:se.report)==null?void 0:j.matrixData;return Ee?g.jsx("div",{className:"p-2 overflow-auto h-full",children:g.jsxs("table",{className:"w-full text-[8px] border-collapse bg-white",children:[g.jsx("thead",{children:g.jsx("tr",{className:"bg-slate-200",children:Ee.headers.map((ke,De)=>g.jsx("th",{className:"border border-slate-300 p-1 font-semibold",children:ke},De))})}),g.jsx("tbody",{children:Ee.rows.map((ke,De)=>g.jsx("tr",{children:ke.map((Ce,Je)=>g.jsx("td",{className:"border border-slate-300 p-1",children:Ce},`${De}-${Je}`))},De))})]})}):g.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"chart":{const H=re,se=te(H.subStepId,H.actionItemId),Ee=(((J=(R=se==null?void 0:se.report)==null?void 0:R.matrixData)==null?void 0:J.rows)||[]).map(ke=>({label:ke[0],value:parseFloat(ke[1])||0})).filter(ke=>ke.label&&!isNaN(ke.value));if(Ee.length===0)return g.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""});switch(H.chartType){case"line":return g.jsx(rR,{data:Ee,title:H.title});case"pie":return g.jsx(nR,{data:Ee,title:H.title});case"bar":default:return g.jsx(aR,{data:Ee,title:H.title})}}case"flowchart":{const H=re;return H.data&&H.data.subSteps?g.jsx(sR,{subSteps:H.data.subSteps}):g.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}default:return null}},ee=()=>window.print(),Se=(re,q)=>{const N=JSON.stringify(re,null,2),j=new Blob([N],{type:"application/json"}),R=URL.createObjectURL(j),J=document.createElement("a");J.href=R,J.download=q,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(R)},Fe=re=>{re==="pdf"?ee():Se(p,"report-deck.json"),b(!1)},we=()=>{n(p),r()},ae=p.slides[x],me=u==="project"?`: ${l}`:`: ${e[0].title}`;return g.jsxs(g.Fragment,{children:[g.jsx("style",{children:"@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } .no-print { display: none !important; } .slide-print-page { page-break-after: always; width: 100vw; height: 56.25vw; /* 16:9 aspect ratio */ box-shadow: none !important; border: none; } }"}),g.jsxs("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-80 z-[100] flex flex-col p-4 no-print",onClick:()=>E(null),children:[g.jsxs("header",{className:"flex items-center justify-between pb-4 flex-shrink-0",children:[g.jsx("h2",{className:"text-xl font-bold text-white truncate pr-4",children:me}),g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsxs("button",{onClick:O,disabled:S,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[g.jsx(mf,{className:"w-4 h-4"})," ",S?"...":""]}),g.jsxs("button",{onClick:W,disabled:S,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[g.jsx(Nh,{className:"w-4 h-4"})," ",S?"...":"AI"]}),g.jsxs("div",{className:"relative",ref:U,children:[g.jsx("button",{onClick:()=>b(re=>!re),className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:g.jsx(uf,{className:"w-5 h-5"})}),k&&g.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-10",children:[g.jsx("button",{onClick:()=>Fe("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"PDF"}),g.jsx("button",{onClick:()=>Fe("json"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"JSON"})]})]}),g.jsxs("button",{onClick:r,className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:[" ",g.jsx(sa,{className:"w-5 h-5"})]}),g.jsx("button",{onClick:we,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold text-sm",children:""})]})]}),C&&g.jsx("div",{className:"text-red-400 text-sm mb-2 bg-red-100 border border-red-400 p-2 rounded-md",children:C}),g.jsxs("div",{className:"flex-grow flex gap-4 min-h-0",children:[g.jsx("aside",{className:"w-40 bg-slate-800 rounded-lg p-2 flex flex-col gap-2 overflow-y-auto",children:p.slides.map((re,q)=>g.jsxs("div",{onClick:()=>y(q),className:`relative group aspect-video bg-white rounded cursor-pointer transition-all p-1 ${x===q?"ring-4 ring-blue-500":"hover:ring-2 ring-blue-400"}`,children:[g.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-50 group-hover:opacity-100 transition-opacity",children:g.jsx("button",{onClick:N=>{N.stopPropagation(),X(q)},title:re.isLocked?"":"",className:`p-1 rounded-full ${re.isLocked?"bg-blue-600 text-white":"bg-slate-500 text-white"}`,children:re.isLocked?g.jsx(XM,{className:"w-3 h-3"}):g.jsx(JM,{className:"w-3 h-3"})})}),g.jsx("div",{className:"w-full h-full transform scale-[0.1] origin-top-left overflow-hidden relative",children:re.elements.map(N=>g.jsx("div",{style:{position:"absolute",left:`${N.position.x}%`,top:`${N.position.y}%`,width:`${N.position.width}%`,height:`${N.position.height}%`,backgroundColor:"#ccc"}},N.id))}),g.jsx("span",{className:"text-white text-xs block text-center -mt-2",children:q+1})]},re.id))}),g.jsx("main",{className:"flex-grow flex items-center justify-center",children:ae&&g.jsx("div",{className:"aspect-video w-full max-w-[100vh] bg-white shadow-2xl rounded-lg relative overflow-hidden",children:ae.elements.map(re=>g.jsx(lR,{el:re,onUpdate:()=>{},isSelected:_===re.id,onClick:()=>E(re.id),children:ne(re)},re.id))})}),g.jsxs("aside",{className:"w-64 bg-slate-800 rounded-lg p-3 text-white overflow-y-auto",children:[g.jsx("h3",{className:"font-bold border-b border-slate-600 pb-2 mb-3",children:""}),g.jsx("p",{className:"text-xs text-slate-400",children:""})]})]})]}),g.jsx("div",{className:"hidden print:block",children:p.slides.map((re,q)=>g.jsx("div",{className:"slide-print-page bg-white relative",children:g.jsx("div",{className:"w-full h-full relative",children:re.elements.map(N=>g.jsx("div",{style:{position:"absolute",left:`${N.position.x}%`,top:`${N.position.y}%`,width:`${N.position.width}%`,height:`${N.position.height}%`},children:ne(N)},N.id))})},re.id))})]})},oR=({onClose:e,onDownloadAndStartNew:t,onStartNewWithoutSaving:n})=>g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[g.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[g.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center",children:[g.jsx(Lo,{className:"w-6 h-6 mr-2 text-yellow-500"}),""]}),g.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:g.jsx(sa,{className:"w-5 h-5"})})]}),g.jsxs("div",{className:"p-6",children:[g.jsx("p",{className:"text-slate-700",children:""}),g.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"JSON"})]}),g.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 rounded-b-xl",children:[g.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),g.jsx("button",{type:"button",onClick:n,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md shadow-sm hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:""}),g.jsxs("button",{type:"submit",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[g.jsx(uf,{className:"w-4 h-4"}),""]})]})]})});function cR(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),t&&(r.href=t),a.href=e,a.href}const uR=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function Ri(e){const t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}let rl=null;function F2(e={}){return rl||(e.includeStyleProperties?(rl=e.includeStyleProperties,rl):(rl=Ri(window.getComputedStyle(document.documentElement)),rl))}function qu(e,t){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return r?parseFloat(r.replace("px","")):0}function fR(e){const t=qu(e,"border-left-width"),n=qu(e,"border-right-width");return e.clientWidth+t+n}function dR(e){const t=qu(e,"border-top-width"),n=qu(e,"border-bottom-width");return e.clientHeight+t+n}function L2(e,t={}){const n=t.width||fR(e),r=t.height||dR(e);return{width:n,height:r}}function hR(){let e,t;try{t=process}catch{}const n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const Cr=16384;function mR(e){(e.width>Cr||e.height>Cr)&&(e.width>Cr&&e.height>Cr?e.width>e.height?(e.height*=Cr/e.width,e.width=Cr):(e.width*=Cr/e.height,e.height=Cr):e.width>Cr?(e.height*=Cr/e.width,e.width=Cr):(e.width*=Cr/e.height,e.height=Cr))}function $u(e){return new Promise((t,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>t(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function pR(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function xR(e,t,n){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),l=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${t}`),a.setAttribute("height",`${n}`),a.setAttribute("viewBox",`0 0 ${t} ${n}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),a.appendChild(l),l.appendChild(e),pR(a)}const gr=(e,t)=>{if(e instanceof t)return!0;const n=Object.getPrototypeOf(e);return n===null?!1:n.constructor.name===t.name||gr(n,t)};function gR(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function vR(e,t){return F2(t).map(n=>{const r=e.getPropertyValue(n),a=e.getPropertyPriority(n);return`${n}: ${r}${a?" !important":""};`}).join(" ")}function yR(e,t,n,r){const a=`.${e}:${t}`,l=n.cssText?gR(n):vR(n,r);return document.createTextNode(`${a}{${l}}`)}function bv(e,t,n,r){const a=window.getComputedStyle(e,n),l=a.getPropertyValue("content");if(l===""||l==="none")return;const c=uR();try{t.className=`${t.className} ${c}`}catch{return}const u=document.createElement("style");u.appendChild(yR(c,n,a,r)),t.appendChild(u)}function TR(e,t,n){bv(e,t,":before",n),bv(e,t,":after",n)}const kv="application/font-woff",Nv="image/jpeg",_R={woff:kv,woff2:kv,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Nv,jpeg:Nv,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function ER(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Rh(e){const t=ER(e).toLowerCase();return _R[t]||""}function SR(e){return e.split(/,/)[1]}function ch(e){return e.search(/^(data:)/)!==-1}function wR(e,t){return`data:${t};base64,${e}`}async function O2(e,t,n){const r=await fetch(e,t);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((l,c)=>{const u=new FileReader;u.onerror=c,u.onloadend=()=>{try{l(n({res:r,result:u.result}))}catch(p){c(p)}},u.readAsDataURL(a)})}const Dd={};function CR(e,t,n){let r=e.replace(/\?.*/,"");return n&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),t?`[${t}]${r}`:r}async function Dh(e,t,n){const r=CR(e,t,n.includeQueryParams);if(Dd[r]!=null)return Dd[r];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let a;try{const l=await O2(e,n.fetchRequestInit,({res:c,result:u})=>(t||(t=c.headers.get("Content-Type")||""),SR(u)));a=wR(l,t)}catch(l){a=n.imagePlaceholder||"";let c=`Failed to fetch resource: ${e}`;l&&(c=typeof l=="string"?l:l.message),c&&console.warn(c)}return Dd[r]=a,a}async function AR(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):$u(t)}async function bR(e,t){if(e.currentSrc){const l=document.createElement("canvas"),c=l.getContext("2d");l.width=e.clientWidth,l.height=e.clientHeight,c==null||c.drawImage(e,0,0,l.width,l.height);const u=l.toDataURL();return $u(u)}const n=e.poster,r=Rh(n),a=await Dh(n,r,t);return $u(a)}async function kR(e,t){var n;try{if(!((n=e==null?void 0:e.contentDocument)===null||n===void 0)&&n.body)return await pf(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function NR(e,t){return gr(e,HTMLCanvasElement)?AR(e):gr(e,HTMLVideoElement)?bR(e,t):gr(e,HTMLIFrameElement)?kR(e,t):e.cloneNode(P2(e))}const MR=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",P2=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function RR(e,t,n){var r,a;if(P2(t))return t;let l=[];return MR(e)&&e.assignedNodes?l=Ri(e.assignedNodes()):gr(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?l=Ri(e.contentDocument.body.childNodes):l=Ri(((a=e.shadowRoot)!==null&&a!==void 0?a:e).childNodes),l.length===0||gr(e,HTMLVideoElement)||await l.reduce((c,u)=>c.then(()=>pf(u,n)).then(p=>{p&&t.appendChild(p)}),Promise.resolve()),t}function DR(e,t,n){const r=t.style;if(!r)return;const a=window.getComputedStyle(e);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):F2(n).forEach(l=>{let c=a.getPropertyValue(l);l==="font-size"&&c.endsWith("px")&&(c=`${Math.floor(parseFloat(c.substring(0,c.length-2)))-.1}px`),gr(e,HTMLIFrameElement)&&l==="display"&&c==="inline"&&(c="block"),l==="d"&&t.getAttribute("d")&&(c=`path(${t.getAttribute("d")})`),r.setProperty(l,c,a.getPropertyPriority(l))})}function IR(e,t){gr(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),gr(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function FR(e,t){if(gr(e,HTMLSelectElement)){const n=t,r=Array.from(n.children).find(a=>e.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function LR(e,t,n){return gr(t,Element)&&(DR(e,t,n),TR(e,t,n),IR(e,t),FR(e,t)),t}async function OR(e,t){const n=e.querySelectorAll?e.querySelectorAll("use"):[];if(n.length===0)return e;const r={};for(let l=0;l<n.length;l++){const u=n[l].getAttribute("xlink:href");if(u){const p=e.querySelector(u),m=document.querySelector(u);!p&&m&&!r[u]&&(r[u]=await pf(m,t,!0))}}const a=Object.values(r);if(a.length){const l="http://www.w3.org/1999/xhtml",c=document.createElementNS(l,"svg");c.setAttribute("xmlns",l),c.style.position="absolute",c.style.width="0",c.style.height="0",c.style.overflow="hidden",c.style.display="none";const u=document.createElementNS(l,"defs");c.appendChild(u);for(let p=0;p<a.length;p++)u.appendChild(a[p]);e.appendChild(c)}return e}async function pf(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(r=>NR(r,t)).then(r=>RR(e,r,t)).then(r=>LR(e,r,t)).then(r=>OR(r,t))}const U2=/url\((['"]?)([^'"]+?)\1\)/g,PR=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,UR=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function BR(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function VR(e){const t=[];return e.replace(U2,(n,r,a)=>(t.push(a),n)),t.filter(n=>!ch(n))}async function HR(e,t,n,r,a){try{const l=n?cR(t,n):t,c=Rh(t);let u;return a||(u=await Dh(l,c,r)),e.replace(BR(t),`$1${u}$3`)}catch{}return e}function GR(e,{preferredFontFormat:t}){return t?e.replace(UR,n=>{for(;;){const[r,,a]=PR.exec(n)||[];if(!a)return"";if(a===t)return`src: ${r};`}}):e}function B2(e){return e.search(U2)!==-1}async function V2(e,t,n){if(!B2(e))return e;const r=GR(e,n);return VR(r).reduce((l,c)=>l.then(u=>HR(u,c,t,n)),Promise.resolve(r))}async function al(e,t,n){var r;const a=(r=t.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(a){const l=await V2(a,null,n);return t.style.setProperty(e,l,t.style.getPropertyPriority(e)),!0}return!1}async function zR(e,t){await al("background",e,t)||await al("background-image",e,t),await al("mask",e,t)||await al("-webkit-mask",e,t)||await al("mask-image",e,t)||await al("-webkit-mask-image",e,t)}async function jR(e,t){const n=gr(e,HTMLImageElement);if(!(n&&!ch(e.src))&&!(gr(e,SVGImageElement)&&!ch(e.href.baseVal)))return;const r=n?e.src:e.href.baseVal,a=await Dh(r,Rh(r),t);await new Promise((l,c)=>{e.onload=l,e.onerror=t.onImageErrorHandler?(...p)=>{try{l(t.onImageErrorHandler(...p))}catch(m){c(m)}}:c;const u=e;u.decode&&(u.decode=l),u.loading==="lazy"&&(u.loading="eager"),n?(e.srcset="",e.src=a):e.href.baseVal=a})}async function qR(e,t){const r=Ri(e.childNodes).map(a=>H2(a,t));await Promise.all(r).then(()=>e)}async function H2(e,t){gr(e,Element)&&(await zR(e,t),await jR(e,t),await qR(e,t))}function $R(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const r=t.style;return r!=null&&Object.keys(r).forEach(a=>{n[a]=r[a]}),e}const Mv={};async function Rv(e){let t=Mv[e];if(t!=null)return t;const r=await(await fetch(e)).text();return t={url:e,cssText:r},Mv[e]=t,t}async function Dv(e,t){let n=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,l=(n.match(/url\([^)]+\)/g)||[]).map(async c=>{let u=c.replace(r,"$1");return u.startsWith("https://")||(u=new URL(u,e.url).href),O2(u,t.fetchRequestInit,({result:p})=>(n=n.replace(c,`url(${p})`),[c,p]))});return Promise.all(l).then(()=>n)}function Iv(e){if(e==null)return[];const t=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(n,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const p=a.exec(r);if(p===null)break;t.push(p[0])}r=r.replace(a,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,c="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(c,"gi");for(;;){let p=l.exec(r);if(p===null){if(p=u.exec(r),p===null)break;l.lastIndex=u.lastIndex}else u.lastIndex=l.lastIndex;t.push(p[0])}return t}async function YR(e,t){const n=[],r=[];return e.forEach(a=>{if("cssRules"in a)try{Ri(a.cssRules||[]).forEach((l,c)=>{if(l.type===CSSRule.IMPORT_RULE){let u=c+1;const p=l.href,m=Rv(p).then(x=>Dv(x,t)).then(x=>Iv(x).forEach(y=>{try{a.insertRule(y,y.startsWith("@import")?u+=1:a.cssRules.length)}catch(_){console.error("Error inserting rule from remote css",{rule:y,error:_})}})).catch(x=>{console.error("Error loading remote css",x.toString())});r.push(m)}})}catch(l){const c=e.find(u=>u.href==null)||document.styleSheets[0];a.href!=null&&r.push(Rv(a.href).then(u=>Dv(u,t)).then(u=>Iv(u).forEach(p=>{c.insertRule(p,c.cssRules.length)})).catch(u=>{console.error("Error loading remote stylesheet",u)})),console.error("Error inlining remote css file",l)}}),Promise.all(r).then(()=>(e.forEach(a=>{if("cssRules"in a)try{Ri(a.cssRules||[]).forEach(l=>{n.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${a.href}`,l)}}),n))}function WR(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>B2(t.style.getPropertyValue("src")))}async function XR(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Ri(e.ownerDocument.styleSheets),r=await YR(n,t);return WR(r)}function G2(e){return e.trim().replace(/["']/g,"")}function JR(e){const t=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(l=>{t.add(G2(l))}),Array.from(r.children).forEach(l=>{l instanceof HTMLElement&&n(l)})}return n(e),t}async function KR(e,t){const n=await XR(e,t),r=JR(e);return(await Promise.all(n.filter(l=>r.has(G2(l.style.fontFamily))).map(l=>{const c=l.parentStyleSheet?l.parentStyleSheet.href:null;return V2(l.cssText,c,t)}))).join(`
`)}async function ZR(e,t){const n=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await KR(e,t);if(n){const r=document.createElement("style"),a=document.createTextNode(n);r.appendChild(a),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function QR(e,t={}){const{width:n,height:r}=L2(e,t),a=await pf(e,t,!0);return await ZR(a,t),await H2(a,t),$R(a,t),await xR(a,n,r)}async function eD(e,t={}){const{width:n,height:r}=L2(e,t),a=await QR(e,t),l=await $u(a),c=document.createElement("canvas"),u=c.getContext("2d"),p=t.pixelRatio||hR(),m=t.canvasWidth||n,x=t.canvasHeight||r;return c.width=m*p,c.height=x*p,t.skipAutoScale||mR(c),c.style.width=`${m}`,c.style.height=`${x}`,t.backgroundColor&&(u.fillStyle=t.backgroundColor,u.fillRect(0,0,c.width,c.height)),u.drawImage(l,0,0,c.width,c.height),c}async function tD(e,t={}){return(await eD(e,t)).toDataURL()}const No=40,Fv=64,Lv=320,Ov=["#3B82F6","#F59E0B","#10B981","#EF4444","#6B7280","#6366F1","#EC4899","#8B5CF6"],nD=({data:e,onClose:t,onItemClick:n,onRegenerate:r,isRegenerating:a})=>{const[l,c]=xe.useState(!0),[u,p]=xe.useState(new Set),[m,x]=xe.useState("all"),y=xe.useRef(null),[_,E]=xe.useState(!1),[S,w]=xe.useState("day"),[C,M]=xe.useState({start:"",end:""}),b={day:40,week:15,month:5}[S],U=xe.useMemo(()=>{const re=new Map;return e.filter(q=>q.type==="task").forEach((q,N)=>{re.set(q.id,Ov[N%Ov.length])}),re},[e]),G=xe.useCallback((re,q)=>{if(re.type==="task")return re.id;let N=re;for(;N.parentId;){const j=q.get(N.parentId);if(!j)return null;if(j.type==="task")return j.id;N=j}return null},[]),X=xe.useMemo(()=>new Map(e.map(re=>[re.id,re])),[e]),F=xe.useCallback(re=>{const q=G(re,X);return q&&U.get(q)||"#9CA3AF"},[X,U,G]);xe.useEffect(()=>{const re=new Set(e.filter(q=>q.type==="task").map(q=>q.id));p(re)},[e]);const W=re=>{p(q=>{const N=new Set(q);return N.has(re)?N.delete(re):N.add(re),N})},O=xe.useMemo(()=>{const re=[];return e.filter(N=>N.type==="task").forEach(N=>{re.push(N),u.has(N.id)&&e.filter(R=>R.type==="substep"&&R.parentId===N.id).forEach(R=>{if(re.push(R),u.has(R.id)){const J=e.filter(Y=>{if(Y.type!=="actionitem"||Y.parentId!==R.id)return!1;if(m==="all")return!0;const H=Y.progress===100;return m==="completed"?H:m==="pending"?!H:!0});re.push(...J)}})}),re},[e,u,m]),{timelineStart:te,totalDays:ne}=xe.useMemo(()=>{if(e.length===0)return{timelineStart:new Date,totalDays:30};const re=e.map(H=>new Date(H.start)).filter(H=>!isNaN(H.getTime())),q=e.map(H=>new Date(H.end)).filter(H=>!isNaN(H.getTime()));let N,j;re.length===0||q.length===0?(N=new Date,j=new Date,j.setMonth(j.getMonth()+1)):(N=new Date(Math.min(...re.map(H=>H.getTime()))),j=new Date(Math.max(...q.map(H=>H.getTime()))));let R=C.start?new Date(C.start):N,J=C.end?new Date(C.end):j;isNaN(R.getTime())&&(R=N),isNaN(J.getTime())&&(J=j),J<R&&(J=R),R.setDate(R.getDate()-2),J.setDate(J.getDate()+5);const Y=(J.getTime()-R.getTime())/(1e3*3600*24);return{timelineStart:R,totalDays:Math.ceil(Y)}},[e,C]),ee=xe.useMemo(()=>{const re=j=>{j=new Date(Date.UTC(j.getFullYear(),j.getMonth(),j.getDate())),j.setUTCDate(j.getUTCDate()+4-(j.getUTCDay()||7));const R=new Date(Date.UTC(j.getUTCFullYear(),0,1));return Math.ceil(((j.getTime()-R.getTime())/864e5+1)/7)},q=[];let N=new Date(te);if(S==="day")for(let j=0;j<ne;j++)q.push({secondaryLabel:N.toLocaleDateString("ja-JP",{weekday:"short"}),label:String(N.getDate()),width:b}),N.setDate(N.getDate()+1);else if(S==="week")for(let j=0;j<ne;j++)(N.getDay()===1||q.length===0)&&q.push({label:`W${re(N)}`,secondaryLabel:N.toLocaleDateString("ja-JP",{month:"short"}),width:0}),q[q.length-1].width+=b,N.setDate(N.getDate()+1);else if(S==="month"){let j=-1;for(let R=0;R<ne;R++){const J=N.getMonth();J!==j&&(j=J,q.push({label:N.toLocaleDateString("ja-JP",{month:"long",year:"numeric"}),width:0})),q[q.length-1].width+=b,N.setDate(N.getDate()+1)}}return q},[te,ne,S,b]),Se=re=>{const q=new Date(re);return isNaN(q.getTime())?-1:(q.getTime()-te.getTime())/(1e3*3600*24)},Fe=re=>{switch(re){case"substep":return"pl-5";case"actionitem":return"pl-9";default:return"pl-1"}},we=re=>e.some(q=>q.parentId===re),ae=xe.useCallback(()=>{if(y.current===null){alert("");return}E(!0),tD(y.current,{cacheBust:!0,backgroundColor:"#ffffff",width:y.current.scrollWidth,height:y.current.scrollHeight}).then(re=>{const q=document.createElement("a");q.download="gantt-chart.png",q.href=re,q.click()}).catch(re=>{console.error("",re),alert("")}).finally(()=>{E(!1)})},[]),me=xe.useMemo(()=>ee.reduce((re,q)=>re+q.width,0),[ee]);return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 z-[80]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full h-full flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex flex-wrap items-center justify-between p-4 border-b gap-4",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800",children:""}),g.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),g.jsx("div",{className:"flex items-center rounded-md bg-slate-100 p-1",children:["day","week","month"].map(re=>g.jsx("button",{onClick:()=>w(re),className:`px-3 py-1 text-xs capitalize rounded-md ${S===re?"bg-white shadow-sm font-semibold text-blue-600":""}`,children:re},re))})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),g.jsx("input",{type:"date",value:C.start,onChange:re=>M(q=>({...q,start:re.target.value})),className:"p-1 border rounded-md text-sm"}),g.jsx("span",{children:"-"}),g.jsx("input",{type:"date",value:C.end,onChange:re=>M(q=>({...q,end:re.target.value})),className:"p-1 border rounded-md text-sm"}),g.jsx("button",{onClick:()=>M({start:"",end:""}),className:"text-xs px-2 py-1 bg-slate-200 rounded-md hover:bg-slate-300",children:""})]}),g.jsxs("button",{onClick:ae,disabled:_,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[_?g.jsx(na,{size:"sm",color:"border-white"}):g.jsx(uf,{className:"w-4 h-4"}),"PNG"]}),g.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:[g.jsx(sa,{className:"w-5 h-5"}),""]})]})]}),g.jsxs("div",{className:"flex-shrink-0 p-4 border-b flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-100 p-1",children:[g.jsx("button",{onClick:()=>x("all"),className:`px-3 py-1 text-xs rounded-full ${m==="all"?"bg-white shadow-sm":""}`,children:""}),g.jsx("button",{onClick:()=>x("pending"),className:`px-3 py-1 text-xs rounded-full ${m==="pending"?"bg-white shadow-sm":""}`,children:""}),g.jsx("button",{onClick:()=>x("completed"),className:`px-3 py-1 text-xs rounded-full ${m==="completed"?"bg-white shadow-sm":""}`,children:""})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("button",{onClick:r,disabled:a,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[a?g.jsx(na,{size:"sm",color:"border-white"}):g.jsx(mf,{className:"w-4 h-4"}),"AI"]}),g.jsxs("label",{className:"flex items-center text-sm text-slate-600 cursor-pointer",children:[g.jsx("input",{type:"checkbox",checked:l,onChange:()=>c(re=>!re),className:"w-4 h-4 mr-2 accent-blue-600"}),""]})]})]}),g.jsx("div",{className:"flex-grow overflow-auto relative",children:g.jsxs("div",{ref:y,className:"grid",style:{gridTemplateColumns:`${Lv}px 1fr`,width:`${Lv+me}px`},children:[g.jsx("div",{className:"sticky top-0 left-0 z-30 flex items-center p-2 font-semibold text-sm border-b border-r bg-slate-100 text-slate-800",style:{gridColumn:1,gridRow:1,height:Fv},children:" / "}),g.jsx("div",{className:"sticky top-0 z-20 border-b bg-slate-50",style:{gridColumn:2,gridRow:1,height:Fv},children:g.jsx("div",{className:"flex h-full",children:ee.map((re,q)=>g.jsxs("div",{className:"border-r text-center text-[10px] flex flex-col items-center justify-center",style:{width:re.width},children:[re.secondaryLabel&&g.jsx("span",{className:"font-semibold text-slate-600",children:re.secondaryLabel}),g.jsx("div",{className:`font-bold text-slate-800 ${S==="day"?"text-lg":"text-sm"}`,children:re.label})]},q))})}),g.jsx("div",{className:"pointer-events-none flex",style:{gridColumn:2,gridRow:`2 / span ${O.length}`},children:ee.map((re,q)=>g.jsx("div",{className:"h-full border-r border-slate-200",style:{width:re.width}},q))}),O.map((re,q)=>{const N=F(re),j=(()=>{const Ee=O[q+1];return Ee?G(re,X)!==G(Ee,X):!0})(),R=Se(re.start),J=Math.max(.2,Se(re.end)-R+1),Y=R*b,H=J*b,se={task:{height:"24px"},substep:{height:"20px"},actionitem:{height:"8px"}};return g.jsxs(Fi.Fragment,{children:[g.jsxs("div",{className:"sticky left-0 z-10 flex items-center border-r bg-slate-50",style:{gridColumn:1,gridRow:q+2,height:No,borderBottom:j?`2px solid ${N}`:"1px solid #e5e7eb"},children:[g.jsx("div",{className:"w-1 h-full flex-shrink-0",style:{backgroundColor:N}}),g.jsxs("div",{className:`flex items-center w-full ${Fe(re.type)}`,children:[(re.type==="task"||re.type==="substep")&&(we(re.id)?g.jsx(WM,{onClick:()=>W(re.id),className:`w-4 h-4 mr-1 text-slate-500 cursor-pointer transition-transform ${u.has(re.id)?"rotate-0":"-rotate-90"}`}):g.jsx("div",{className:"w-4 h-4 mr-1"})),re.type==="actionitem"&&(re.progress===100?g.jsx(df,{className:"w-3.5 h-3.5 text-green-600 mr-2 flex-shrink-0"}):g.jsx(hf,{className:"w-3.5 h-3.5 text-slate-400 mr-2 flex-shrink-0"})),g.jsx("span",{onClick:()=>n==null?void 0:n(re),className:`truncate text-xs ${re.type==="task"?"font-semibold text-slate-800":"text-slate-600"} ${n?"cursor-pointer hover:text-blue-600":""}`,title:re.name,children:re.name})]})]}),g.jsx("div",{className:"relative",style:{gridColumn:2,gridRow:q+2,borderBottom:j?`2px solid ${N}`:"1px solid #e5e7eb"},children:R>=0&&g.jsx("div",{title:`${re.name} (${re.progress}%)`,onClick:()=>n==null?void 0:n(re),className:"absolute h-full flex items-center group",style:{left:Y,width:H,cursor:n?"pointer":"default"},children:g.jsx("div",{className:"w-full rounded",style:{...se[re.type],backgroundColor:N},children:g.jsx("div",{className:"bg-black bg-opacity-30 h-full rounded",style:{width:`${re.progress}%`}})})})})]},re.id)}),g.jsx("div",{style:{gridColumn:2,gridRow:`2 / span ${O.length}`,position:"relative",pointerEvents:"none"},children:l&&g.jsx(rD,{items:O,getDaysFromStart:Se,dayWidth:b})})]})})]})})},rD=({items:e,getDaysFromStart:t,dayWidth:n})=>{const r=xe.useMemo(()=>{const a=[],l=new Map(e.map((c,u)=>[c.id,u]));return e.forEach((c,u)=>{(c.dependencies||[]).forEach(p=>{const m=l.get(p),x=m!==void 0?e[m]:void 0;if(x&&m!==void 0){const y=t(x.end),_=t(c.start);if(y<0||_<0)return;const E=(y+1)*n,S=m*No+No/2,w=_*n,C=u*No+No/2,M=E+20,k=w-20,b=`M ${E} ${S} C ${M} ${S}, ${k} ${C}, ${w} ${C}`;a.push({key:`${p}-${c.id}`,d:b})}})}),a},[e,t,n]);return g.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",overflow:"visible",children:[g.jsx("defs",{children:g.jsx("marker",{id:"gantt_arrowhead",markerWidth:"5",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:g.jsx("polygon",{points:"0 0, 5 2, 0 4",fill:"#4b5563"})})}),r.map(a=>g.jsx("path",{d:a.d,stroke:"#4b5563",strokeWidth:"1",fill:"none",markerEnd:"url(#gantt_arrowhead)"},a.key))]})},oc=({message:e})=>e?g.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative",role:"alert",children:[g.jsx("strong",{className:"font-bold",children:"Error: "}),g.jsx("span",{className:"block sm:inline",children:e})]}):null,aD=({tasks:e,projectGoal:t,targetDate:n,ganttData:r,projectReportDeck:a,onClose:l,onReportGenerated:c,generateUniqueId:u})=>{const[p,m]=xe.useState("list"),[x,y]=xe.useState(new Set),[_,E]=xe.useState(""),[S,w]=xe.useState(!1),[C,M]=xe.useState(null),[k,b]=xe.useState({key:"taskName",direction:"ascending"}),[U,G]=xe.useState("slides"),[X,F]=xe.useState(null),W=xe.useMemo(()=>{const N=[];return r&&N.push({id:"gantt-chart-main",name:" ",type:"Gantt Chart",taskName:"",subStepName:"",actionItemName:"",source:{name:" ",type:"json",content:r}}),a&&N.push({id:"project-report-main",name:"",type:"Project Report",taskName:"",subStepName:"",actionItemName:"",source:{name:"",type:"json",content:a}}),e.forEach(j=>{var R,J,Y,H,se;(R=j.extendedDetails)!=null&&R.reportDeck&&N.push({id:`task-report-${j.id}`,name:`: ${j.title}`,type:"Task Report",taskName:j.title,subStepName:"",actionItemName:"",source:{name:`: ${j.title}`,type:"json",content:j.extendedDetails.reportDeck}}),(Y=(J=j.extendedDetails)==null?void 0:J.attachments)==null||Y.forEach(Ee=>{N.push({id:Ee.id,name:Ee.name,type:"Attachment",taskName:j.title,subStepName:"",actionItemName:"",source:{name:Ee.name,type:Ee.type.startsWith("image/")?"image":"text",content:Ee.dataUrl,dataUrl:Ee.dataUrl}})}),(se=(H=j.extendedDetails)==null?void 0:H.subSteps)==null||se.forEach(Ee=>{var ke,De;(ke=Ee.attachments)==null||ke.forEach(Ce=>{N.push({id:Ce.id,name:Ce.name,type:"Attachment",taskName:j.title,subStepName:Ee.text,actionItemName:"",source:{name:Ce.name,type:Ce.type.startsWith("image/")?"image":"text",content:Ce.dataUrl,dataUrl:Ce.dataUrl}})}),(De=Ee.actionItems)==null||De.forEach(Ce=>{var Je,K,pt;(K=(Je=Ce.report)==null?void 0:Je.attachments)==null||K.forEach(Ke=>{N.push({id:Ke.id,name:Ke.name,type:"Attachment",taskName:j.title,subStepName:Ee.text,actionItemName:Ce.text,source:{name:Ke.name,type:Ke.type.startsWith("image/")?"image":"text",content:Ke.dataUrl,dataUrl:Ke.dataUrl}})}),(pt=Ce.report)!=null&&pt.matrixData&&N.push({id:`matrix-${Ce.id}`,name:`: ${Ce.text}`,type:"Data Matrix",taskName:j.title,subStepName:Ee.text,actionItemName:Ce.text,source:{name:`: ${Ce.text}`,type:"json",content:Ce.report.matrixData}})})})}),N},[e,r,a]),O=xe.useMemo(()=>{let N=[...W];return k!==null&&N.sort((j,R)=>{const J=(j[k.key]||"").toLowerCase(),Y=(R[k.key]||"").toLowerCase();return J<Y?k.direction==="ascending"?-1:1:J>Y?k.direction==="ascending"?1:-1:0}),N},[W,k]),te=N=>{let j="ascending";k&&k.key===N&&k.direction==="ascending"&&(j="descending"),b({key:N,direction:j})},ne=N=>!k||k.key!==N?g.jsx(fs,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):k.direction==="ascending"?g.jsx(Xo,{className:"w-3 h-3 ml-1 text-blue-600"}):g.jsx(fs,{className:"w-3 h-3 ml-1 text-blue-600"}),ee=N=>{y(j=>{const R=new Set(j);return R.has(N)?R.delete(N):R.add(N),R})},Se=()=>{x.size===W.length?y(new Set):y(new Set(W.map(N=>N.id)))},Fe=async()=>{if(x.size===0){M("1");return}if(!_.trim()){M("");return}w(!0),M(null),F(null);const N=W.filter(j=>x.has(j.id)).map(j=>j.source);try{if(U==="slides"){const j=await E2(N,_);c(j)}else{const j=await UM(N,_);F(j)}}catch(j){M(j instanceof Error?j.message:"")}finally{w(!1)}},we=N=>{switch(N){case"Gantt Chart":return g.jsx(D2,{className:"w-5 h-5 text-amber-600"});case"Project Report":case"Task Report":return g.jsx(k2,{className:"w-5 h-5 text-teal-600"});case"Attachment":return g.jsx(Mi,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return g.jsx(Yo,{className:"w-5 h-5 text-purple-600"});default:return g.jsx(Wo,{className:"w-5 h-5 text-slate-500"})}},ae=N=>{if(N.dataUrl)return N.dataUrl;if(N.type==="json")try{const j=JSON.stringify(N.content,null,2),R=new Blob([j],{type:"application/json"});return URL.createObjectURL(R)}catch{return}},me=xe.useMemo(()=>W.filter(N=>x.has(N.id)),[x,W]),re=()=>g.jsxs(g.Fragment,{children:[g.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:g.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[g.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:g.jsxs("tr",{children:[g.jsx("th",{className:"p-2 border border-slate-300 w-10 text-center",children:g.jsx("input",{type:"checkbox",checked:x.size===W.length&&W.length>0,onChange:Se,className:"w-4 h-4 accent-blue-600"})}),g.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:g.jsxs("button",{onClick:()=>te("name"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("name")]})}),g.jsx("th",{className:"p-0 border border-slate-300 w-40",children:g.jsxs("button",{onClick:()=>te("type"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("type")]})}),g.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:g.jsxs("button",{onClick:()=>te("taskName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("taskName")]})}),g.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:g.jsxs("button",{onClick:()=>te("subStepName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("subStepName")]})}),g.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:g.jsxs("button",{onClick:()=>te("actionItemName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("actionItemName")]})})]})}),g.jsx("tbody",{children:O.map(N=>{const j=ae(N.source);return g.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[g.jsx("td",{className:"border border-slate-300 align-middle text-center p-2",children:g.jsx("input",{type:"checkbox",checked:x.has(N.id),onChange:()=>ee(N.id),className:"w-4 h-4 accent-blue-600"})}),g.jsx("td",{className:"border border-slate-300 p-2 font-medium text-slate-800",children:j?g.jsx("a",{href:j,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:N.name}):g.jsx("span",{children:N.name})}),g.jsx("td",{className:"border border-slate-300 p-2 text-slate-600",children:g.jsxs("div",{className:"flex items-center gap-2",children:[we(N.type),g.jsx("span",{children:N.type})]})}),g.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.taskName}),g.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.subStepName}),g.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.actionItemName})]},N.id)})})]})}),g.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[g.jsxs("span",{className:"text-sm text-slate-600",children:[x.size," / ",W.length," "]}),g.jsx("button",{onClick:()=>m("generate"),disabled:x.size===0,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:""})]})]}),q=()=>g.jsxs(g.Fragment,{children:[g.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsxs("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:[" (",me.length,")"]}),g.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-96 overflow-y-auto space-y-2",children:me.map(N=>g.jsxs("div",{className:"text-sm text-slate-700 flex items-center gap-2",children:[we(N.type),g.jsx("span",{className:"truncate",title:N.name,children:N.name})]},N.id))}),g.jsx("h4",{className:"font-semibold text-lg text-slate-800 mt-6 mb-2",children:""}),g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[g.jsx("input",{type:"radio",name:"reportFormat",value:"slides",checked:U==="slides",onChange:()=>G("slides"),className:"w-4 h-4 accent-blue-600"}),""]}),g.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[g.jsx("input",{type:"radio",name:"reportFormat",value:"text",checked:U==="text",onChange:()=>G("text"),className:"w-4 h-4 accent-blue-600"}),""]})]})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:""}),g.jsx("textarea",{value:_,onChange:N=>E(N.target.value),placeholder:"",rows:6,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),C&&g.jsx("div",{className:"mt-2",children:g.jsx(oc,{message:C})}),X&&g.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-slate-50",children:[g.jsx("h5",{className:"font-semibold text-md text-slate-800 mb-2",children:""}),g.jsx("pre",{className:"text-sm text-slate-700 bg-white p-3 rounded whitespace-pre-wrap max-h-60 overflow-y-auto",children:X}),g.jsx("button",{onClick:()=>navigator.clipboard.writeText(X),className:"text-xs mt-2 px-2 py-1 bg-slate-200 rounded",children:""})]})]})]}),g.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[g.jsxs("button",{onClick:()=>{m("list"),F(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:[g.jsx(C2,{className:"w-4 h-4"}),""]}),g.jsxs("button",{onClick:Fe,disabled:S,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[S?g.jsx(na,{size:"sm",color:"border-white"}):g.jsx(lc,{className:"w-5 h-5"}),g.jsx("span",{children:S?"...":""})]})]})]});return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[70]",children:g.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[g.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-3",children:[g.jsx(Wo,{className:"w-7 h-7 text-blue-600"}),g.jsx("span",{children:""})]}),g.jsx("button",{onClick:l,className:"p-1.5 rounded-full hover:bg-slate-100",children:g.jsx(sa,{className:"w-6 h-6 text-slate-500"})})]}),p==="list"?re():q()]})})},iD=({tasks:e,projectGoal:t,targetDate:n,onSelectTask:r,onUpdateTaskExtendedDetails:a,onUpdateTaskPosition:l,onUpdateTaskStatus:c,onStartNewProject:u,onExportProject:p,onAddTask:m,onRemoveTask:x,onImportSingleTask:y,onAutoLayout:_,onUndo:E,canUndo:S,onRedo:w,canRedo:C,generateUniqueId:M,onUpdateTaskConnections:k,ganttData:b,setGanttData:U,onCustomReportGenerated:G,onClearApiKey:X})=>{xe.useRef(null);const F=xe.useRef(null),[W,O]=xe.useState(new Map),[te,ne]=xe.useState([]),ee=xe.useRef(null),Se=xe.useRef({x:0,y:0}),[Fe,we]=xe.useState(!1),[ae,me]=xe.useState(!1),[re,q]=xe.useState(null),[N,j]=xe.useState(!1),[R,J]=xe.useState(null),[Y,H]=xe.useState(!1),[se,Ee]=xe.useState(null),[ke,De]=xe.useState(!1),[Ce,Je]=xe.useState(null),[K,pt]=xe.useState(!1),[Ke,ft]=xe.useState(!1),[Me,Te]=xe.useState(null),[He,ze]=xe.useState(!1),[Ft,Tt]=xe.useState(!1),[ot,fn]=xe.useState(null),[an,Un]=xe.useState({x:0,y:0});xe.useEffect(()=>{const Pe=new Map;e.forEach(st=>{Pe.set(st.id,W.get(st.id)||xe.createRef())}),O(Pe)},[e]);const $t=xe.useCallback(()=>{if(!F.current||W.size===0){ne([]);return}const Pe=[];e.forEach(st=>{var xt,sn;if(st.nextTaskIds&&st.nextTaskIds.length>0){const Rn=W.get(st.id),En=Rn==null?void 0:Rn.current;if(!En)return;const Nr=((xt=st.position)==null?void 0:xt.x)||0,Aa=((sn=st.position)==null?void 0:sn.y)||0,Vn=En.getBoundingClientRect(),Zt={x:Nr+Vn.width,y:Aa+Vn.height/2};st.nextTaskIds.forEach(Qt=>{var B,z;const _t=e.find(fe=>fe.id===Qt);if(!_t)return;const Mr=W.get(Qt),ba=Mr==null?void 0:Mr.current;if(!ba)return;const D=((B=_t.position)==null?void 0:B.x)||0,V=((z=_t.position)==null?void 0:z.y)||0,L=ba.getBoundingClientRect(),P={x:D,y:V+L.height/2};Pe.push({id:`conn-${st.id}-${Qt}`,from:Zt,to:P,sourceId:st.id,targetId:Qt})})}}),ne(Pe)},[e,W]);xe.useEffect(()=>{const Pe=setTimeout($t,50);return()=>clearTimeout(Pe)},[$t,e]),xe.useEffect(()=>{window.addEventListener("resize",$t);const Pe=new MutationObserver($t);return F.current&&Pe.observe(F.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("resize",$t),Pe.disconnect()}},[$t]);const Yt=(Pe,st)=>{var sn,Rn;ee.current=st;const xt=e.find(En=>En.id===st);if(F.current){const En=F.current.getBoundingClientRect();Se.current.x=Pe.clientX-En.left-(((sn=xt==null?void 0:xt.position)==null?void 0:sn.x)||0),Se.current.y=Pe.clientY-En.top-(((Rn=xt==null?void 0:xt.position)==null?void 0:Rn.y)||0)}Pe.dataTransfer.effectAllowed="move"},at=Pe=>{Pe.preventDefault(),Pe.dataTransfer.dropEffect="move"},Dt=Pe=>{var Zt;if(Pe.preventDefault(),!ee.current||!F.current)return;const st=F.current.getBoundingClientRect(),xt=(Zt=W.get(ee.current))==null?void 0:Zt.current,sn=(xt==null?void 0:xt.offsetWidth)||380,Rn=(xt==null?void 0:xt.offsetHeight)||280;let En=Pe.clientX-st.left-Se.current.x,Nr=Pe.clientY-st.top-Se.current.y;const Aa=F.current.scrollWidth,Vn=F.current.scrollHeight;En=Math.max(0,Math.min(En,Aa-sn)),Nr=Math.max(0,Math.min(Nr,Vn-Rn)),l(ee.current,{x:En,y:Nr}),ee.current=null,setTimeout($t,0)},Ue=async()=>{j(!0),J(null);try{const Pe=await FM(e,t,n);q(Pe),me(!0)}catch(Pe){J(Pe instanceof Error?Pe.message:"")}finally{j(!1)}},dt=async()=>{if(se){H(!0);return}De(!0),Je(null);try{const Pe=await LM(e,t,n);Ee(Pe),H(!0)}catch(Pe){Je(Pe instanceof Error?Pe.message:"")}finally{De(!1)}},jt=async()=>{if(b){pt(!0);return}ft(!0),Te(null);try{const Pe=await Sv(e,t,n);U(Pe),pt(!0)}catch(Pe){Te(Pe instanceof Error?Pe.message:"")}finally{ft(!1)}},Et=async()=>{ft(!0),Te(null);try{const Pe=await Sv(e,t,n);U(Pe)}catch(Pe){Te(Pe instanceof Error?Pe.message:"")}finally{ft(!1)}},Mn=(Pe,st)=>{if(!F.current)return;const xt=F.current.getBoundingClientRect(),sn={x:st.clientX-xt.left+F.current.scrollLeft,y:st.clientY-xt.top+F.current.scrollTop};fn({fromId:Pe,fromPos:sn})},Bn=Pe=>{if(!ot||ot.fromId===Pe){fn(null);return}const st=e.find(xt=>xt.id===ot.fromId);if(st){const xt=Array.from(new Set([...st.nextTaskIds||[],Pe]));k(st.id,xt)}fn(null)},$r=(Pe,st)=>{const xt=e.find(sn=>sn.id===Pe);if(xt){const sn=(xt.nextTaskIds||[]).filter(Rn=>Rn!==st);k(xt.id,sn)}},Yr=Pe=>{if(!ot||!F.current)return;const st=F.current.getBoundingClientRect();Un({x:Pe.clientX-st.left+F.current.scrollLeft,y:Pe.clientY-st.top+F.current.scrollTop})},Za=()=>{ot&&fn(null)},Sa=Pe=>{const st=Pe.type==="task"?Pe.id:Pe.parentId;if(!st)return;const xt=e.find(sn=>sn.id===st);xt&&(pt(!1),r(xt))},wa=Pe=>{G(Pe),Tt(!1)},Ca=n?new Date(n+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"";return Y&&se?g.jsx(Mh,{tasks:e,initialDeck:se,onSave:Pe=>Ee(Pe),onClose:()=>H(!1),projectGoal:t,targetDate:n,reportScope:"project",generateUniqueId:M}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 md:p-6 flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"max-w-full mx-auto w-full",children:[g.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[g.jsxs("button",{onClick:()=>ze(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-transform hover:scale-105",children:[g.jsx(ju,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("div",{className:"flex flex-wrap gap-2",children:[g.jsx("button",{onClick:E,disabled:!S,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:g.jsx(N2,{className:"w-5 h-5"})}),g.jsx("button",{onClick:w,disabled:!C,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:g.jsx(M2,{className:"w-5 h-5"})}),g.jsx("button",{onClick:X,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"API",children:g.jsx(I2,{className:"w-5 h-5 text-yellow-600"})}),g.jsxs("button",{onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",children:[g.jsx(kh,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[g.jsx(uf,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:_,className:"inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",title:"",children:[g.jsx(mf,{className:"w-5 h-5 mr-2"}),""]})]})]}),g.jsxs("header",{className:"mb-6 p-6 bg-white rounded-xl shadow-lg",children:[g.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:""}),g.jsxs("div",{className:"space-y-2 text-slate-700",children:[g.jsxs("p",{className:"flex items-start",children:[g.jsx(w2,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0 mt-1"}),g.jsx("strong",{children:":"}),"",g.jsx("span",{className:"break-all",children:t})]}),g.jsxs("p",{className:"flex items-center",children:[g.jsx(S2,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0"}),g.jsx("strong",{children:":"}),"",Ca]})]})]}),g.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[g.jsxs("button",{onClick:()=>we(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[g.jsx(R2,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:()=>Tt(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[g.jsx(Wo,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:jt,disabled:Ke,className:"inline-flex items-center justify-center px-4 py-2 border border-amber-300 text-sm font-medium rounded-md shadow-sm text-amber-800 bg-amber-100 hover:bg-amber-200 disabled:bg-slate-400",children:[Ke?g.jsx(na,{size:"sm"}):g.jsx(D2,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:Ue,disabled:N,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400",children:[N?g.jsx(na,{size:"sm"}):g.jsx(lc,{className:"w-5 h-5 mr-2"}),"AI"]}),g.jsxs("button",{onClick:dt,disabled:ke,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-teal-600 hover:bg-teal-700 disabled:bg-slate-400",children:[ke?g.jsx(na,{size:"sm"}):g.jsx(k2,{className:"w-5 h-5 mr-2"}),""]})]})]}),R&&g.jsx("div",{className:"mt-4",children:g.jsx("p",{className:"text-red-600 text-sm",children:R})}),Ce&&g.jsx("div",{className:"mt-4",children:g.jsx("p",{className:"text-red-600 text-sm",children:Ce})}),Me&&g.jsx("div",{className:"mt-4",children:g.jsx("p",{className:"text-red-600 text-sm",children:Me})})]})]}),g.jsxs("div",{ref:F,className:"flex-grow overflow-auto pb-8 relative min-h-[600px] border border-slate-300 rounded-lg bg-slate-50 p-4 shadow-inner",onDragOver:at,onDrop:Dt,onMouseMove:Yr,onMouseUp:Za,children:[g.jsxs("div",{className:"relative w-full h-full min-w-[1200px] min-h-[800px]",children:[e.map((Pe,st)=>g.jsx(QM,{cardRef:W.get(Pe.id),task:Pe,onSelectTask:r,onRemoveTask:x,onUpdateStatus:c,onDragCardStart:Yt,onStartConnection:Mn,onEndConnection:Bn,index:st},Pe.id)),te.map(Pe=>g.jsx(Jo,{from:Pe.from,to:Pe.to,id:Pe.id,onDelete:()=>$r(Pe.sourceId,Pe.targetId)},Pe.id)),ot&&g.jsx(Jo,{from:ot.fromPos,to:an,id:"preview-connector"})]}),e.length===0&&g.jsx("div",{className:"text-center py-10 flex-grow flex items-center justify-center",children:g.jsx("p",{className:"text-slate-500 text-lg",children:""})})]})]}),K&&b&&g.jsx(nD,{data:b,onClose:()=>pt(!1),onItemClick:Sa,onRegenerate:Et,isRegenerating:Ke}),Ft&&g.jsx(aD,{tasks:e,projectGoal:t,targetDate:n,ganttData:b,projectReportDeck:se,onClose:()=>Tt(!1),onReportGenerated:wa,generateUniqueId:M}),Fe&&g.jsx(eR,{tasks:e,onClose:()=>we(!1)}),ae&&g.jsx(tR,{report:re,onClose:()=>me(!1)}),He&&g.jsx(oR,{onClose:()=>ze(!1),onDownloadAndStartNew:()=>{p(),u()},onStartNewWithoutSaving:u})]})},sD=({proposals:e,existingSubSteps:t,onConfirm:n,onClose:r})=>{const[a,l]=xe.useState(()=>{const p={};return e.forEach((m,x)=>{p[x]={decision:"NEW",targetSubStepId:void 0}}),p}),c=(p,m,x)=>{l(y=>({...y,[p]:{...y[p],[m]:x}}))},u=()=>{const p=[],m=[];Object.entries(a).forEach(([x,y])=>{const _=parseInt(x,10),E=e[_];y.decision==="NEW"?p.push(E):y.decision==="ADD"&&y.targetSubStepId&&m.push({targetSubStepId:y.targetSubStepId,title:E.title})}),n({newSubSteps:p,newActionItems:m})};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),g.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:g.jsx(sa,{className:"w-6 h-6 text-slate-500"})})]}),g.jsxs("div",{className:"flex-grow p-5 overflow-y-auto space-y-4",children:[g.jsx("p",{className:"text-sm text-slate-600",children:"AI"}),g.jsx("div",{className:"space-y-3",children:e.map((p,m)=>g.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[g.jsx("p",{className:"font-semibold text-slate-800",children:p.title}),g.jsx("p",{className:"text-sm text-slate-600 mb-3",children:p.description}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("select",{value:a[m].decision,onChange:x=>c(m,"decision",x.target.value),className:"p-2 border border-slate-300 rounded-md text-sm",children:[g.jsx("option",{value:"NEW",children:""}),t.length>0&&g.jsx("option",{value:"ADD",children:""}),g.jsx("option",{value:"IGNORE",children:""})]}),a[m].decision==="ADD"&&g.jsxs("select",{value:a[m].targetSubStepId||"",onChange:x=>c(m,"targetSubStepId",x.target.value),className:"flex-grow p-2 border border-slate-300 rounded-md text-sm",children:[g.jsx("option",{value:"",disabled:!0,children:"..."}),t.map(x=>g.jsx("option",{value:x.id,children:x.text},x.id))]})]})]},m))})]}),g.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[g.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),g.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var z2=1252,lD=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ih={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Fh=function(e){lD.indexOf(e)!=-1&&(z2=Ih[0]=e)};function oD(){Fh(1252)}var ea=function(e){Fh(e)};function j2(){ea(1200),oD()}function Pv(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function cD(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}function q2(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Mo=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return t==255&&n==254?cD(e.slice(2)):t==254&&n==255?q2(e.slice(2)):t==65279?e.slice(1):e},wu=function(t){return String.fromCharCode(t)},Uv=function(t){return String.fromCharCode(t)},Ko,bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bv(e){for(var t="",n=0,r=0,a=0,l=0,c=0,u=0,p=0,m=0;m<e.length;)n=e.charCodeAt(m++),l=n>>2,r=e.charCodeAt(m++),c=(n&3)<<4|r>>4,a=e.charCodeAt(m++),u=(r&15)<<2|a>>6,p=a&63,isNaN(r)?u=p=64:isNaN(a)&&(p=64),t+=bi.charAt(l)+bi.charAt(c)+bi.charAt(u)+bi.charAt(p);return t}function kr(e){var t="",n=0,r=0,a=0,l=0,c=0,u=0,p=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)l=bi.indexOf(e.charAt(m++)),c=bi.indexOf(e.charAt(m++)),n=l<<2|c>>4,t+=String.fromCharCode(n),u=bi.indexOf(e.charAt(m++)),r=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(r)),p=bi.indexOf(e.charAt(m++)),a=(u&3)<<6|p,p!==64&&(t+=String.fromCharCode(a));return t}var St=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),gs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Oi(e){return St?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Vv(e){return St?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qr=function(t){return St?gs(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function vs(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function Lh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Lh(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var Ai=St?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:gs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function uD(e){for(var t=[],n=0,r=e.length+250,a=Oi(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)a[n++]=c;else if(c<2048)a[n++]=192|c>>6&31,a[n++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++l)&1023;a[n++]=240|c>>8&7,a[n++]=128|c>>2&63,a[n++]=128|u>>6&15|(c&3)<<4,a[n++]=128|u&63}else a[n++]=224|c>>12&15,a[n++]=128|c>>6&63,a[n++]=128|c&63;n>r&&(t.push(a.slice(0,n)),n=0,a=Oi(65535),r=65530)}return t.push(a.slice(0,n)),Ai(t)}var cr=/\u0000/g,Ro=/[\u0001-\u0006]/g;function dl(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function ta(e,t){var n=""+e;return n.length>=t?n:cn("0",t-n.length)+n}function Oh(e,t){var n=""+e;return n.length>=t?n:cn(" ",t-n.length)+n}function Yu(e,t){var n=""+e;return n.length>=t?n:n+cn(" ",t-n.length)}function fD(e,t){var n=""+Math.round(e);return n.length>=t?n:cn("0",t-n.length)+n}function dD(e,t){var n=""+e;return n.length>=t?n:cn("0",t-n.length)+n}var Hv=Math.pow(2,32);function il(e,t){if(e>Hv||e<-Hv)return fD(e,t);var n=Math.round(e);return dD(n,t)}function Wu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Gv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Id=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function hD(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},zv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},mD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xu(e,t,n){for(var r=e<0?-1:1,a=e*r,l=0,c=1,u=0,p=1,m=0,x=0,y=Math.floor(a);m<t&&(y=Math.floor(a),u=y*c+l,x=y*m+p,!(a-y<5e-8));)a=1/(a-y),l=c,c=u,p=m,m=x;if(x>t&&(m>t?(x=p,u=l):(x=m,u=c)),!n)return[0,r*u,x];var _=Math.floor(r*u/x);return[_,r*u-_*x,x]}function as(e,t,n){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),l=0,c=[],u={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(r+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++r,++u.D)),r===60)c=n?[1317,10,29]:[1900,2,29],l=3;else if(r===0)c=n?[1317,8,29]:[1900,1,0],l=6;else{r>60&&--r;var p=new Date(1900,0,1);p.setDate(p.getDate()+r-1),c=[p.getFullYear(),p.getMonth()+1,p.getDate()],l=p.getDay(),r<60&&(l=(l+6)%7),n&&(l=TD(p,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=l,u}var $2=new Date(1899,11,31,0,0,0),pD=$2.getTime(),xD=new Date(1900,2,1,0,0,0);function Y2(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=xD&&(n+=24*60*60*1e3),(n-(pD+(e.getTimezoneOffset()-$2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ph(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gD(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function vD(e){var t=e<0?12:11,n=Ph(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function yD(e){var t=Ph(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Zo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=vD(e):t===10?n=e.toFixed(10).substr(0,12):n=yD(e),Ph(gD(n.toUpperCase()))}function ds(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Zo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return zr(14,Y2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function TD(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function _D(e,t,n,r){var a="",l=0,c=0,u=n.y,p,m=0;switch(e){case 98:u=n.y+543;case 121:switch(t.length){case 1:case 2:p=u%100,m=2;break;default:p=u%1e4,m=4;break}break;case 109:switch(t.length){case 1:case 2:p=n.m,m=t.length;break;case 3:return Id[n.m-1][1];case 5:return Id[n.m-1][0];default:return Id[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:p=n.d,m=t.length;break;case 3:return Gv[n.q][0];default:return Gv[n.q][1]}break;case 104:switch(t.length){case 1:case 2:p=1+(n.H+11)%12,m=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:p=n.H,m=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:p=n.M,m=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?ta(n.S,t.length):(r>=2?c=r===3?1e3:100:c=r===1?10:1,l=Math.round(c*(n.S+n.u)),l>=60*c&&(l=0),t==="s"?l===0?"0":""+l/c:(a=ta(l,2+r),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":p=n.D*24+n.H;break;case"[m]":case"[mm]":p=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":p=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}m=t.length===3?1:2;break;case 101:p=u,m=1;break}var x=m>0?ta(p,m):"";return x}function ki(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var W2=/%/g;function ED(e,t,n){var r=t.replace(W2,""),a=t.length-r.length;return ja(e,r,n*Math.pow(10,2*a))+cn("%",a)}function SD(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return ja(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function X2(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+X2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%a;if(l<0&&(l+=a),n=(t/Math.pow(10,l)).toPrecision(r+1+(a+l)%a),n.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(c-n.length+l):n+="E+"+(c-l);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,p,m,x){return p+m+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var J2=/# (\?+)( ?)\/( ?)(\d+)/;function wD(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),l=Math.floor(a/r),c=a-l*r,u=r;return n+(l===0?"":""+l)+" "+(c===0?cn(" ",e[1].length+1+e[4].length):Oh(c,e[1].length)+e[2]+"/"+e[3]+ta(u,e[4].length))}function CD(e,t,n){return n+(t===0?"":""+t)+cn(" ",e[1].length+2+e[4].length)}var K2=/^#*0*\.([0#]+)/,Z2=/\).*[0#]/,Q2=/\(###\) ###\\?-####/;function sr(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function jv(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function qv(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function AD(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function bD(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Vr(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Z2)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Vr("n",r,n):"("+Vr("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return SD(e,t,n);if(t.indexOf("%")!==-1)return ED(e,t,n);if(t.indexOf("E")!==-1)return X2(t,n);if(t.charCodeAt(0)===36)return"$"+Vr(e,t.substr(t.charAt(1)==" "?2:1),n);var a,l,c,u,p=Math.abs(n),m=n<0?"-":"";if(t.match(/^00+$/))return m+il(p,t.length);if(t.match(/^[#?]+$/))return a=il(n,0),a==="0"&&(a=""),a.length>t.length?a:sr(t.substr(0,t.length-a.length))+a;if(l=t.match(J2))return wD(l,p,m);if(t.match(/^#+0+$/))return m+il(p,t.length-t.indexOf("0"));if(l=t.match(K2))return a=jv(n,l[1].length).replace(/^([^\.]+)$/,"$1."+sr(l[1])).replace(/\.$/,"."+sr(l[1])).replace(/\.(\d*)$/,function(S,w){return"."+w+cn("0",sr(l[1]).length-w.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return m+jv(p,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return m+ki(il(p,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Vr(e,t,-n):ki(""+(Math.floor(n)+AD(n,l[1].length)))+"."+ta(qv(n,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return Vr(e,t.replace(/^#,#*,/,""),n);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=dl(Vr(e,t.replace(/[\\-]/g,""),n)),c=0,dl(dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<a.length?a.charAt(c++):S==="0"?"0":""}));if(t.match(Q2))return a=Vr(e,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Xu(p,Math.pow(10,c)-1,!1),a=""+m,x=ja("n",l[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=Yu(u[2],c),x.length<l[4].length&&(x=sr(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Xu(p,Math.pow(10,c)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Oh(u[1],c)+l[2]+"/"+l[3]+Yu(u[2],c):cn(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return a=il(n,0),t.length<=a.length?a:sr(t.substr(0,t.length-a.length))+a;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=t.indexOf(".")-c,_=t.length-a.length-y;return sr(t.substr(0,y)+a+t.substr(t.length-_))}if(l=t.match(/^00,000\.([#0]*0)$/))return c=qv(n,l[1].length),n<0?"-"+Vr(e,t,-n):ki(bD(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ta(0,3-S.length):"")+S})+"."+ta(c,l[1].length);switch(t){case"###,##0.00":return Vr(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var E=ki(il(p,0));return E!=="0"?m+E:"";case"###,###.00":return Vr(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Vr(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function kD(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return ja(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function ND(e,t,n){var r=t.replace(W2,""),a=t.length-r.length;return ja(e,r,n*Math.pow(10,2*a))+cn("%",a)}function eT(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+eT(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%a;if(l<0&&(l+=a),n=(t/Math.pow(10,l)).toPrecision(r+1+(a+l)%a),!n.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(c-n.length+l):n+="E+"+(c-l),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,p,m,x){return p+m+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function ma(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Z2)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?ma("n",r,n):"("+ma("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return kD(e,t,n);if(t.indexOf("%")!==-1)return ND(e,t,n);if(t.indexOf("E")!==-1)return eT(t,n);if(t.charCodeAt(0)===36)return"$"+ma(e,t.substr(t.charAt(1)==" "?2:1),n);var a,l,c,u,p=Math.abs(n),m=n<0?"-":"";if(t.match(/^00+$/))return m+ta(p,t.length);if(t.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>t.length?a:sr(t.substr(0,t.length-a.length))+a;if(l=t.match(J2))return CD(l,p,m);if(t.match(/^#+0+$/))return m+ta(p,t.length-t.indexOf("0"));if(l=t.match(K2))return a=(""+n).replace(/^([^\.]+)$/,"$1."+sr(l[1])).replace(/\.$/,"."+sr(l[1])),a=a.replace(/\.(\d*)$/,function(S,w){return"."+w+cn("0",sr(l[1]).length-w.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return m+(""+p).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return m+ki(""+p);if(l=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+ma(e,t,-n):ki(""+n)+"."+cn("0",l[1].length);if(l=t.match(/^#,#*,#0/))return ma(e,t.replace(/^#,#*,/,""),n);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=dl(ma(e,t.replace(/[\\-]/g,""),n)),c=0,dl(dl(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<a.length?a.charAt(c++):S==="0"?"0":""}));if(t.match(Q2))return a=ma(e,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Xu(p,Math.pow(10,c)-1,!1),a=""+m,x=ja("n",l[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=Yu(u[2],c),x.length<l[4].length&&(x=sr(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Xu(p,Math.pow(10,c)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Oh(u[1],c)+l[2]+"/"+l[3]+Yu(u[2],c):cn(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:sr(t.substr(0,t.length-a.length))+a;if(l=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=t.indexOf(".")-c,_=t.length-a.length-y;return sr(t.substr(0,y)+a+t.substr(t.length-_))}if(l=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+ma(e,t,-n):ki(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ta(0,3-S.length):"")+S})+"."+ta(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var E=ki(""+p);return E!=="0"?m+E:"";default:if(t.match(/\.[0#?]*$/))return ma(e,t.slice(0,t.lastIndexOf(".")),n)+sr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ja(e,t,n){return(n|0)===n?ma(e,t,n):Vr(e,t,n)}function MD(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var tT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Al(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Wu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(tT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function RD(e,t,n,r){for(var a=[],l="",c=0,u="",p="t",m,x,y,_="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Wu(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(y=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(y);a[a.length]={t:"t",v:l},++c;break;case"\\":var E=e.charAt(++c),S=E==="("||E===")"?E:"t";a[a.length]={t:S,v:E},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(m==null&&(m=as(t,n,e.charAt(c+1)==="2"),m==null))return"";a[a.length]={t:"X",v:e.substr(c,2)},p=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||m==null&&(m=as(t,n),m==null))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&p.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:l},p=u;break;case"A":case"a":case"":var w={t:u,v:u};if(m==null&&(m=as(t,n)),e.substr(c,3).toUpperCase()==="A/P"?(m!=null&&(w.v=m.H>=12?"P":"A"),w.t="T",_="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(m!=null&&(w.v=m.H>=12?"PM":"AM"),w.t="T",c+=5,_="h"):e.substr(c,5).toUpperCase()==="/"?(m!=null&&(w.v=m.H>=12?"":""),w.t="T",c+=5,_="h"):(w.t="t",++c),m==null&&w.t==="T")return"";a[a.length]=w,p=u;break;case"[":for(l=u;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(tT)){if(m==null&&(m=as(t,n),m==null))return"";a[a.length]={t:"Z",v:l.toLowerCase()},p=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Al(e)||(a[a.length]={t:"t",v:l}));break;case".":if(m!=null){for(l=u;++c<e.length&&(u=e.charAt(c))==="0";)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;a[a.length]={t:u,v:l},p=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:r===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c;break}var C=0,M=0,k;for(c=a.length-1,p="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=_,p="h",C<1&&(C=1);break;case"s":(k=a[c].v.match(/\.0+$/))&&(M=Math.max(M,k[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":p=a[c].t;break;case"m":p==="s"&&(a[c].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&a[c].v.match(/[Hh]/)&&(C=1),C<2&&a[c].v.match(/[Mm]/)&&(C=2),C<3&&a[c].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var b="",U;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=_D(a[c].t.charCodeAt(0),a[c].v,m,M),a[c].t="t";break;case"n":case"?":for(U=c+1;a[U]!=null&&((u=a[U].t)==="?"||u==="D"||(u===" "||u==="t")&&a[U+1]!=null&&(a[U+1].t==="?"||a[U+1].t==="t"&&a[U+1].v==="/")||a[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[U].v==="/"||a[U].v===" "&&a[U+1]!=null&&a[U+1].t=="?"));)a[c].v+=a[U].v,a[U]={v:"",t:";"},++U;b+=a[c].v,c=U-1;break;case"G":a[c].t="t",a[c].v=ds(t,n);break}var G="",X,F;if(b.length>0){b.charCodeAt(0)==40?(X=t<0&&b.charCodeAt(0)===45?-t:t,F=ja("n",b,X)):(X=t<0&&r>1?-t:t,F=ja("n",b,X),X<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),U=F.length-1;var W=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){W=c;break}var O=a.length;if(W===a.length&&F.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(U>=a[c].v.length-1?(U-=a[c].v.length,a[c].v=F.substr(U+1,a[c].v.length)):U<0?a[c].v="":(a[c].v=F.substr(0,U+1),U=-1),a[c].t="t",O=c);U>=0&&O<a.length&&(a[O].v=F.substr(0,U+1)+a[O].v)}else if(W!==a.length&&F.indexOf("E")===-1){for(U=F.indexOf(".")-1,c=W;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(x=a[c].v.indexOf(".")>-1&&c===W?a[c].v.indexOf(".")-1:a[c].v.length-1,G=a[c].v.substr(x+1);x>=0;--x)U>=0&&(a[c].v.charAt(x)==="0"||a[c].v.charAt(x)==="#")&&(G=F.charAt(U--)+G);a[c].v=G,a[c].t="t",O=c}for(U>=0&&O<a.length&&(a[O].v=F.substr(0,U+1)+a[O].v),U=F.indexOf(".")+1,c=W;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==W)){for(x=a[c].v.indexOf(".")>-1&&c===W?a[c].v.indexOf(".")+1:0,G=a[c].v.substr(0,x);x<a[c].v.length;++x)U<F.length&&(G+=F.charAt(U++));a[c].v=G,a[c].t="t",O=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(X=r>1&&t<0&&c>0&&a[c-1].v==="-"?-t:t,a[c].v=ja(a[c].t,a[c].v,X),a[c].t="t");var te="";for(c=0;c!==a.length;++c)a[c]!=null&&(te+=a[c].v);return te}var $v=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Yv(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function DD(e,t){var n=MD(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var l=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,l];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var c=n[0].match($v),u=n[1].match($v);return Yv(t,c)?[r,n[0]]:Yv(t,u)?[r,n[1]]:[r,n[c!=null&&u!=null?2:1]]}return[r,l]}function zr(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:lt)[e],r==null&&(r=n.table&&n.table[zv[e]]||lt[zv[e]]),r==null&&(r=mD[e]||"General");break}if(Wu(r,0))return ds(t,n);t instanceof Date&&(t=Y2(t,n.date1904));var a=DD(r,t);if(Wu(a[1]))return ds(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return RD(a[1],t,n,a[0])}function is(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(lt[n]==null){t<0&&(t=n);continue}if(lt[n]==e){t=n;break}}t<0&&(t=391)}return lt[t]=e,t}function nT(){lt=hD()}var ID={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function FD(e){var t=typeof e=="number"?lt[e]:e;return t=t.replace(rT,"(\\d+)"),new RegExp("^"+t+"$")}function LD(e,t,n){var r=-1,a=-1,l=-1,c=-1,u=-1,p=-1;(t.match(rT)||[]).forEach(function(y,_){var E=parseInt(n[_+1],10);switch(y.toLowerCase().charAt(0)){case"y":r=E;break;case"d":l=E;break;case"h":c=E;break;case"s":p=E;break;case"m":c>=0?u=E:a=E;break}}),p>=0&&u==-1&&a>=0&&(u=a,a=-1);var m=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var x=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2);return c==-1&&u==-1&&p==-1?m:r==-1&&a==-1&&l==-1?x:m+"T"+x}var OD=function(){var e={};e.version="1.2.0";function t(){for(var F=0,W=new Array(256),O=0;O!=256;++O)F=O,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,W[O]=F;return typeof Int32Array<"u"?new Int32Array(W):W}var n=t();function r(F){var W=0,O=0,te=0,ne=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)ne[te]=F[te];for(te=0;te!=256;++te)for(O=F[te],W=256+te;W<4096;W+=256)O=ne[W]=O>>>8^F[O&255];var ee=[];for(te=1;te!=16;++te)ee[te-1]=typeof Int32Array<"u"?ne.subarray(te*256,te*256+256):ne.slice(te*256,te*256+256);return ee}var a=r(n),l=a[0],c=a[1],u=a[2],p=a[3],m=a[4],x=a[5],y=a[6],_=a[7],E=a[8],S=a[9],w=a[10],C=a[11],M=a[12],k=a[13],b=a[14];function U(F,W){for(var O=W^-1,te=0,ne=F.length;te<ne;)O=O>>>8^n[(O^F.charCodeAt(te++))&255];return~O}function G(F,W){for(var O=W^-1,te=F.length-15,ne=0;ne<te;)O=b[F[ne++]^O&255]^k[F[ne++]^O>>8&255]^M[F[ne++]^O>>16&255]^C[F[ne++]^O>>>24]^w[F[ne++]]^S[F[ne++]]^E[F[ne++]]^_[F[ne++]]^y[F[ne++]]^x[F[ne++]]^m[F[ne++]]^p[F[ne++]]^u[F[ne++]]^c[F[ne++]]^l[F[ne++]]^n[F[ne++]];for(te+=15;ne<te;)O=O>>>8^n[(O^F[ne++])&255];return~O}function X(F,W){for(var O=W^-1,te=0,ne=F.length,ee=0,Se=0;te<ne;)ee=F.charCodeAt(te++),ee<128?O=O>>>8^n[(O^ee)&255]:ee<2048?(O=O>>>8^n[(O^(192|ee>>6&31))&255],O=O>>>8^n[(O^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,Se=F.charCodeAt(te++)&1023,O=O>>>8^n[(O^(240|ee>>8&7))&255],O=O>>>8^n[(O^(128|ee>>2&63))&255],O=O>>>8^n[(O^(128|Se>>6&15|(ee&3)<<4))&255],O=O>>>8^n[(O^(128|Se&63))&255]):(O=O>>>8^n[(O^(224|ee>>12&15))&255],O=O>>>8^n[(O^(128|ee>>6&63))&255],O=O>>>8^n[(O^(128|ee&63))&255]);return~O}return e.table=n,e.bstr=U,e.buf=G,e.str=X,e}(),At=function(){var t={};t.version="1.2.1";function n(D,V){for(var L=D.split("/"),P=V.split("/"),B=0,z=0,fe=Math.min(L.length,P.length);B<fe;++B){if(z=L[B].length-P[B].length)return z;if(L[B]!=P[B])return L[B]<P[B]?-1:1}return L.length-P.length}function r(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:r(D.slice(0,-1));var V=D.lastIndexOf("/");return V===-1?D:D.slice(0,V+1)}function a(D){if(D.charAt(D.length-1)=="/")return a(D.slice(0,-1));var V=D.lastIndexOf("/");return V===-1?D:D.slice(V+1)}function l(D,V){typeof V=="string"&&(V=new Date(V));var L=V.getHours();L=L<<6|V.getMinutes(),L=L<<5|V.getSeconds()>>>1,D.write_shift(2,L);var P=V.getFullYear()-1980;P=P<<4|V.getMonth()+1,P=P<<5|V.getDate(),D.write_shift(2,P)}function c(D){var V=D.read_shift(2)&65535,L=D.read_shift(2)&65535,P=new Date,B=L&31;L>>>=5;var z=L&15;L>>>=4,P.setMilliseconds(0),P.setFullYear(L+1980),P.setMonth(z-1),P.setDate(B);var fe=V&31;V>>>=5;var _e=V&63;return V>>>=6,P.setHours(V),P.setMinutes(_e),P.setSeconds(fe<<1),P}function u(D){jn(D,0);for(var V={},L=0;D.l<=D.length-4;){var P=D.read_shift(2),B=D.read_shift(2),z=D.l+B,fe={};switch(P){case 21589:L=D.read_shift(1),L&1&&(fe.mtime=D.read_shift(4)),B>5&&(L&2&&(fe.atime=D.read_shift(4)),L&4&&(fe.ctime=D.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}D.l=z,V[P]=fe}return V}var p;function m(){return p||(p={})}function x(D,V){if(D[0]==80&&D[1]==75)return wa(D,V);if((D[0]|32)==109&&(D[1]|32)==105)return Aa(D,V);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var L=3,P=512,B=0,z=0,fe=0,_e=0,oe=0,pe=[],ve=D.slice(0,512);jn(ve,0);var Re=y(ve);switch(L=Re[0],L){case 3:P=512;break;case 4:P=4096;break;case 0:if(Re[1]==0)return wa(D,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}P!==512&&(ve=D.slice(0,P),jn(ve,28));var Oe=D.slice(0,P);_(ve,L);var Z=ve.read_shift(4,"i");if(L===3&&Z!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Z);ve.l+=4,fe=ve.read_shift(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),_e=ve.read_shift(4,"i"),B=ve.read_shift(4,"i"),oe=ve.read_shift(4,"i"),z=ve.read_shift(4,"i");for(var ce=-1,de=0;de<109&&(ce=ve.read_shift(4,"i"),!(ce<0));++de)pe[de]=ce;var Ie=E(D,P);C(oe,z,Ie,P,pe);var Ge=k(Ie,fe,pe,P);Ge[fe].name="!Directory",B>0&&_e!==Se&&(Ge[_e].name="!MiniFAT"),Ge[pe[0]].name="!FAT",Ge.fat_addrs=pe,Ge.ssz=P;var $e={},Ve=[],gt=[],Lt=[];b(fe,Ge,Ie,Ve,B,$e,gt,_e),S(gt,Lt,Ve),Ve.shift();var Ot={FileIndex:gt,FullPaths:Lt};return V&&V.raw&&(Ot.raw={header:Oe,sectors:Ie}),Ot}function y(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(Fe,"Header Signature: "),D.l+=16;var V=D.read_shift(2,"u");return[D.read_shift(2,"u"),V]}function _(D,V){var L=9;switch(D.l+=2,L=D.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function E(D,V){for(var L=Math.ceil(D.length/V)-1,P=[],B=1;B<L;++B)P[B-1]=D.slice(B*V,(B+1)*V);return P[L-1]=D.slice(L*V),P}function S(D,V,L){for(var P=0,B=0,z=0,fe=0,_e=0,oe=L.length,pe=[],ve=[];P<oe;++P)pe[P]=ve[P]=P,V[P]=L[P];for(;_e<ve.length;++_e)P=ve[_e],B=D[P].L,z=D[P].R,fe=D[P].C,pe[P]===P&&(B!==-1&&pe[B]!==B&&(pe[P]=pe[B]),z!==-1&&pe[z]!==z&&(pe[P]=pe[z])),fe!==-1&&(pe[fe]=P),B!==-1&&P!=pe[P]&&(pe[B]=pe[P],ve.lastIndexOf(B)<_e&&ve.push(B)),z!==-1&&P!=pe[P]&&(pe[z]=pe[P],ve.lastIndexOf(z)<_e&&ve.push(z));for(P=1;P<oe;++P)pe[P]===P&&(z!==-1&&pe[z]!==z?pe[P]=pe[z]:B!==-1&&pe[B]!==B&&(pe[P]=pe[B]));for(P=1;P<oe;++P)if(D[P].type!==0){if(_e=P,_e!=pe[_e])do _e=pe[_e],V[P]=V[_e]+"/"+V[P];while(_e!==0&&pe[_e]!==-1&&_e!=pe[_e]);pe[P]=-1}for(V[0]+="/",P=1;P<oe;++P)D[P].type!==2&&(V[P]+="/")}function w(D,V,L){for(var P=D.start,B=D.size,z=[],fe=P;L&&B>0&&fe>=0;)z.push(V.slice(fe*ee,fe*ee+ee)),B-=ee,fe=rs(L,fe*4);return z.length===0?bn(0):Ai(z).slice(0,D.size)}function C(D,V,L,P,B){var z=Se;if(D===Se){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var fe=L[D],_e=(P>>>2)-1;if(!fe)return;for(var oe=0;oe<_e&&(z=rs(fe,oe*4))!==Se;++oe)B.push(z);C(rs(fe,P-4),V-1,L,P,B)}}function M(D,V,L,P,B){var z=[],fe=[];B||(B=[]);var _e=P-1,oe=0,pe=0;for(oe=V;oe>=0;){B[oe]=!0,z[z.length]=oe,fe.push(D[oe]);var ve=L[Math.floor(oe*4/P)];if(pe=oe*4&_e,P<4+pe)throw new Error("FAT boundary crossed: "+oe+" 4 "+P);if(!D[ve])break;oe=rs(D[ve],pe)}return{nodes:z,data:ry([fe])}}function k(D,V,L,P){var B=D.length,z=[],fe=[],_e=[],oe=[],pe=P-1,ve=0,Re=0,Oe=0,Z=0;for(ve=0;ve<B;++ve)if(_e=[],Oe=ve+V,Oe>=B&&(Oe-=B),!fe[Oe]){oe=[];var ce=[];for(Re=Oe;Re>=0;){ce[Re]=!0,fe[Re]=!0,_e[_e.length]=Re,oe.push(D[Re]);var de=L[Math.floor(Re*4/P)];if(Z=Re*4&pe,P<4+Z)throw new Error("FAT boundary crossed: "+Re+" 4 "+P);if(!D[de]||(Re=rs(D[de],Z),ce[Re]))break}z[Oe]={nodes:_e,data:ry([oe])}}return z}function b(D,V,L,P,B,z,fe,_e){for(var oe=0,pe=P.length?2:0,ve=V[D].data,Re=0,Oe=0,Z;Re<ve.length;Re+=128){var ce=ve.slice(Re,Re+128);jn(ce,64),Oe=ce.read_shift(2),Z=Gh(ce,0,Oe-pe),P.push(Z);var de={name:Z,type:ce.read_shift(1),color:ce.read_shift(1),L:ce.read_shift(4,"i"),R:ce.read_shift(4,"i"),C:ce.read_shift(4,"i"),clsid:ce.read_shift(16),state:ce.read_shift(4,"i"),start:0,size:0},Ie=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);Ie!==0&&(de.ct=U(ce,ce.l-8));var Ge=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);Ge!==0&&(de.mt=U(ce,ce.l-8)),de.start=ce.read_shift(4,"i"),de.size=ce.read_shift(4,"i"),de.size<0&&de.start<0&&(de.size=de.type=0,de.start=Se,de.name=""),de.type===5?(oe=de.start,B>0&&oe!==Se&&(V[oe].name="!StreamData")):de.size>=4096?(de.storage="fat",V[de.start]===void 0&&(V[de.start]=M(L,de.start,V.fat_addrs,V.ssz)),V[de.start].name=de.name,de.content=V[de.start].data.slice(0,de.size)):(de.storage="minifat",de.size<0?de.size=0:oe!==Se&&de.start!==Se&&V[oe]&&(de.content=w(de,V[oe].data,(V[_e]||{}).data))),de.content&&jn(de.content,0),z[Z]=de,fe.push(de)}}function U(D,V){return new Date((Ar(D,V+4)/1e7*Math.pow(2,32)+Ar(D,V)/1e7-11644473600)*1e3)}function G(D,V){return m(),x(p.readFileSync(D),V)}function X(D,V){var L=V&&V.type;switch(L||St&&Buffer.isBuffer(D)&&(L="buffer"),L||"base64"){case"file":return G(D,V);case"base64":return x(Qr(kr(D)),V);case"binary":return x(Qr(D),V)}return x(D,V)}function F(D,V){var L=V||{},P=L.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=P+"/",D.FileIndex[0]={name:P,type:5}),L.CLSID&&(D.FileIndex[0].clsid=L.CLSID),W(D)}function W(D){var V="Sh33tJ5";if(!At.find(D,"/"+V)){var L=bn(4);L[0]=55,L[1]=L[3]=50,L[2]=54,D.FileIndex.push({name:V,type:2,content:L,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+V),O(D)}}function O(D,V){F(D);for(var L=!1,P=!1,B=D.FullPaths.length-1;B>=0;--B){var z=D.FileIndex[B];switch(z.type){case 0:P?L=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(z.R*z.L*z.C)&&(L=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!V)){var fe=new Date(1987,1,19),_e=0,oe=Object.create?Object.create(null):{},pe=[];for(B=0;B<D.FullPaths.length;++B)oe[D.FullPaths[B]]=!0,D.FileIndex[B].type!==0&&pe.push([D.FullPaths[B],D.FileIndex[B]]);for(B=0;B<pe.length;++B){var ve=r(pe[B][0]);P=oe[ve],P||(pe.push([ve,{name:a(ve).replace("/",""),type:1,clsid:ae,ct:fe,mt:fe,content:null}]),oe[ve]=!0)}for(pe.sort(function(Z,ce){return n(Z[0],ce[0])}),D.FullPaths=[],D.FileIndex=[],B=0;B<pe.length;++B)D.FullPaths[B]=pe[B][0],D.FileIndex[B]=pe[B][1];for(B=0;B<pe.length;++B){var Re=D.FileIndex[B],Oe=D.FullPaths[B];if(Re.name=a(Oe).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||ae,B===0)Re.C=pe.length>1?1:-1,Re.size=0,Re.type=5;else if(Oe.slice(-1)=="/"){for(_e=B+1;_e<pe.length&&r(D.FullPaths[_e])!=Oe;++_e);for(Re.C=_e>=pe.length?-1:_e,_e=B+1;_e<pe.length&&r(D.FullPaths[_e])!=r(Oe);++_e);Re.R=_e>=pe.length?-1:_e,Re.type=1}else r(D.FullPaths[B+1]||"")==r(Oe)&&(Re.R=B+1),Re.type=2}}}function te(D,V){var L=V||{};if(L.fileType=="mad")return Vn(D,L);switch(O(D),L.fileType){case"zip":return Pe(D,L)}var P=function(Z){for(var ce=0,de=0,Ie=0;Ie<Z.FileIndex.length;++Ie){var Ge=Z.FileIndex[Ie];if(Ge.content){var $e=Ge.content.length;$e>0&&($e<4096?ce+=$e+63>>6:de+=$e+511>>9)}}for(var Ve=Z.FullPaths.length+3>>2,gt=ce+7>>3,Lt=ce+127>>7,Ot=gt+de+Ve+Lt,Pt=Ot+127>>7,Dn=Pt<=109?0:Math.ceil((Pt-109)/127);Ot+Pt+Dn+127>>7>Pt;)Dn=++Pt<=109?0:Math.ceil((Pt-109)/127);var Sn=[1,Dn,Pt,Lt,Ve,de,ce,0];return Z.FileIndex[0].size=ce<<6,Sn[7]=(Z.FileIndex[0].start=Sn[0]+Sn[1]+Sn[2]+Sn[3]+Sn[4]+Sn[5])+(Sn[6]+7>>3),Sn}(D),B=bn(P[7]<<9),z=0,fe=0;{for(z=0;z<8;++z)B.write_shift(1,we[z]);for(z=0;z<8;++z)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),z=0;z<3;++z)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,P[2]),B.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:Se),B.write_shift(4,P[3]),B.write_shift(-4,P[1]?P[0]-1:Se),B.write_shift(4,P[1]),z=0;z<109;++z)B.write_shift(-4,z<P[2]?P[1]+z:-1)}if(P[1])for(fe=0;fe<P[1];++fe){for(;z<236+fe*127;++z)B.write_shift(-4,z<P[2]?P[1]+z:-1);B.write_shift(-4,fe===P[1]-1?Se:fe+1)}var _e=function(Z){for(fe+=Z;z<fe-1;++z)B.write_shift(-4,z+1);Z&&(++z,B.write_shift(-4,Se))};for(fe=z=0,fe+=P[1];z<fe;++z)B.write_shift(-4,me.DIFSECT);for(fe+=P[2];z<fe;++z)B.write_shift(-4,me.FATSECT);_e(P[3]),_e(P[4]);for(var oe=0,pe=0,ve=D.FileIndex[0];oe<D.FileIndex.length;++oe)ve=D.FileIndex[oe],ve.content&&(pe=ve.content.length,!(pe<4096)&&(ve.start=fe,_e(pe+511>>9)));for(_e(P[6]+7>>3);B.l&511;)B.write_shift(-4,me.ENDOFCHAIN);for(fe=z=0,oe=0;oe<D.FileIndex.length;++oe)ve=D.FileIndex[oe],ve.content&&(pe=ve.content.length,!(!pe||pe>=4096)&&(ve.start=fe,_e(pe+63>>6)));for(;B.l&511;)B.write_shift(-4,me.ENDOFCHAIN);for(z=0;z<P[4]<<2;++z){var Re=D.FullPaths[z];if(!Re||Re.length===0){for(oe=0;oe<17;++oe)B.write_shift(4,0);for(oe=0;oe<3;++oe)B.write_shift(4,-1);for(oe=0;oe<12;++oe)B.write_shift(4,0);continue}ve=D.FileIndex[z],z===0&&(ve.start=ve.size?ve.start-1:Se);var Oe=z===0&&L.root||ve.name;if(pe=2*(Oe.length+1),B.write_shift(64,Oe,"utf16le"),B.write_shift(2,pe),B.write_shift(1,ve.type),B.write_shift(1,ve.color),B.write_shift(-4,ve.L),B.write_shift(-4,ve.R),B.write_shift(-4,ve.C),ve.clsid)B.write_shift(16,ve.clsid,"hex");else for(oe=0;oe<4;++oe)B.write_shift(4,0);B.write_shift(4,ve.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,ve.start),B.write_shift(4,ve.size),B.write_shift(4,0)}for(z=1;z<D.FileIndex.length;++z)if(ve=D.FileIndex[z],ve.size>=4096)if(B.l=ve.start+1<<9,St&&Buffer.isBuffer(ve.content))ve.content.copy(B,B.l,0,ve.size),B.l+=ve.size+511&-512;else{for(oe=0;oe<ve.size;++oe)B.write_shift(1,ve.content[oe]);for(;oe&511;++oe)B.write_shift(1,0)}for(z=1;z<D.FileIndex.length;++z)if(ve=D.FileIndex[z],ve.size>0&&ve.size<4096)if(St&&Buffer.isBuffer(ve.content))ve.content.copy(B,B.l,0,ve.size),B.l+=ve.size+63&-64;else{for(oe=0;oe<ve.size;++oe)B.write_shift(1,ve.content[oe]);for(;oe&63;++oe)B.write_shift(1,0)}if(St)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function ne(D,V){var L=D.FullPaths.map(function(oe){return oe.toUpperCase()}),P=L.map(function(oe){var pe=oe.split("/");return pe[pe.length-(oe.slice(-1)=="/"?2:1)]}),B=!1;V.charCodeAt(0)===47?(B=!0,V=L[0].slice(0,-1)+V):B=V.indexOf("/")!==-1;var z=V.toUpperCase(),fe=B===!0?L.indexOf(z):P.indexOf(z);if(fe!==-1)return D.FileIndex[fe];var _e=!z.match(Ro);for(z=z.replace(cr,""),_e&&(z=z.replace(Ro,"!")),fe=0;fe<L.length;++fe)if((_e?L[fe].replace(Ro,"!"):L[fe]).replace(cr,"")==z||(_e?P[fe].replace(Ro,"!"):P[fe]).replace(cr,"")==z)return D.FileIndex[fe];return null}var ee=64,Se=-2,Fe="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Se,FREESECT:-1,HEADER_SIGNATURE:Fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(D,V,L){m();var P=te(D,L);p.writeFileSync(V,P)}function q(D){for(var V=new Array(D.length),L=0;L<D.length;++L)V[L]=String.fromCharCode(D[L]);return V.join("")}function N(D,V){var L=te(D,V);switch(V&&V.type||"buffer"){case"file":return m(),p.writeFileSync(V.filename,L),L;case"binary":return typeof L=="string"?L:q(L);case"base64":return Bv(typeof L=="string"?L:q(L));case"buffer":if(St)return Buffer.isBuffer(L)?L:gs(L);case"array":return typeof L=="string"?Qr(L):L}return L}var j;function R(D){try{var V=D.InflateRaw,L=new V;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)j=D;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function J(D,V){if(!j)return Za(D,V);var L=j.InflateRaw,P=new L,B=P._processChunk(D.slice(D.l),P._finishFlushFlag);return D.l+=P.bytesRead,B}function Y(D){return j?j.deflateRawSync(D):Ue(D)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(D){var V=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(V>>16|V>>8|V)&255}for(var De=typeof Uint8Array<"u",Ce=De?new Uint8Array(256):[],Je=0;Je<256;++Je)Ce[Je]=ke(Je);function K(D,V){var L=Ce[D&255];return V<=8?L>>>8-V:(L=L<<8|Ce[D>>8&255],V<=16?L>>>16-V:(L=L<<8|Ce[D>>16&255],L>>>24-V))}function pt(D,V){var L=V&7,P=V>>>3;return(D[P]|(L<=6?0:D[P+1]<<8))>>>L&3}function Ke(D,V){var L=V&7,P=V>>>3;return(D[P]|(L<=5?0:D[P+1]<<8))>>>L&7}function ft(D,V){var L=V&7,P=V>>>3;return(D[P]|(L<=4?0:D[P+1]<<8))>>>L&15}function Me(D,V){var L=V&7,P=V>>>3;return(D[P]|(L<=3?0:D[P+1]<<8))>>>L&31}function Te(D,V){var L=V&7,P=V>>>3;return(D[P]|(L<=1?0:D[P+1]<<8))>>>L&127}function He(D,V,L){var P=V&7,B=V>>>3,z=(1<<L)-1,fe=D[B]>>>P;return L<8-P||(fe|=D[B+1]<<8-P,L<16-P)||(fe|=D[B+2]<<16-P,L<24-P)||(fe|=D[B+3]<<24-P),fe&z}function ze(D,V,L){var P=V&7,B=V>>>3;return P<=5?D[B]|=(L&7)<<P:(D[B]|=L<<P&255,D[B+1]=(L&7)>>8-P),V+3}function Ft(D,V,L){var P=V&7,B=V>>>3;return L=(L&1)<<P,D[B]|=L,V+1}function Tt(D,V,L){var P=V&7,B=V>>>3;return L<<=P,D[B]|=L&255,L>>>=8,D[B+1]=L,V+8}function ot(D,V,L){var P=V&7,B=V>>>3;return L<<=P,D[B]|=L&255,L>>>=8,D[B+1]=L&255,D[B+2]=L>>>8,V+16}function fn(D,V){var L=D.length,P=2*L>V?2*L:V+5,B=0;if(L>=V)return D;if(St){var z=Vv(P);if(D.copy)D.copy(z);else for(;B<D.length;++B)z[B]=D[B];return z}else if(De){var fe=new Uint8Array(P);if(fe.set)fe.set(D);else for(;B<L;++B)fe[B]=D[B];return fe}return D.length=P,D}function an(D){for(var V=new Array(D),L=0;L<D;++L)V[L]=0;return V}function Un(D,V,L){var P=1,B=0,z=0,fe=0,_e=0,oe=D.length,pe=De?new Uint16Array(32):an(32);for(z=0;z<32;++z)pe[z]=0;for(z=oe;z<L;++z)D[z]=0;oe=D.length;var ve=De?new Uint16Array(oe):an(oe);for(z=0;z<oe;++z)pe[B=D[z]]++,P<B&&(P=B),ve[z]=0;for(pe[0]=0,z=1;z<=P;++z)pe[z+16]=_e=_e+pe[z-1]<<1;for(z=0;z<oe;++z)_e=D[z],_e!=0&&(ve[z]=pe[_e+16]++);var Re=0;for(z=0;z<oe;++z)if(Re=D[z],Re!=0)for(_e=K(ve[z],P)>>P-Re,fe=(1<<P+4-Re)-1;fe>=0;--fe)V[_e|fe<<Re]=Re&15|z<<4;return P}var $t=De?new Uint16Array(512):an(512),Yt=De?new Uint16Array(32):an(32);if(!De){for(var at=0;at<512;++at)$t[at]=0;for(at=0;at<32;++at)Yt[at]=0}(function(){for(var D=[],V=0;V<32;V++)D.push(5);Un(D,Yt,32);var L=[];for(V=0;V<=143;V++)L.push(8);for(;V<=255;V++)L.push(9);for(;V<=279;V++)L.push(7);for(;V<=287;V++)L.push(8);Un(L,$t,288)})();var Dt=function(){for(var V=De?new Uint8Array(32768):[],L=0,P=0;L<Ee.length-1;++L)for(;P<Ee[L+1];++P)V[P]=L;for(;P<32768;++P)V[P]=29;var B=De?new Uint8Array(259):[];for(L=0,P=0;L<se.length-1;++L)for(;P<se[L+1];++P)B[P]=L;function z(_e,oe){for(var pe=0;pe<_e.length;){var ve=Math.min(65535,_e.length-pe),Re=pe+ve==_e.length;for(oe.write_shift(1,+Re),oe.write_shift(2,ve),oe.write_shift(2,~ve&65535);ve-- >0;)oe[oe.l++]=_e[pe++]}return oe.l}function fe(_e,oe){for(var pe=0,ve=0,Re=De?new Uint16Array(32768):[];ve<_e.length;){var Oe=Math.min(65535,_e.length-ve);if(Oe<10){for(pe=ze(oe,pe,+(ve+Oe==_e.length)),pe&7&&(pe+=8-(pe&7)),oe.l=pe/8|0,oe.write_shift(2,Oe),oe.write_shift(2,~Oe&65535);Oe-- >0;)oe[oe.l++]=_e[ve++];pe=oe.l*8;continue}pe=ze(oe,pe,+(ve+Oe==_e.length)+2);for(var Z=0;Oe-- >0;){var ce=_e[ve];Z=(Z<<5^ce)&32767;var de=-1,Ie=0;if((de=Re[Z])&&(de|=ve&-32768,de>ve&&(de-=32768),de<ve))for(;_e[de+Ie]==_e[ve+Ie]&&Ie<250;)++Ie;if(Ie>2){ce=B[Ie],ce<=22?pe=Tt(oe,pe,Ce[ce+1]>>1)-1:(Tt(oe,pe,3),pe+=5,Tt(oe,pe,Ce[ce-23]>>5),pe+=3);var Ge=ce<8?0:ce-4>>2;Ge>0&&(ot(oe,pe,Ie-se[ce]),pe+=Ge),ce=V[ve-de],pe=Tt(oe,pe,Ce[ce]>>3),pe-=3;var $e=ce<4?0:ce-2>>1;$e>0&&(ot(oe,pe,ve-de-Ee[ce]),pe+=$e);for(var Ve=0;Ve<Ie;++Ve)Re[Z]=ve&32767,Z=(Z<<5^_e[ve])&32767,++ve;Oe-=Ie-1}else ce<=143?ce=ce+48:pe=Ft(oe,pe,1),pe=Tt(oe,pe,Ce[ce]),Re[Z]=ve&32767,++ve}pe=Tt(oe,pe,0)-1}return oe.l=(pe+7)/8|0,oe.l}return function(oe,pe){return oe.length<8?z(oe,pe):fe(oe,pe)}}();function Ue(D){var V=bn(50+Math.floor(D.length*1.1)),L=Dt(D,V);return V.slice(0,L)}var dt=De?new Uint16Array(32768):an(32768),jt=De?new Uint16Array(32768):an(32768),Et=De?new Uint16Array(128):an(128),Mn=1,Bn=1;function $r(D,V){var L=Me(D,V)+257;V+=5;var P=Me(D,V)+1;V+=5;var B=ft(D,V)+4;V+=4;for(var z=0,fe=De?new Uint8Array(19):an(19),_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,pe=De?new Uint8Array(8):an(8),ve=De?new Uint8Array(8):an(8),Re=fe.length,Oe=0;Oe<B;++Oe)fe[H[Oe]]=z=Ke(D,V),oe<z&&(oe=z),pe[z]++,V+=3;var Z=0;for(pe[0]=0,Oe=1;Oe<=oe;++Oe)ve[Oe]=Z=Z+pe[Oe-1]<<1;for(Oe=0;Oe<Re;++Oe)(Z=fe[Oe])!=0&&(_e[Oe]=ve[Z]++);var ce=0;for(Oe=0;Oe<Re;++Oe)if(ce=fe[Oe],ce!=0){Z=Ce[_e[Oe]]>>8-ce;for(var de=(1<<7-ce)-1;de>=0;--de)Et[Z|de<<ce]=ce&7|Oe<<3}var Ie=[];for(oe=1;Ie.length<L+P;)switch(Z=Et[Te(D,V)],V+=Z&7,Z>>>=3){case 16:for(z=3+pt(D,V),V+=2,Z=Ie[Ie.length-1];z-- >0;)Ie.push(Z);break;case 17:for(z=3+Ke(D,V),V+=3;z-- >0;)Ie.push(0);break;case 18:for(z=11+Te(D,V),V+=7;z-- >0;)Ie.push(0);break;default:Ie.push(Z),oe<Z&&(oe=Z);break}var Ge=Ie.slice(0,L),$e=Ie.slice(L);for(Oe=L;Oe<286;++Oe)Ge[Oe]=0;for(Oe=P;Oe<30;++Oe)$e[Oe]=0;return Mn=Un(Ge,dt,286),Bn=Un($e,jt,30),V}function Yr(D,V){if(D[0]==3&&!(D[1]&3))return[Oi(V),2];for(var L=0,P=0,B=Vv(V||1<<18),z=0,fe=B.length>>>0,_e=0,oe=0;(P&1)==0;){if(P=Ke(D,L),L+=3,P>>>1)P>>1==1?(_e=9,oe=5):(L=$r(D,L),_e=Mn,oe=Bn);else{L&7&&(L+=8-(L&7));var pe=D[L>>>3]|D[(L>>>3)+1]<<8;if(L+=32,pe>0)for(!V&&fe<z+pe&&(B=fn(B,z+pe),fe=B.length);pe-- >0;)B[z++]=D[L>>>3],L+=8;continue}for(;;){!V&&fe<z+32767&&(B=fn(B,z+32767),fe=B.length);var ve=He(D,L,_e),Re=P>>>1==1?$t[ve]:dt[ve];if(L+=Re&15,Re>>>=4,(Re>>>8&255)===0)B[z++]=Re;else{if(Re==256)break;Re-=257;var Oe=Re<8?0:Re-4>>2;Oe>5&&(Oe=0);var Z=z+se[Re];Oe>0&&(Z+=He(D,L,Oe),L+=Oe),ve=He(D,L,oe),Re=P>>>1==1?Yt[ve]:jt[ve],L+=Re&15,Re>>>=4;var ce=Re<4?0:Re-2>>1,de=Ee[Re];for(ce>0&&(de+=He(D,L,ce),L+=ce),!V&&fe<Z&&(B=fn(B,Z+100),fe=B.length);z<Z;)B[z]=B[z-de],++z}}}return V?[B,L+7>>>3]:[B.slice(0,z),L+7>>>3]}function Za(D,V){var L=D.slice(D.l||0),P=Yr(L,V);return D.l+=P[1],P[0]}function Sa(D,V){if(D)typeof console<"u"&&console.error(V);else throw new Error(V)}function wa(D,V){var L=D;jn(L,0);var P=[],B=[],z={FileIndex:P,FullPaths:B};F(z,{root:V.root});for(var fe=L.length-4;(L[fe]!=80||L[fe+1]!=75||L[fe+2]!=5||L[fe+3]!=6)&&fe>=0;)--fe;L.l=fe+4,L.l+=4;var _e=L.read_shift(2);L.l+=6;var oe=L.read_shift(4);for(L.l=oe,fe=0;fe<_e;++fe){L.l+=20;var pe=L.read_shift(4),ve=L.read_shift(4),Re=L.read_shift(2),Oe=L.read_shift(2),Z=L.read_shift(2);L.l+=8;var ce=L.read_shift(4),de=u(L.slice(L.l+Re,L.l+Re+Oe));L.l+=Re+Oe+Z;var Ie=L.l;L.l=ce+4,Ca(L,pe,ve,z,de),L.l=Ie}return z}function Ca(D,V,L,P,B){D.l+=2;var z=D.read_shift(2),fe=D.read_shift(2),_e=c(D);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var oe=D.read_shift(4),pe=D.read_shift(4),ve=D.read_shift(4),Re=D.read_shift(2),Oe=D.read_shift(2),Z="",ce=0;ce<Re;++ce)Z+=String.fromCharCode(D[D.l++]);if(Oe){var de=u(D.slice(D.l,D.l+Oe));(de[21589]||{}).mt&&(_e=de[21589].mt),((B||{})[21589]||{}).mt&&(_e=B[21589].mt)}D.l+=Oe;var Ie=D.slice(D.l,D.l+pe);switch(fe){case 8:Ie=J(D,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var Ge=!1;z&8&&(oe=D.read_shift(4),oe==134695760&&(oe=D.read_shift(4),Ge=!0),pe=D.read_shift(4),ve=D.read_shift(4)),pe!=V&&Sa(Ge,"Bad compressed size: "+V+" != "+pe),ve!=L&&Sa(Ge,"Bad uncompressed size: "+L+" != "+ve),Qt(P,Z,Ie,{unsafe:!0,mt:_e})}function Pe(D,V){var L=V||{},P=[],B=[],z=bn(1),fe=L.compression?8:0,_e=0,oe=0,pe=0,ve=0,Re=0,Oe=D.FullPaths[0],Z=Oe,ce=D.FileIndex[0],de=[],Ie=0;for(oe=1;oe<D.FullPaths.length;++oe)if(Z=D.FullPaths[oe].slice(Oe.length),ce=D.FileIndex[oe],!(!ce.size||!ce.content||Z=="Sh33tJ5")){var Ge=ve,$e=bn(Z.length);for(pe=0;pe<Z.length;++pe)$e.write_shift(1,Z.charCodeAt(pe)&127);$e=$e.slice(0,$e.l),de[Re]=OD.buf(ce.content,0);var Ve=ce.content;fe==8&&(Ve=Y(Ve)),z=bn(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,_e),z.write_shift(2,fe),ce.mt?l(z,ce.mt):z.write_shift(4,0),z.write_shift(-4,de[Re]),z.write_shift(4,Ve.length),z.write_shift(4,ce.content.length),z.write_shift(2,$e.length),z.write_shift(2,0),ve+=z.length,P.push(z),ve+=$e.length,P.push($e),ve+=Ve.length,P.push(Ve),z=bn(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,_e),z.write_shift(2,fe),z.write_shift(4,0),z.write_shift(-4,de[Re]),z.write_shift(4,Ve.length),z.write_shift(4,ce.content.length),z.write_shift(2,$e.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Ge),Ie+=z.l,B.push(z),Ie+=$e.length,B.push($e),++Re}return z=bn(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,Re),z.write_shift(2,Re),z.write_shift(4,Ie),z.write_shift(4,ve),z.write_shift(2,0),Ai([Ai(P),Ai(B),z])}var st={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xt(D,V){if(D.ctype)return D.ctype;var L=D.name||"",P=L.match(/\.([^\.]+)$/);return P&&st[P[1]]||V&&(P=(L=V).match(/[\.\\]([^\.\\])+$/),P&&st[P[1]])?st[P[1]]:"application/octet-stream"}function sn(D){for(var V=Bv(D),L=[],P=0;P<V.length;P+=76)L.push(V.slice(P,P+76));return L.join(`\r
`)+`\r
`}function Rn(D){var V=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var ve=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],P=V.split(`\r
`),B=0;B<P.length;++B){var z=P[B];if(z.length==0){L.push("");continue}for(var fe=0;fe<z.length;){var _e=76,oe=z.slice(fe,fe+_e);oe.charAt(_e-1)=="="?_e--:oe.charAt(_e-2)=="="?_e-=2:oe.charAt(_e-3)=="="&&(_e-=3),oe=z.slice(fe,fe+_e),fe+=_e,fe<z.length&&(oe+="="),L.push(oe)}}return L.join(`\r
`)}function En(D){for(var V=[],L=0;L<D.length;++L){for(var P=D[L];L<=D.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+D[++L];V.push(P)}for(var B=0;B<V.length;++B)V[B]=V[B].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Qr(V.join(`\r
`))}function Nr(D,V,L){for(var P="",B="",z="",fe,_e=0;_e<10;++_e){var oe=V[_e];if(!oe||oe.match(/^\s*$/))break;var pe=oe.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":P=pe[2].trim();break;case"content-type":z=pe[2].trim();break;case"content-transfer-encoding":B=pe[2].trim();break}}switch(++_e,B.toLowerCase()){case"base64":fe=Qr(kr(V.slice(_e).join("")));break;case"quoted-printable":fe=En(V.slice(_e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var ve=Qt(D,P.slice(L.length),fe,{unsafe:!0});z&&(ve.ctype=z)}function Aa(D,V){if(q(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=V&&V.root||"",P=(St&&Buffer.isBuffer(D)?D.toString("binary"):q(D)).split(`\r
`),B=0,z="";for(B=0;B<P.length;++B)if(z=P[B],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),L||(L=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),z.slice(0,L.length)!=L););var fe=(P[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var _e="--"+(fe[1]||""),oe=[],pe=[],ve={FileIndex:oe,FullPaths:pe};F(ve);var Re,Oe=0;for(B=0;B<P.length;++B){var Z=P[B];Z!==_e&&Z!==_e+"--"||(Oe++&&Nr(ve,P.slice(Re,B),L),Re=B)}return ve}function Vn(D,V){var L=V||{},P=L.boundary||"SheetJS";P="------="+P;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],z=D.FullPaths[0],fe=z,_e=D.FileIndex[0],oe=1;oe<D.FullPaths.length;++oe)if(fe=D.FullPaths[oe].slice(z.length),_e=D.FileIndex[oe],!(!_e.size||!_e.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var pe=_e.content,ve=St&&Buffer.isBuffer(pe)?pe.toString("binary"):q(pe),Re=0,Oe=Math.min(1024,ve.length),Z=0,ce=0;ce<=Oe;++ce)(Z=ve.charCodeAt(ce))>=32&&Z<128&&++Re;var de=Re>=Oe*4/5;B.push(P),B.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+fe),B.push("Content-Transfer-Encoding: "+(de?"quoted-printable":"base64")),B.push("Content-Type: "+xt(_e,fe)),B.push(""),B.push(de?Rn(ve):sn(ve))}return B.push(P+`--\r
`),B.join(`\r
`)}function Zt(D){var V={};return F(V,D),V}function Qt(D,V,L,P){var B=P&&P.unsafe;B||F(D);var z=!B&&At.find(D,V);if(!z){var fe=D.FullPaths[0];V.slice(0,fe.length)==fe?fe=V:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+V).replace("//","/")),z={name:a(V),type:2},D.FileIndex.push(z),D.FullPaths.push(fe),B||At.utils.cfb_gc(D)}return z.content=L,z.size=L?L.length:0,P&&(P.CLSID&&(z.clsid=P.CLSID),P.mt&&(z.mt=P.mt),P.ct&&(z.ct=P.ct)),z}function _t(D,V){F(D);var L=At.find(D,V);if(L){for(var P=0;P<D.FileIndex.length;++P)if(D.FileIndex[P]==L)return D.FileIndex.splice(P,1),D.FullPaths.splice(P,1),!0}return!1}function Mr(D,V,L){F(D);var P=At.find(D,V);if(P){for(var B=0;B<D.FileIndex.length;++B)if(D.FileIndex[B]==P)return D.FileIndex[B].name=a(L),D.FullPaths[B]=L,!0}return!1}function ba(D){O(D,!0)}return t.find=ne,t.read=X,t.parse=x,t.write=N,t.writeFile=re,t.utils={cfb_new:Zt,cfb_add:Qt,cfb_del:_t,cfb_mov:Mr,cfb_gc:ba,ReadShift:Oo,CheckField:CT,prep_blob:jn,bconcat:Ai,use_zlib:R,_deflateRaw:Ue,_inflateRaw:Za,consts:me},t}();function PD(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function ya(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Uh(e){for(var t=[],n=ya(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}var Ju=new Date(1899,11,30,0,0,0);function fr(e,t){var n=e.getTime(),r=Ju.getTime()+(e.getTimezoneOffset()-Ju.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var aT=new Date,UD=Ju.getTime()+(aT.getTimezoneOffset()-Ju.getTimezoneOffset())*6e4,Wv=aT.getTimezoneOffset();function xf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+UD),t.getTimezoneOffset()!==Wv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Wv)*6e4),t}function BD(e){var t=0,n=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=a.length;++l)if(a[l]){switch(n=1,l>3&&(r=!0),a[l].slice(a[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[l].slice(a[l].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=n*parseInt(a[l],10)}return t}var Xv=new Date("2017-02-19T19:06:09.000Z"),iT=isNaN(Xv.getFullYear())?new Date("2/19/17"):Xv,VD=iT.getFullYear()==2017;function Pn(e,t){var n=new Date(e);if(VD)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(iT.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function hs(e,t){if(St&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Io(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Io(q2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Io(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Io(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return n[l]||l})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function qn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=qn(e[n]));return t}function cn(e,t){for(var n="";n.length<t;)n+=e;return n}function ra(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,l){return n=-n,l}),!isNaN(t=Number(r)))?t/n:t}var HD=["january","february","march","april","may","june","july","august","september","october","november","december"];function Tl(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),l=t.getDate();if(isNaN(l))return n;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&HD.indexOf(c)==-1)return n}else if(c.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||l>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}var GD=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(e||typeof r=="string")return n.split(r);for(var l=n.split(r),c=[l[0]],u=1;u<l.length;++u)c.push(a),c.push(l[u]);return c}}();function sT(e){return e?e.content&&e.type?hs(e.content,!0):e.data?Mo(e.data):e.asNodeBuffer&&St?Mo(e.asNodeBuffer().toString("binary")):e.asBinary?Mo(e.asBinary()):e._data&&e._data.getContent?Mo(hs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function lT(e){if(!e)return null;if(e.data)return Pv(e.data);if(e.asNodeBuffer&&St)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Pv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function zD(e){return e&&e.name.slice(-4)===".bin"?lT(e):sT(e)}function Hr(e,t){for(var n=e.FullPaths||ya(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),l=0;l<n.length;++l){var c=n[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==c||a==c)return e.files?e.files[n[l]]:e.FileIndex[l]}return null}function Bh(e,t){var n=Hr(e,t);if(n==null)throw new Error("Cannot find file "+t+" in zip");return n}function yn(e,t,n){if(!n)return zD(Bh(e,t));if(!t)return null;try{return yn(e,t)}catch{return null}}function br(e,t,n){if(!n)return sT(Bh(e,t));if(!t)return null;try{return br(e,t)}catch{return null}}function jD(e,t,n){return lT(Bh(e,t))}function Jv(e){for(var t=e.FullPaths||ya(e.files),n=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function qD(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return St?r=gs(n):r=uD(n),At.utils.cfb_add(e,t,r)}At.utils.cfb_add(e,t,n)}else e.file(t,n)}function oT(e,t){switch(t.type){case"base64":return At.read(e,{type:"base64"});case"binary":return At.read(e,{type:"binary"});case"buffer":case"array":return At.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Do(e,t){if(e.charAt(0)=="/")return e.slice(1);var n=t.split("/");t.slice(-1)!="/"&&n.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var cT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$D=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Kv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,YD=/<[^>]*>/g,nr=cT.match(Kv)?Kv:YD,WD=/<\w*:/,XD=/<(\/?)\w+:/;function tt(e,t,n){for(var r={},a=0,l=0;a!==e.length&&!((l=e.charCodeAt(a))===32||l===10||l===13);++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var c=e.match($D),u=0,p="",m=0,x="",y="",_=1;if(c)for(m=0;m!=c.length;++m){for(y=c[m],l=0;l!=y.length&&y.charCodeAt(l)!==61;++l);for(x=y.slice(0,l).trim();y.charCodeAt(l+1)==32;)++l;for(_=(a=y.charCodeAt(l+1))==34||a==39?1:0,p=y.slice(l+1+_,y.length-_),u=0;u!=x.length&&x.charCodeAt(u)!==58;++u);if(u===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),r[x]=p,r[x.toLowerCase()]=p;else{var E=(u===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(u+1);if(r[E]&&x.slice(u-3,u)=="ext")continue;r[E]=p,r[E.toLowerCase()]=p}}return r}function _a(e){return e.replace(XD,"<$1")}var uT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},JD=Uh(uT),Nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",l=a.indexOf("<![CDATA[");if(l==-1)return a.replace(e,function(u,p){return uT[u]||String.fromCharCode(parseInt(p,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,p){return String.fromCharCode(parseInt(p,16))});var c=a.indexOf("]]>");return n(a.slice(0,l))+a.slice(l+9,c)+n(a.slice(c+3))}}(),KD=/[&<>'"]/g,ZD=/[\u0000-\u001f]/g;function Vh(e){var t=e+"";return t.replace(KD,function(n){return JD[n]}).replace(/\n/g,"<br/>").replace(ZD,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var Zv=function(){var e=/&#(\d+);/g;function t(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}}();function nn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Fd(e){for(var t="",n=0,r=0,a=0,l=0,c=0,u=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(a=e.charCodeAt(n++),r>191&&r<224){c=(r&31)<<6,c|=a&63,t+=String.fromCharCode(c);continue}if(l=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(a&63)<<6|l&63);continue}c=e.charCodeAt(n++),u=((r&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Qv(e){var t=Oi(2*e.length),n,r,a=1,l=0,c=0,u;for(r=0;r<e.length;r+=a)a=1,(u=e.charCodeAt(r))<128?n=u:u<224?(n=(u&31)*64+(e.charCodeAt(r+1)&63),a=2):u<240?(n=(u&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,n=(u&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,c=55296+(n>>>10&1023),n=56320+(n&1023)),c!==0&&(t[l++]=c&255,t[l++]=c>>>8,c=0),t[l++]=n%256,t[l++]=n>>>8;return t.slice(0,l).toString("ucs2")}function ey(e){return gs(e,"binary").toString("utf8")}var Cu="foo bar baz",Jt=St&&(ey(Cu)==Fd(Cu)&&ey||Qv(Cu)==Fd(Cu)&&Qv)||Fd,Io=St?function(e){return gs(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},Qo=function(){var e={};return function(n,r){var a=n+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),fT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}}(),QD=function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),e6=/<\/?(?:vt:)?variant>/g,t6=/<(?:vt:)([^>]*)>([\s\S]*)</;function ty(e,t){var n=tt(e),r=e.match(QD(n.baseType))||[],a=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(l){var c=l.replace(e6,"").match(t6);c&&a.push({v:Jt(c[2]),t:c[1]})}),a}var n6=/(^\s|\s$|\n)/;function r6(e){return ya(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function a6(e,t,n){return"<"+e+(n!=null?r6(n):"")+(t!=null?(t.match(n6)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Hh(e){if(St&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Jt(vs(Lh(e)));throw new Error("Bad input format: expected Buffer or string")}var ec=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,i6={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},s6=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function l6(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,l=5;l>=0;--l)a=a*256+e[t+l];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function o6(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,l=0,c=r?-t:t;isFinite(c)?c==0?a=l=0:(a=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?a=-1022:(l-=Math.pow(2,52),a+=1023)):(a=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[n+u]=l&255;e[n+6]=(a&15)<<4|l&15,e[n+7]=a>>4|r}var ny=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,l=e[0][r].length;a<l;a+=n)t.push.apply(t,e[0][r].slice(a,a+n));return t},ry=St?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:gs(t)})):ny(e)}:ny,ay=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(za(e,a)));return r.join("").replace(cr,"")},Gh=St?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(cr,""):ay(e,t,n)}:ay,iy=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},dT=St?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):iy(e,t,n)}:iy,sy=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(ll(e,a)));return r.join("")},cc=St?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):sy(t,n,r)}:sy,hT=function(e,t){var n=Ar(e,t);return n>0?cc(e,t+4,t+4+n-1):""},mT=hT,pT=function(e,t){var n=Ar(e,t);return n>0?cc(e,t+4,t+4+n-1):""},xT=pT,gT=function(e,t){var n=2*Ar(e,t);return n>0?cc(e,t+4,t+4+n-1):""},vT=gT,yT=function(t,n){var r=Ar(t,n);return r>0?Gh(t,n+4,n+4+r):""},TT=yT,_T=function(e,t){var n=Ar(e,t);return n>0?cc(e,t+4,t+4+n):""},ET=_T,ST=function(e,t){return l6(e,t)},Ku=ST,wT=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};St&&(mT=function(t,n){if(!Buffer.isBuffer(t))return hT(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},xT=function(t,n){if(!Buffer.isBuffer(t))return pT(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},vT=function(t,n){if(!Buffer.isBuffer(t))return gT(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},TT=function(t,n){if(!Buffer.isBuffer(t))return yT(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},ET=function(t,n){if(!Buffer.isBuffer(t))return _T(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},Ku=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):ST(t,n)},wT=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ll=function(e,t){return e[t]},za=function(e,t){return e[t+1]*256+e[t]},c6=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},Ar=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},rs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},u6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Oo(e,t){var n="",r,a,l=[],c,u,p,m;switch(t){case"dbcs":if(m=this.l,St&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(p=0;p<e;++p)n+=String.fromCharCode(za(this,m)),m+=2;e*=2;break;case"utf8":n=cc(this,this.l,this.l+e);break;case"utf16le":e*=2,n=Gh(this,this.l,this.l+e);break;case"wstr":return Oo.call(this,e,"dbcs");case"lpstr-ansi":n=mT(this,this.l),e=4+Ar(this,this.l);break;case"lpstr-cp":n=xT(this,this.l),e=4+Ar(this,this.l);break;case"lpwstr":n=vT(this,this.l),e=4+2*Ar(this,this.l);break;case"lpp4":e=4+Ar(this,this.l),n=TT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ar(this,this.l),n=ET(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(c=ll(this,this.l+e++))!==0;)l.push(wu(c));n=l.join("");break;case"_wstr":for(e=0,n="";(c=za(this,this.l+e))!==0;)l.push(wu(c)),e+=2;e+=2,n=l.join("");break;case"dbcs-cont":for(n="",m=this.l,p=0;p<e;++p){if(this.lens&&this.lens.indexOf(m)!==-1)return c=ll(this,m),this.l=m+1,u=Oo.call(this,e-p,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(wu(za(this,m))),m+=2}n=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",m=this.l,p=0;p!=e;++p){if(this.lens&&this.lens.indexOf(m)!==-1)return c=ll(this,m),this.l=m+1,u=Oo.call(this,e-p,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(wu(ll(this,m))),m+=1}n=l.join("");break;default:switch(e){case 1:return r=ll(this,this.l),this.l++,r;case 2:return r=(t==="i"?c6:za)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(e>0?rs:u6)(this,this.l),this.l+=4,r):(a=Ar(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Ku(this,this.l):a=Ku([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:n=dT(this,this.l,e);break}}return this.l+=e,n}var f6=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},d6=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},h6=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function m6(e,t,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=t.length;++a)h6(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;r=t.length}else if(n==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var l=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var c=t.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,f6(this,t,this.l);break;case 8:if(r=8,n==="f"){o6(this,t,this.l);break}case 16:break;case-4:r=4,d6(this,t,this.l);break}return this.l+=r,this}function CT(e,t){var n=dT(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function jn(e,t){e.l=t,e.read_shift=Oo,e.chk=CT,e.write_shift=m6}function tr(e,t){e.l+=t}function bn(e){var t=Oi(e);return jn(t,0),t}function Ka(e,t,n){if(e){var r,a,l;jn(e,e.l||0);for(var c=e.length,u=0,p=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var m=rf[u]||rf[65535];for(r=e.read_shift(1),l=r&127,a=1;a<4&&r&128;++a)l+=((r=e.read_shift(1))&127)<<7*a;p=e.l+l;var x=m.f&&m.f(e,l,n);if(e.l=p,t(x,m,u))return}}}function uh(){var e=[],t=St?256:2048,n=function(m){var x=bn(m);return jn(x,0),x},r=n(t),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},l=function(m){return r&&m<r.length-r.l?r:(a(),r=n(Math.max(m+1,t)))},c=function(){return a(),Ai(e)},u=function(m){a(),r=m,r.l==null&&(r.l=r.length),l(t)};return{next:l,push:u,end:c,_bufs:e}}function Po(e,t,n){var r=qn(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function ly(e,t,n){var r=qn(e);return r.s=Po(r.s,t.s,n),r.e=Po(r.e,t.s,n),r}function Uo(e,t){if(e.cRel&&e.c<0)for(e=qn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=qn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=it(e);return!e.cRel&&e.cRel!=null&&(n=g6(n)),!e.rRel&&e.rRel!=null&&(n=p6(n)),n}function Ld(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+kn(e.s.c)+":"+(e.e.cRel?"":"$")+kn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+$n(e.s.r)+":"+(e.e.rRel?"":"$")+$n(e.e.r):Uo(e.s,t.biff)+":"+Uo(e.e,t.biff)}function zh(e){return parseInt(x6(e),10)-1}function $n(e){return""+(e+1)}function p6(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function x6(e){return e.replace(/\$(\d+)$/,"$1")}function jh(e){for(var t=v6(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function kn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function g6(e){return e.replace(/^([A-Z])/,"$$$1")}function v6(e){return e.replace(/^\$([A-Z])/,"$1")}function y6(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function or(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function it(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function bl(e){var t=e.indexOf(":");return t==-1?{s:or(e),e:or(e)}:{s:or(e.slice(0,t)),e:or(e.slice(t+1))}}function kt(e,t){return typeof t>"u"||typeof t=="number"?kt(e.s,e.e):(typeof e!="string"&&(e=it(e)),typeof t!="string"&&(t=it(t)),e==t?e:e+":"+t)}function un(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,l=e.length;for(n=0;r<l&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<l&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===l||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=l&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=l&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function oy(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=zr(e.z,n?fr(t):t)}catch{}try{return e.w=zr((e.XF||{}).numFmtId||(n?14:0),n?fr(t):t)}catch{return""+t}}function Wa(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?_s[e.v]||e.v:t==null?oy(e,e.v):oy(e,t))}function Ui(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function AT(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense,l=e||(a?[]:{}),c=0,u=0;if(l&&r.origin!=null){if(typeof r.origin=="number")c=r.origin;else{var p=typeof r.origin=="string"?or(r.origin):r.origin;c=p.r,u=p.c}l["!ref"]||(l["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var x=un(l["!ref"]);m.s.c=x.s.c,m.s.r=x.s.r,m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),c==-1&&(m.e.r=c=x.e.r+1)}for(var y=0;y!=t.length;++y)if(t[y]){if(!Array.isArray(t[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=t[y].length;++_)if(!(typeof t[y][_]>"u")){var E={v:t[y][_]},S=c+y,w=u+_;if(m.s.r>S&&(m.s.r=S),m.s.c>w&&(m.s.c=w),m.e.r<S&&(m.e.r=S),m.e.c<w&&(m.e.c=w),t[y][_]&&typeof t[y][_]=="object"&&!Array.isArray(t[y][_])&&!(t[y][_]instanceof Date))E=t[y][_];else if(Array.isArray(E.v)&&(E.f=t[y][_][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(r.nullError)E.t="e",E.v=0;else if(r.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=r.dateNF||lt[14],r.cellDates?(E.t="d",E.w=zr(E.z,fr(E.v))):(E.t="n",E.v=fr(E.v),E.w=zr(E.z,E.v))):E.t="s";if(a)l[S]||(l[S]=[]),l[S][w]&&l[S][w].z&&(E.z=l[S][w].z),l[S][w]=E;else{var C=it({c:w,r:S});l[C]&&l[C].z&&(E.z=l[C].z),l[C]=E}}}return m.s.c<1e7&&(l["!ref"]=kt(m)),l}function kl(e,t){return AT(null,e,t)}function T6(e){return e.read_shift(4,"i")}function er(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function _6(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function qh(e,t){var n=e.l,r=e.read_shift(1),a=er(e),l=[],c={t:a,h:a};if((r&1)!==0){for(var u=e.read_shift(4),p=0;p!=u;++p)l.push(_6(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=n+t,c}var E6=qh;function qr(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function ys(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var S6=er;function $h(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var w6=er,fh=$h;function Yh(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var a=r===0?Ku([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):rs(t,0)>>2;return n?a/100:a}function bT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ts=bT;function Kn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function C6(e){var t={},n=e.read_shift(1),r=n>>>1,a=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),p=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=a;var m=ss[a];m&&(t.rgb=nc(m));break;case 2:t.rgb=nc([c,u,p]);break;case 3:t.theme=a;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function A6(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function kT(e,t){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function b6(e){return kT(e,1)}function k6(e){return kT(e,2)}var Wh=2,xr=3,Au=11,cy=12,Zu=19,bu=64,N6=65,M6=71,R6=4108,D6=4126,On=80,NT=81,I6=[On,NT],F6={1:{n:"CodePage",t:Wh},2:{n:"Category",t:On},3:{n:"PresentationFormat",t:On},4:{n:"ByteCount",t:xr},5:{n:"LineCount",t:xr},6:{n:"ParagraphCount",t:xr},7:{n:"SlideCount",t:xr},8:{n:"NoteCount",t:xr},9:{n:"HiddenCount",t:xr},10:{n:"MultimediaClipCount",t:xr},11:{n:"ScaleCrop",t:Au},12:{n:"HeadingPairs",t:R6},13:{n:"TitlesOfParts",t:D6},14:{n:"Manager",t:On},15:{n:"Company",t:On},16:{n:"LinksUpToDate",t:Au},17:{n:"CharacterCount",t:xr},19:{n:"SharedDoc",t:Au},22:{n:"HyperlinksChanged",t:Au},23:{n:"AppVersion",t:xr,p:"version"},24:{n:"DigSig",t:N6},26:{n:"ContentType",t:On},27:{n:"ContentStatus",t:On},28:{n:"Language",t:On},29:{n:"Version",t:On},255:{},2147483648:{n:"Locale",t:Zu},2147483651:{n:"Behavior",t:Zu},1919054434:{}},L6={1:{n:"CodePage",t:Wh},2:{n:"Title",t:On},3:{n:"Subject",t:On},4:{n:"Author",t:On},5:{n:"Keywords",t:On},6:{n:"Comments",t:On},7:{n:"Template",t:On},8:{n:"LastAuthor",t:On},9:{n:"RevNumber",t:On},10:{n:"EditTime",t:bu},11:{n:"LastPrinted",t:bu},12:{n:"CreatedDate",t:bu},13:{n:"ModifiedDate",t:bu},14:{n:"PageCount",t:xr},15:{n:"WordCount",t:xr},16:{n:"CharCount",t:xr},17:{n:"Thumbnail",t:M6},18:{n:"Application",t:On},19:{n:"DocSecurity",t:xr},255:{},2147483648:{n:"Locale",t:Zu},2147483651:{n:"Behavior",t:Zu},1919054434:{}},uy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},O6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function P6(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var U6=P6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ss=qn(U6),_s={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},MT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},fy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function B6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function V6(e){var t=B6();if(!e||!e.match)return t;var n={};if((e.match(nr)||[]).forEach(function(r){var a=tt(r);switch(a[0].replace(WD,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":t[fy[a.ContentType]]!==void 0&&t[fy[a.ContentType]].push(a.PartName);break}}),t.xmlns!==i6.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}var cl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function dh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Bo(e,t){var n={"!id":{}};if(!e)return n;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match(nr)||[]).forEach(function(a){var l=tt(a);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Do(l.Target,t);n[u]=c,r[l.Id]=c}}),n["!id"]=r,n}var H6="application/vnd.oasis.opendocument.spreadsheet";function G6(e,t){for(var n=Hh(e),r,a;r=ec.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=tt(r[0],!1),a.path=="/"&&a.type!==H6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}var Vo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],z6=function(){for(var e=new Array(Vo.length),t=0;t<Vo.length;++t){var n=Vo[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function RT(e){var t={};e=Jt(e);for(var n=0;n<Vo.length;++n){var r=Vo[n],a=e.match(z6[n]);a!=null&&a.length>0&&(t[r[1]]=Nt(a[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=Pn(t[r[1]]))}return t}var j6=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function DT(e,t,n,r){var a=[];if(typeof e=="string")a=ty(e,r);else for(var l=0;l<e.length;++l)a=a.concat(e[l].map(function(x){return{v:x}}));var c=typeof t=="string"?ty(t,r).map(function(x){return x.v}):t,u=0,p=0;if(c.length>0)for(var m=0;m!==a.length;m+=2){switch(p=+a[m+1].v,a[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=p,n.SheetNames=c.slice(u,u+p);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=p,n.DefinedNames=c.slice(u,u+p);break;case"Charts":case"Diagramme":n.Chartsheets=p,n.ChartNames=c.slice(u,u+p);break}u+=p}}function q6(e,t,n){var r={};return t||(t={}),e=Jt(e),j6.forEach(function(a){var l=(e.match(Qo(a[0]))||[])[1];switch(a[2]){case"string":l&&(t[a[1]]=Nt(l));break;case"bool":t[a[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));c&&c.length>0&&(r[a[1]]=c[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&DT(r.HeadingPairs,r.TitlesOfParts,t,n),t}var $6=/<[^>]+>[^<]*/g;function Y6(e,t){var n={},r="",a=e.match($6);if(a)for(var l=0;l!=a.length;++l){var c=a[l],u=tt(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Nt(u.name);break;case"</property>":r=null;break;default:if(c.indexOf("<vt:")===0){var p=c.split(">"),m=p[0].slice(4),x=p[1];switch(m){case"lpstr":case"bstr":case"lpwstr":n[r]=Nt(x);break;case"bool":n[r]=nn(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(x,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(x);break;case"filetime":case"date":n[r]=Pn(x);break;case"cy":case"error":n[r]=Nt(x);break;default:if(m.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,m,p)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return n}var W6={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Od;function X6(e,t,n){Od||(Od=Uh(W6)),t=Od[t]||t,e[t]=n}function Xh(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function IT(e,t,n){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return a}function FT(e,t,n){var r=e.read_shift(0,"lpwstr");return r}function LT(e,t,n){return t===31?FT(e):IT(e,t,n)}function hh(e,t,n){return LT(e,t,n===!1?0:4)}function J6(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return LT(e,t,0)}function K6(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var a=e.l;n[r]=e.read_shift(0,"lpwstr").replace(cr,""),e.l-a&2&&(e.l+=2)}return n}function Z6(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(cr,"");return n}function Q6(e){var t=e.l,n=Qu(e,NT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=Qu(e,xr);return[n,r]}function eI(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(Q6(e));return n}function dy(e,t){for(var n=e.read_shift(4),r={},a=0;a!=n;++a){var l=e.read_shift(4),c=e.read_shift(4);r[l]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(cr,"").replace(Ro,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function OT(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),n}function tI(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Qu(e,t,n){var r=e.read_shift(2),a,l=n||{};if(e.l+=2,t!==cy&&r!==t&&I6.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===cy?r:t){case 2:return a=e.read_shift(2,"i"),l.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return IT(e,r,4).replace(cr,"");case 31:return FT(e);case 64:return Xh(e);case 65:return OT(e);case 71:return tI(e);case 80:return hh(e,r,!l.raw).replace(cr,"");case 81:return J6(e,r).replace(cr,"");case 4108:return eI(e);case 4126:case 4127:return r==4127?K6(e):Z6(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function hy(e,t){var n=e.l,r=e.read_shift(4),a=e.read_shift(4),l=[],c=0,u=0,p=-1,m={};for(c=0;c!=a;++c){var x=e.read_shift(4),y=e.read_shift(4);l[c]=[x,y+n]}l.sort(function(k,b){return k[1]-b[1]});var _={};for(c=0;c!=a;++c){if(e.l!==l[c][1]){var E=!0;if(c>0&&t)switch(t[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,E=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break}if((!t||c==0)&&e.l<=l[c][1]&&(E=!1,e.l=l[c][1]),E)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(t){var S=t[l[c][0]];if(_[S.n]=Qu(e,S.t,{raw:!0}),S.p==="version"&&(_[S.n]=String(_[S.n]>>16)+"."+("0000"+String(_[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(_[S.n]){case 0:_[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ea(u=_[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[S.n])}}else if(l[c][0]===1){if(u=_.CodePage=Qu(e,Wh),ea(u),p!==-1){var w=e.l;e.l=l[p][1],m=dy(e,u),e.l=w}}else if(l[c][0]===0){if(u===0){p=c,e.l=l[c+1][1];continue}m=dy(e,u)}else{var C=m[l[c][0]],M;switch(e[e.l]){case 65:e.l+=4,M=OT(e);break;case 30:e.l+=4,M=hh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,M=hh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,M=e.read_shift(4,"i");break;case 19:e.l+=4,M=e.read_shift(4);break;case 5:e.l+=4,M=e.read_shift(8,"f");break;case 11:e.l+=4,M=pn(e,4);break;case 64:e.l+=4,M=Pn(Xh(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[C]=M}}return e.l=n+r,_}function my(e,t,n){var r=e.content;if(!r)return{};jn(r,0);var a,l,c,u,p=0;r.chk("feff","Byte Order: "),r.read_shift(2);var m=r.read_shift(4),x=r.read_shift(16);if(x!==At.utils.consts.HEADER_CLSID&&x!==n)throw new Error("Bad PropertySet CLSID "+x);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(l=r.read_shift(16),u=r.read_shift(4),a===1&&u!==r.l)throw new Error("Length mismatch: "+u+" !== "+r.l);a===2&&(c=r.read_shift(16),p=r.read_shift(4));var y=hy(r,t),_={SystemIdentifier:m};for(var E in y)_[E]=y[E];if(_.FMTID=l,a===1)return _;if(p-r.l==2&&(r.l+=2),r.l!==p)throw new Error("Length mismatch 2: "+r.l+" !== "+p);var S;try{S=hy(r,null)}catch{}for(E in S)_[E]=S[E];return _.FMTID=[l,c],_}function wi(e,t){return e.read_shift(t),null}function nI(e,t,n){for(var r=[],a=e.l+t;e.l<a;)r.push(n(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function pn(e,t){return e.read_shift(t)===1}function Tn(e){return e.read_shift(2,"u")}function PT(e,t){return nI(e,t,Tn)}function rI(e){var t=e.read_shift(1),n=e.read_shift(1);return n===1?t:t===1}function uc(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var l=e.read_shift(1);l&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var c=r?e.read_shift(r,a):"";return c}function aI(e){var t=e.read_shift(2),n=e.read_shift(1),r=n&4,a=n&8,l=1+(n&1),c=0,u,p={};a&&(c=e.read_shift(2)),r&&(u=e.read_shift(4));var m=l==2?"dbcs-cont":"sbcs-cont",x=t===0?"":e.read_shift(t,m);return a&&(e.l+=4*c),r&&(e.l+=u),p.t=x,a||(p.raw="<t>"+p.t+"</t>",p.r=p.t),p}function ms(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function fc(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):ms(e,r,n)}function Es(e,t,n){if(n.biff>5)return fc(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function iI(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}function sI(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=n);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(cr,"");return r&&(e.l+=24),a}function lI(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(cr,"");return n+c}function oI(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return sI(e);case"0303000000000000c000000000000046":return lI(e);default:throw new Error("Unsupported Moniker "+n)}}function ku(e){var t=e.read_shift(4),n=t>0?e.read_shift(t,"utf16le").replace(cr,""):"";return n}function cI(e,t){var n=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var l,c,u,p,m="",x,y;a&16&&(l=ku(e,n-e.l)),a&128&&(c=ku(e,n-e.l)),(a&257)===257&&(u=ku(e,n-e.l)),(a&257)===1&&(p=oI(e,n-e.l)),a&8&&(m=ku(e,n-e.l)),a&32&&(x=e.read_shift(16)),a&64&&(y=Xh(e)),e.l=n;var _=c||u||p||"";_&&m&&(_+="#"+m),_||(_="#"+m),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var E={Target:_};return x&&(E.guid=x),y&&(E.time=y),l&&(E.Tooltip=l),E}function UT(e){var t=e.read_shift(1),n=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[t,n,r,a]}function BT(e,t){var n=UT(e);return n[3]=0,n}function Ea(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return{r:t,c:n,ixfe:r}}function uI(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}function fI(e,t,n){return t===0?"":Es(e,t,n)}function dI(e,t,n){var r=n.biff>8?4:2,a=e.read_shift(r),l=e.read_shift(r,"i"),c=e.read_shift(r,"i");return[a,l,c]}function VT(e){var t=e.read_shift(2),n=Yh(e);return[t,n]}function hI(e,t,n){e.l+=4,t-=4;var r=e.l+t,a=uc(e,t,n),l=e.read_shift(2);if(r-=e.l,l!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+l);return e.l+=l,a}function gf(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:t},e:{c:a,r:n}}}function HT(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:t},e:{c:a,r:n}}}var mI=HT;function GT(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function pI(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function xI(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Xn(e){e.l+=2,e.l+=e.read_shift(2)}var gI={0:Xn,4:Xn,5:Xn,6:Xn,7:xI,8:Xn,9:Xn,10:Xn,11:Xn,12:Xn,13:pI,14:Xn,15:Xn,16:Xn,17:Xn,18:Xn,19:Xn,20:Xn,21:GT};function vI(e,t){for(var n=e.l+t,r=[];e.l<n;){var a=e.read_shift(2);e.l-=2;try{r.push(gI[a](e,n-e.l))}catch{return e.l=n,r}}return e.l!=n&&(e.l=n),r}function Nu(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),t-=2,t>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function yI(e,t){return t===0||e.read_shift(2),1200}function TI(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,a=Es(e,0,n);return e.read_shift(t+r-e.l),a}function _I(e,t,n){var r=n&&n.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function EI(e,t,n){var r=e.read_shift(4),a=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=uc(e,0,n);return c.length===0&&(c="Sheet1"),{pos:r,hs:a,dt:l,name:c}}function SI(e,t){for(var n=e.l+t,r=e.read_shift(4),a=e.read_shift(4),l=[],c=0;c!=a&&e.l<n;++c)l.push(aI(e));return l.Count=r,l.Unique=a,l}function wI(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}function CI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=n/20),t}function AI(e){var t=uI(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var n=e.read_shift(4);return n!==0}function bI(e){return e.read_shift(2),e.read_shift(4)}function py(e,t,n){var r=0;n&&n.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var l={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[l,a]}function kI(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),p=e.read_shift(2),m=e.read_shift(2);return{Pos:[t,n],Dim:[r,a],Flags:l,CurTab:c,FirstTab:u,Selected:p,TabRatio:m}}function NI(e,t,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function MI(){}function RI(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=uc(e,0,n),r}function DI(e){var t=Ea(e);return t.isst=e.read_shift(4),t}function II(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=e.l+t,a=Ea(e);n.biff==2&&e.l++;var l=fc(e,r-e.l,n);return a.val=l,a}function FI(e,t,n){var r=e.read_shift(2),a=Es(e,0,n);return[r,a]}var LI=Es;function xy(e,t,n){var r=e.l+t,a=n.biff==8||!n.biff?4:2,l=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(2),p=e.read_shift(2);return e.l=r,{s:{r:l,c:u},e:{r:c,c:p}}}function OI(e){var t=e.read_shift(2),n=e.read_shift(2),r=VT(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}function PI(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),l=[];e.l<n;)l.push(VT(e));if(e.l!==n)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:c,rkrec:l}}function UI(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),l=[];e.l<n;)l.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:c,ixfe:l}}function BI(e,t,n,r){var a={},l=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),p=e.read_shift(2);return a.patternType=O6[u>>26],r.cellStyles&&(a.alc=l&7,a.fWrap=l>>3&1,a.alcV=l>>4&7,a.fJustLast=l>>7&1,a.trot=l>>8&255,a.cIndent=l>>16&15,a.fShrinkToFit=l>>20&1,a.iReadOrder=l>>22&2,a.fAtrNum=l>>26&1,a.fAtrFnt=l>>27&1,a.fAtrAlc=l>>28&1,a.fAtrBdr=l>>29&1,a.fAtrPat=l>>30&1,a.fAtrProt=l>>31&1,a.dgLeft=c&15,a.dgRight=c>>4&15,a.dgTop=c>>8&15,a.dgBottom=c>>12&15,a.icvLeft=c>>16&127,a.icvRight=c>>23&127,a.grbitDiag=c>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=p&127,a.icvBack=p>>7&127,a.fsxButton=p>>14&1),a}function VI(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=BI(e,t,r.fStyle,n),r}function HI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function gy(e,t,n){var r=Ea(e);(n.biff==2||t==9)&&++e.l;var a=rI(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function GI(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=Ea(e),a=Kn(e);return r.val=a,r}var vy=fI;function zI(e,t,n){var r=e.l+t,a=e.read_shift(2),l=e.read_shift(2);if(n.sbcch=l,l==1025||l==14849)return[l,a];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=ms(e,l),u=[];r>e.l;)u.push(fc(e));return[l,a,c,u]}function yy(e,t,n){var r=e.read_shift(2),a,l={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=hI(e,t-2,n)),l.body=a||e.read_shift(t-2),typeof a=="string"&&(l.Name=a),l}var jI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ty(e,t,n){var r=e.l+t,a=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(n&&n.biff==2?1:2),p=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),p=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var m=ms(e,c,n);a&32&&(m=jI[m.charCodeAt(0)]);var x=r-e.l;n&&n.biff==2&&--x;var y=r==e.l||u===0||!(x>0)?[]:CO(e,x,n,u);return{chKey:l,Name:m,itab:p,rgce:y}}function zT(e,t,n){if(n.biff<8)return qI(e,t,n);for(var r=[],a=e.l+t,l=e.read_shift(n.biff>8?4:2);l--!==0;)r.push(dI(e,n.biff>8?12:6,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function qI(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=uc(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function $I(e,t,n){if(n.biff<8){e.l+=t;return}var r=e.read_shift(2),a=e.read_shift(2),l=ms(e,r,n),c=ms(e,a,n);return[l,c]}function YI(e,t,n){var r=HT(e);e.l++;var a=e.read_shift(1);return t-=8,[AO(e,t,n),a,r]}function _y(e,t,n){var r=mI(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,SO(e,t,n)]}function WI(e){var t=e.read_shift(4)!==0,n=e.read_shift(4)!==0,r=e.read_shift(4);return[t,n,r]}function XI(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=Es(e,0,n);return n.biff<8&&e.read_shift(1),[{r,c:a},u,c,l]}}function JI(e,t,n){return XI(e,t,n)}function KI(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(gf(e));return n}function ZI(e,t,n){if(n&&n.biff<8)return e8(e,t,n);var r=GT(e),a=vI(e,t-22,r[1]);return{cmo:r,ft:a}}var QI={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=n,{fmt:r}}};function e8(e,t,n){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((QI[r]||tr)(e,t,n)),{cmo:[a,r,l],ft:c}}function t8(e,t,n){var r=e.l,a="";try{e.l+=4;var l=(n.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=iI(e,6,n);var u=e.read_shift(2);e.read_shift(2),Tn(e,2);var p=e.read_shift(2);e.l+=p;for(var m=1;m<e.lens.length-1;++m){if(e.l-r!=e.lens[m])throw new Error("TxO: bad continue record");var x=e[e.l],y=ms(e,e.lens[m+1]-e.lens[m]-1);if(a+=y,a.length>=(x?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return e.l=r+t,{t:a}}catch{return e.l=r+t,{t:a}}}function n8(e,t){var n=gf(e);e.l+=16;var r=cI(e,t-24);return[n,r]}function r8(e,t){e.read_shift(2);var n=gf(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(cr,""),[n,r]}function a8(e){var t=[0,0],n;return n=e.read_shift(2),t[0]=uy[n]||n,n=e.read_shift(2),t[1]=uy[n]||n,t}function i8(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(BT(e));return n}function s8(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(BT(e));return n}function l8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function jT(e,t,n){if(!n.cellStyles)return tr(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),u=e.read_shift(r),p=e.read_shift(2);r==2&&(e.l+=2);var m={s:a,e:l,w:c,ixfe:u,flags:p};return(n.biff>=5||!n.biff)&&(m.level=p>>8&7),m}function o8(e,t){var n={};return t<32||(e.l+=16,n.header=Kn(e),n.footer=Kn(e),e.l+=2),n}function c8(e,t,n){var r={area:!1};if(n.biff!=5)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var u8=Ea,f8=PT,d8=fc;function h8(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function m8(e,t,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=Ea(e);++e.l;var a=Es(e,t-7,n);return r.t="str",r.val=a,r}function p8(e){var t=Ea(e);++e.l;var n=Kn(e);return t.t="n",t.val=n,t}function x8(e){var t=Ea(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}function g8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function v8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function y8(e,t,n){var r=e.l+t,a=Ea(e),l=e.read_shift(2),c=ms(e,l,n);return e.l=r,a.t="str",a.val=c,a}var T8=[2,3,48,49,131,139,140,245],Ey=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Uh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(u,p){var m=[],x=Oi(1);switch(p.type){case"base64":x=Qr(kr(u));break;case"binary":x=Qr(u);break;case"buffer":case"array":x=u;break}jn(x,0);var y=x.read_shift(1),_=!!(y&136),E=!1,S=!1;switch(y){case 2:break;case 3:break;case 48:E=!0,_=!0;break;case 49:E=!0,_=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var w=0,C=521;y==2&&(w=x.read_shift(2)),x.l+=3,y!=2&&(w=x.read_shift(4)),w>1048576&&(w=1e6),y!=2&&(C=x.read_shift(2));var M=x.read_shift(2),k=p.codepage||1252;y!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(k=e[x[x.l]]),x.l+=1,x.l+=2),S&&(x.l+=36);for(var b=[],U={},G=Math.min(x.length,y==2?521:C-10-(E?264:0)),X=S?32:11;x.l<G&&x[x.l]!=13;)switch(U={},U.name=Ko.utils.decode(k,x.slice(x.l,x.l+X)).replace(/[\u0000\r\n].*$/g,""),x.l+=X,U.type=String.fromCharCode(x.read_shift(1)),y!=2&&!S&&(U.offset=x.read_shift(4)),U.len=x.read_shift(1),y==2&&(U.offset=x.read_shift(2)),U.dec=x.read_shift(1),U.name.length&&b.push(U),y!=2&&(x.l+=S?13:14),U.type){case"B":(!E||U.len!=8)&&p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(x[x.l]!==13&&(x.l=C-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=C;var F=0,W=0;for(m[0]=[],W=0;W!=b.length;++W)m[0][W]=b[W].name;for(;w-- >0;){if(x[x.l]===42){x.l+=M;continue}for(++x.l,m[++F]=[],W=0,W=0;W!=b.length;++W){var O=x.slice(x.l,x.l+b[W].len);x.l+=b[W].len,jn(O,0);var te=Ko.utils.decode(k,O);switch(b[W].type){case"C":te.trim().length&&(m[F][W]=te.replace(/\s+$/,""));break;case"D":te.length===8?m[F][W]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):m[F][W]=te;break;case"F":m[F][W]=parseFloat(te.trim());break;case"+":case"I":m[F][W]=S?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":m[F][W]=!0;break;case"N":case"F":m[F][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));m[F][W]="##MEMO##"+(S?parseInt(te.trim(),10):O.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(m[F][W]=+te||0);break;case"@":m[F][W]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":m[F][W]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":m[F][W]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[F][W]=-O.read_shift(-8,"f");break;case"B":if(E&&b[W].len==8){m[F][W]=O.read_shift(8,"f");break}case"G":case"P":O.l+=b[W].len;break;case"0":if(b[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[W].type)}}}if(y!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return p&&p.sheetRows&&(m=m.slice(0,p.sheetRows)),p.DBF=b,m}function r(u,p){var m=p||{};m.dateNF||(m.dateNF="yyyymmdd");var x=kl(n(u,m),m);return x["!cols"]=m.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete m.DBF,x}function a(u,p){try{return Ui(r(u,p),p)}catch(m){if(p&&p.WTF)throw m}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,p){var m=p||{};if(+m.codepage>=0&&ea(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var x=uh(),y=Th(u,{header:1,raw:!0,cellDates:!0}),_=y[0],E=y.slice(1),S=u["!cols"]||[],w=0,C=0,M=0,k=1;for(w=0;w<_.length;++w){if(((S[w]||{}).DBF||{}).name){_[w]=S[w].DBF.name,++M;continue}if(_[w]!=null){if(++M,typeof _[w]=="number"&&(_[w]=_[w].toString(10)),typeof _[w]!="string")throw new Error("DBF Invalid column name "+_[w]+" |"+typeof _[w]+"|");if(_.indexOf(_[w])!==w){for(C=0;C<1024;++C)if(_.indexOf(_[w]+"_"+C)==-1){_[w]+="_"+C;break}}}}var b=un(u["!ref"]),U=[],G=[],X=[];for(w=0;w<=b.e.c-b.s.c;++w){var F="",W="",O=0,te=[];for(C=0;C<E.length;++C)E[C][w]!=null&&te.push(E[C][w]);if(te.length==0||_[w]==null){U[w]="?";continue}for(C=0;C<te.length;++C){switch(typeof te[C]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=te[C]instanceof Date?"D":"C";break;default:W="C"}O=Math.max(O,String(te[C]).length),F=F&&F!=W?"C":W}O>250&&(O=250),W=((S[w]||{}).DBF||{}).type,W=="C"&&S[w].DBF.len>O&&(O=S[w].DBF.len),F=="B"&&W=="N"&&(F="N",X[w]=S[w].DBF.dec,O=S[w].DBF.len),G[w]=F=="C"||W=="N"?O:l[F]||0,k+=G[w],U[w]=F}var ne=x.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,E.length),ne.write_shift(2,296+32*M),ne.write_shift(2,k),w=0;w<4;++w)ne.write_shift(4,0);for(ne.write_shift(4,0|(+t[z2]||3)<<8),w=0,C=0;w<_.length;++w)if(_[w]!=null){var ee=x.next(32),Se=(_[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,Se,"sbcs"),ee.write_shift(1,U[w]=="?"?"C":U[w],"sbcs"),ee.write_shift(4,C),ee.write_shift(1,G[w]||l[U[w]]||0),ee.write_shift(1,X[w]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),C+=G[w]||l[U[w]]||0}var Fe=x.next(264);for(Fe.write_shift(4,13),w=0;w<65;++w)Fe.write_shift(4,0);for(w=0;w<E.length;++w){var we=x.next(k);for(we.write_shift(1,0),C=0;C<_.length;++C)if(_[C]!=null)switch(U[C]){case"L":we.write_shift(1,E[w][C]==null?63:E[w][C]?84:70);break;case"B":we.write_shift(8,E[w][C]||0,"f");break;case"N":var ae="0";for(typeof E[w][C]=="number"&&(ae=E[w][C].toFixed(X[C]||0)),M=0;M<G[C]-ae.length;++M)we.write_shift(1,32);we.write_shift(1,ae,"sbcs");break;case"D":E[w][C]?(we.write_shift(4,("0000"+E[w][C].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(E[w][C].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+E[w][C].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var me=String(E[w][C]!=null?E[w][C]:"").slice(0,G[C]);for(we.write_shift(1,me,"sbcs"),M=0;M<G[C]-me.length;++M)we.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:a,to_sheet:r,from_sheet:c}}(),_8=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ya(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(_,E){var S=e[E];return typeof S=="number"?Uv(S):S},r=function(_,E,S){var w=E.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return w==59?_:Uv(w)};e["|"]=254;function a(_,E){switch(E.type){case"base64":return l(kr(_),E);case"binary":return l(_,E);case"buffer":return l(St&&Buffer.isBuffer(_)?_.toString("binary"):vs(_),E);case"array":return l(hs(_),E)}throw new Error("Unrecognized type "+E.type)}function l(_,E){var S=_.split(/[\n\r]+/),w=-1,C=-1,M=0,k=0,b=[],U=[],G=null,X={},F=[],W=[],O=[],te=0,ne;for(+E.codepage>=0&&ea(+E.codepage);M!==S.length;++M){te=0;var ee=S[M].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),Se=ee.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),Fe=Se[0],we;if(ee.length>0)switch(Fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Se[1].charAt(0)=="P"&&U.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,me=!1,re=!1,q=!1,N=-1,j=-1;for(k=1;k<Se.length;++k)switch(Se[k].charAt(0)){case"A":break;case"X":C=parseInt(Se[k].slice(1))-1,me=!0;break;case"Y":for(w=parseInt(Se[k].slice(1))-1,me||(C=0),ne=b.length;ne<=w;++ne)b[ne]=[];break;case"K":we=Se[k].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(ra(we))?isNaN(Tl(we).getDate())||(we=Pn(we)):(we=ra(we),G!==null&&Al(G)&&(we=xf(we))),ae=!0;break;case"E":q=!0;var R=hl(Se[k].slice(1),{r:w,c:C});b[w][C]=[b[w][C],R];break;case"S":re=!0,b[w][C]=[b[w][C],"S5S"];break;case"G":break;case"R":N=parseInt(Se[k].slice(1))-1;break;case"C":j=parseInt(Se[k].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ee)}if(ae&&(b[w][C]&&b[w][C].length==2?b[w][C][0]=we:b[w][C]=we,G=null),re){if(q)throw new Error("SYLK shared formula cannot have own formula");var J=N>-1&&b[N][j];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");b[w][C][1]=e_(J[1],{r:w-N,c:C-j})}break;case"F":var Y=0;for(k=1;k<Se.length;++k)switch(Se[k].charAt(0)){case"X":C=parseInt(Se[k].slice(1))-1,++Y;break;case"Y":for(w=parseInt(Se[k].slice(1))-1,ne=b.length;ne<=w;++ne)b[ne]=[];break;case"M":te=parseInt(Se[k].slice(1))/20;break;case"F":break;case"G":break;case"P":G=U[parseInt(Se[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=Se[k].slice(1).split(" "),ne=parseInt(O[0],10);ne<=parseInt(O[1],10);++ne)te=parseInt(O[2],10),W[ne-1]=te===0?{hidden:!0}:{wch:te},_l(W[ne-1]);break;case"C":C=parseInt(Se[k].slice(1))-1,W[C]||(W[C]={});break;case"R":w=parseInt(Se[k].slice(1))-1,F[w]||(F[w]={}),te>0?(F[w].hpt=te,F[w].hpx=rc(te)):te===0&&(F[w].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ee)}Y<1&&(G=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ee)}}return F.length>0&&(X["!rows"]=F),W.length>0&&(X["!cols"]=W),E&&E.sheetRows&&(b=b.slice(0,E.sheetRows)),[b,X]}function c(_,E){var S=a(_,E),w=S[0],C=S[1],M=kl(w,E);return ya(C).forEach(function(k){M[k]=C[k]}),M}function u(_,E){return Ui(c(_,E),E)}function p(_,E,S,w){var C="C;Y"+(S+1)+";X"+(w+1)+";K";switch(_.t){case"n":C+=_.v||0,_.f&&!_.F&&(C+=";E"+lL(_.f,{r:S,c:w}));break;case"b":C+=_.v?"TRUE":"FALSE";break;case"e":C+=_.w||_.v;break;case"d":C+='"'+(_.w||_.v)+'"';break;case"s":C+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function m(_,E){E.forEach(function(S,w){var C="F;W"+(w+1)+" "+(w+1)+" ";S.hidden?C+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=tf(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=nf(S.wpx)),typeof S.wch=="number"&&(C+=Math.round(S.wch))),C.charAt(C.length-1)!=" "&&_.push(C)})}function x(_,E){E.forEach(function(S,w){var C="F;";S.hidden?C+="M0;":S.hpt?C+="M"+20*S.hpt+";":S.hpx&&(C+="M"+20*KT(S.hpx)+";"),C.length>2&&_.push(C+"R"+(w+1))})}function y(_,E){var S=["ID;PWXL;N;E"],w=[],C=un(_["!ref"]),M,k=Array.isArray(_),b=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),_["!cols"]&&m(S,_["!cols"]),_["!rows"]&&x(S,_["!rows"]),S.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var U=C.s.r;U<=C.e.r;++U)for(var G=C.s.c;G<=C.e.c;++G){var X=it({r:U,c:G});M=k?(_[U]||[])[G]:_[X],!(!M||M.v==null&&(!M.f||M.F))&&w.push(p(M,_,U,G))}return S.join(b)+b+w.join(b)+b+"E"+b}return{to_workbook:u,to_sheet:c,from_sheet:y}}(),E8=function(){function e(l,c){switch(c.type){case"base64":return t(kr(l),c);case"binary":return t(l,c);case"buffer":return t(St&&Buffer.isBuffer(l)?l.toString("binary"):vs(l),c);case"array":return t(hs(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var u=l.split(`
`),p=-1,m=-1,x=0,y=[];x!==u.length;++x){if(u[x].trim()==="BOT"){y[++p]=[],m=0;continue}if(!(p<0)){var _=u[x].trim().split(","),E=_[0],S=_[1];++x;for(var w=u[x]||"";(w.match(/["]/g)||[]).length&1&&x<u.length-1;)w+=`
`+u[++x];switch(w=w.trim(),+E){case-1:if(w==="BOT"){y[++p]=[],m=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?y[p][m]=!0:w==="FALSE"?y[p][m]=!1:isNaN(ra(S))?isNaN(Tl(S).getDate())?y[p][m]=S:y[p][m]=Pn(S):y[p][m]=ra(S),++m;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),y[p][m++]=w!==""?w:null;break}if(w==="EOD")break}}return c&&c.sheetRows&&(y=y.slice(0,c.sheetRows)),y}function n(l,c){return kl(e(l,c),c)}function r(l,c){return Ui(n(l,c),c)}var a=function(){var l=function(p,m,x,y,_){p.push(m),p.push(x+","+y),p.push('"'+_.replace(/"/g,'""')+'"')},c=function(p,m,x,y){p.push(m+","+x),p.push(m==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(p){var m=[],x=un(p["!ref"]),y,_=Array.isArray(p);l(m,"TABLE",0,1,"sheetjs"),l(m,"VECTORS",0,x.e.r-x.s.r+1,""),l(m,"TUPLES",0,x.e.c-x.s.c+1,""),l(m,"DATA",0,0,"");for(var E=x.s.r;E<=x.e.r;++E){c(m,-1,0,"BOT");for(var S=x.s.c;S<=x.e.c;++S){var w=it({r:E,c:S});if(y=_?(p[E]||[])[S]:p[w],!y){c(m,1,0,"");continue}switch(y.t){case"n":var C=y.w;!C&&y.v!=null&&(C=y.v),C==null?y.f&&!y.F?c(m,1,0,"="+y.f):c(m,1,0,""):c(m,0,C,"V");break;case"b":c(m,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":c(m,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=zr(y.z||lt[14],fr(Pn(y.v)))),c(m,0,y.w,"V");break;default:c(m,1,0,"")}}}c(m,-1,0,"EOD");var M=`\r
`,k=m.join(M);return k}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),S8=function(){function e(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(y,_){for(var E=y.split(`
`),S=-1,w=-1,C=0,M=[];C!==E.length;++C){var k=E[C].trim().split(":");if(k[0]==="cell"){var b=or(k[1]);if(M.length<=b.r)for(S=M.length;S<=b.r;++S)M[S]||(M[S]=[]);switch(S=b.r,w=b.c,k[2]){case"t":M[S][w]=e(k[3]);break;case"v":M[S][w]=+k[3];break;case"vtf":var U=k[k.length-1];case"vtc":switch(k[3]){case"nl":M[S][w]=!!+k[4];break;default:M[S][w]=+k[4];break}k[2]=="vtf"&&(M[S][w]=[M[S][w],U])}}}return _&&_.sheetRows&&(M=M.slice(0,_.sheetRows)),M}function r(y,_){return kl(n(y,_),_)}function a(y,_){return Ui(r(y,_),_)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),p="--SocialCalcSpreadsheetControlSave--";function m(y){if(!y||!y["!ref"])return"";for(var _=[],E=[],S,w="",C=bl(y["!ref"]),M=Array.isArray(y),k=C.s.r;k<=C.e.r;++k)for(var b=C.s.c;b<=C.e.c;++b)if(w=it({r:k,c:b}),S=M?(y[k]||[])[b]:y[w],!(!S||S.v==null||S.t==="z")){switch(E=["cell",w,"t"],S.t){case"s":case"str":E.push(t(S.v));break;case"n":S.f?(E[2]="vtf",E[3]="n",E[4]=S.v,E[5]=t(S.f)):(E[2]="v",E[3]=S.v);break;case"b":E[2]="vt"+(S.f?"f":"c"),E[3]="nl",E[4]=S.v?"1":"0",E[5]=t(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var U=fr(Pn(S.v));E[2]="vtc",E[3]="nd",E[4]=""+U,E[5]=S.w||zr(S.z||lt[14],U);break;case"e":continue}_.push(E.join(":"))}return _.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function x(y){return[l,c,u,c,m(y),p].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:x}}(),tc=function(){function e(x,y,_,E,S){S.raw?y[_][E]=x:x===""||(x==="TRUE"?y[_][E]=!0:x==="FALSE"?y[_][E]=!1:isNaN(ra(x))?isNaN(Tl(x).getDate())?y[_][E]=x:y[_][E]=Pn(x):y[_][E]=ra(x))}function t(x,y){var _=y||{},E=[];if(!x||x.length===0)return E;for(var S=x.split(/[\r\n]/),w=S.length-1;w>=0&&S[w].length===0;)--w;for(var C=10,M=0,k=0;k<=w;++k)M=S[k].indexOf(" "),M==-1?M=S[k].length:M++,C=Math.max(C,M);for(k=0;k<=w;++k){E[k]=[];var b=0;for(e(S[k].slice(0,C).trim(),E,k,b,_),b=1;b<=(S[k].length-C)/10+1;++b)e(S[k].slice(C+(b-1)*10,C+b*10).trim(),E,k,b,_)}return _.sheetRows&&(E=E.slice(0,_.sheetRows)),E}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(x){for(var y={},_=!1,E=0,S=0;E<x.length;++E)(S=x.charCodeAt(E))==34?_=!_:!_&&S in n&&(y[S]=(y[S]||0)+1);S=[];for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&S.push([y[E],E]);if(!S.length){y=r;for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&S.push([y[E],E])}return S.sort(function(w,C){return w[0]-C[0]||r[w[1]]-r[C[1]]}),n[S.pop()[1]]||44}function l(x,y){var _=y||{},E="",S=_.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(E=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(E=x.charAt(4),x=x.slice(6)):E=a(x.slice(0,1024)):_&&_.FS?E=_.FS:E=a(x.slice(0,1024));var C=0,M=0,k=0,b=0,U=0,G=E.charCodeAt(0),X=!1,F=0,W=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var O=_.dateNF!=null?FD(_.dateNF):null;function te(){var ne=x.slice(b,U),ee={};if(ne.charAt(0)=='"'&&ne.charAt(ne.length-1)=='"'&&(ne=ne.slice(1,-1).replace(/""/g,'"')),ne.length===0)ee.t="z";else if(_.raw)ee.t="s",ee.v=ne;else if(ne.trim().length===0)ee.t="s",ee.v=ne;else if(ne.charCodeAt(0)==61)ne.charCodeAt(1)==34&&ne.charCodeAt(ne.length-1)==34?(ee.t="s",ee.v=ne.slice(2,-1).replace(/""/g,'"')):cL(ne)?(ee.t="n",ee.f=ne.slice(1)):(ee.t="s",ee.v=ne);else if(ne=="TRUE")ee.t="b",ee.v=!0;else if(ne=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(k=ra(ne)))ee.t="n",_.cellText!==!1&&(ee.w=ne),ee.v=k;else if(!isNaN(Tl(ne).getDate())||O&&ne.match(O)){ee.z=_.dateNF||lt[14];var Se=0;O&&ne.match(O)&&(ne=LD(ne,_.dateNF,ne.match(O)||[]),Se=1),_.cellDates?(ee.t="d",ee.v=Pn(ne,Se)):(ee.t="n",ee.v=fr(Pn(ne,Se))),_.cellText!==!1&&(ee.w=zr(ee.z,ee.v instanceof Date?fr(ee.v):ee.v)),_.cellNF||delete ee.z}else ee.t="s",ee.v=ne;if(ee.t=="z"||(_.dense?(S[C]||(S[C]=[]),S[C][M]=ee):S[it({c:M,r:C})]=ee),b=U+1,W=x.charCodeAt(b),w.e.c<M&&(w.e.c=M),w.e.r<C&&(w.e.r=C),F==G)++M;else if(M=0,++C,_.sheetRows&&_.sheetRows<=C)return!0}e:for(;U<x.length;++U)switch(F=x.charCodeAt(U)){case 34:W===34&&(X=!X);break;case G:case 10:case 13:if(!X&&te())break e;break}return U-b>0&&te(),S["!ref"]=kt(w),S}function c(x,y){return!(y&&y.PRN)||y.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?l(x,y):kl(t(x,y),y)}function u(x,y){var _="",E=y.type=="string"?[0,0,0,0]:rm(x,y);switch(y.type){case"base64":_=kr(x);break;case"binary":_=x;break;case"buffer":y.codepage==65001?_=x.toString("utf8"):y.codepage&&typeof Ko<"u"||(_=St&&Buffer.isBuffer(x)?x.toString("binary"):vs(x));break;case"array":_=hs(x);break;case"string":_=x;break;default:throw new Error("Unrecognized type "+y.type)}return E[0]==239&&E[1]==187&&E[2]==191?_=Jt(_.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?_=Jt(_):y.type=="binary"&&typeof Ko<"u",_.slice(0,19)=="socialcalc:version:"?S8.to_sheet(y.type=="string"?_:Jt(_),y):c(_,y)}function p(x,y){return Ui(u(x,y),y)}function m(x){for(var y=[],_=un(x["!ref"]),E,S=Array.isArray(x),w=_.s.r;w<=_.e.r;++w){for(var C=[],M=_.s.c;M<=_.e.c;++M){var k=it({r:w,c:M});if(E=S?(x[w]||[])[M]:x[k],!E||E.v==null){C.push("          ");continue}for(var b=(E.w||(Wa(E),E.w)||"").slice(0,10);b.length<10;)b+=" ";C.push(b+(M===0?" ":""))}y.push(C.join(""))}return y.join(`
`)}return{to_workbook:p,to_sheet:u,from_sheet:m}}();function w8(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var a=_8.to_workbook(e,n);return n.WTF=r,a}catch(l){if(n.WTF=r,!l.message.match(/SYLK bad record ID/)&&r)throw l;return tc.to_workbook(e,t)}}var Ho=function(){function e(R,J,Y){if(R){jn(R,R.l||0);for(var H=Y.Enum||N;R.l<R.length;){var se=R.read_shift(2),Ee=H[se]||H[65535],ke=R.read_shift(2),De=R.l+ke,Ce=Ee.f&&Ee.f(R,ke,Y);if(R.l=De,J(Ce,Ee,se))return}}}function t(R,J){switch(J.type){case"base64":return n(Qr(kr(R)),J);case"binary":return n(Qr(R),J);case"buffer":case"array":return n(R,J)}throw"Unsupported type "+J.type}function n(R,J){if(!R)return R;var Y=J||{},H=Y.dense?[]:{},se="Sheet1",Ee="",ke=0,De={},Ce=[],Je=[],K={s:{r:0,c:0},e:{r:0,c:0}},pt=Y.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)Y.Enum=N,e(R,function(Te,He,ze){switch(ze){case 0:Y.vers=Te,Te>=4096&&(Y.qpro=!0);break;case 6:K=Te;break;case 204:Te&&(Ee=Te);break;case 222:Ee=Te;break;case 15:case 51:Y.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:ze==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=Y.dateNF||lt[14],Y.cellDates&&(Te[1].t="d",Te[1].v=xf(Te[1].v))),Y.qpro&&Te[3]>ke&&(H["!ref"]=kt(K),De[se]=H,Ce.push(se),H=Y.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},ke=Te[3],se=Ee||"Sheet"+(ke+1),Ee="");var Ft=Y.dense?(H[Te[0].r]||[])[Te[0].c]:H[it(Te[0])];if(Ft){Ft.t=Te[1].t,Ft.v=Te[1].v,Te[1].z!=null&&(Ft.z=Te[1].z),Te[1].f!=null&&(Ft.f=Te[1].f);break}Y.dense?(H[Te[0].r]||(H[Te[0].r]=[]),H[Te[0].r][Te[0].c]=Te[1]):H[it(Te[0])]=Te[1];break}},Y);else if(R[2]==26||R[2]==14)Y.Enum=j,R[2]==14&&(Y.qpro=!0,R.l=0),e(R,function(Te,He,ze){switch(ze){case 204:se=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>ke&&(H["!ref"]=kt(K),De[se]=H,Ce.push(se),H=Y.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},ke=Te[3],se="Sheet"+(ke+1)),pt>0&&Te[0].r>=pt)break;Y.dense?(H[Te[0].r]||(H[Te[0].r]=[]),H[Te[0].r][Te[0].c]=Te[1]):H[it(Te[0])]=Te[1],K.e.c<Te[0].c&&(K.e.c=Te[0].c),K.e.r<Te[0].r&&(K.e.r=Te[0].r);break;case 27:Te[14e3]&&(Je[Te[14e3][0]]=Te[14e3][1]);break;case 1537:Je[Te[0]]=Te[1],Te[0]==ke&&(se=Te[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(H["!ref"]=kt(K),De[Ee||se]=H,Ce.push(Ee||se),!Je.length)return{SheetNames:Ce,Sheets:De};for(var Ke={},ft=[],Me=0;Me<Je.length;++Me)De[Ce[Me]]?(ft.push(Je[Me]||Ce[Me]),Ke[Je[Me]]=De[Je[Me]]||De[Ce[Me]]):(ft.push(Je[Me]),Ke[Je[Me]]={"!ref":"A1"});return{SheetNames:ft,Sheets:Ke}}function r(R,J){var Y=J||{};if(+Y.codepage>=0&&ea(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var H=uh(),se=un(R["!ref"]),Ee=Array.isArray(R),ke=[];Zr(H,0,l(1030)),Zr(H,6,p(se));for(var De=Math.min(se.e.r,8191),Ce=se.s.r;Ce<=De;++Ce)for(var Je=$n(Ce),K=se.s.c;K<=se.e.c;++K){Ce===se.s.r&&(ke[K]=kn(K));var pt=ke[K]+Je,Ke=Ee?(R[Ce]||[])[K]:R[pt];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Zr(H,13,E(Ce,K,Ke.v)):Zr(H,14,w(Ce,K,Ke.v));else{var ft=Wa(Ke);Zr(H,15,y(Ce,K,ft.slice(0,239)))}}return Zr(H,1),H.end()}function a(R,J){var Y=J||{};if(+Y.codepage>=0&&ea(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var H=uh();Zr(H,0,c(R));for(var se=0,Ee=0;se<R.SheetNames.length;++se)(R.Sheets[R.SheetNames[se]]||{})["!ref"]&&Zr(H,27,q(R.SheetNames[se],Ee++));var ke=0;for(se=0;se<R.SheetNames.length;++se){var De=R.Sheets[R.SheetNames[se]];if(!(!De||!De["!ref"])){for(var Ce=un(De["!ref"]),Je=Array.isArray(De),K=[],pt=Math.min(Ce.e.r,8191),Ke=Ce.s.r;Ke<=pt;++Ke)for(var ft=$n(Ke),Me=Ce.s.c;Me<=Ce.e.c;++Me){Ke===Ce.s.r&&(K[Me]=kn(Me));var Te=K[Me]+ft,He=Je?(De[Ke]||[])[Me]:De[Te];if(!(!He||He.t=="z"))if(He.t=="n")Zr(H,23,te(Ke,Me,ke,He.v));else{var ze=Wa(He);Zr(H,22,F(Ke,Me,ke,ze.slice(0,239)))}}++ke}}return Zr(H,1),H.end()}function l(R){var J=bn(2);return J.write_shift(2,R),J}function c(R){var J=bn(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var Y=0,H=0,se=0,Ee=0;Ee<R.SheetNames.length;++Ee){var ke=R.SheetNames[Ee],De=R.Sheets[ke];if(!(!De||!De["!ref"])){++se;var Ce=bl(De["!ref"]);Y<Ce.e.r&&(Y=Ce.e.r),H<Ce.e.c&&(H=Ce.e.c)}}return Y>8191&&(Y=8191),J.write_shift(2,Y),J.write_shift(1,se),J.write_shift(1,H),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function u(R,J,Y){var H={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&Y.qpro?(H.s.c=R.read_shift(1),R.l++,H.s.r=R.read_shift(2),H.e.c=R.read_shift(1),R.l++,H.e.r=R.read_shift(2),H):(H.s.c=R.read_shift(2),H.s.r=R.read_shift(2),J==12&&Y.qpro&&(R.l+=2),H.e.c=R.read_shift(2),H.e.r=R.read_shift(2),J==12&&Y.qpro&&(R.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function p(R){var J=bn(8);return J.write_shift(2,R.s.c),J.write_shift(2,R.s.r),J.write_shift(2,R.e.c),J.write_shift(2,R.e.r),J}function m(R,J,Y){var H=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(H[0].c=R.read_shift(1),H[3]=R.read_shift(1),H[0].r=R.read_shift(2),R.l+=2):(H[2]=R.read_shift(1),H[0].c=R.read_shift(2),H[0].r=R.read_shift(2)),H}function x(R,J,Y){var H=R.l+J,se=m(R,J,Y);if(se[1].t="s",Y.vers==20768){R.l++;var Ee=R.read_shift(1);return se[1].v=R.read_shift(Ee,"utf8"),se}return Y.qpro&&R.l++,se[1].v=R.read_shift(H-R.l,"cstr"),se}function y(R,J,Y){var H=bn(7+Y.length);H.write_shift(1,255),H.write_shift(2,J),H.write_shift(2,R),H.write_shift(1,39);for(var se=0;se<H.length;++se){var Ee=Y.charCodeAt(se);H.write_shift(1,Ee>=128?95:Ee)}return H.write_shift(1,0),H}function _(R,J,Y){var H=m(R,J,Y);return H[1].v=R.read_shift(2,"i"),H}function E(R,J,Y){var H=bn(7);return H.write_shift(1,255),H.write_shift(2,J),H.write_shift(2,R),H.write_shift(2,Y,"i"),H}function S(R,J,Y){var H=m(R,J,Y);return H[1].v=R.read_shift(8,"f"),H}function w(R,J,Y){var H=bn(13);return H.write_shift(1,255),H.write_shift(2,J),H.write_shift(2,R),H.write_shift(8,Y,"f"),H}function C(R,J,Y){var H=R.l+J,se=m(R,J,Y);if(se[1].v=R.read_shift(8,"f"),Y.qpro)R.l=H;else{var Ee=R.read_shift(2);U(R.slice(R.l,R.l+Ee),se),R.l+=Ee}return se}function M(R,J,Y){var H=J&32768;return J&=-32769,J=(H?R:0)+(J>=8192?J-16384:J),(H?"":"$")+(Y?kn(J):$n(J))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(R,J){jn(R,0);for(var Y=[],H=0,se="",Ee="",ke="",De="";R.l<R.length;){var Ce=R[R.l++];switch(Ce){case 0:Y.push(R.read_shift(8,"f"));break;case 1:Ee=M(J[0].c,R.read_shift(2),!0),se=M(J[0].r,R.read_shift(2),!1),Y.push(Ee+se);break;case 2:{var Je=M(J[0].c,R.read_shift(2),!0),K=M(J[0].r,R.read_shift(2),!1);Ee=M(J[0].c,R.read_shift(2),!0),se=M(J[0].r,R.read_shift(2),!1),Y.push(Je+K+":"+Ee+se)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(R.read_shift(2));break;case 6:{for(var pt="";Ce=R[R.l++];)pt+=String.fromCharCode(Ce);Y.push('"'+pt.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:De=Y.pop(),ke=Y.pop(),Y.push(["AND","OR"][Ce-20]+"("+ke+","+De+")");break;default:if(Ce<32&&b[Ce])De=Y.pop(),ke=Y.pop(),Y.push(ke+b[Ce]+De);else if(k[Ce]){if(H=k[Ce][1],H==69&&(H=R[R.l++]),H>Y.length){console.error("WK1 bad formula parse 0x"+Ce.toString(16)+":|"+Y.join("|")+"|");return}var Ke=Y.slice(-H);Y.length-=H,Y.push(k[Ce][0]+"("+Ke.join(",")+")")}else return Ce<=7?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=24?console.error("WK1 unsupported op "+Ce.toString(16)):Ce<=30?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=115?console.error("WK1 unsupported function opcode "+Ce.toString(16)):console.error("WK1 unrecognized opcode "+Ce.toString(16))}}Y.length==1?J[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function G(R){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=R.read_shift(2),J[3]=R[R.l++],J[0].c=R[R.l++],J}function X(R,J){var Y=G(R);return Y[1].t="s",Y[1].v=R.read_shift(J-4,"cstr"),Y}function F(R,J,Y,H){var se=bn(6+H.length);se.write_shift(2,R),se.write_shift(1,Y),se.write_shift(1,J),se.write_shift(1,39);for(var Ee=0;Ee<H.length;++Ee){var ke=H.charCodeAt(Ee);se.write_shift(1,ke>=128?95:ke)}return se.write_shift(1,0),se}function W(R,J){var Y=G(R);Y[1].v=R.read_shift(2);var H=Y[1].v>>1;if(Y[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return Y[1].v=H,Y}function O(R,J){var Y=G(R),H=R.read_shift(4),se=R.read_shift(4),Ee=R.read_shift(2);if(Ee==65535)return H===0&&se===3221225472?(Y[1].t="e",Y[1].v=15):H===0&&se===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var ke=Ee&32768;return Ee=(Ee&32767)-16446,Y[1].v=(1-ke*2)*(se*Math.pow(2,Ee+32)+H*Math.pow(2,Ee)),Y}function te(R,J,Y,H){var se=bn(14);if(se.write_shift(2,R),se.write_shift(1,Y),se.write_shift(1,J),H==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var Ee=0,ke=0,De=0,Ce=0;return H<0&&(Ee=1,H=-H),ke=Math.log2(H)|0,H/=Math.pow(2,ke-31),Ce=H>>>0,(Ce&2147483648)==0&&(H/=2,++ke,Ce=H>>>0),H-=Ce,Ce|=2147483648,Ce>>>=0,H*=Math.pow(2,32),De=H>>>0,se.write_shift(4,De),se.write_shift(4,Ce),ke+=16383+(Ee?32768:0),se.write_shift(2,ke),se}function ne(R,J){var Y=O(R);return R.l+=J-14,Y}function ee(R,J){var Y=G(R),H=R.read_shift(4);return Y[1].v=H>>6,Y}function Se(R,J){var Y=G(R),H=R.read_shift(8,"f");return Y[1].v=H,Y}function Fe(R,J){var Y=Se(R);return R.l+=J-10,Y}function we(R,J){return R[R.l+J-1]==0?R.read_shift(J,"cstr"):""}function ae(R,J){var Y=R[R.l++];Y>J-1&&(Y=J-1);for(var H="";H.length<Y;)H+=String.fromCharCode(R[R.l++]);return H}function me(R,J,Y){if(!(!Y.qpro||J<21)){var H=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var se=R.read_shift(J-21,"cstr");return[H,se]}}function re(R,J){for(var Y={},H=R.l+J;R.l<H;){var se=R.read_shift(2);if(se==14e3){for(Y[se]=[0,""],Y[se][0]=R.read_shift(2);R[R.l];)Y[se][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return Y}function q(R,J){var Y=bn(5+R.length);Y.write_shift(2,14e3),Y.write_shift(2,J);for(var H=0;H<R.length;++H){var se=R.charCodeAt(H);Y[Y.l++]=se>127?95:se}return Y[Y.l++]=0,Y}var N={0:{n:"BOF",f:Tn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},j={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:X},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:ne},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:Se},40:{n:"FORMULA28",f:Fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:t}}();function C8(e){var t={},n=e.match(nr),r=0,a=!1;if(n)for(;r!=n.length;++r){var l=tt(n[r]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=Ih[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(l[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+l[0])}}return t}var A8=function(){var e=Qo("t"),t=Qo("rPr");function n(l){var c=l.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:Nt(c[1])},p=l.match(t);return p&&(u.s=C8(p[1])),u}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(c){return c.replace(r,"").split(a).map(n).filter(function(u){return u.v})}}(),b8=function(){var t=/(\r\n|\n)/g;function n(a,l,c){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),a.b&&(l.push("<b>"),c.push("</b>")),a.i&&(l.push("<i>"),c.push("</i>")),a.strike&&(l.push("<s>"),c.push("</s>"));var p=a.valign||"";return p=="superscript"||p=="super"?p="sup":p=="subscript"&&(p="sub"),p!=""&&(l.push("<"+p+">"),c.push("</"+p+">")),c.push("</span>"),a}function r(a){var l=[[],a.v,[]];return a.v?(a.s&&n(a.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(r).join("")}}(),k8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,N8=/<(?:\w+:)?r>/,M8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Jh(e,t){var n=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Nt(Jt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Jt(e),n&&(r.h=Vh(r.t))):e.match(N8)&&(r.r=Jt(e),r.t=Nt(Jt((e.replace(M8,"").match(k8)||[]).join("").replace(nr,""))),n&&(r.h=b8(A8(r.r)))),r):{t:""}}var R8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,D8=/<(?:\w+:)?(?:si|sstItem)>/g,I8=/<\/(?:\w+:)?(?:si|sstItem)>/;function F8(e,t){var n=[],r="";if(!e)return n;var a=e.match(R8);if(a){r=a[2].replace(D8,"").split(I8);for(var l=0;l!=r.length;++l){var c=Jh(r[l].trim(),t);c!=null&&(n[n.length]=c)}a=tt(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}function L8(e){return[e.read_shift(4),e.read_shift(4)]}function O8(e,t){var n=[],r=!1;return Ka(e,function(l,c,u){switch(u){case 159:n.Count=l[0],n.Unique=l[1];break;case 19:n.push(l);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(c.T,!r||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function qT(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function qa(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function P8(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=qa(e,4),t.U=qa(e,4),t.W=qa(e,4),t}function U8(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},a=e.read_shift(4),l=[];a-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=l,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function B8(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(U8(e));return t}function V8(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function H8(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=qa(e,4),t.U=qa(e,4),t.W=qa(e,4),t}function G8(e){var t=H8(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function $T(e,t){var n=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function YT(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function z8(e){var t=qa(e);switch(t.Minor){case 2:return[t.Minor,j8(e)];case 3:return[t.Minor,q8()];case 4:return[t.Minor,$8(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function j8(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),r=$T(e,n),a=YT(e,e.length-e.l);return{t:"Std",h:r,v:a}}function q8(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $8(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(nr,function(l){var c=tt(l);switch(_a(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){r[u]=c[u]});break;case"<dataIntegrity":r.encryptedHmacKey=c.encryptedHmacKey,r.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(c);break;default:throw c[0]}}),r}function Y8(e,t){var n={},r=n.EncryptionVersionInfo=qa(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,n.EncryptionHeader=$T(e,a),t-=a,n.EncryptionVerifier=YT(e,t),n}function W8(e){var t={},n=t.EncryptionVersionInfo=qa(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function X8(e){var t=0,n,r=qT(e),a=r.length+1,l,c,u,p,m;for(n=Oi(a),n[0]=r.length,l=1;l!=a;++l)n[l]=r[l-1];for(l=a-1;l>=0;--l)c=n[l],u=(t&16384)===0?0:1,p=t<<1&32767,m=u|p,t=m^c;return t^52811}var WT=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(c){return(c/2|c*128)&255},a=function(c,u){return r(c^u)},l=function(c){for(var u=t[c.length-1],p=104,m=c.length-1;m>=0;--m)for(var x=c[m],y=0;y!=7;++y)x&64&&(u^=n[p]),x*=2,--p;return u};return function(c){for(var u=qT(c),p=l(u),m=u.length,x=Oi(16),y=0;y!=16;++y)x[y]=0;var _,E,S;for((m&1)===1&&(_=p>>8,x[m]=a(e[0],_),--m,_=p&255,E=u[u.length-1],x[m]=a(E,_));m>0;)--m,_=p>>8,x[m]=a(u[m],_),--m,_=p&255,x[m]=a(u[m],_);for(m=15,S=15-u.length;S>0;)_=p>>8,x[m]=a(e[S],_),--m,--S,_=p&255,x[m]=a(u[m],_),--m,--S;return x}}(),J8=function(e,t,n,r,a){a||(a=t),r||(r=WT(e));var l,c;for(l=0;l!=t.length;++l)c=t[l],c^=r[n],c=(c>>5|c<<3)&255,a[l]=c,++n;return[a,n,r]},K8=function(e){var t=0,n=WT(e);return function(r){var a=J8("",r,t,n);return t=a[1],a[0]}};function Z8(e,t,n,r){var a={key:Tn(e),verificationBytes:Tn(e)};return n.password&&(a.verifier=X8(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=K8(n.password)),a}function Q8(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=W8(e):r.Data=Y8(e,t),r}function eF(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?Q8(e,t-2,r):Z8(e,n.biff>=8?t:t-2,n,r),r}var tF=function(){function e(a,l){switch(l.type){case"base64":return t(kr(a),l);case"binary":return t(a,l);case"buffer":return t(St&&Buffer.isBuffer(a)?a.toString("binary"):vs(a),l);case"array":return t(hs(a),l)}throw new Error("Unrecognized type "+l.type)}function t(a,l){var c=l||{},u=c.dense?[]:{},p=a.match(/\\trowd.*?\\row\b/g);if(!p.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:p.length-1}};return p.forEach(function(x,y){Array.isArray(u)&&(u[y]=[]);for(var _=/\\\w+\b/g,E=0,S,w=-1;S=_.exec(x);){switch(S[0]){case"\\cell":var C=x.slice(E,_.lastIndex-S[0].length);if(C[0]==" "&&(C=C.slice(1)),++w,C.length){var M={v:C,t:"s"};Array.isArray(u)?u[y][w]=M:u[it({r:y,c:w})]=M}break}E=_.lastIndex}w>m.e.c&&(m.e.c=w)}),u["!ref"]=kt(m),u}function n(a,l){return Ui(e(a,l),l)}function r(a){for(var l=["{\\rtf1\\ansi"],c=un(a["!ref"]),u,p=Array.isArray(a),m=c.s.r;m<=c.e.r;++m){l.push("\\trowd\\trautofit1");for(var x=c.s.c;x<=c.e.c;++x)l.push("\\cellx"+(x+1));for(l.push("\\pard\\intbl"),x=c.s.c;x<=c.e.c;++x){var y=it({r:m,c:x});u=p?(a[m]||[])[x]:a[y],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Wa(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function nF(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function nc(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function rF(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),l=Math.min(t,n,r),c=a-l;if(c===0)return[0,0,t];var u=0,p=0,m=a+l;switch(p=c/(m>1?2-m:m),a){case t:u=((n-r)/c+6)%6;break;case n:u=(r-t)/c+2;break;case r:u=(t-n)/c+4;break}return[u/6,p,m/2]}function aF(e){var t=e[0],n=e[1],r=e[2],a=n*2*(r<.5?r:1-r),l=r-a/2,c=[l,l,l],u=6*t,p;if(n!==0)switch(u|0){case 0:case 6:p=a*u,c[0]+=a,c[1]+=p;break;case 1:p=a*(2-u),c[0]+=p,c[1]+=a;break;case 2:p=a*(u-2),c[1]+=a,c[2]+=p;break;case 3:p=a*(4-u),c[1]+=p,c[2]+=a;break;case 4:p=a*(u-4),c[2]+=a,c[0]+=p;break;case 5:p=a*(6-u),c[2]+=p,c[0]+=a;break}for(var m=0;m!=3;++m)c[m]=Math.round(c[m]*255);return c}function ef(e,t){if(t===0)return e;var n=rF(nF(e));return t<0?n[2]=n[2]*(1+t):n[2]=1-(1-n[2])*(1-t),nc(aF(n))}var XT=6,iF=15,sF=1,lr=XT;function tf(e){return Math.floor((e+Math.round(128/lr)/256)*lr)}function nf(e){return Math.floor((e-5)/lr*100+.5)/100}function mh(e){return Math.round((e*lr+5)/lr*256)/256}function Pd(e){return mh(nf(tf(e)))}function Kh(e){var t=Math.abs(e-Pd(e)),n=lr;if(t>.005)for(lr=sF;lr<iF;++lr)Math.abs(e-Pd(e))<=t&&(t=Math.abs(e-Pd(e)),n=lr);lr=n}function _l(e){e.width?(e.wpx=tf(e.width),e.wch=nf(e.wpx),e.MDW=lr):e.wpx?(e.wch=nf(e.wpx),e.width=mh(e.wch),e.MDW=lr):typeof e.wch=="number"&&(e.width=mh(e.wch),e.wpx=tf(e.width),e.MDW=lr),e.customWidth&&delete e.customWidth}var lF=96,JT=lF;function KT(e){return e*96/JT}function rc(e){return e*JT/96}var oF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function cF(e,t,n,r){t.Borders=[];var a={},l=!1;(e[0].match(nr)||[]).forEach(function(c){var u=tt(c);switch(_a(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=nn(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=nn(u.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function uF(e,t,n,r){t.Fills=[];var a={},l=!1;(e[0].match(nr)||[]).forEach(function(c){var u=tt(c);switch(_a(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function fF(e,t,n,r){t.Fonts=[];var a={},l=!1;(e[0].match(nr)||[]).forEach(function(c){var u=tt(c);switch(_a(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=Jt(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?nn(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?nn(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?nn(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?nn(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?nn(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?nn(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?nn(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Ih[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=nn(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var p=ss[a.color.index];a.color.index==81&&(p=ss[1]),p||(p=ss[1]),a.color.rgb=p[0].toString(16)+p[1].toString(16)+p[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=ef(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function dF(e,t,n){t.NumberFmt=[];for(var r=ya(lt),a=0;a<r.length;++a)t.NumberFmt[r[a]]=lt[r[a]];var l=e[0].match(nr);if(l)for(a=0;a<l.length;++a){var c=tt(l[a]);switch(_a(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Nt(Jt(c.formatCode)),p=parseInt(c.numFmtId,10);if(t.NumberFmt[p]=u,p>0){if(p>392){for(p=392;p>60&&t.NumberFmt[p]!=null;--p);t.NumberFmt[p]=u}is(u,p)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var Mu=["numFmtId","fillId","fontId","borderId","xfId"],Ru=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hF(e,t,n){t.CellXf=[];var r,a=!1;(e[0].match(nr)||[]).forEach(function(l){var c=tt(l),u=0;switch(_a(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=c,delete r[0],u=0;u<Mu.length;++u)r[Mu[u]]&&(r[Mu[u]]=parseInt(r[Mu[u]],10));for(u=0;u<Ru.length;++u)r[Ru[u]]&&(r[Ru[u]]=nn(r[Ru[u]]));if(t.NumberFmt&&r.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[u]){r.numFmtId=u;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var p={};c.vertical&&(p.vertical=c.vertical),c.horizontal&&(p.horizontal=c.horizontal),c.textRotation!=null&&(p.textRotation=c.textRotation),c.indent&&(p.indent=c.indent),c.wrapText&&(p.wrapText=nn(c.wrapText)),r.alignment=p;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var mF=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,p,m){var x={};if(!u)return x;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=u.match(t))&&dF(y,x,m),(y=u.match(a))&&fF(y,x,p,m),(y=u.match(r))&&uF(y,x,p,m),(y=u.match(l))&&cF(y,x,p,m),(y=u.match(n))&&hF(y,x,m),x}}();function pF(e,t){var n=e.read_shift(2),r=er(e);return[n,r]}function xF(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=A6(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var l=e.read_shift(2);switch(l===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(r.underline=c);var u=e.read_shift(1);u>0&&(r.family=u);var p=e.read_shift(1);switch(p>0&&(r.charset=p),e.l++,r.color=C6(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=er(e),r}var gF=tr;function vF(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}var yF=tr;function TF(e,t,n){var r={};r.NumberFmt=[];for(var a in lt)r.NumberFmt[a]=lt[a];r.CellXf=[],r.Fonts=[];var l=[],c=!1;return Ka(e,function(p,m,x){switch(x){case 44:r.NumberFmt[p[0]]=p[1],is(p[1],p[0]);break;case 43:r.Fonts.push(p),p.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(p.color.rgb=ef(t.themeElements.clrScheme[p.color.theme].rgb,p.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&r.CellXf.push(p);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(x),c=!0;break;case 38:l.pop(),c=!1;break;default:if(m.T>0)l.push(x);else if(m.T<0)l.pop();else if(!c||n.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),r}var _F=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function EF(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(nr)||[]).forEach(function(a){var l=tt(a);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=l.val;break;case"<a:sysClr":r.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[_F.indexOf(l[0])]=r,r={}):r.name=l[0].slice(3,l[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function SF(){}function wF(){}var CF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,AF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,bF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function kF(e,t,n){t.themeElements={};var r;[["clrScheme",CF,EF],["fontScheme",AF,SF],["fmtScheme",bF,wF]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,n)})}var NF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ZT(e,t){(!e||e.length===0)&&(e=MF());var n,r={};if(!(n=e.match(NF)))throw new Error("themeElements not found in theme");return kF(n[0],r,t),r.raw=e,r}function MF(e,t){var n=[cT];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function RF(e,t,n){var r=e.l+t,a=e.read_shift(4);if(a!==124226){if(!n.cellStyles){e.l=r;return}var l=e.slice(e.l);e.l=r;var c;try{c=oT(l,{type:"array"})}catch{return}var u=br(c,"theme/theme/theme1.xml",!0);if(u)return ZT(u,n)}}function DF(e){return e.read_shift(4)}function IF(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=FF(e,4);break;case 2:t.xclrValue=UT(e);break;case 3:t.xclrValue=DF(e);break;case 4:e.l+=4;break}return e.l+=8,t}function FF(e,t){return tr(e,t)}function LF(e,t){return tr(e,t)}function OF(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=IF(e);break;case 6:r[1]=LF(e,n);break;case 14:case 15:r[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function PF(e,t){var n=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),l=[];a-- >0;)l.push(OF(e,n-e.l));return{ixfe:r,ext:l}}function UF(e,t){t.forEach(function(n){n[0]})}function BF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:er(e)}}function VF(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function HF(e){return e.l+=4,e.read_shift(4)!=0}function GF(e,t,n){var r={Types:[],Cell:[],Value:[]},a=n||{},l=[],c=!1,u=2;return Ka(e,function(p,m,x){switch(x){case 335:r.Types.push({name:p.name});break;case 51:p.forEach(function(y){u==1?r.Cell.push({type:r.Types[y[0]-1].name,index:y[1]}):u==0&&r.Value.push({type:r.Types[y[0]-1].name,index:y[1]})});break;case 337:u=p?1:0;break;case 338:u=2;break;case 35:l.push(x),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!m.T){if(!c||a.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),r}function zF(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,l=2,c;return e.replace(nr,function(u){var p=tt(u);switch(_a(p[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:p.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<r.Types.length;++m)r.Types[m].name==p.name&&(c=r.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?r.Cell.push({type:r.Types[p.t-1].name,index:+p.v}):l==0&&r.Value.push({type:r.Types[p.t-1].name,index:+p.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+p.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+p[0]+" in metadata")}return u}),r}function jF(e){var t=[];if(!e)return t;var n=1;return(e.match(nr)||[]).forEach(function(r){var a=tt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,t.push(a);break}}),t}function qF(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=it(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function $F(e,t,n){var r=[];return Ka(e,function(l,c,u){switch(u){case 63:r.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function YF(e,t,n,r){if(!e)return e;var a=r||{},l=!1;Ka(e,function(u,p,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!p.T){if(!l||a.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},a)}function WF(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}function Sy(e,t,n,r){var a=Array.isArray(e),l;t.forEach(function(c){var u=or(c.ref);if(a?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[c.ref],!l){l={t:"z"},a?e[u.r][u.c]=l:e[c.ref]=l;var p=un(e["!ref"]||"BDWGO1000001:A1");p.s.r>u.r&&(p.s.r=u.r),p.e.r<u.r&&(p.e.r=u.r),p.s.c>u.c&&(p.s.c=u.c),p.e.c<u.c&&(p.e.c=u.c);var m=kt(p);m!==e["!ref"]&&(e["!ref"]=m)}l.c||(l.c=[]);var x={a:c.author,t:c.t,r:c.r,T:n};c.h&&(x.h=c.h);for(var y=l.c.length-1;y>=0;--y){if(!n&&l.c[y].T)return;n&&!l.c[y].T&&l.c.splice(y,1)}if(n&&r){for(y=0;y<r.length;++y)if(x.a==r[y].id){x.a=r[y].name||x.a;break}}l.c.push(x)})}function XF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&n.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var p=tt(u[0]),m={author:p.authorId&&n[p.authorId]||"sheetjsghost",ref:p.ref,guid:p.guid},x=or(p.ref);if(!(t.sheetRows&&t.sheetRows<=x.r)){var y=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!y&&!!y[1]&&Jh(y[1])||{r:"",t:"",h:""};m.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),m.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(m.h=_.h),r.push(m)}}}}),r}function JF(e,t){var n=[],r=!1,a={},l=0;return e.replace(nr,function(u,p){var m=tt(u);switch(_a(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":l=p+u.length;break;case"</text>":a.t=e.slice(l,p).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return u}),n}function KF(e,t){var n=[],r=!1;return e.replace(nr,function(l){var c=tt(l);switch(_a(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),n}function ZF(e){var t={};t.iauthor=e.read_shift(4);var n=Ts(e);return t.rfx=n.s,t.ref=it(n.s),e.l+=16,t}var QF=er;function eL(e,t){var n=[],r=[],a={},l=!1;return Ka(e,function(u,p,m){switch(m){case 632:r.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!p.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}var tL="application/vnd.ms-office.vbaProject";function nL(e){var t=At.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");At.utils.cfb_add(t,a,e.FileIndex[r].content)}}),At.write(t)}function rL(){return{"!type":"dialog"}}function aL(){return{"!type":"dialog"}}function iL(){return{"!type":"macro"}}function sL(){return{"!type":"macro"}}var hl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,a,l,c){var u=!1,p=!1;l.length==0?p=!0:l.charAt(0)=="["&&(p=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var m=l.length>0?parseInt(l,10)|0:0,x=c.length>0?parseInt(c,10)|0:0;return u?x+=t.c:--x,p?m+=t.r:--m,a+(u?"":"$")+kn(x)+(p?"":"$")+$n(m)}return function(a,l){return t=l,a.replace(e,n)}}(),QT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,lL=function(){return function(t,n){return t.replace(QT,function(r,a,l,c,u,p){var m=jh(c)-(l?0:n.c),x=zh(p)-(u?0:n.r),y=x==0?"":u?x+1:"["+x+"]",_=m==0?"":l?m+1:"["+m+"]";return a+"R"+y+"C"+_})}}();function e_(e,t){return e.replace(QT,function(n,r,a,l,c,u){return r+(a=="$"?a+l:kn(jh(l)+t.c))+(c=="$"?c+u:$n(zh(u)+t.r))})}function oL(e,t,n){var r=bl(t),a=r.s,l=or(n),c={r:l.r-a.r,c:l.c-a.c};return e_(e,c)}function cL(e){return e.length!=1}function wy(e){return e.replace(/_xlfn\./g,"")}function vn(e){e.l+=1}function Pi(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function t_(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return n_(e);n.biff==12&&(r=4)}var a=e.read_shift(r),l=e.read_shift(r),c=Pi(e),u=Pi(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function n_(e){var t=Pi(e),n=Pi(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function uL(e,t,n){if(n.biff<8)return n_(e);var r=e.read_shift(n.biff==12?4:2),a=e.read_shift(n.biff==12?4:2),l=Pi(e),c=Pi(e);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function r_(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return fL(e);var r=e.read_shift(n&&n.biff==12?4:2),a=Pi(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function fL(e){var t=Pi(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function dL(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function hL(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return mL(e);var a=e.read_shift(r>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;a>524287;)a-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:a,c:l,cRel:c,rRel:u}}function mL(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),a==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:a,rRel:r}}function pL(e,t,n){var r=(e[e.l++]&96)>>5,a=t_(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function xL(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),l=8;if(n)switch(n.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=t_(e,l,n);return[r,a,c]}function gL(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function vL(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),l=8;if(n)switch(n.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[r,a]}function yL(e,t,n){var r=(e[e.l++]&96)>>5,a=uL(e,t-1,n);return[r,a]}function TL(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Cy(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function _L(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),a=[],l=0;l<=r;++l)a.push(e.read_shift(n&&n.biff==2?1:2));return a}function EL(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function SL(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function wL(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function CL(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function a_(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function AL(e){return e.read_shift(2),a_(e)}function bL(e){return e.read_shift(2),a_(e)}function kL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=r_(e,0,n);return[r,a]}function NL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=hL(e,0,n);return[r,a]}function ML(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var l=r_(e,0,n);return[r,a,l]}function RL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[DO[a],l_[a],r]}function DL(e,t,n){var r=e[e.l++],a=e.read_shift(1),l=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:IL(e);return[a,(l[0]===0?l_:RO)[l[1]]]}function IL(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function FL(e,t,n){e.l+=n&&n.biff==2?3:4}function LL(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function OL(e){return e.l++,_s[e.read_shift(1)]}function PL(e){return e.l++,e.read_shift(2)}function UL(e){return e.l++,e.read_shift(1)!==0}function BL(e){return e.l++,Kn(e)}function VL(e,t,n){return e.l++,uc(e,t-1,n)}function HL(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=pn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=_s[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Kn(e);break;case 2:n[1]=Es(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function GL(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),a=[],l=0;l!=r;++l)a.push((n.biff==12?Ts:gf)(e));return a}function zL(e,t,n){var r=0,a=0;n.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var l=0,c=[];l!=r&&(c[l]=[]);++l)for(var u=0;u!=a;++u)c[l][u]=HL(e,n.biff);return c}function jL(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,l=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,l]}function qL(e,t,n){if(n.biff==5)return $L(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),l=e.read_shift(4);return[r,a,l]}function $L(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function YL(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function WL(e,t,n){var r=e.read_shift(1)>>>5&3,a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function XL(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function JL(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),l=4;if(n)switch(n.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[r,a]}var KL=tr,ZL=tr,QL=tr;function dc(e,t,n){return e.l+=2,[dL(e)]}function Zh(e){return e.l+=6,[]}var eO=dc,tO=Zh,nO=Zh,rO=dc;function i_(e){return e.l+=2,[Tn(e),e.read_shift(2)&1]}var aO=dc,iO=i_,sO=Zh,lO=dc,oO=dc,cO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uO(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),l=e.read_shift(2),c=cO[n>>2&31];return{ixti:t,coltype:n&3,rt:c,idx:r,c:a,C:l}}function fO(e){return e.l+=2,[e.read_shift(4)]}function dO(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function hO(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function mO(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function pO(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function xO(e){return e.l+=4,[0,0]}var Ay={1:{n:"PtgExp",f:LL},2:{n:"PtgTbl",f:QL},3:{n:"PtgAdd",f:vn},4:{n:"PtgSub",f:vn},5:{n:"PtgMul",f:vn},6:{n:"PtgDiv",f:vn},7:{n:"PtgPower",f:vn},8:{n:"PtgConcat",f:vn},9:{n:"PtgLt",f:vn},10:{n:"PtgLe",f:vn},11:{n:"PtgEq",f:vn},12:{n:"PtgGe",f:vn},13:{n:"PtgGt",f:vn},14:{n:"PtgNe",f:vn},15:{n:"PtgIsect",f:vn},16:{n:"PtgUnion",f:vn},17:{n:"PtgRange",f:vn},18:{n:"PtgUplus",f:vn},19:{n:"PtgUminus",f:vn},20:{n:"PtgPercent",f:vn},21:{n:"PtgParen",f:vn},22:{n:"PtgMissArg",f:vn},23:{n:"PtgStr",f:VL},26:{n:"PtgSheet",f:dO},27:{n:"PtgEndSheet",f:hO},28:{n:"PtgErr",f:OL},29:{n:"PtgBool",f:UL},30:{n:"PtgInt",f:PL},31:{n:"PtgNum",f:BL},32:{n:"PtgArray",f:TL},33:{n:"PtgFunc",f:RL},34:{n:"PtgFuncVar",f:DL},35:{n:"PtgName",f:jL},36:{n:"PtgRef",f:kL},37:{n:"PtgArea",f:pL},38:{n:"PtgMemArea",f:YL},39:{n:"PtgMemErr",f:KL},40:{n:"PtgMemNoMem",f:ZL},41:{n:"PtgMemFunc",f:WL},42:{n:"PtgRefErr",f:XL},43:{n:"PtgAreaErr",f:gL},44:{n:"PtgRefN",f:NL},45:{n:"PtgAreaN",f:yL},46:{n:"PtgMemAreaN",f:mO},47:{n:"PtgMemNoMemN",f:pO},57:{n:"PtgNameX",f:qL},58:{n:"PtgRef3d",f:ML},59:{n:"PtgArea3d",f:xL},60:{n:"PtgRefErr3d",f:JL},61:{n:"PtgAreaErr3d",f:vL},255:{}},gO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},vO={1:{n:"PtgElfLel",f:i_},2:{n:"PtgElfRw",f:lO},3:{n:"PtgElfCol",f:eO},6:{n:"PtgElfRwV",f:oO},7:{n:"PtgElfColV",f:rO},10:{n:"PtgElfRadical",f:aO},11:{n:"PtgElfRadicalS",f:sO},13:{n:"PtgElfColS",f:tO},15:{n:"PtgElfColSV",f:nO},16:{n:"PtgElfRadicalLel",f:iO},25:{n:"PtgList",f:uO},29:{n:"PtgSxName",f:fO},255:{}},yO={0:{n:"PtgAttrNoop",f:xO},1:{n:"PtgAttrSemi",f:CL},2:{n:"PtgAttrIf",f:SL},4:{n:"PtgAttrChoose",f:_L},8:{n:"PtgAttrGoto",f:EL},16:{n:"PtgAttrSum",f:FL},32:{n:"PtgAttrBaxcel",f:Cy},33:{n:"PtgAttrBaxcel",f:Cy},64:{n:"PtgAttrSpace",f:AL},65:{n:"PtgAttrSpaceSemi",f:bL},128:{n:"PtgAttrIfError",f:wL},255:{}};function hc(e,t,n,r){if(r.biff<8)return tr(e,t);for(var a=e.l+t,l=[],c=0;c!==n.length;++c)switch(n[c][0]){case"PtgArray":n[c][1]=zL(e,0,r),l.push(n[c][1]);break;case"PtgMemArea":n[c][2]=GL(e,n[c][1],r),l.push(n[c][2]);break;case"PtgExp":r&&r.biff==12&&(n[c][1][1]=e.read_shift(4),l.push(n[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[c][0]}return t=a-e.l,t!==0&&l.push(tr(e,t)),l}function mc(e,t,n){for(var r=e.l+t,a,l,c=[];r!=e.l;)t=r-e.l,l=e[e.l],a=Ay[l]||Ay[gO[l]],(l===24||l===25)&&(a=(l===24?vO:yO)[e[e.l+1]]),!a||!a.f?tr(e,t):c.push([a.n,a.f(e,t,n)]);return c}function TO(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],l=0;l<r.length;++l){var c=r[l];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var _O={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function EO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function s_(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function by(e,t,n){var r=s_(e,t,n);return r=="#REF"?r:EO(r,n)}function Jn(e,t,n,r,a){var l=a&&a.biff||8,c={s:{c:0,r:0}},u=[],p,m,x,y=0,_=0,E,S="";if(!e[0]||!e[0][0])return"";for(var w=-1,C="",M=0,k=e[0].length;M<k;++M){var b=e[0][M];switch(b[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(p=u.pop(),m=u.pop(),w>=0){switch(e[0][w][1][0]){case 0:C=cn(" ",e[0][w][1][1]);break;case 1:C=cn("\r",e[0][w][1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}m=m+C,w=-1}u.push(m+_O[b[0]]+p);break;case"PtgIsect":p=u.pop(),m=u.pop(),u.push(m+" "+p);break;case"PtgUnion":p=u.pop(),m=u.pop(),u.push(m+","+p);break;case"PtgRange":p=u.pop(),m=u.pop(),u.push(m+":"+p);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=Po(b[1][1],c,a),u.push(Uo(x,l));break;case"PtgRefN":x=n?Po(b[1][1],n,a):b[1][1],u.push(Uo(x,l));break;case"PtgRef3d":y=b[1][1],x=Po(b[1][2],c,a),S=by(r,y,a),u.push(S+"!"+Uo(x,l));break;case"PtgFunc":case"PtgFuncVar":var U=b[1][0],G=b[1][1];U||(U=0),U&=127;var X=U==0?[]:u.slice(-U);u.length-=U,G==="User"&&(G=X.shift()),u.push(G+"("+X.join(",")+")");break;case"PtgBool":u.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(b[1]);break;case"PtgNum":u.push(String(b[1]));break;case"PtgStr":u.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(b[1]);break;case"PtgAreaN":E=ly(b[1][1],n?{s:n}:c,a),u.push(Ld(E,a));break;case"PtgArea":E=ly(b[1][1],c,a),u.push(Ld(E,a));break;case"PtgArea3d":y=b[1][1],E=b[1][2],S=by(r,y,a),u.push(S+"!"+Ld(E,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=b[1][2];var F=(r.names||[])[_-1]||(r[0]||[])[_],W=F?F.Name:"SH33TJSNAME"+String(_);W&&W.slice(0,6)=="_xlfn."&&!a.xlfn&&(W=W.slice(6)),u.push(W);break;case"PtgNameX":var O=b[1][1];_=b[1][2];var te;if(a.biff<=5)O<0&&(O=-O),r[O]&&(te=r[O][_]);else{var ne="";if(((r[O]||[])[0]||[])[0]==14849||(((r[O]||[])[0]||[])[0]==1025?r[O][_]&&r[O][_].itab>0&&(ne=r.SheetNames[r[O][_].itab-1]+"!"):ne=r.SheetNames[_-1]+"!"),r[O]&&r[O][_])ne+=r[O][_].Name;else if(r[0]&&r[0][_])ne+=r[0][_].Name;else{var ee=(s_(r,O,a)||"").split(";;");ee[_-1]?ne=ee[_-1]:ne+="SH33TJSERRX"}u.push(ne);break}te||(te={Name:"SH33TJSERRY"}),u.push(te.Name);break;case"PtgParen":var Se="(",Fe=")";if(w>=0){switch(C="",e[0][w][1][0]){case 2:Se=cn(" ",e[0][w][1][1])+Se;break;case 3:Se=cn("\r",e[0][w][1][1])+Se;break;case 4:Fe=cn(" ",e[0][w][1][1])+Fe;break;case 5:Fe=cn("\r",e[0][w][1][1])+Fe;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}u.push(Se+u.pop()+Fe);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":x={c:b[1][1],r:b[1][0]};var we={c:n.c,r:n.r};if(r.sharedf[it(x)]){var ae=r.sharedf[it(x)];u.push(Jn(ae,c,we,r,a))}else{var me=!1;for(p=0;p!=r.arrayf.length;++p)if(m=r.arrayf[p],!(x.c<m[0].s.c||x.c>m[0].e.c)&&!(x.r<m[0].s.r||x.r>m[0].e.r)){u.push(Jn(m[1],c,we,r,a)),me=!0;break}me||u.push(b[1])}break;case"PtgArray":u.push("{"+TO(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=M;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&re.indexOf(e[0][M][0])==-1){b=e[0][w];var q=!0;switch(b[1][0]){case 4:q=!1;case 0:C=cn(" ",b[1][1]);break;case 5:q=!1;case 1:C=cn("\r",b[1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}u.push((q?C:"")+u.pop()+(q?"":C)),w=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function SO(e,t,n){var r=e.l+t,a=n.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],tr(e,t-2)];var u=mc(e,c,n);return t!==c+a&&(l=hc(e,t-c-a,u,n)),e.l=r,[u,l]}function wO(e,t,n){var r=e.l+t,a=n.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],tr(e,t-2)];var u=mc(e,c,n);return t!==c+a&&(l=hc(e,t-c-a,u,n)),e.l=r,[u,l]}function CO(e,t,n,r){var a=e.l+t,l=mc(e,r,n),c;return a!==e.l&&(c=hc(e,a-e.l,l,n)),[l,c]}function AO(e,t,n){var r=e.l+t,a,l=e.read_shift(2),c=mc(e,l,n);return l==65535?[[],tr(e,t-2)]:(t!==l+2&&(a=hc(e,r-l-2,c,n)),[c,a])}function bO(e){var t;if(za(e,e.l+6)!==65535)return[Kn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Ud(e,t,n){var r=e.l+t,a=Ea(e);n.biff==2&&++e.l;var l=bO(e),c=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var u=wO(e,r-e.l,n);return{cell:a,val:l[0],formula:u,shared:c>>3&1,tt:l[1]}}function vf(e,t,n){var r=e.read_shift(4),a=mc(e,r,n),l=e.read_shift(4),c=l>0?hc(e,l,a,n):null;return[a,c]}var kO=vf,yf=vf,NO=vf,MO=vf,RO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},l_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},DO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ky(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Bd(e){var t=e.split(":"),n=t[0].split(".")[0];return[n,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Go={},ml={};function zo(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function o_(e,t,n,r,a,l){try{r.cellNF&&(e.z=lt[t])}catch(u){if(r.WTF)throw u}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Pn(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(lt[t]==null&&is(ID[t]||"General",t),e.t==="e")e.w=e.w||_s[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zo(e.v);else if(e.t==="d"){var c=fr(e.v);(c|0)===c?e.w=c.toString(10):e.w=Zo(c)}else{if(e.v===void 0)return"";e.w=ds(e.v,ml)}else e.t==="d"?e.w=zr(t,fr(e.v),ml):e.w=zr(t,e.v,ml)}catch(u){if(r.WTF)throw u}if(r.cellStyles&&n!=null)try{e.s=l.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ef(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ef(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(r.WTF&&l.Fills)throw u}}}function IO(e,t){var n=un(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=kt(n))}var FO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,LO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,OO=/<(?:\w:)?hyperlink [^>]*>/mg,PO=/"(\w*:\w*)"/,UO=/<(?:\w:)?col\b[^>]*[\/]?>/g,BO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,VO=/<(?:\w:)?pageMargins[^>]*\/>/g,c_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,HO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,GO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zO(e,t,n,r,a,l,c){if(!e)return e;r||(r={"!id":{}});var u=t.dense?[]:{},p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",x="",y=e.match(LO);y?(m=e.slice(0,y.index),x=e.slice(y.index+y[0].length)):m=x=e;var _=m.match(c_);_?Qh(_[0],u,a,n):(_=m.match(HO))&&jO(_[0],_[1]||"",u,a,n);var E=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var S=m.slice(E,E+50).match(PO);S&&IO(u,S[1])}var w=m.match(GO);w&&w[1]&&JO(w[1],a);var C=[];if(t.cellStyles){var M=m.match(UO);M&&YO(C,M)}y&&KO(y[1],u,t,p,l,c);var k=x.match(BO);k&&(u["!autofilter"]=WO(k[0]));var b=[],U=x.match(FO);if(U)for(E=0;E!=U.length;++E)b[E]=un(U[E].slice(U[E].indexOf('"')+1));var G=x.match(OO);G&&qO(u,G,r);var X=x.match(VO);if(X&&(u["!margins"]=$O(tt(X[0]))),!u["!ref"]&&p.e.c>=p.s.c&&p.e.r>=p.s.r&&(u["!ref"]=kt(p)),t.sheetRows>0&&u["!ref"]){var F=un(u["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>p.e.r&&(F.e.r=p.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>p.e.c&&(F.e.c=p.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),u["!fullref"]=u["!ref"],u["!ref"]=kt(F))}return C.length>0&&(u["!cols"]=C),b.length>0&&(u["!merges"]=b),u}function Qh(e,t,n,r){var a=tt(e);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=Nt(Jt(a.codeName)))}function jO(e,t,n,r,a){Qh(e.slice(0,e.indexOf(">")),n,r,a)}function qO(e,t,n){for(var r=Array.isArray(e),a=0;a!=t.length;++a){var l=tt(Jt(t[a]),!0);if(!l.ref)return;var c=((n||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+Nt(l.location))):(l.Target="#"+Nt(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=un(l.ref),p=u.s.r;p<=u.e.r;++p)for(var m=u.s.c;m<=u.e.c;++m){var x=it({c:m,r:p});r?(e[p]||(e[p]=[]),e[p][m]||(e[p][m]={t:"z",v:void 0}),e[p][m].l=l):(e[x]||(e[x]={t:"z",v:void 0}),e[x].l=l)}}}function $O(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}function YO(e,t){for(var n=!1,r=0;r!=t.length;++r){var a=tt(t[r],!0);a.hidden&&(a.hidden=nn(a.hidden));var l=parseInt(a.min,10)-1,c=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,Kh(a.width)),_l(a);l<=c;)e[l++]=qn(a)}}function WO(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var XO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function JO(e,t){t.Views||(t.Views=[{}]),(e.match(XO)||[]).forEach(function(n,r){var a=tt(n);t.Views[r]||(t.Views[r]={}),+a.zoomScale&&(t.Views[r].zoom=+a.zoomScale),nn(a.rightToLeft)&&(t.Views[r].RTL=!0)})}var KO=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,l=Qo("v"),c=Qo("f");return function(p,m,x,y,_,E){for(var S=0,w="",C=[],M=[],k=0,b=0,U=0,G="",X,F,W=0,O=0,te,ne,ee=0,Se=0,Fe=Array.isArray(E.CellXf),we,ae=[],me=[],re=Array.isArray(m),q=[],N={},j=!1,R=!!x.sheetStubs,J=p.split(t),Y=0,H=J.length;Y!=H;++Y){w=J[Y].trim();var se=w.length;if(se!==0){var Ee=0;e:for(S=0;S<se;++S)switch(w[S]){case">":if(w[S-1]!="/"){++S;break e}if(x&&x.cellStyles){if(F=tt(w.slice(Ee,S),!0),W=F.r!=null?parseInt(F.r,10):W+1,O=-1,x.sheetRows&&x.sheetRows<W)continue;N={},j=!1,F.ht&&(j=!0,N.hpt=parseFloat(F.ht),N.hpx=rc(N.hpt)),F.hidden=="1"&&(j=!0,N.hidden=!0),F.outlineLevel!=null&&(j=!0,N.level=+F.outlineLevel),j&&(q[W-1]=N)}break;case"<":Ee=S;break}if(Ee>=S)break;if(F=tt(w.slice(Ee,S),!0),W=F.r!=null?parseInt(F.r,10):W+1,O=-1,!(x.sheetRows&&x.sheetRows<W)){y.s.r>W-1&&(y.s.r=W-1),y.e.r<W-1&&(y.e.r=W-1),x&&x.cellStyles&&(N={},j=!1,F.ht&&(j=!0,N.hpt=parseFloat(F.ht),N.hpx=rc(N.hpt)),F.hidden=="1"&&(j=!0,N.hidden=!0),F.outlineLevel!=null&&(j=!0,N.level=+F.outlineLevel),j&&(q[W-1]=N)),C=w.slice(S).split(e);for(var ke=0;ke!=C.length&&C[ke].trim().charAt(0)=="<";++ke);for(C=C.slice(ke),S=0;S!=C.length;++S)if(w=C[S].trim(),w.length!==0){if(M=w.match(n),k=S,b=0,U=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,M!=null&&M.length===2){for(k=0,G=M[1],b=0;b!=G.length&&!((U=G.charCodeAt(b)-64)<1||U>26);++b)k=26*k+U;--k,O=k}else++O;for(b=0;b!=w.length&&w.charCodeAt(b)!==62;++b);if(++b,F=tt(w.slice(0,b),!0),F.r||(F.r=it({r:W-1,c:O})),G=w.slice(b),X={t:""},(M=G.match(l))!=null&&M[1]!==""&&(X.v=Nt(M[1])),x.cellFormula){if((M=G.match(c))!=null&&M[1]!==""){if(X.f=Nt(Jt(M[1])).replace(/\r\n/g,`
`),x.xlfn||(X.f=wy(X.f)),M[0].indexOf('t="array"')>-1)X.F=(G.match(a)||[])[1],X.F.indexOf(":")>-1&&ae.push([un(X.F),X.F]);else if(M[0].indexOf('t="shared"')>-1){ne=tt(M[0]);var De=Nt(Jt(M[1]));x.xlfn||(De=wy(De)),me[parseInt(ne.si,10)]=[ne,De,F.r]}}else(M=G.match(/<f[^>]*\/>/))&&(ne=tt(M[0]),me[ne.si]&&(X.f=oL(me[ne.si][1],me[ne.si][2],F.r)));var Ce=or(F.r);for(b=0;b<ae.length;++b)Ce.r>=ae[b][0].s.r&&Ce.r<=ae[b][0].e.r&&Ce.c>=ae[b][0].s.c&&Ce.c<=ae[b][0].e.c&&(X.F=ae[b][1])}if(F.t==null&&X.v===void 0)if(X.f||X.F)X.v=0,X.t="n";else if(R)X.t="z";else continue;else X.t=F.t||"n";switch(y.s.c>O&&(y.s.c=O),y.e.c<O&&(y.e.c=O),X.t){case"n":if(X.v==""||X.v==null){if(!R)continue;X.t="z"}else X.v=parseFloat(X.v);break;case"s":if(typeof X.v>"u"){if(!R)continue;X.t="z"}else te=Go[parseInt(X.v,10)],X.v=te.t,X.r=te.r,x.cellHTML&&(X.h=te.h);break;case"str":X.t="s",X.v=X.v!=null?Jt(X.v):"",x.cellHTML&&(X.h=Vh(X.v));break;case"inlineStr":M=G.match(r),X.t="s",M!=null&&(te=Jh(M[1]))?(X.v=te.t,x.cellHTML&&(X.h=te.h)):X.v="";break;case"b":X.v=nn(X.v);break;case"d":x.cellDates?X.v=Pn(X.v,1):(X.v=fr(Pn(X.v,1)),X.t="n");break;case"e":(!x||x.cellText!==!1)&&(X.w=X.v),X.v=MT[X.v];break}if(ee=Se=0,we=null,Fe&&F.s!==void 0&&(we=E.CellXf[F.s],we!=null&&(we.numFmtId!=null&&(ee=we.numFmtId),x.cellStyles&&we.fillId!=null&&(Se=we.fillId))),o_(X,ee,Se,x,_,E),x.cellDates&&Fe&&X.t=="n"&&Al(lt[ee])&&(X.t="d",X.v=xf(X.v)),F.cm&&x.xlmeta){var Je=(x.xlmeta.Cell||[])[+F.cm-1];Je&&Je.type=="XLDAPR"&&(X.D=!0)}if(re){var K=or(F.r);m[K.r]||(m[K.r]=[]),m[K.r][K.c]=X}else m[F.r]=X}}}}q.length>0&&(m["!rows"]=q)}}();function ZO(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=r,l&7&&(n.level=l&7),l&16&&(n.hidden=!0),l&32&&(n.hpt=a/20),n}var QO=Ts;function e7(){}function t7(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=S6(e),n}function n7(e){var t=qr(e);return[t]}function r7(e){var t=ys(e);return[t]}function a7(e){var t=qr(e),n=e.read_shift(1);return[t,n,"b"]}function i7(e){var t=ys(e),n=e.read_shift(1);return[t,n,"b"]}function s7(e){var t=qr(e),n=e.read_shift(1);return[t,n,"e"]}function l7(e){var t=ys(e),n=e.read_shift(1);return[t,n,"e"]}function o7(e){var t=qr(e),n=e.read_shift(4);return[t,n,"s"]}function c7(e){var t=ys(e),n=e.read_shift(4);return[t,n,"s"]}function u7(e){var t=qr(e),n=Kn(e);return[t,n,"n"]}function u_(e){var t=ys(e),n=Kn(e);return[t,n,"n"]}function f7(e){var t=qr(e),n=Yh(e);return[t,n,"n"]}function d7(e){var t=ys(e),n=Yh(e);return[t,n,"n"]}function h7(e){var t=qr(e),n=qh(e);return[t,n,"is"]}function m7(e){var t=qr(e),n=er(e);return[t,n,"str"]}function p7(e){var t=ys(e),n=er(e);return[t,n,"str"]}function x7(e,t,n){var r=e.l+t,a=qr(e);a.r=n["!row"];var l=e.read_shift(1),c=[a,l,"b"];if(n.cellFormula){e.l+=2;var u=yf(e,r-e.l,n);c[3]=Jn(u,null,a,n.supbooks,n)}else e.l=r;return c}function g7(e,t,n){var r=e.l+t,a=qr(e);a.r=n["!row"];var l=e.read_shift(1),c=[a,l,"e"];if(n.cellFormula){e.l+=2;var u=yf(e,r-e.l,n);c[3]=Jn(u,null,a,n.supbooks,n)}else e.l=r;return c}function v7(e,t,n){var r=e.l+t,a=qr(e);a.r=n["!row"];var l=Kn(e),c=[a,l,"n"];if(n.cellFormula){e.l+=2;var u=yf(e,r-e.l,n);c[3]=Jn(u,null,a,n.supbooks,n)}else e.l=r;return c}function y7(e,t,n){var r=e.l+t,a=qr(e);a.r=n["!row"];var l=er(e),c=[a,l,"str"];if(n.cellFormula){e.l+=2;var u=yf(e,r-e.l,n);c[3]=Jn(u,null,a,n.supbooks,n)}else e.l=r;return c}var T7=Ts;function _7(e,t){var n=e.l+t,r=Ts(e),a=$h(e),l=er(e),c=er(e),u=er(e);e.l=n;var p={rfx:r,relId:a,loc:l,display:u};return c&&(p.Tooltip=c),p}function E7(){}function S7(e,t,n){var r=e.l+t,a=bT(e),l=e.read_shift(1),c=[a];if(c[2]=l,n.cellFormula){var u=kO(e,r-e.l,n);c[1]=u}else e.l=r;return c}function w7(e,t,n){var r=e.l+t,a=Ts(e),l=[a];if(n.cellFormula){var c=MO(e,r-e.l,n);l[1]=c,e.l=r}else e.l=r;return l}var C7=["left","right","top","bottom","header","footer"];function A7(e){var t={};return C7.forEach(function(n){t[n]=Kn(e)}),t}function b7(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function k7(){}function N7(){}function M7(e,t,n,r,a,l,c){if(!e)return e;var u=t||{};r||(r={"!id":{}});var p=u.dense?[]:{},m,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,_=!1,E,S,w,C,M,k,b,U,G,X=[];u.biff=12,u["!row"]=0;var F=0,W=!1,O=[],te={},ne=u.supbooks||a.supbooks||[[]];if(ne.sharedf=te,ne.arrayf=O,ne.SheetNames=a.SheetNames||a.Sheets.map(function(re){return re.name}),!u.supbooks&&(u.supbooks=ne,a.Names))for(var ee=0;ee<a.Names.length;++ee)ne[0][ee+1]=a.Names[ee];var Se=[],Fe=[],we=!1;rf[16]={n:"BrtShortReal",f:u_};var ae;if(Ka(e,function(q,N,j){if(!_)switch(j){case 148:m=q;break;case 0:E=q,u.sheetRows&&u.sheetRows<=E.r&&(_=!0),U=$n(C=E.r),u["!row"]=E.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=rc(q.hpt)),Fe[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:q[2]},q[2]){case"n":S.v=q[1];break;case"s":b=Go[q[1]],S.v=b.t,S.r=b.r;break;case"b":S.v=!!q[1];break;case"e":S.v=q[1],u.cellText!==!1&&(S.w=_s[S.v]);break;case"str":S.t="s",S.v=q[1];break;case"is":S.t="s",S.v=q[1].t;break}if((w=c.CellXf[q[0].iStyleRef])&&o_(S,w.numFmtId,null,u,l,c),M=q[0].c==-1?M+1:q[0].c,u.dense?(p[C]||(p[C]=[]),p[C][M]=S):p[kn(M)+U]=S,u.cellFormula){for(W=!1,F=0;F<O.length;++F){var R=O[F];E.r>=R[0].s.r&&E.r<=R[0].e.r&&M>=R[0].s.c&&M<=R[0].e.c&&(S.F=kt(R[0]),W=!0)}!W&&q.length>3&&(S.f=q[3])}if(x.s.r>E.r&&(x.s.r=E.r),x.s.c>M&&(x.s.c=M),x.e.r<E.r&&(x.e.r=E.r),x.e.c<M&&(x.e.c=M),u.cellDates&&w&&S.t=="n"&&Al(lt[w.numFmtId])){var J=as(S.v);J&&(S.t="d",S.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}ae&&(ae.type=="XLDAPR"&&(S.D=!0),ae=void 0);break;case 1:case 12:if(!u.sheetStubs||y)break;S={t:"z",v:void 0},M=q[0].c==-1?M+1:q[0].c,u.dense?(p[C]||(p[C]=[]),p[C][M]=S):p[kn(M)+U]=S,x.s.r>E.r&&(x.s.r=E.r),x.s.c>M&&(x.s.c=M),x.e.r<E.r&&(x.e.r=E.r),x.e.c<M&&(x.e.c=M),ae&&(ae.type=="XLDAPR"&&(S.D=!0),ae=void 0);break;case 176:X.push(q);break;case 49:ae=((u.xlmeta||{}).Cell||[])[q-1];break;case 494:var Y=r["!id"][q.relId];for(Y?(q.Target=Y.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=Y):q.relId==""&&(q.Target="#"+q.loc),C=q.rfx.s.r;C<=q.rfx.e.r;++C)for(M=q.rfx.s.c;M<=q.rfx.e.c;++M)u.dense?(p[C]||(p[C]=[]),p[C][M]||(p[C][M]={t:"z",v:void 0}),p[C][M].l=q):(k=it({c:M,r:C}),p[k]||(p[k]={t:"z",v:void 0}),p[k].l=q);break;case 426:if(!u.cellFormula)break;O.push(q),G=u.dense?p[C][M]:p[kn(M)+U],G.f=Jn(q[1],x,{r:E.r,c:M},ne,u),G.F=kt(q[0]);break;case 427:if(!u.cellFormula)break;te[it(q[0].s)]=q[1],G=u.dense?p[C][M]:p[kn(M)+U],G.f=Jn(q[1],x,{r:E.r,c:M},ne,u);break;case 60:if(!u.cellStyles)break;for(;q.e>=q.s;)Se[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},we||(we=!0,Kh(q.w/256)),_l(Se[q.e+1]);break;case 161:p["!autofilter"]={ref:kt(q)};break;case 476:p["!margins"]=q;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),q.name&&(a.Sheets[n].CodeName=q.name),(q.above||q.left)&&(p["!outline"]={above:q.above,left:q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!N.T){if(!y||u.WTF)throw new Error("Unexpected record 0x"+j.toString(16))}}},u),delete u.supbooks,delete u["!row"],!p["!ref"]&&(x.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(p["!ref"]=kt(m||x)),u.sheetRows&&p["!ref"]){var me=un(p["!ref"]);u.sheetRows<=+me.e.r&&(me.e.r=u.sheetRows-1,me.e.r>x.e.r&&(me.e.r=x.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>x.e.c&&(me.e.c=x.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),p["!fullref"]=p["!ref"],p["!ref"]=kt(me))}return X.length>0&&(p["!merges"]=X),Se.length>0&&(p["!cols"]=Se),Fe.length>0&&(p["!rows"]=Fe),p}function R7(e){var t=[],n=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=n?+c[2]:c[2])});var a=Nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){r=l.replace(/<.*?>/g,"")}),[t,a,r]}function D7(e,t,n,r,a,l){var c=l||{"!type":"chart"};if(!e)return l;var u=0,p=0,m="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var _=R7(y);x.s.r=x.s.c=0,x.e.c=u,m=kn(u),_[0].forEach(function(E,S){c[m+$n(S)]={t:"n",v:E,z:_[1]},p=S}),x.e.r<p&&(x.e.r=p),++u}),u>0&&(c["!ref"]=kt(x)),c}function I7(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(c_);return u&&Qh(u[0],l,a,n),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}function F7(e,t){e.l+=10;var n=er(e);return{name:n}}function L7(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Ka(e,function(p,m,x){switch(x){case 550:l["!rel"]=p;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),p.name&&(a.Sheets[n].CodeName=p.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},t),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}var f_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],O7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],P7=[],U7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ny(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],a=0;a!=t.length;++a){var l=t[a];if(r[l[0]]==null)r[l[0]]=l[1];else switch(l[2]){case"bool":typeof r[l[0]]=="string"&&(r[l[0]]=nn(r[l[0]]));break;case"int":typeof r[l[0]]=="string"&&(r[l[0]]=parseInt(r[l[0]],10));break}}}function My(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=nn(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function d_(e){My(e.WBProps,f_),My(e.CalcPr,U7),Ny(e.WBView,O7),Ny(e.Sheets,P7),ml.date1904=nn(e.WBProps.date1904)}var B7="][*?/\\".split("");function V7(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return B7.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}var H7=/<\w+:workbook/;function G7(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",l={},c=0;if(e.replace(nr,function(p,m){var x=tt(p);switch(_a(x[0])){case"<?xml":break;case"<workbook":p.match(H7)&&(a="xmlns"+p.match(/<(\w+):/)[1]),n.xmlns=x[a];break;case"</workbook>":break;case"<fileVersion":delete x[0],n.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":f_.forEach(function(y){if(x[y[0]]!=null)switch(y[2]){case"bool":n.WBProps[y[0]]=nn(x[y[0]]);break;case"int":n.WBProps[y[0]]=parseInt(x[y[0]],10);break;default:n.WBProps[y[0]]=x[y[0]]}}),x.codeName&&(n.WBProps.CodeName=Jt(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],n.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=Nt(Jt(x.name)),delete x[0],n.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":l={},l.Name=Jt(x.name),x.comment&&(l.Comment=x.comment),x.localSheetId&&(l.Sheet=+x.localSheetId),nn(x.hidden||"0")&&(l.Hidden=!0),c=m+p.length;break;case"</definedName>":l.Ref=Nt(Jt(e.slice(c,m))),n.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete x[0],n.CalcPr=x;break;case"<calcPr/>":delete x[0],n.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return p}),s6.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return d_(n),n}function z7(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=fh(e),n.name=er(e),n}function j7(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?er(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function q7(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function $7(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),l=w6(e),c=NO(e,0,n),u=$h(e);e.l=r;var p={Name:l,Ptg:c};return a<268435455&&(p.Sheet=a),u&&(p.Comment=u),p}function Y7(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],rf[16]={n:"BrtFRTArchID$",f:q7},Ka(e,function(p,m,x){switch(x){case 156:c.SheetNames.push(p.name),n.Sheets.push(p);break;case 153:n.WBProps=p;break;case 39:p.Sheet!=null&&(t.SID=p.Sheet),p.Ref=Jn(p.Ptg,null,null,c,t),delete t.SID,delete p.Ptg,l.push(p);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([x,p]):c[0]=[x,p],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(p),c.XTI=c.XTI.concat(p);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(x),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(x),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!m.T){if(!a||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},t),d_(n),n.Names=l,n.supbooks=c,n}function W7(e,t,n){return t.slice(-4)===".bin"?Y7(e,n):G7(e,n)}function X7(e,t,n,r,a,l,c,u){return t.slice(-4)===".bin"?M7(e,r,n,a,l,c,u):zO(e,r,n,a,l,c,u)}function J7(e,t,n,r,a,l,c,u){return t.slice(-4)===".bin"?L7(e,r,n,a,l):I7(e,r,n,a,l)}function K7(e,t,n,r,a,l,c,u){return t.slice(-4)===".bin"?iL():sL()}function Z7(e,t,n,r,a,l,c,u){return t.slice(-4)===".bin"?rL():aL()}function Q7(e,t,n,r){return t.slice(-4)===".bin"?TF(e,n,r):mF(e,n,r)}function eP(e,t,n){return ZT(e,n)}function tP(e,t,n){return t.slice(-4)===".bin"?O8(e,n):F8(e,n)}function nP(e,t,n){return t.slice(-4)===".bin"?eL(e,n):XF(e,n)}function rP(e,t,n){return t.slice(-4)===".bin"?$F(e):jF(e)}function aP(e,t,n,r){return n.slice(-4)===".bin"?YF(e,t,n,r):void 0}function iP(e,t,n){return t.slice(-4)===".bin"?GF(e,t,n):zF(e,t,n)}var h_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,m_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Kr(e,t){var n=e.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=e.match(h_),l,c,u,p;if(a)for(p=0;p!=a.length;++p)l=a[p].match(m_),(c=l[1].indexOf(":"))===-1?r[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(c+1),r[u]=l[2].slice(1,l[2].length-1));return r}function sP(e){var t=e.split(/\s+/),n={};if(t.length===1)return n;var r=e.match(h_),a,l,c,u;if(r)for(u=0;u!=r.length;++u)a=r[u].match(m_),(l=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(l+1),n[c]=a[2].slice(1,a[2].length-1));return n}var jo;function lP(e,t){var n=jo[e]||Nt(e);return n==="General"?ds(t):zr(n,t)}function oP(e,t,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=nn(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Pn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[Nt(t)]=a}function cP(e,t,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||_s[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zo(e.v):e.w=ds(e.v):e.w=lP(t||"General",e.v)}catch(l){if(n.WTF)throw l}try{var r=jo[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&e.t=="n"&&Al(r)){var a=as(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(l){if(n.WTF)throw l}}}function uP(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=oF[r.Pattern]||r.Pattern)}e[t.ID]=t}function fP(e,t,n,r,a,l,c,u,p,m){var x="General",y=r.StyleID,_={};m=m||{};var E=[],S=0;for(y===void 0&&u&&(y=u.StyleID),y===void 0&&c&&(y=c.StyleID);l[y]!==void 0&&(l[y].nf&&(x=l[y].nf),l[y].Interior&&E.push(l[y].Interior),!!l[y].Parent);)y=l[y].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=nn(e);break;case"String":r.t="s",r.r=Zv(Nt(e)),r.v=e.indexOf("<")>-1?Nt(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Pn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Nt(e):r.v<60&&(r.v=r.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=MT[e],m.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=Zv(t||e));break}if(cP(r,x,m),m.cellFormula!==!1)if(r.Formula){var w=Nt(r.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),r.f=hl(w,a),delete r.Formula,r.ArrayRange=="RC"?r.F=hl("RC:RC",a):r.ArrayRange&&(r.F=hl(r.ArrayRange,a),p.push([un(r.F),r.F]))}else for(S=0;S<p.length;++S)a.r>=p[S][0].s.r&&a.r<=p[S][0].e.r&&a.c>=p[S][0].s.c&&a.c<=p[S][0].e.c&&(r.F=p[S][1]);m.cellStyles&&(E.forEach(function(C){!_.patternType&&C.patternType&&(_.patternType=C.patternType)}),r.s=_),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function dP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Vd(e,t){var n=t||{};nT();var r=Mo(Hh(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Jt(r));var a=r.slice(0,1024).toLowerCase(),l=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var c=qn(n);return c.type="string",tc.to_workbook(r,c)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(He){a.indexOf("<"+He)>=0&&(l=!0)}),l)return _P(r,n);jo={"General Number":"General","General Date":lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lt[15],"Short Date":lt[14],"Long Time":lt[19],"Medium Time":lt[18],"Short Time":lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lt[2],Standard:lt[4],Percent:lt[10],Scientific:lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,p=[],m,x={},y=[],_=n.dense?[]:{},E="",S={},w={},C=Kr('<Data ss:Type="String">'),M=0,k=0,b=0,U={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},X={},F="",W=0,O=[],te={},ne={},ee=0,Se=[],Fe=[],we={},ae=[],me,re=!1,q=[],N=[],j={},R=0,J=0,Y={Sheets:[],WBProps:{date1904:!1}},H={};ec.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";u=ec.exec(r);)switch(u[3]=(se=u[3]).toLowerCase()){case"data":if(se=="data"){if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&p.push([u[3],!0]);break}if(p[p.length-1][1])break;u[1]==="/"?fP(r.slice(M,u.index),F,C,p[p.length-1][0]=="comment"?we:S,{c:k,r:b},G,ae[k],w,q,n):(F="",C=Kr(u[0]),M=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Fe.length>0&&(S.c=Fe),(!n.sheetRows||n.sheetRows>b)&&S.v!==void 0&&(n.dense?(_[b]||(_[b]=[]),_[b][k]=S):_[kn(k)+$n(b)]=S),S.HRef&&(S.l={Target:Nt(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(R=k+(parseInt(S.MergeAcross,10)|0),J=b+(parseInt(S.MergeDown,10)|0),O.push({s:{c:k,r:b},e:{c:R,r:J}})),!n.sheetStubs)S.MergeAcross?k=R+1:++k;else if(S.MergeAcross||S.MergeDown){for(var Ee=k;Ee<=R;++Ee)for(var ke=b;ke<=J;++ke)(Ee>k||ke>b)&&(n.dense?(_[ke]||(_[ke]=[]),_[ke][Ee]={t:"z"}):_[kn(Ee)+$n(ke)]={t:"z"});k=R+1}else++k;else S=sP(u[0]),S.Index&&(k=+S.Index-1),k<U.s.c&&(U.s.c=k),k>U.e.c&&(U.e.c=k),u[0].slice(-2)==="/>"&&++k,Fe=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(b<U.s.r&&(U.s.r=b),b>U.e.r&&(U.e.r=b),u[0].slice(-2)==="/>"&&(w=Kr(u[0]),w.Index&&(b=+w.Index-1)),k=0,++b):(w=Kr(u[0]),w.Index&&(b=+w.Index-1),j={},(w.AutoFitHeight=="0"||w.Height)&&(j.hpx=parseInt(w.Height,10),j.hpt=KT(j.hpx),N[b]=j),w.Hidden=="1"&&(j.hidden=!0,N[b]=j));break;case"worksheet":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));y.push(E),U.s.r<=U.e.r&&U.s.c<=U.e.c&&(_["!ref"]=kt(U),n.sheetRows&&n.sheetRows<=U.e.r&&(_["!fullref"]=_["!ref"],U.e.r=n.sheetRows-1,_["!ref"]=kt(U))),O.length&&(_["!merges"]=O),ae.length>0&&(_["!cols"]=ae),N.length>0&&(_["!rows"]=N),x[E]=_}else U={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=k=0,p.push([u[3],!1]),m=Kr(u[0]),E=Nt(m.Name),_=n.dense?[]:{},O=[],q=[],N=[],H={name:E,Hidden:0},Y.Sheets.push(H);break;case"table":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else{if(u[0].slice(-2)=="/>")break;p.push([u[3],!1]),ae=[],re=!1}break;case"style":u[1]==="/"?uP(G,X,n):X=Kr(u[0]);break;case"numberformat":X.nf=Nt(Kr(u[0]).Format||"General"),jo[X.nf]&&(X.nf=jo[X.nf]);for(var De=0;De!=392&&lt[De]!=X.nf;++De);if(De==392){for(De=57;De!=392;++De)if(lt[De]==null){is(X.nf,De);break}}break;case"column":if(p[p.length-1][0]!=="table")break;if(me=Kr(u[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!re&&me.wpx>10){re=!0,lr=XT;for(var Ce=0;Ce<ae.length;++Ce)ae[Ce]&&_l(ae[Ce])}re&&_l(me),ae[me.Index-1||ae.length]=me;for(var Je=0;Je<+me.Span;++Je)ae[ae.length]=qn(me);break;case"namedrange":if(u[1]==="/")break;Y.Names||(Y.Names=[]);var K=tt(u[0]),pt={Name:K.Name,Ref:hl(K.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(pt.Sheet=Y.Sheets.length-1),Y.Names.push(pt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?F+=r.slice(W,u.index):W=u.index+u[0].length;break;case"interior":if(!n.cellStyles)break;X.Interior=Kr(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?X6(te,se,r.slice(ee,u.index)):ee=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else p.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));dP(we),Fe.push(we)}else p.push([u[3],!1]),m=Kr(u[0]),we={a:m.Author};break;case"autofilter":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ke=Kr(u[0]);_["!autofilter"]={ref:hl(Ke.Range).replace(/\$/g,"")},p.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&p.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&p.push([u[3],!0]);break;case"null":break;default:if(p.length==0&&u[3]=="document"||p.length==0&&u[3]=="uof")return Oy(r,n);var ft=!0;switch(p[p.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ft=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ft=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ft=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:ft=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(r.slice(ee,u.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else ee=u.index+u[0].length;break;case"header":_["!margins"]||zo(_["!margins"]={},"xlml"),isNaN(+tt(u[0]).Margin)||(_["!margins"].header=+tt(u[0]).Margin);break;case"footer":_["!margins"]||zo(_["!margins"]={},"xlml"),isNaN(+tt(u[0]).Margin)||(_["!margins"].footer=+tt(u[0]).Margin);break;case"pagemargins":var Me=tt(u[0]);_["!margins"]||zo(_["!margins"]={},"xlml"),isNaN(+Me.Top)||(_["!margins"].top=+Me.Top),isNaN(+Me.Left)||(_["!margins"].left=+Me.Left),isNaN(+Me.Right)||(_["!margins"].right=+Me.Right),isNaN(+Me.Bottom)||(_["!margins"].bottom=+Me.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ft=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ft=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ft=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ft=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ft=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ft=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ft=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ft=!1}break;case"smarttags":break;default:ft=!1;break}if(ft||u[3].match(/!\[CDATA/))break;if(!p[p.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+p.join("|");if(p[p.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?oP(ne,se,Se,r.slice(ee,u.index)):(Se=u,ee=u.index+u[0].length);break}if(n.WTF)throw"Unrecognized tag: "+u[3]+"|"+p.join("|")}var Te={};return!n.bookSheets&&!n.bookProps&&(Te.Sheets=x),Te.SheetNames=y,Te.Workbook=Y,Te.SSF=qn(lt),Te.Props=te,Te.Custprops=ne,Te}function ph(e,t){switch(nm(t=t||{}),t.type||"base64"){case"base64":return Vd(kr(e),t);case"binary":case"buffer":case"file":return Vd(e,t);case"array":return Vd(vs(e),t)}}function hP(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=b6(n),n.length-n.l<=4)return t;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=k6(n),r=n.read_shift(4),r==0||r>40))return t;n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr")}var mP=[60,1084,2066,2165,2175];function pP(e,t,n,r,a){var l=r,c=[],u=n.slice(n.l,n.l+l);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}c.push(u),n.l+=l;for(var p=za(n,n.l),m=xh[p],x=0;m!=null&&mP.indexOf(p)>-1;)l=za(n,n.l+2),x=n.l+4,p==2066?x+=4:(p==2165||p==2175)&&(x+=12),u=n.slice(x,n.l+4+l),c.push(u),n.l+=4+l,m=xh[p=za(n,n.l)];var y=Ai(c);jn(y,0);var _=0;y.lens=[];for(var E=0;E<c.length;++E)y.lens.push(_),_+=c[E].length;if(y.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+y.length+" < "+r;return t.f(y,y.length,a)}function da(e,t,n){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=lt[r])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||_s[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zo(e.v):e.w=ds(e.v):e.w=zr(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&r&&e.t=="n"&&Al(lt[r]||String(r))){var a=as(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Du(e,t,n){return{v:e,ixfe:t,t:n}}function xP(e,t){var n={opts:{}},r={},a=t.dense?[]:{},l={},c={},u=null,p=[],m="",x={},y,_="",E,S,w,C,M={},k=[],b,U,G=[],X=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},O=function(Ue){return Ue<8?ss[Ue]:Ue<64&&X[Ue-8]||ss[Ue]},te=function(Ue,dt,jt){var Et=dt.XF.data;if(!(!Et||!Et.patternType||!jt||!jt.cellStyles)){dt.s={},dt.s.patternType=Et.patternType;var Mn;(Mn=nc(O(Et.icvFore)))&&(dt.s.fgColor={rgb:Mn}),(Mn=nc(O(Et.icvBack)))&&(dt.s.bgColor={rgb:Mn})}},ne=function(Ue,dt,jt){if(!(j>1)&&!(jt.sheetRows&&Ue.r>=jt.sheetRows)){if(jt.cellStyles&&dt.XF&&dt.XF.data&&te(Ue,dt,jt),delete dt.ixfe,delete dt.XF,y=Ue,_=it(Ue),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),Ue.r<c.s.r&&(c.s.r=Ue.r),Ue.c<c.s.c&&(c.s.c=Ue.c),Ue.r+1>c.e.r&&(c.e.r=Ue.r+1),Ue.c+1>c.e.c&&(c.e.c=Ue.c+1),jt.cellFormula&&dt.f){for(var Et=0;Et<k.length;++Et)if(!(k[Et][0].s.c>Ue.c||k[Et][0].s.r>Ue.r)&&!(k[Et][0].e.c<Ue.c||k[Et][0].e.r<Ue.r)){dt.F=kt(k[Et][0]),(k[Et][0].s.c!=Ue.c||k[Et][0].s.r!=Ue.r)&&delete dt.f,dt.f&&(dt.f=""+Jn(k[Et][1],c,Ue,q,ee));break}}jt.dense?(a[Ue.r]||(a[Ue.r]=[]),a[Ue.r][Ue.c]=dt):a[_]=dt}},ee={enc:!1,sbcch:0,snames:[],sharedf:M,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(ee.password=t.password);var Se,Fe=[],we=[],ae=[],me=[],re=!1,q=[];q.SheetNames=ee.snames,q.sharedf=ee.sharedf,q.arrayf=ee.arrayf,q.names=[],q.XTI=[];var N=0,j=0,R=0,J=[],Y=[],H;ee.codepage=1200,ea(1200);for(var se=!1;e.l<e.length-1;){var Ee=e.l,ke=e.read_shift(2);if(ke===0&&N===10)break;var De=e.l===e.length?0:e.read_shift(2),Ce=xh[ke];if(Ce&&Ce.f){if(t.bookSheets&&N===133&&ke!==133)break;if(N=ke,Ce.r===2||Ce.r==12){var Je=e.read_shift(2);if(De-=2,!ee.enc&&Je!==ke&&((Je&255)<<8|Je>>8)!==ke)throw new Error("rt mismatch: "+Je+"!="+ke);Ce.r==12&&(e.l+=10,De-=10)}var K={};if(ke===10?K=Ce.f(e,De,ee):K=pP(ke,Ce,e,De,ee),j==0&&[9,521,1033,2057].indexOf(N)===-1)continue;switch(ke){case 34:n.opts.Date1904=F.WBProps.date1904=K;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(ee.enc||(e.l=0),ee.enc=K,!t.password)throw new Error("File is password-protected");if(K.valid==null)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=K;break;case 66:var pt=Number(K);switch(pt){case 21010:pt=1200;break;case 32768:pt=1e4;break;case 32769:pt=1252;break}ea(ee.codepage=pt),se=!0;break;case 317:ee.rrtabid=K;break;case 25:ee.winlocked=K;break;case 439:n.opts.RefreshAll=K;break;case 12:n.opts.CalcCount=K;break;case 16:n.opts.CalcDelta=K;break;case 17:n.opts.CalcIter=K;break;case 13:n.opts.CalcMode=K;break;case 14:n.opts.CalcPrecision=K;break;case 95:n.opts.CalcSaveRecalc=K;break;case 15:ee.CalcRefMode=K;break;case 2211:n.opts.FullCalc=K;break;case 129:K.fDialog&&(a["!type"]="dialog"),K.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),K.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:G.push(K);break;case 430:q.push([K]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(K);break;case 24:case 536:H={Name:K.Name,Ref:Jn(K.rgce,c,null,q,ee)},K.itab>0&&(H.Sheet=K.itab-1),q.names.push(H),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(K),K.Name=="_xlnm._FilterDatabase"&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&K.rgce[0][0][0]=="PtgArea3d"&&(Y[K.itab-1]={ref:kt(K.rgce[0][0][1][2])});break;case 22:ee.ExternCount=K;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(K),q.XTI=q.XTI.concat(K);break;case 2196:if(ee.biff<8)break;H!=null&&(H.Comment=K[1]);break;case 18:a["!protect"]=K;break;case 19:K!==0&&ee.WTF&&console.error("Password verifier: "+K);break;case 133:l[K.pos]=K,ee.snames.push(K.name);break;case 10:{if(--j)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,a["!ref"]=kt(c),t.sheetRows&&t.sheetRows<=c.e.r){var Ke=c.e.r;c.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=kt(c),c.e.r=Ke}c.e.r++,c.e.c++}Fe.length>0&&(a["!merges"]=Fe),we.length>0&&(a["!objects"]=we),ae.length>0&&(a["!cols"]=ae),me.length>0&&(a["!rows"]=me),F.Sheets.push(W)}m===""?x=a:r[m]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),ee.biffguess=K.BIFFVer==0,K.BIFFVer==0&&K.dt==4096&&(ee.biff=5,se=!0,ea(ee.codepage=28591)),ee.biff==8&&K.BIFFVer==0&&K.dt==16&&(ee.biff=2),j++)break;if(a=t.dense?[]:{},ee.biff<8&&!se&&(se=!0,ea(ee.codepage=t.codepage||1252)),ee.biff<5||K.BIFFVer==0&&K.dt==4096){m===""&&(m="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var ft={pos:e.l-De,name:m};l[ft.pos]=ft,ee.snames.push(m)}else m=(l[Ee]||{name:""}).name;K.dt==32&&(a["!type"]="chart"),K.dt==64&&(a["!type"]="macro"),Fe=[],we=[],ee.arrayf=k=[],ae=[],me=[],re=!1,W={Hidden:(l[Ee]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[K.r]||[])[K.c]:a[it({c:K.c,r:K.r})])&&++K.c,b={ixfe:K.ixfe,XF:G[K.ixfe]||{},v:K.val,t:"n"},R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne({c:K.c,r:K.r},b,t);break;case 5:case 517:b={ixfe:K.ixfe,XF:G[K.ixfe],v:K.val,t:K.t},R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne({c:K.c,r:K.r},b,t);break;case 638:b={ixfe:K.ixfe,XF:G[K.ixfe],v:K.rknum,t:"n"},R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne({c:K.c,r:K.r},b,t);break;case 189:for(var Me=K.c;Me<=K.C;++Me){var Te=K.rkrec[Me-K.c][0];b={ixfe:Te,XF:G[Te],v:K.rkrec[Me-K.c][1],t:"n"},R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne({c:Me,r:K.r},b,t)}break;case 6:case 518:case 1030:{if(K.val=="String"){u=K;break}if(b=Du(K.val,K.cell.ixfe,K.tt),b.XF=G[b.ixfe],t.cellFormula){var He=K.formula;if(He&&He[0]&&He[0][0]&&He[0][0][0]=="PtgExp"){var ze=He[0][0][1][0],Ft=He[0][0][1][1],Tt=it({r:ze,c:Ft});M[Tt]?b.f=""+Jn(K.formula,c,K.cell,q,ee):b.F=((t.dense?(a[ze]||[])[Ft]:a[Tt])||{}).F}else b.f=""+Jn(K.formula,c,K.cell,q,ee)}R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne(K.cell,b,t),u=K}break;case 7:case 519:if(u)u.val=K,b=Du(K,u.cell.ixfe,"s"),b.XF=G[b.ixfe],t.cellFormula&&(b.f=""+Jn(u.formula,c,u.cell,q,ee)),R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne(u.cell,b,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(K);var ot=it(K[0].s);if(E=t.dense?(a[K[0].s.r]||[])[K[0].s.c]:a[ot],t.cellFormula&&E){if(!u||!ot||!E)break;E.f=""+Jn(K[1],c,K[0],q,ee),E.F=kt(K[0])}}break;case 1212:{if(!t.cellFormula)break;if(_){if(!u)break;M[it(u.cell)]=K[0],E=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[it(u.cell)],(E||{}).f=""+Jn(K[0],c,y,q,ee)}}break;case 253:b=Du(p[K.isst].t,K.ixfe,"s"),p[K.isst].h&&(b.h=p[K.isst].h),b.XF=G[b.ixfe],R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne({c:K.c,r:K.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:K.ixfe,XF:G[K.ixfe],t:"z"},R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne({c:K.c,r:K.r},b,t));break;case 190:if(t.sheetStubs)for(var fn=K.c;fn<=K.C;++fn){var an=K.ixfe[fn-K.c];b={ixfe:an,XF:G[an],t:"z"},R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne({c:fn,r:K.r},b,t)}break;case 214:case 516:case 4:b=Du(K.val,K.ixfe,"s"),b.XF=G[b.ixfe],R>0&&(b.z=J[b.ixfe>>8&63]),da(b,t,n.opts.Date1904),ne({c:K.c,r:K.r},b,t);break;case 0:case 512:j===1&&(c=K);break;case 252:p=K;break;case 1054:if(ee.biff==4){J[R++]=K[1];for(var Un=0;Un<R+163&&lt[Un]!=K[1];++Un);Un>=163&&is(K[1],R+163)}else is(K[1],K[0]);break;case 30:{J[R++]=K;for(var $t=0;$t<R+163&&lt[$t]!=K;++$t);$t>=163&&is(K,R+163)}break;case 229:Fe=Fe.concat(K);break;case 93:we[K.cmo[0]]=ee.lastobj=K;break;case 438:ee.lastobj.TxO=K;break;case 127:ee.lastobj.ImData=K;break;case 440:for(C=K[0].s.r;C<=K[0].e.r;++C)for(w=K[0].s.c;w<=K[0].e.c;++w)E=t.dense?(a[C]||[])[w]:a[it({c:w,r:C})],E&&(E.l=K[1]);break;case 2048:for(C=K[0].s.r;C<=K[0].e.r;++C)for(w=K[0].s.c;w<=K[0].e.c;++w)E=t.dense?(a[C]||[])[w]:a[it({c:w,r:C})],E&&E.l&&(E.l.Tooltip=K[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;E=t.dense?(a[K[0].r]||[])[K[0].c]:a[it(K[0])];var Yt=we[K[2]];E||(t.dense?(a[K[0].r]||(a[K[0].r]=[]),E=a[K[0].r][K[0].c]={t:"z"}):E=a[it(K[0])]={t:"z"},c.e.r=Math.max(c.e.r,K[0].r),c.s.r=Math.min(c.s.r,K[0].r),c.e.c=Math.max(c.e.c,K[0].c),c.s.c=Math.min(c.s.c,K[0].c)),E.c||(E.c=[]),S={a:K[1],t:Yt.TxO.t},E.c.push(S)}break;case 2173:UF(G[K.ixfe],K.ext);break;case 125:{if(!ee.cellStyles)break;for(;K.e>=K.s;)ae[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(K.flags&1)},re||(re=!0,Kh(K.w/256)),_l(ae[K.e+1])}break;case 520:{var at={};K.level!=null&&(me[K.r]=at,at.level=K.level),K.hidden&&(me[K.r]=at,at.hidden=!0),K.hpt&&(me[K.r]=at,at.hpt=K.hpt,at.hpx=rc(K.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||zo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=K;break;case 161:a["!margins"]||zo(a["!margins"]={}),a["!margins"].header=K.header,a["!margins"].footer=K.footer;break;case 574:K.RTL&&(F.Views[0].RTL=!0);break;case 146:X=K;break;case 2198:Se=K;break;case 140:U=K;break;case 442:m?W.CodeName=K||W.name:F.WBProps.CodeName=K||"ThisWorkbook";break}}else Ce||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),e.l+=De}return n.SheetNames=ya(l).sort(function(Dt,Ue){return Number(Dt)-Number(Ue)}).map(function(Dt){return l[Dt].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&x["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=x)):n.Preamble=x,n.Sheets&&Y.forEach(function(Dt,Ue){n.Sheets[n.SheetNames[Ue]]["!autofilter"]=Dt}),n.Strings=p,n.SSF=qn(lt),ee.enc&&(n.Encryption=ee.enc),Se&&(n.Themes=Se),n.Metadata={},U!==void 0&&(n.Metadata.Country=U),q.names.length>0&&(F.Names=q.names),n.Workbook=F,n}var Ry={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function gP(e,t,n){var r=At.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=my(r,F6,Ry.DSI);for(var l in a)t[l]=a[l]}catch(m){if(n.WTF)throw m}var c=At.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=my(c,L6,Ry.SI);for(var p in u)t[p]==null&&(t[p]=u[p])}catch(m){if(n.WTF)throw m}t.HeadingPairs&&t.TitlesOfParts&&(DT(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}function p_(e,t){t||(t={}),nm(t),j2(),t.codepage&&Fh(t.codepage);var n,r;if(e.FullPaths){if(At.find(e,"/encryption"))throw new Error("File is password-protected");n=At.find(e,"!CompObj"),r=At.find(e,"/Workbook")||At.find(e,"/Book")}else{switch(t.type){case"base64":e=Qr(kr(e));break;case"binary":e=Qr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}jn(e,0),r={content:e}}var a,l;if(n&&hP(n),t.bookProps&&!t.bookSheets)a={};else{var c=St?"buffer":"array";if(r&&r.content)a=xP(r.content,t);else if((l=At.find(e,"PerfectOffice_MAIN"))&&l.content)a=Ho.to_workbook(l.content,(t.type=c,t));else if((l=At.find(e,"NativeContent_MAIN"))&&l.content)a=Ho.to_workbook(l.content,(t.type=c,t));else throw(l=At.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&At.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=nL(e))}var u={};return e.FullPaths&&gP(e,u,t),a.Props=a.Custprops=u,t.bookFiles&&(a.cfb=e),a}var rf={0:{f:ZO},1:{f:n7},2:{f:f7},3:{f:s7},4:{f:a7},5:{f:u7},6:{f:m7},7:{f:o7},8:{f:y7},9:{f:v7},10:{f:x7},11:{f:g7},12:{f:r7},13:{f:d7},14:{f:l7},15:{f:i7},16:{f:u_},17:{f:p7},18:{f:c7},19:{f:qh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$7},40:{},42:{},43:{f:xF},44:{f:pF},45:{f:gF},46:{f:yF},47:{f:vF},48:{},49:{f:T6},50:{},51:{f:VF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jT},62:{f:h7},63:{f:qF},64:{f:k7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:tr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:b7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:t7},148:{f:QO,p:16},151:{f:E7},152:{},153:{f:j7},154:{},155:{},156:{f:z7},157:{},158:{},159:{T:1,f:L8},160:{T:-1},161:{T:1,f:Ts},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:T7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:BF},336:{T:-1},337:{f:HF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:fh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:zT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:S7},427:{f:w7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:A7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:e7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:fh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:QF},633:{T:1},634:{T:-1},635:{T:1,f:ZF},636:{T:-1},637:{f:E6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:F7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:N7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},xh={6:{f:Ud},10:{f:wi},12:{f:Tn},13:{f:Tn},14:{f:pn},15:{f:pn},16:{f:Kn},17:{f:pn},18:{f:pn},19:{f:Tn},20:{f:vy},21:{f:vy},23:{f:zT},24:{f:Ty},25:{f:pn},26:{},27:{},28:{f:JI},29:{},34:{f:pn},35:{f:yy},38:{f:Kn},39:{f:Kn},40:{f:Kn},41:{f:Kn},42:{f:pn},43:{f:pn},47:{f:eF},49:{f:RI},51:{f:Tn},60:{},61:{f:kI},64:{f:pn},65:{f:MI},66:{f:Tn},77:{},80:{},81:{},82:{},85:{f:Tn},89:{},90:{},91:{},92:{f:TI},93:{f:ZI},94:{},95:{f:pn},96:{},97:{},99:{f:pn},125:{f:jT},128:{f:HI},129:{f:_I},130:{f:Tn},131:{f:pn},132:{f:pn},133:{f:EI},134:{},140:{f:a8},141:{f:Tn},144:{},146:{f:s8},151:{},152:{},153:{},154:{},155:{},156:{f:Tn},157:{},158:{},160:{f:f8},161:{f:o8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:PI},190:{f:UI},193:{f:wi},197:{},198:{},199:{},200:{},201:{},202:{f:pn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Tn},220:{},221:{f:pn},222:{},224:{f:VI},225:{f:yI},226:{f:wi},227:{},229:{f:KI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:SI},253:{f:DI},255:{f:wI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:PT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pn},353:{f:wi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:zI},431:{f:pn},432:{},433:{},434:{},437:{},438:{f:t8},439:{f:pn},440:{f:n8},441:{},442:{f:fc},443:{},444:{f:Tn},445:{},446:{},448:{f:wi},449:{f:bI,r:2},450:{f:wi},512:{f:xy},513:{f:u8},515:{f:GI},516:{f:II},517:{f:gy},519:{f:d8},520:{f:CI},523:{},545:{f:_y},549:{f:py},566:{},574:{f:NI},638:{f:OI},659:{},1048:{},1054:{f:FI},1084:{},1212:{f:YI},2048:{f:r8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Nu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:wi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:l8,r:12},2173:{f:PF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:$I,r:12},2197:{},2198:{f:RF,r:12},2199:{},2200:{},2201:{},2202:{f:WI,r:12},2203:{f:wi},2204:{},2205:{},2206:{},2207:{},2211:{f:AI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Tn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:c8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:i8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:xy},1:{},2:{f:x8},3:{f:p8},4:{f:m8},5:{f:gy},7:{f:g8},8:{},9:{f:Nu},11:{},22:{f:Tn},30:{f:LI},31:{},32:{},33:{f:_y},36:{},37:{f:py},50:{f:v8},62:{},52:{},67:{},68:{f:Tn},69:{},86:{},126:{},127:{f:h8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:y8},223:{},234:{},354:{},421:{},518:{f:Ud},521:{f:Nu},536:{f:Ty},547:{f:yy},561:{},579:{},1030:{f:Ud},1033:{f:Nu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Zr(e,t,n,r){var a=t;if(!isNaN(a)){var l=(n||[]).length||0,c=e.next(4);c.write_shift(2,a),c.write_shift(2,l),l>0&&wT(n)&&e.push(n)}}function Dy(e,t){var n=t||{},r=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=a.index,u=l&&l.index||e.length,p=GD(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,x=0,y=0,_=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(c=0;c<p.length;++c){var w=p[c].trim(),C=w.slice(0,3).toLowerCase();if(C=="<tr"){if(++m,n.sheetRows&&n.sheetRows<=m){--m;break}x=0;continue}if(!(C!="<td"&&C!="<th")){var M=w.split(/<\/t[dh]>/i);for(u=0;u<M.length;++u){var k=M[u].trim();if(k.match(/<t[dh]/i)){for(var b=k,U=0;b.charAt(0)=="<"&&(U=b.indexOf(">"))>-1;)b=b.slice(U+1);for(var G=0;G<S.length;++G){var X=S[G];X.s.c==x&&X.s.r<m&&m<=X.e.r&&(x=X.e.c+1,G=-1)}var F=tt(k.slice(0,k.indexOf(">")));_=F.colspan?+F.colspan:1,((y=+F.rowspan)>1||_>1)&&S.push({s:{r:m,c:x},e:{r:m+(y||1)-1,c:x+_-1}});var W=F.t||F["data-t"]||"";if(!b.length){x+=_;continue}if(b=fT(b),E.s.r>m&&(E.s.r=m),E.e.r<m&&(E.e.r=m),E.s.c>x&&(E.s.c=x),E.e.c<x&&(E.e.c=x),!b.length){x+=_;continue}var O={t:"s",v:b};n.raw||!b.trim().length||W=="s"||(b==="TRUE"?O={t:"b",v:!0}:b==="FALSE"?O={t:"b",v:!1}:isNaN(ra(b))?isNaN(Tl(b).getDate())||(O={t:"d",v:Pn(b)},n.cellDates||(O={t:"n",v:fr(O.v)}),O.z=n.dateNF||lt[14]):O={t:"n",v:ra(b)}),n.dense?(r[m]||(r[m]=[]),r[m][x]=O):r[it({r:m,c:x})]=O,x+=_}}}}return r["!ref"]=kt(E),S.length&&(r["!merges"]=S),r}function vP(e,t,n,r){for(var a=e["!merges"]||[],l=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,p=0,m=0;m<a.length;++m)if(!(a[m].s.r>n||a[m].s.c>c)&&!(a[m].e.r<n||a[m].e.c<c)){if(a[m].s.r<n||a[m].s.c<c){u=-1;break}u=a[m].e.r-a[m].s.r+1,p=a[m].e.c-a[m].s.c+1;break}if(!(u<0)){var x=it({r:n,c}),y=r.dense?(e[n]||[])[c]:e[x],_=y&&y.v!=null&&(y.h||Vh(y.w||(Wa(y),y.w)||""))||"",E={};u>1&&(E.rowspan=u),p>1&&(E.colspan=p),r.editable?_='<span contenteditable="true">'+_+"</span>":y&&(E["data-t"]=y&&y.t||"z",y.v!=null&&(E["data-v"]=y.v),y.z!=null&&(E["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+y.l.Target+'">'+_+"</a>")),E.id=(r.id||"sjs")+"-"+x,l.push(a6("td",_,E))}}var S="<tr>";return S+l.join("")+"</tr>"}var yP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',TP="</body></html>";function _P(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return Ui(Dy(n[0],t),t);var r=am();return n.forEach(function(a,l){im(r,Dy(a,t),"Sheet"+(l+1))}),r}function EP(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function SP(e,t){var n=t||{},r=n.header!=null?n.header:yP,a=n.footer!=null?n.footer:TP,l=[r],c=bl(e["!ref"]);n.dense=Array.isArray(e),l.push(EP(e,c,n));for(var u=c.s.r;u<=c.e.r;++u)l.push(vP(e,c,u,n));return l.push("</table>"+a),l.join("")}function x_(e,t,n){var r=n||{},a=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var c=typeof r.origin=="string"?or(r.origin):r.origin;a=c.r,l=c.c}var u=t.getElementsByTagName("tr"),p=Math.min(r.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r:a,c:l}};if(e["!ref"]){var x=bl(e["!ref"]);m.s.r=Math.min(m.s.r,x.s.r),m.s.c=Math.min(m.s.c,x.s.c),m.e.r=Math.max(m.e.r,x.e.r),m.e.c=Math.max(m.e.c,x.e.c),a==-1&&(m.e.r=a=x.e.r+1)}var y=[],_=0,E=e["!rows"]||(e["!rows"]=[]),S=0,w=0,C=0,M=0,k=0,b=0;for(e["!cols"]||(e["!cols"]=[]);S<u.length&&w<p;++S){var U=u[S];if(Iy(U)){if(r.display)continue;E[w]={hidden:!0}}var G=U.children;for(C=M=0;C<G.length;++C){var X=G[C];if(!(r.display&&Iy(X))){var F=X.hasAttribute("data-v")?X.getAttribute("data-v"):X.hasAttribute("v")?X.getAttribute("v"):fT(X.innerHTML),W=X.getAttribute("data-z")||X.getAttribute("z");for(_=0;_<y.length;++_){var O=y[_];O.s.c==M+l&&O.s.r<w+a&&w+a<=O.e.r&&(M=O.e.c+1-l,_=-1)}b=+X.getAttribute("colspan")||1,((k=+X.getAttribute("rowspan")||1)>1||b>1)&&y.push({s:{r:w+a,c:M+l},e:{r:w+a+(k||1)-1,c:M+l+(b||1)-1}});var te={t:"s",v:F},ne=X.getAttribute("data-t")||X.getAttribute("t")||"";F!=null&&(F.length==0?te.t=ne||"z":r.raw||F.trim().length==0||ne=="s"||(F==="TRUE"?te={t:"b",v:!0}:F==="FALSE"?te={t:"b",v:!1}:isNaN(ra(F))?isNaN(Tl(F).getDate())||(te={t:"d",v:Pn(F)},r.cellDates||(te={t:"n",v:fr(te.v)}),te.z=r.dateNF||lt[14]):te={t:"n",v:ra(F)})),te.z===void 0&&W!=null&&(te.z=W);var ee="",Se=X.getElementsByTagName("A");if(Se&&Se.length)for(var Fe=0;Fe<Se.length&&!(Se[Fe].hasAttribute("href")&&(ee=Se[Fe].getAttribute("href"),ee.charAt(0)!="#"));++Fe);ee&&ee.charAt(0)!="#"&&(te.l={Target:ee}),r.dense?(e[w+a]||(e[w+a]=[]),e[w+a][M+l]=te):e[it({c:M+l,r:w+a})]=te,m.e.c<M+l&&(m.e.c=M+l),M+=b}}++w}return y.length&&(e["!merges"]=(e["!merges"]||[]).concat(y)),m.e.r=Math.max(m.e.r,w-1+a),e["!ref"]=kt(m),w>=p&&(e["!fullref"]=kt((m.e.r=u.length-S+w-1+a,m))),e}function g_(e,t){var n=t||{},r=n.dense?[]:{};return x_(r,e,t)}function wP(e,t){return Ui(g_(e,t),t)}function Iy(e){var t="",n=CP(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function CP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function AP(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Nt(t.replace(/<[^>]*>/g,""));return[n]}var Fy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function v_(e,t){var n=t||{},r=Hh(e),a=[],l,c,u={name:""},p="",m=0,x,y,_={},E=[],S=n.dense?[]:{},w,C,M={value:""},k="",b=0,U=[],G=-1,X=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,O={},te=[],ne={},ee=0,Se=0,Fe=[],we=1,ae=1,me=[],re={Names:[]},q={},N=["",""],j=[],R={},J="",Y=0,H=!1,se=!1,Ee=0;for(ec.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=ec.exec(r);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?S["!ref"]=kt(F):S["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=F.e.r&&(S["!fullref"]=S["!ref"],F.e.r=n.sheetRows-1,S["!ref"]=kt(F)),te.length&&(S["!merges"]=te),Fe.length&&(S["!rows"]=Fe),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),E.push(x.name),_[x.name]=S,se=!1):w[0].charAt(w[0].length-2)!=="/"&&(x=tt(w[0],!1),G=X=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,S=n.dense?[]:{},te=[],Fe=[],se=!0);break;case"table-row-group":w[1]==="/"?--W:++W;break;case"table-row":case"":if(w[1]==="/"){G+=we,we=1;break}if(y=tt(w[0],!1),y.?G=y.-1:G==-1&&(G=0),we=+y["number-rows-repeated"]||1,we<10)for(Ee=0;Ee<we;++Ee)W>0&&(Fe[G+Ee]={level:W});X=-1;break;case"covered-table-cell":w[1]!=="/"&&++X,n.sheetStubs&&(n.dense?(S[G]||(S[G]=[]),S[G][X]={t:"z"}):S[it({r:G,c:X})]={t:"z"}),k="",U=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++X,M=tt(w[0],!1),ae=parseInt(M["number-columns-repeated"]||"1",10),C={t:"z",v:null},M.formula&&n.cellFormula!=!1&&(C.f=ky(Nt(M.formula))),(M.||M["value-type"])=="string"&&(C.t="s",C.v=Nt(M["string-value"]||""),n.dense?(S[G]||(S[G]=[]),S[G][X]=C):S[it({r:G,c:X})]=C),X+=ae-1;else if(w[1]!=="/"){++X,k="",b=0,U=[],ae=1;var ke=we?G+we-1:G;if(X>F.e.c&&(F.e.c=X),X<F.s.c&&(F.s.c=X),G<F.s.r&&(F.s.r=G),ke>F.e.r&&(F.e.r=ke),M=tt(w[0],!1),j=[],R={},C={t:M.||M["value-type"],v:null},n.cellFormula)if(M.formula&&(M.formula=Nt(M.formula)),M["number-matrix-columns-spanned"]&&M["number-matrix-rows-spanned"]&&(ee=parseInt(M["number-matrix-rows-spanned"],10)||0,Se=parseInt(M["number-matrix-columns-spanned"],10)||0,ne={s:{r:G,c:X},e:{r:G+ee-1,c:X+Se-1}},C.F=kt(ne),me.push([ne,C.F])),M.formula)C.f=ky(M.formula);else for(Ee=0;Ee<me.length;++Ee)G>=me[Ee][0].s.r&&G<=me[Ee][0].e.r&&X>=me[Ee][0].s.c&&X<=me[Ee][0].e.c&&(C.F=me[Ee][1]);switch((M["number-columns-spanned"]||M["number-rows-spanned"])&&(ee=parseInt(M["number-rows-spanned"],10)||0,Se=parseInt(M["number-columns-spanned"],10)||0,ne={s:{r:G,c:X},e:{r:G+ee-1,c:X+Se-1}},te.push(ne)),M["number-columns-repeated"]&&(ae=parseInt(M["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=nn(M["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(M.value);break;case"percentage":C.t="n",C.v=parseFloat(M.value);break;case"currency":C.t="n",C.v=parseFloat(M.value);break;case"date":C.t="d",C.v=Pn(M["date-value"]),n.cellDates||(C.t="n",C.v=fr(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=BD(M["time-value"])/86400,n.cellDates&&(C.t="d",C.v=xf(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(M.);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",M["string-value"]!=null&&(k=Nt(M["string-value"]),U=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(H=!1,C.t==="s"&&(C.v=k||"",U.length&&(C.R=U),H=b==0),q.Target&&(C.l=q),j.length>0&&(C.c=j,j=[]),k&&n.cellText!==!1&&(C.w=k),H&&(C.t="z",delete C.v),(!H||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=G))for(var De=0;De<we;++De){if(ae=parseInt(M["number-columns-repeated"]||"1",10),n.dense)for(S[G+De]||(S[G+De]=[]),S[G+De][X]=De==0?C:qn(C);--ae>0;)S[G+De][X+ae]=qn(C);else for(S[it({r:G+De,c:X})]=C;--ae>0;)S[it({r:G+De,c:X+ae})]=qn(C);F.e.c<=X&&(F.e.c=X)}ae=parseInt(M["number-columns-repeated"]||"1",10),X+=ae-1,ae=0,C={},k="",U=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((l=a.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((l=a.pop())[0]!==w[3])throw"Bad state: "+l;R.t=k,U.length&&(R.R=U),R.a=J,j.push(R)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);J="",Y=0,k="",b=0,U=[];break;case"creator":w[1]==="/"?J=r.slice(Y,w.index):Y=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((l=a.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);k="",b=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(O[u.name]=p,(l=a.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&(p="",u=tt(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":c=tt(w[0],!1),p+=Fy[w[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":c=tt(w[0],!1),p+=Fy[w[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":p+=r.slice(m,w.index);break}else m=w.index+w[0].length;break;case"named-range":c=tt(w[0],!1),N=Bd(c["cell-range-address"]);var Ce={Name:c.name,Ref:N[0]+"!"+N[1]};se&&(Ce.Sheet=E.length),re.Names.push(Ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!M||!M["string-value"])){var Je=AP(r.slice(b,w.index));k=(k.length>0?k+`
`:"")+Je[0]}else tt(w[0],!1),b=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{N=Bd(tt(w[0])["target-range-address"]),_[N[0]]["!autofilter"]={ref:N[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(q=tt(w[0],!1),!q.href)break;q.Target=Nt(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(N=Bd(q.Target.slice(1)),q.Target="#"+N[0]+"!"+N[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(w)}}var K={Sheets:_,SheetNames:E,Workbook:re};return n.bookSheets&&delete K.Sheets,K}function Ly(e,t){t=t||{},Hr(e,"META-INF/manifest.xml")&&G6(yn(e,"META-INF/manifest.xml"),t);var n=br(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=v_(Jt(n),t);return Hr(e,"meta.xml")&&(r.Props=RT(yn(e,"meta.xml"))),r}function Oy(e,t){return v_(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function em(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function gh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Jt(vs(e))}function vh(e){var t=e.reduce(function(a,l){return a+l.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(a){n.set(a,r),r+=a.length}),n}function Py(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function bP(e,t){for(var n=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,a=t+13;a>=t;--a)r=r*256+e[a];return(e[t+15]&128?-r:r)*Math.pow(10,n-6176)}function ac(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Nn(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function Qn(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],a=ac(e,n),l=a&7;a=Math.floor(a/8);var c=0,u;if(a==0)break;switch(l){case 0:{for(var p=n[0];e[n[0]++]>=128;);u=e.slice(p,n[0])}break;case 5:c=4,u=e.slice(n[0],n[0]+c),n[0]+=c;break;case 1:c=8,u=e.slice(n[0],n[0]+c),n[0]+=c;break;case 2:c=ac(e,n),u=e.slice(n[0],n[0]+c),n[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(a," at offset ").concat(r))}var m={data:u,type:l};t[a]==null?t[a]=[m]:t[a].push(m)}return t}function tm(e,t){return(e==null?void 0:e.map(function(n){return t(n.data)}))||[]}function kP(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=ac(e,r),l=Qn(e.slice(r[0],r[0]+a));r[0]+=a;var c={id:Nn(l[1][0].data),messages:[]};l[2].forEach(function(u){var p=Qn(u.data),m=Nn(p[3][0].data);c.messages.push({meta:p,data:e.slice(r[0],r[0]+m)}),r[0]+=m}),(t=l[3])!=null&&t[0]&&(c.merge=Nn(l[3][0].data)>>>0>0),n.push(c)}return n}function NP(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=ac(t,n),a=[];n[0]<t.length;){var l=t[n[0]]&3;if(l==0){var c=t[n[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[n[0]],u>1&&(c|=t[n[0]+1]<<8),u>2&&(c|=t[n[0]+2]<<16),u>3&&(c|=t[n[0]+3]<<24),c>>>=0,c++,n[0]+=u}a.push(t.slice(n[0],n[0]+c)),n[0]+=c;continue}else{var p=0,m=0;if(l==1?(m=(t[n[0]]>>2&7)+4,p=(t[n[0]++]&224)<<3,p|=t[n[0]++]):(m=(t[n[0]++]>>2)+1,l==2?(p=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(p=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[vh(a)],p==0)throw new Error("Invalid offset 0");if(p>a[0].length)throw new Error("Invalid offset beyond length");if(m>=p)for(a.push(a[0].slice(-p)),m-=p;m>=a[a.length-1].length;)a.push(a[a.length-1]),m-=a[a.length-1].length;a.push(a[0].slice(-p,-p+m))}}var x=vh(a);if(x.length!=r)throw new Error("Unexpected length: ".concat(x.length," != ").concat(r));return x}function MP(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(NP(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return vh(t)}function RP(e,t,n,r){var a=em(e),l=a.getUint32(4,!0),c=(r>1?12:8)+Py(l&(r>1?3470:398))*4,u=-1,p=-1,m=NaN,x=new Date(2001,0,1);l&512&&(u=a.getUint32(c,!0),c+=4),c+=Py(l&(r>1?12288:4096))*4,l&16&&(p=a.getUint32(c,!0),c+=4),l&32&&(m=a.getFloat64(c,!0),c+=8),l&64&&(x.setTime(x.getTime()+a.getFloat64(c,!0)*1e3),c+=8);var y;switch(e[2]){case 0:break;case 2:y={t:"n",v:m};break;case 3:y={t:"s",v:t[p]};break;case 5:y={t:"d",v:x};break;case 6:y={t:"b",v:m>0};break;case 7:y={t:"n",v:m/86400};break;case 8:y={t:"e",v:0};break;case 9:if(u>-1)y={t:"s",v:n[u]};else if(p>-1)y={t:"s",v:t[p]};else if(!isNaN(m))y={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return y}function DP(e,t,n){var r=em(e),a=r.getUint32(8,!0),l=12,c=-1,u=-1,p=NaN,m=NaN,x=new Date(2001,0,1);a&1&&(p=bP(e,l),l+=16),a&2&&(m=r.getFloat64(l,!0),l+=8),a&4&&(x.setTime(x.getTime()+r.getFloat64(l,!0)*1e3),l+=8),a&8&&(u=r.getUint32(l,!0),l+=4),a&16&&(c=r.getUint32(l,!0),l+=4);var y;switch(e[1]){case 0:break;case 2:y={t:"n",v:p};break;case 3:y={t:"s",v:t[u]};break;case 5:y={t:"d",v:x};break;case 6:y={t:"b",v:m>0};break;case 7:y={t:"n",v:m/86400};break;case 8:y={t:"e",v:0};break;case 9:if(c>-1)y={t:"s",v:n[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:y={t:"n",v:p};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return y}function IP(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return RP(e,t,n,e[0]);case 5:return DP(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Di(e){var t=Qn(e);return ac(t[1][0].data)}function Uy(e,t){var n=Qn(t.data),r=Nn(n[1][0].data),a=n[3],l=[];return(a||[]).forEach(function(c){var u=Qn(c.data),p=Nn(u[1][0].data)>>>0;switch(r){case 1:l[p]=gh(u[3][0].data);break;case 8:{var m=e[Di(u[9][0].data)][0],x=Qn(m.data),y=e[Di(x[1][0].data)][0],_=Nn(y.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var E=Qn(y.data);l[p]=E[3].map(function(S){return gh(S.data)}).join("")}break}}),l}function FP(e,t){var n,r,a,l,c,u,p,m,x,y,_,E,S,w,C=Qn(e),M=Nn(C[1][0].data)>>>0,k=Nn(C[2][0].data)>>>0,b=((r=(n=C[8])==null?void 0:n[0])==null?void 0:r.data)&&Nn(C[8][0].data)>0||!1,U,G;if((l=(a=C[7])==null?void 0:a[0])!=null&&l.data&&t!=0)U=(u=(c=C[7])==null?void 0:c[0])==null?void 0:u.data,G=(m=(p=C[6])==null?void 0:p[0])==null?void 0:m.data;else if((y=(x=C[4])==null?void 0:x[0])!=null&&y.data&&t!=1)U=(E=(_=C[4])==null?void 0:_[0])==null?void 0:E.data,G=(w=(S=C[3])==null?void 0:S[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var X=b?4:1,F=em(U),W=[],O=0;O<U.length/2;++O){var te=F.getUint16(O*2,!0);te<65535&&W.push([O,te])}if(W.length!=k)throw"Expected ".concat(k," cells, found ").concat(W.length);var ne=[];for(O=0;O<W.length-1;++O)ne[W[O][0]]=G.subarray(W[O][1]*X,W[O+1][1]*X);return W.length>=1&&(ne[W[W.length-1][0]]=G.subarray(W[W.length-1][1]*X)),{R:M,cells:ne}}function LP(e,t){var n,r=Qn(t.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?Nn(r[7][0].data)>>>0>0?1:0:-1,l=tm(r[5],function(c){return FP(c,a)});return{nrows:Nn(r[4][0].data)>>>0,data:l.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(p,m){if(c[u.R][m])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(m));c[u.R][m]=p}),c},[])}}function OP(e,t,n){var r,a=Qn(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(Nn(a[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(l.e.c=(Nn(a[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=kt(l);var c=Qn(a[4][0].data),u=Uy(e,e[Di(c[4][0].data)][0]),p=(r=c[17])!=null&&r[0]?Uy(e,e[Di(c[17][0].data)][0]):[],m=Qn(c[3][0].data),x=0;m[1].forEach(function(y){var _=Qn(y.data),E=e[Di(_[2][0].data)][0],S=Nn(E.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var w=LP(e,E);w.data.forEach(function(C,M){C.forEach(function(k,b){var U=it({r:x+M,c:b}),G=IP(k,u,p);G&&(n[U]=G)})}),x+=w.nrows})}function PP(e,t){var n=Qn(t.data),r={"!ref":"A1"},a=e[Di(n[2][0].data)],l=Nn(a[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return OP(e,a[0],r),r}function UP(e,t){var n,r=Qn(t.data),a={name:(n=r[1])!=null&&n[0]?gh(r[1][0].data):"",sheets:[]},l=tm(r[2],Di);return l.forEach(function(c){e[c].forEach(function(u){var p=Nn(u.meta[1][0].data);p==6e3&&a.sheets.push(PP(e,u))})}),a}function BP(e,t){var n=am(),r=Qn(t.data),a=tm(r[1],Di);if(a.forEach(function(l){e[l].forEach(function(c){var u=Nn(c.meta[1][0].data);if(u==2){var p=UP(e,c);p.sheets.forEach(function(m,x){im(n,m,x==0?p.name:p.name+"_"+x,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function Hd(e){var t,n,r,a,l={},c=[];if(e.FullPaths.forEach(function(p){if(p.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(p){if(p.name.match(/\.iwa$/)){var m;try{m=MP(p.content)}catch(y){return console.log("?? "+p.content.length+" "+(y.message||y))}var x;try{x=kP(m)}catch(y){return console.log("## "+(y.message||y))}x.forEach(function(y){l[y.id]=y.messages,c.push(y.id)})}}),!c.length)throw new Error("File has no messages");var u=((a=(r=(n=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Nn(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||c.forEach(function(p){l[p].forEach(function(m){var x=Nn(m.meta[1][0].data)>>>0;if(x==1)if(!u)u=m;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return BP(l,u)}function VP(e){return function(n){for(var r=0;r!=e.length;++r){var a=e[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function nm(e){VP([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function HP(e){return cl.WS.indexOf(e)>-1?"sheet":e==cl.CS?"chart":e==cl.DS?"dialog":e==cl.MS?"macro":e&&e.length?e:"sheet"}function GP(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,HP(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function zP(e,t,n,r,a,l,c,u,p,m,x,y){try{l[r]=Bo(br(e,n,!0),t);var _=yn(e,t),E;switch(u){case"sheet":E=X7(_,t,a,p,l[r],m,x,y);break;case"chart":if(E=J7(_,t,a,p,l[r],m,x,y),!E||!E["!drawel"])break;var S=Do(E["!drawel"].Target,t),w=dh(S),C=WF(br(e,S,!0),Bo(br(e,w,!0),S)),M=Do(C,S),k=dh(M);E=D7(br(e,M,!0),M,p,Bo(br(e,k,!0),M),m,E);break;case"macro":E=K7(_,t,a,p,l[r],m,x,y);break;case"dialog":E=Z7(_,t,a,p,l[r],m,x,y);break;default:throw new Error("Unrecognized sheet type "+u)}c[r]=E;var b=[];l&&l[r]&&ya(l[r]).forEach(function(U){var G="";if(l[r][U].Type==cl.CMNT){G=Do(l[r][U].Target,t);var X=nP(yn(e,G,!0),G,p);if(!X||!X.length)return;Sy(E,X,!1)}l[r][U].Type==cl.TCMNT&&(G=Do(l[r][U].Target,t),b=b.concat(JF(yn(e,G,!0),p)))}),b&&b.length&&Sy(E,b,!0,p.people||[])}catch(U){if(p.WTF)throw U}}function Ur(e){return e.charAt(0)=="/"?e.slice(1):e}function jP(e,t){if(nT(),t=t||{},nm(t),Hr(e,"META-INF/manifest.xml")||Hr(e,"objectdata.xml"))return Ly(e,t);if(Hr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hd<"u"){if(e.FileIndex)return Hd(e);var n=At.utils.cfb_new();return Jv(e).forEach(function(Fe){qD(n,Fe,jD(e,Fe))}),Hd(n)}throw new Error("Unsupported NUMBERS file")}if(!Hr(e,"[Content_Types].xml"))throw Hr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Hr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Jv(e),a=V6(br(e,"[Content_Types].xml")),l=!1,c,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",yn(e,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!yn(e,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),l=!0}a.workbooks[0].slice(-3)=="bin"&&(l=!0);var p={},m={};if(!t.bookSheets&&!t.bookProps){if(Go=[],a.sst)try{Go=tP(yn(e,Ur(a.sst)),a.sst,t)}catch(Fe){if(t.WTF)throw Fe}t.cellStyles&&a.themes.length&&(p=eP(br(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(m=Q7(yn(e,Ur(a.style)),a.style,p,t))}a.links.map(function(Fe){try{var we=Bo(br(e,dh(Ur(Fe))),Fe);return aP(yn(e,Ur(Fe)),we,Fe,t)}catch{}});var x=W7(yn(e,Ur(a.workbooks[0])),a.workbooks[0],t),y={},_="";a.coreprops.length&&(_=yn(e,Ur(a.coreprops[0]),!0),_&&(y=RT(_)),a.extprops.length!==0&&(_=yn(e,Ur(a.extprops[0]),!0),_&&q6(_,y,t)));var E={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(_=br(e,Ur(a.custprops[0]),!0),_&&(E=Y6(_,t)));var S={};if((t.bookSheets||t.bookProps)&&(x.Sheets?c=x.Sheets.map(function(we){return we.name}):y.Worksheets&&y.SheetNames.length>0&&(c=y.SheetNames),t.bookProps&&(S.Props=y,S.Custprops=E),t.bookSheets&&typeof c<"u"&&(S.SheetNames=c),t.bookSheets?S.SheetNames:t.bookProps))return S;c={};var w={};t.bookDeps&&a.calcchain&&(w=rP(yn(e,Ur(a.calcchain)),a.calcchain));var C=0,M={},k,b;{var U=x.Sheets;y.Worksheets=U.length,y.SheetNames=[];for(var G=0;G!=U.length;++G)y.SheetNames[G]=U[G].name}var X=l?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),W=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Hr(e,W)||(W="xl/_rels/workbook."+X+".rels");var O=Bo(br(e,W,!0),W.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=iP(yn(e,Ur(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=KF(yn(e,Ur(a.people[0])),t)),O&&(O=GP(O,x.Sheets));var te=yn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=y.Worksheets;++C){var ne="sheet";if(O&&O[C]?(k="xl/"+O[C][1].replace(/[\/]?xl\//,""),Hr(e,k)||(k=O[C][1]),Hr(e,k)||(k=W.replace(/_rels\/.*$/,"")+O[C][1]),ne=O[C][2]):(k="xl/worksheets/sheet"+(C+1-te)+"."+X,k=k.replace(/sheet0\./,"sheet.")),b=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(C!=t.sheets)continue e;break;case"string":if(y.SheetNames[C].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var ee=!1,Se=0;Se!=t.sheets.length;++Se)typeof t.sheets[Se]=="number"&&t.sheets[Se]==C&&(ee=1),typeof t.sheets[Se]=="string"&&t.sheets[Se].toLowerCase()==y.SheetNames[C].toLowerCase()&&(ee=1);if(!ee)continue e}}zP(e,k,b,y.SheetNames[C],C,M,c,ne,t,x,p,m)}return S={Directory:a,Workbook:x,Props:y,Custprops:E,Deps:w,Sheets:c,SheetNames:y.SheetNames,Strings:Go,Styles:m,Themes:p,SSF:qn(lt)},t&&t.bookFiles&&(e.files?(S.keys=r,S.files=e.files):(S.keys=[],S.files={},e.FullPaths.forEach(function(Fe,we){Fe=Fe.replace(/^Root Entry[\/]/,""),S.keys.push(Fe),S.files[Fe]=e.FileIndex[we]}))),t&&t.bookVBA&&(a.vba.length>0?S.vbaraw=yn(e,Ur(a.vba[0]),!0):a.defaults&&a.defaults.bin===tL&&(S.vbaraw=yn(e,"xl/vbaProject.bin",!0))),S}function qP(e,t){var n=t||{},r="Workbook",a=At.find(e,r);try{if(r="/!DataSpaces/Version",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(P8(a.content),r="/!DataSpaces/DataSpaceMap",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=B8(a.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=V8(a.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);G8(a.content)}catch{}if(r="/EncryptionInfo",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var u=z8(a.content);if(r="/EncryptedPackage",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,n.password||"",n);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function rm(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=kr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function $P(e,t){return At.find(e,"EncryptedPackage")?qP(e,t):p_(e,t)}function YP(e,t){var n,r=e,a=t||{};return a.type||(a.type=St&&Buffer.isBuffer(e)?"buffer":"base64"),n=oT(r,a),jP(n,a)}function y_(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return ph(e.slice(n),t);default:break e}return tc.to_workbook(e,t)}function WP(e,t){var n="",r=rm(e,t);switch(t.type){case"base64":n=kr(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=hs(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Jt(n)),t.type="binary",y_(n,t)}function XP(e,t){var n=e;return t.type=="base64"&&(n=kr(n)),n=Ko.utils.decode(1200,n.slice(2),"str"),t.type="binary",y_(n,t)}function JP(e){return e.match(/[^\x00-\x7F]/)?Io(e):e}function Gd(e,t,n,r){return r?(n.type="string",tc.to_workbook(e,n)):tc.to_workbook(t,n)}function yh(e,t){j2();var n=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return yh(new Uint8Array(e),(n=qn(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],l=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),ml={},n.dateNF&&(ml.dateNF=n.dateNF),n.type||(n.type=St&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=St?"buffer":"binary",r=PD(e),typeof Uint8Array<"u"&&!St&&(n.type="array")),n.type=="string"&&(l=!0,n.type="binary",n.codepage=65001,r=JP(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return n=qn(n),n.type="array",yh(Lh(r),n)}switch((a=rm(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return $P(At.read(r,n),n);break;case 9:if(a[1]<=8)return p_(r,n);break;case 60:return ph(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return w8(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return E8.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?YP(r,n):Gd(e,r,n,l);case 239:return a[3]===60?ph(r,n):Gd(e,r,n,l);case 255:if(a[1]===254)return XP(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return Ho.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Ho.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return Ey.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return tF.to_workbook(r,n);break;case 10:case 13:case 32:return WP(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return T8.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Ey.to_workbook(r,n):Gd(e,r,n,l)}function KP(e,t,n,r,a,l,c,u){var p=$n(n),m=u.defval,x=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),y=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:!1})}catch{_.__rowNum__=n}else _.__rowNum__=n;if(!c||e[n])for(var E=t.s.c;E<=t.e.c;++E){var S=c?e[n][E]:e[r[E]+p];if(S===void 0||S.t===void 0){if(m===void 0)continue;l[E]!=null&&(_[l[E]]=m);continue}var w=S.v;switch(S.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(l[E]!=null){if(w==null)if(S.t=="e"&&w===null)_[l[E]]=null;else if(m!==void 0)_[l[E]]=m;else if(x&&w===null)_[l[E]]=null;else continue;else _[l[E]]=x&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?w:Wa(S,w,u);w!=null&&(y=!1)}}return{row:_,isempty:y}}function Th(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,l=[],c=0,u="",p={s:{r:0,c:0},e:{r:0,c:0}},m=t||{},x=m.range!=null?m.range:e["!ref"];switch(m.header===1?r=1:m.header==="A"?r=2:Array.isArray(m.header)?r=3:m.header==null&&(r=0),typeof x){case"string":p=un(x);break;case"number":p=un(e["!ref"]),p.s.r=x;break;default:p=x}r>0&&(a=0);var y=$n(p.s.r),_=[],E=[],S=0,w=0,C=Array.isArray(e),M=p.s.r,k=0,b={};C&&!e[M]&&(e[M]=[]);var U=m.skipHidden&&e["!cols"]||[],G=m.skipHidden&&e["!rows"]||[];for(k=p.s.c;k<=p.e.c;++k)if(!(U[k]||{}).hidden)switch(_[k]=kn(k),n=C?e[M][k]:e[_[k]+y],r){case 1:l[k]=k-p.s.c;break;case 2:l[k]=_[k];break;case 3:l[k]=m.header[k-p.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),u=c=Wa(n,null,m),w=b[c]||0,!w)b[c]=1;else{do u=c+"_"+w++;while(b[u]);b[c]=w,b[u]=1}l[k]=u}for(M=p.s.r+a;M<=p.e.r;++M)if(!(G[M]||{}).hidden){var X=KP(e,p,M,_,r,l,C,m);(X.isempty===!1||(r===1?m.blankrows!==!1:m.blankrows))&&(E[S++]=X.row)}return E.length=S,E}var By=/"/g;function ZP(e,t,n,r,a,l,c,u){for(var p=!0,m=[],x="",y=$n(n),_=t.s.c;_<=t.e.c;++_)if(r[_]){var E=u.dense?(e[n]||[])[_]:e[r[_]+y];if(E==null)x="";else if(E.v!=null){p=!1,x=""+(u.rawNumbers&&E.t=="n"?E.v:Wa(E,null,u));for(var S=0,w=0;S!==x.length;++S)if((w=x.charCodeAt(S))===a||w===l||w===34||u.forceQuotes){x='"'+x.replace(By,'""')+'"';break}x=="ID"&&(x='"ID"')}else E.f!=null&&!E.F?(p=!1,x="="+E.f,x.indexOf(",")>=0&&(x='"'+x.replace(By,'""')+'"')):x="";m.push(x)}return u.blankrows===!1&&p?null:m.join(c)}function T_(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var a=un(e["!ref"]),l=r.FS!==void 0?r.FS:",",c=l.charCodeAt(0),u=r.RS!==void 0?r.RS:`
`,p=u.charCodeAt(0),m=new RegExp((l=="|"?"\\|":l)+"+$"),x="",y=[];r.dense=Array.isArray(e);for(var _=r.skipHidden&&e["!cols"]||[],E=r.skipHidden&&e["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(y[S]=kn(S));for(var w=0,C=a.s.r;C<=a.e.r;++C)(E[C]||{}).hidden||(x=ZP(e,a,C,y,c,p,l,r),x!=null&&(r.strip&&(x=x.replace(m,"")),(x||r.blankrows!==!1)&&n.push((w++?u:"")+x)));return delete r.dense,n.join("")}function QP(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=T_(e,t);return n}function e9(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var a=un(e["!ref"]),l="",c=[],u,p=[],m=Array.isArray(e);for(u=a.s.c;u<=a.e.c;++u)c[u]=kn(u);for(var x=a.s.r;x<=a.e.r;++x)for(l=$n(x),u=a.s.c;u<=a.e.c;++u)if(t=c[u]+l,n=m?(e[x]||[])[u]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}p[p.length]=t+"="+r}return p}function __(e,t,n){var r=n||{},a=+!r.skipHeader,l=e||{},c=0,u=0;if(l&&r.origin!=null)if(typeof r.origin=="number")c=r.origin;else{var p=typeof r.origin=="string"?or(r.origin):r.origin;c=p.r,u=p.c}var m,x={s:{c:0,r:0},e:{c:u,r:c+t.length-1+a}};if(l["!ref"]){var y=un(l["!ref"]);x.e.c=Math.max(x.e.c,y.e.c),x.e.r=Math.max(x.e.r,y.e.r),c==-1&&(c=y.e.r+1,x.e.r=c+t.length-1+a)}else c==-1&&(c=0,x.e.r=t.length-1+a);var _=r.header||[],E=0;t.forEach(function(w,C){ya(w).forEach(function(M){(E=_.indexOf(M))==-1&&(_[E=_.length]=M);var k=w[M],b="z",U="",G=it({c:u+E,r:c+C+a});m=ic(l,G),k&&typeof k=="object"&&!(k instanceof Date)?l[G]=k:(typeof k=="number"?b="n":typeof k=="boolean"?b="b":typeof k=="string"?b="s":k instanceof Date?(b="d",r.cellDates||(b="n",k=fr(k)),U=r.dateNF||lt[14]):k===null&&r.nullError&&(b="e",k=0),m?(m.t=b,m.v=k,delete m.w,delete m.R,U&&(m.z=U)):l[G]=m={t:b,v:k},U&&(m.z=U))})}),x.e.c=Math.max(x.e.c,u+_.length-1);var S=$n(c);if(a)for(E=0;E<_.length;++E)l[kn(E+u)+S]={t:"s",v:_[E]};return l["!ref"]=kt(x),l}function t9(e,t){return __(null,e,t)}function ic(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=or(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ic(e,it(t)):ic(e,it({r:t,c:n||0}))}function n9(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function am(){return{SheetNames:[],Sheets:{}}}function im(e,t,n,r){var a=1;if(!n)for(;a<=65535&&e.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var l=n.match(/(^.*?)(\d+)$/);a=l&&+l[2]||0;var c=l&&l[1]||n;for(++a;a<=65535&&e.SheetNames.indexOf(n=c+a)!=-1;++a);}if(V7(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function r9(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=n9(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function a9(e,t){return e.z=t,e}function E_(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function i9(e,t,n){return E_(e,"#"+t,n)}function s9(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function l9(e,t,n,r){for(var a=typeof t!="string"?t:un(t),l=typeof t=="string"?t:kt(t),c=a.s.r;c<=a.e.r;++c)for(var u=a.s.c;u<=a.e.c;++u){var p=ic(e,c,u);p.t="n",p.F=l,delete p.v,c==a.s.r&&u==a.s.c&&(p.f=n,r&&(p.D=!0))}return e}var o9={encode_col:kn,encode_row:$n,encode_cell:it,encode_range:kt,decode_col:jh,decode_row:zh,split_cell:y6,decode_cell:or,decode_range:bl,format_cell:Wa,sheet_add_aoa:AT,sheet_add_json:__,sheet_add_dom:x_,aoa_to_sheet:kl,json_to_sheet:t9,table_to_sheet:g_,table_to_book:wP,sheet_to_csv:T_,sheet_to_txt:QP,sheet_to_json:Th,sheet_to_html:SP,sheet_to_formulae:e9,sheet_to_row_object_array:Th,sheet_get_cell:ic,book_new:am,book_append_sheet:im,book_set_sheet_visibility:r9,cell_set_number_format:a9,cell_set_hyperlink:E_,cell_set_internal_link:i9,cell_add_comment:s9,sheet_set_array_formula:l9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const S_=({matrixData:e,onUpdate:t})=>{const n=(p,m)=>t({...e,headers:e.headers.map((x,y)=>y===p?m:x)}),r=(p,m,x)=>t({...e,rows:e.rows.map((y,_)=>_===p?y.map((E,S)=>S===m?x:E):y)}),a=()=>t({...e,rows:[...e.rows,Array(e.headers.length).fill("")]}),l=p=>t({...e,rows:e.rows.filter((m,x)=>x!==p)}),c=()=>{const p=` ${e.headers.length+1}`;t({headers:[...e.headers,p],rows:e.rows.map(m=>[...m,""])})},u=p=>{e.headers.length<=1||t({headers:e.headers.filter((m,x)=>x!==p),rows:e.rows.map(m=>m.filter((x,y)=>y!==p))})};return g.jsxs("div",{className:"overflow-x-auto p-1 bg-slate-50 rounded-md border",children:[g.jsxs("table",{className:"w-full text-xs border-collapse",children:[g.jsx("thead",{children:g.jsxs("tr",{className:"bg-slate-200",children:[e.headers.map((p,m)=>g.jsx("th",{className:"border border-slate-300 p-0 font-semibold text-slate-700",children:g.jsxs("div",{className:"flex items-center justify-between gap-1 px-1",children:[g.jsx("input",{type:"text",value:p,onChange:x=>n(m,x.target.value),className:"w-full bg-transparent outline-none text-center font-semibold text-slate-800"}),g.jsx("button",{onClick:()=>u(m),className:"text-red-500 hover:text-red-700 opacity-30 hover:opacity-100",title:"",children:g.jsx(Ya,{className:"w-3 h-3"})})]})},m)),g.jsx("th",{className:"border border-slate-300 p-1 w-10"})]})}),g.jsx("tbody",{children:e.rows.map((p,m)=>g.jsxs("tr",{children:[p.map((x,y)=>g.jsx("td",{className:"border border-slate-300 p-0",children:g.jsx("input",{type:"text",value:x,onChange:_=>r(m,y,_.target.value),className:"w-full bg-white text-slate-900 outline-none p-1 focus:bg-blue-50"})},y)),g.jsx("td",{className:"border border-slate-300 p-1 text-center",children:g.jsx("button",{onClick:()=>l(m),className:"text-red-500 hover:text-red-700",title:"",children:g.jsx(Ya,{className:"w-3 h-3"})})})]},m))})]}),g.jsxs("div",{className:"flex gap-2 mt-2",children:[g.jsxs("button",{onClick:a,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[g.jsx(ju,{className:"w-3 h-3"}),""]}),g.jsxs("button",{onClick:c,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[g.jsx(ju,{className:"w-3 h-3"}),""]})]})]})},Vy=e=>{const t=Math.cos(2*Math.PI*e),n=Math.sin(2*Math.PI*e);return[t,n]},c9=({data:e,title:t})=>{const n=e.reduce((c,u)=>c+u.value,0);if(n===0)return g.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"});let r=0;const a=["#4A90E2","#50E3C2","#F5A623","#F8E71C","#7ED321","#9013FE","#BD10E0","#4A4A4A"],l=e.map((c,u)=>{const p=c.value/n,[m,x]=Vy(r);r+=p;const[y,_]=Vy(r),E=p>.5?1:0;return{path:`M ${m} ${x} A 1 1 0 ${E} 1 ${y} ${_} L 0 0`,color:a[u%a.length],label:c.label,value:c.value}});return g.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-white p-2 border rounded-md",children:[g.jsx("h5",{className:"font-bold text-sm mb-2",children:t}),g.jsx("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-32 h-32 mb-2",children:l.map((c,u)=>g.jsx("path",{d:c.path,fill:c.color},u))}),g.jsx("div",{className:"text-[10px] space-y-0.5 w-full",children:l.map((c,u)=>g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:c.color}}),g.jsx("span",{children:c.label})]}),g.jsxs("span",{children:[c.value," (",(c.value/n*100).toFixed(1),"%)"]})]},u))})]})},u9=({data:e,title:t})=>{if(e.length<2)return g.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"Need at least 2 data points for a line chart."});const n=Math.max(...e.map(r=>r.value),0);return g.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[g.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:t}),g.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-40",children:[[0,.25,.5,.75,1].map(r=>g.jsx("line",{x1:"0",y1:50-r*45,x2:"100",y2:50-r*45,stroke:"#f0f0f0",strokeWidth:"0.5"},r)),g.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1",points:e.map((r,a)=>`${a/(e.length-1)*100},${50-r.value/n*45}`).join(" ")}),e.map((r,a)=>g.jsx("circle",{cx:`${a/(e.length-1)*100}`,cy:`${50-r.value/n*45}`,r:"1.5",fill:"#4a90e2"},a))]})]})},f9=({data:e,title:t})=>{const n=Math.max(...e.map(r=>r.value),0);return n===0?g.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"}):g.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[g.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:t}),g.jsx("div",{className:"space-y-1",children:e.map(r=>g.jsxs("div",{className:"flex items-center text-xs",children:[g.jsx("div",{className:"w-24 truncate pr-2 text-right text-slate-600",children:r.label}),g.jsx("div",{className:"flex-grow bg-slate-200 rounded-full h-4",children:g.jsx("div",{className:"bg-blue-500 h-4 rounded-full text-white text-right pr-1",style:{width:`${r.value/n*100}%`},children:g.jsx("span",{className:"text-[10px]",children:r.value})})})]},r.label))})]})},d9=({actionItem:e,onSave:t,onClose:n,generateUniqueId:r})=>{var M;const[a,l]=xe.useState(e.report||{notes:"",attachments:[],matrixData:null}),[c,u]=xe.useState("bar"),p=xe.useRef(null),m=xe.useRef(null),x=k=>{l(b=>({...b,...k}))},y=()=>{t({...e,report:a})},_=k=>{var F;const b=(F=k.target.files)==null?void 0:F[0];if(!b)return;const U=5,G=U*1024*1024;if(b.size>G){alert(`${U}MB`),k.target&&(k.target.value="");return}const X=new FileReader;X.onload=W=>{var O;if(typeof((O=W.target)==null?void 0:O.result)=="string"){const te={id:r("attach"),name:b.name,type:b.type,dataUrl:W.target.result};x({attachments:[...a.attachments||[],te]})}else alert("")},X.onerror=()=>{alert("")},X.readAsDataURL(b),k.target&&(k.target.value="")},E=k=>{var b;x({attachments:(b=a.attachments)==null?void 0:b.filter(U=>U.id!==k)})},S=k=>{var G;const b=(G=k.target.files)==null?void 0:G[0];if(!b)return;const U=new FileReader;U.onload=X=>{var F;try{const W=(F=X.target)==null?void 0:F.result,O=yh(W,{type:"array"}),te=O.SheetNames[0],ne=O.Sheets[te],ee=o9.sheet_to_json(ne,{header:1});if(!Array.isArray(ee)||ee.length===0){alert("Excel"),k.target&&(k.target.value="");return}const Se=ee[0];if(!Array.isArray(Se)){alert("Excel"),k.target&&(k.target.value="");return}const Fe=Se.map(String),we=ee.slice(1),ae=[];for(const me of we)if(Array.isArray(me)){const re=Array(Fe.length).fill("");for(let q=0;q<Fe.length;q++)re[q]=me[q]!==null&&me[q]!==void 0?String(me[q]):"";ae.push(re)}x({matrixData:{headers:Fe,rows:ae}})}catch(W){console.error("Error parsing Excel file:",W),alert(`Excel: ${W instanceof Error?W.message:"Unknown error"}`)}finally{k.target&&(k.target.value="")}},U.readAsArrayBuffer(b)},w=(((M=a.matrixData)==null?void 0:M.rows)||[]).map(k=>({label:k[0],value:parseFloat(k[1])||0})).filter(k=>k.label&&!isNaN(k.value)),C=()=>{if(!a.matrixData||w.length===0)return null;switch(c){case"line":return g.jsx(u9,{data:w,title:""});case"pie":return g.jsx(c9,{data:w,title:""});case"bar":default:return g.jsx(f9,{data:w,title:""})}};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[70]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsx("p",{className:"text-sm text-slate-500",children:e.text})]}),g.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:g.jsx(sa,{className:"w-6 h-6 text-slate-500"})})]}),g.jsxs("div",{className:"flex-grow p-5 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-semibold text-slate-700",children:""}),g.jsx("textarea",{value:a.notes,onChange:k=>x({notes:k.target.value}),className:"w-full mt-1 p-2 border rounded-md h-32 bg-slate-50 focus:bg-white text-slate-800",placeholder:"..."})]}),g.jsxs("div",{children:[g.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center mb-2",children:["",g.jsx("button",{onClick:()=>{var k;return(k=p.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",children:g.jsx(Mi,{className:"w-5 h-5"})}),g.jsx("input",{type:"file",ref:p,onChange:_,className:"hidden",multiple:!1})]}),g.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto border p-2 rounded-md bg-slate-50",children:(a.attachments||[]).map(k=>g.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-24",children:[g.jsx("a",{href:k.dataUrl,download:k.name,className:"block w-full h-full","aria-label":`Download ${k.name}`,children:k.type.startsWith("image/")?g.jsx("img",{src:k.dataUrl,alt:k.name,className:"w-full h-full object-cover"}):g.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-2 hover:bg-slate-200",children:g.jsx(Mi,{className:"w-8 h-8 text-slate-500"})})}),g.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:g.jsx("p",{className:"text-white text-[10px] truncate",title:k.name,children:k.name})}),g.jsx("button",{onClick:()=>E(k.id),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:g.jsx(Ya,{className:"w-3 h-3"})})]},k.id))})]})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center",children:["",g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:()=>{var k;return(k=m.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",title:"Excel",children:g.jsx(A2,{className:"w-5 h-5 text-green-600"})}),g.jsx("input",{type:"file",ref:m,onChange:S,className:"hidden",accept:".xlsx, .xls, .csv"}),a.matrixData&&w.length>0&&g.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-200 p-0.5",children:[g.jsx("button",{onClick:()=>u("bar"),className:`px-2 py-0.5 rounded-full text-xs ${c==="bar"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Bar"}),g.jsx("button",{onClick:()=>u("line"),className:`px-2 py-0.5 rounded-full text-xs ${c==="line"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Line"}),g.jsx("button",{onClick:()=>u("pie"),className:`px-2 py-0.5 rounded-full text-xs ${c==="pie"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Pie"})]}),g.jsx("button",{onClick:()=>x({matrixData:a.matrixData?null:{headers:["",""],rows:[["",""]]}}),className:"p-1 hover:bg-slate-200 rounded-full",title:a.matrixData?"":"",children:a.matrixData?g.jsx(Ya,{className:"w-5 h-5 text-red-500"}):g.jsx(Yo,{className:"w-5 h-5"})})]})]}),a.matrixData?g.jsx(S_,{matrixData:a.matrixData,onUpdate:k=>x({matrixData:k})}):null,g.jsx("div",{className:"mt-4",children:C()})]})]}),g.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[g.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),g.jsx("button",{onClick:y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})},zd=({value:e,onChange:t,placeholder:n})=>g.jsx("textarea",{value:e,onChange:r=>t(r.target.value),placeholder:n,rows:3,className:"w-full h-full text-sm bg-transparent outline-none p-2 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-blue-50 resize-none text-slate-800 placeholder-slate-400"}),h9=({isOpen:e,onClose:t,onSave:n,task:r,generateUniqueId:a})=>{var F;const[l,c]=xe.useState([]),[u,p]=xe.useState(!1),[m,x]=xe.useState(null),[y,_]=xe.useState({key:"status",direction:"ascending"});xe.useEffect(()=>{var W;e&&c(((W=r.extendedDetails)==null?void 0:W.decisions)||[])},[e,(F=r.extendedDetails)==null?void 0:F.decisions]);const E=xe.useMemo(()=>{let W=[...l];return y!==null&&W.sort((O,te)=>{let ne="",ee="";switch(y.key){case"status":ne=O.status==="undecided"?0:1,ee=te.status==="undecided"?0:1;break;case"date":ne=O.date||"9999-12-31",ee=te.date||"9999-12-31";break;default:ne=(O[y.key]||"").toLowerCase(),ee=(te[y.key]||"").toLowerCase()}return ne<ee?y.direction==="ascending"?-1:1:ne>ee?y.direction==="ascending"?1:-1:0}),W},[l,y]),S=W=>{let O="ascending";y&&y.key===W&&y.direction==="ascending"&&(O="descending"),_({key:W,direction:O})},w=W=>!y||y.key!==W?g.jsx(fs,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):y.direction==="ascending"?g.jsx(Xo,{className:"w-3 h-3 ml-1 text-blue-600"}):g.jsx(fs,{className:"w-3 h-3 ml-1 text-blue-600"}),C=({sortKey:W,label:O,className:te})=>g.jsx("th",{className:`p-0 border border-slate-300 ${te||""}`,children:g.jsxs("button",{onClick:()=>S(W),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[g.jsx("span",{children:O}),w(W)]})}),M=async()=>{p(!0),x(null);try{const O=(await RM(r,l)).map(te=>te.id==="NEW"?{...te,id:a("dec_ai")}:te);c(O)}catch(W){x(W instanceof Error?W.message:"")}finally{p(!1)}},k=(W,O)=>{c(te=>te.map(ne=>ne.id===W?{...ne,...O}:ne))},b=(W,O)=>{const te=l.find(ee=>ee.id===W);if(!te)return;const ne={status:O};O==="decided"&&!te.date?ne.date=new Date().toISOString().split("T")[0]:O==="undecided"&&(ne.date=void 0),k(W,ne)},U=W=>{c(O=>O.filter(te=>te.id!==W))},G=()=>{const W={id:a("dec_manual"),question:"",status:"undecided"};c(O=>[W,...O])},X=()=>{n(l)};return e?g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[50]",children:g.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[g.jsxs("button",{onClick:M,disabled:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[u?g.jsx(na,{size:"sm",color:"border-white"}):g.jsx(lc,{className:"w-5 h-5"}),g.jsx("span",{children:"AI"})]}),g.jsxs("button",{onClick:G,disabled:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300 disabled:bg-slate-400",children:[g.jsx(kh,{className:"w-5 h-5"}),g.jsx("span",{children:""})]}),g.jsx("button",{onClick:t,className:"p-1.5 rounded-full hover:bg-slate-100",children:g.jsx(sa,{className:"w-6 h-6 text-slate-500"})})]})]}),m&&g.jsx("div",{className:"p-4",children:g.jsx(oc,{message:m})}),g.jsx("main",{className:"flex-grow p-4 overflow-auto",children:g.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[g.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:g.jsxs("tr",{children:[g.jsx(C,{sortKey:"status",label:"",className:"w-32"}),g.jsx(C,{sortKey:"question",label:" (Question)",className:"w-[25%]"}),g.jsx(C,{sortKey:"decision",label:" (Decision)",className:"w-[25%]"}),g.jsx(C,{sortKey:"reasoning",label:"/",className:"w-[25%]"}),g.jsx(C,{sortKey:"date",label:"",className:"w-36"}),g.jsx("th",{className:"p-2 border border-slate-300 w-16",children:""})]})}),g.jsxs("tbody",{children:[E.map(W=>g.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[g.jsx("td",{className:"border border-slate-300 align-top p-2",children:g.jsxs("select",{value:W.status,onChange:O=>b(W.id,O.target.value),className:`w-full p-2 rounded-md font-semibold text-xs border ${W.status==="decided"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:[g.jsx("option",{value:"undecided",children:""}),g.jsx("option",{value:"decided",children:""})]})}),g.jsx("td",{className:"border border-slate-300",children:g.jsx(zd,{value:W.question||"",onChange:O=>k(W.id,{question:O}),placeholder:""})}),g.jsx("td",{className:"border border-slate-300",children:g.jsx(zd,{value:W.decision||"",onChange:O=>k(W.id,{decision:O}),placeholder:"..."})}),g.jsx("td",{className:"border border-slate-300",children:g.jsx(zd,{value:W.reasoning||"",onChange:O=>k(W.id,{reasoning:O}),placeholder:"..."})}),g.jsx("td",{className:"border border-slate-300 align-top p-2",children:g.jsx("input",{type:"date",value:W.date||"",onChange:O=>k(W.id,{date:O.target.value}),className:"w-full bg-transparent border-b border-dotted border-slate-400 outline-none p-1 text-xs text-slate-600 focus:border-solid focus:border-blue-500 disabled:border-none disabled:bg-slate-100",disabled:W.status==="undecided"})}),g.jsx("td",{className:"border border-slate-300 text-center align-middle",children:g.jsx("button",{onClick:()=>U(W.id),className:"text-red-400 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",title:"",children:g.jsx(Ya,{className:"w-5 h-5"})})})]},W.id)),l.length===0&&g.jsx("tr",{children:g.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-500 bg-white border border-slate-300",children:"AI"})})]})]})}),g.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:[g.jsx("button",{onClick:t,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:""}),g.jsx("button",{onClick:X,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})}):null},m9=({actionItems:e,subStepName:t,taskName:n,onClose:r})=>{const[a,l]=xe.useState(null),c=xe.useMemo(()=>{let x=[...e];return a!==null&&x.sort((y,_)=>{let E="",S="";switch(a.key){case"status":E=y.completed,S=_.completed;break;case"dueDate":E=y.dueDate||"9999-12-31",S=_.dueDate||"9999-12-31";break;case"completedDate":E=y.completedDate||"9999-12-31",S=_.completedDate||"9999-12-31";break;case"text":case"responsible":E=(y[a.key]||"").toLowerCase(),S=(_[a.key]||"").toLowerCase();break}return E<S?a.direction==="ascending"?-1:1:E>S?a.direction==="ascending"?1:-1:0}),x},[e,a]),u=x=>{let y="ascending";a&&a.key===x&&a.direction==="ascending"&&(y="descending"),l({key:x,direction:y})},p=x=>!a||a.key!==x?g.jsx(fs,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):a.direction==="ascending"?g.jsx(Xo,{className:"w-3 h-3 ml-1 text-blue-600"}):g.jsx(fs,{className:"w-3 h-3 ml-1 text-blue-600"}),m=({sortKey:x,label:y,className:_})=>g.jsx("th",{scope:"col",className:`p-0 ${_||""}`,children:g.jsxs("button",{onClick:()=>u(x),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[g.jsx("span",{children:y}),p(x)]})});return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:g.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsxs("p",{className:"text-sm text-slate-500",children:[": ",n," / : ",t]})]}),g.jsx("button",{onClick:r,className:"p-1.5 rounded-full hover:bg-slate-100",children:g.jsx(sa,{className:"w-6 h-6 text-slate-500"})})]}),g.jsx("main",{className:"flex-grow p-4 overflow-auto",children:g.jsxs("table",{className:"w-full border-collapse text-sm",children:[g.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:g.jsxs("tr",{children:[g.jsx(m,{sortKey:"status",label:"",className:"w-28 border border-slate-300"}),g.jsx(m,{sortKey:"text",label:"",className:"w-2/5 border border-slate-300"}),g.jsx(m,{sortKey:"responsible",label:"",className:"w-40 border border-slate-300"}),g.jsx(m,{sortKey:"dueDate",label:"",className:"w-40 border border-slate-300"}),g.jsx(m,{sortKey:"completedDate",label:"",className:"w-40 border border-slate-300"})]})}),g.jsxs("tbody",{className:"bg-white",children:[c.map(x=>{var y;return g.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[g.jsx("td",{className:"p-2 border border-slate-300 align-top text-center",children:x.completed?g.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[g.jsx(df,{className:"w-4 h-4 mr-1"}),""]}):g.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[g.jsx(hf,{className:"w-4 h-4 mr-1"}),""]})}),g.jsxs("td",{className:"p-2 border border-slate-300 align-top font-medium text-slate-800",children:[x.text,x.report&&Array.isArray(x.report.attachments)&&x.report.attachments.length>0&&g.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200 space-y-1",children:x.report.attachments.map(_=>g.jsxs("a",{href:_.dataUrl,target:"_blank",rel:"noopener noreferrer",download:_.name,className:"flex items-center gap-1.5 text-xs text-blue-600 hover:underline",children:[g.jsx(Mi,{className:"w-3.5 h-3.5"}),g.jsx("span",{children:_.name})]},_.id))}),((y=x.report)==null?void 0:y.notes)&&g.jsx("p",{className:"text-xs text-slate-500 mt-1 pt-1 border-t border-slate-200 whitespace-pre-wrap",children:x.report.notes})]}),g.jsx("td",{className:"p-2 border border-slate-300 align-top",children:x.responsible||""}),g.jsx("td",{className:"p-2 border border-slate-300 align-top",children:x.dueDate||""}),g.jsx("td",{className:"p-2 border border-slate-300 align-top",children:x.completedDate||""})]},x.id)}),e.length===0&&g.jsx("tr",{children:g.jsx("td",{colSpan:5,className:"text-center py-10 text-slate-500",children:""})})]})]})}),g.jsx("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:g.jsx("button",{onClick:r,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})})]})})},p9=({task:e,isOpen:t,onClose:n,onReportGenerated:r})=>{const[a,l]=xe.useState(""),[c,u]=xe.useState(new Set),[p,m]=xe.useState(!1),[x,y]=xe.useState(null),_=xe.useMemo(()=>{var b,U,G,X;const k=[];return k.push({id:`task-data-${e.id}`,name:`: ${e.title}`,type:"Task Data",source:{name:`: ${e.title}`,type:"json",content:e}}),(U=(b=e.extendedDetails)==null?void 0:b.attachments)==null||U.forEach(F=>{k.push({id:F.id,name:`: ${F.name}`,type:"Attachment",source:{name:F.name,type:F.type.startsWith("image/")?"image":"text",content:F.dataUrl}})}),(X=(G=e.extendedDetails)==null?void 0:G.subSteps)==null||X.forEach(F=>{var W;(W=F.actionItems)==null||W.forEach(O=>{var te,ne,ee;(te=O.report)!=null&&te.matrixData&&k.push({id:`matrix-${O.id}`,name:`: ${O.text} (${F.text})`,type:"Data Matrix",source:{name:`: ${O.text}`,type:"json",content:O.report.matrixData}}),(ee=(ne=O.report)==null?void 0:ne.attachments)==null||ee.forEach(Se=>{k.push({id:Se.id,name:`: ${Se.name} (${O.text})`,type:"Attachment",source:{name:Se.name,type:Se.type.startsWith("image/")?"image":"text",content:Se.dataUrl}})})})}),k},[e]),E=xe.useMemo(()=>_.find(k=>k.type==="Task Data"),[_]),S=xe.useMemo(()=>_.filter(k=>k.type!=="Task Data"),[_]);xe.useEffect(()=>{if(t){const k=new Set;E&&k.add(E.id),u(k)}},[t,E]);const w=k=>{const b=_.find(U=>U.id===k);(b==null?void 0:b.type)!=="Task Data"&&u(U=>{const G=new Set(U);return G.has(k)?G.delete(k):G.add(k),G})},C=async()=>{if(!a.trim()){y("");return}if(c.size===0){y("1");return}m(!0),y(null);try{const k=_.filter(U=>c.has(U.id)).map(U=>U.source),b=await E2(k,a);r(b)}catch(k){y(k instanceof Error?k.message:"")}finally{m(!1)}};if(!t)return null;const M=k=>{switch(k){case"Task Data":return g.jsx(Wo,{className:"w-5 h-5 text-blue-600"});case"Attachment":return g.jsx(Mi,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return g.jsx(Yo,{className:"w-5 h-5 text-purple-600"});default:return g.jsx(Wo,{className:"w-5 h-5 text-slate-500"})}};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-slate-200",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:g.jsx(sa,{className:"w-6 h-6 text-slate-500"})})]}),g.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"1. "}),g.jsxs("div",{className:"mb-4",children:[g.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:":"}),g.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-slate-200",children:[g.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-4 h-4 accent-blue-600"}),E&&M(E.type),g.jsx("span",{className:"text-sm text-slate-800 font-medium truncate",title:E==null?void 0:E.name,children:E==null?void 0:E.name})]})]}),S.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:" ():"}),g.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-80 overflow-y-auto space-y-2",children:S.map(k=>g.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-slate-100 cursor-pointer",children:[g.jsx("input",{type:"checkbox",checked:c.has(k.id),onChange:()=>w(k.id),className:"w-4 h-4 accent-blue-600"}),M(k.type),g.jsx("span",{className:"text-sm text-slate-700 truncate",title:k.name,children:k.name})]},k.id))})]})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"2. "}),g.jsx("textarea",{value:a,onChange:k=>l(k.target.value),placeholder:"",rows:8,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),x&&g.jsx("div",{className:"mt-2",children:g.jsx(oc,{message:x})})]})]}),g.jsxs("footer",{className:"flex-shrink-0 p-5 bg-slate-100 border-t flex justify-end items-center gap-4",children:[g.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),g.jsxs("button",{onClick:C,disabled:p,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[p?g.jsx(na,{size:"sm",color:"border-white"}):g.jsx(lc,{className:"w-5 h-5"}),g.jsx("span",{children:p?"...":""})]})]})]})})},ha=({label:e,name:t,value:n,onChange:r,type:a="text",placeholder:l,rows:c,disabled:u=!1,icon:p,required:m=!1})=>g.jsxs("div",{className:"mb-4",children:[g.jsxs("label",{htmlFor:t,className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[p&&g.jsx("span",{className:"mr-1.5 text-slate-500 w-4 h-4",children:p}),e,m&&g.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),a==="textarea"?g.jsx("textarea",{id:t,name:t,value:n,onChange:r,rows:c||3,placeholder:l,disabled:u,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"}):g.jsx("input",{type:a,id:t,name:t,value:n,onChange:r,placeholder:l,disabled:u,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"})]}),x9=Fi.memo(({subStep:e,onRemove:t,onDragStart:n,onClick:r,cardRef:a,isSelected:l,onStartConnection:c,onEndConnection:u})=>{var x,y;const p=_=>{switch(_){case ir.COMPLETED:return"border-l-4 border-green-500";case ir.IN_PROGRESS:return"border-l-4 border-blue-500";default:return"border-l-4 border-slate-300"}},m=_=>{_.stopPropagation(),c(e.id,_)};return g.jsxs("div",{ref:a,draggable:!0,onDragStart:_=>n(_,e.id),onClick:r,onMouseUp:_=>{_.stopPropagation(),u(e.id)},className:`substep-card absolute p-2.5 rounded-lg shadow-sm cursor-grab active:cursor-grabbing bg-white border w-48 h-auto min-h-[60px] text-xs flex flex-col justify-between hover:shadow-md transition-all duration-200 ${l?"ring-2 ring-blue-500 shadow-lg":"border-slate-300"} ${p(e.status)}`,style:{left:((x=e.position)==null?void 0:x.x)||0,top:((y=e.position)==null?void 0:y.y)||0,touchAction:"none"},children:[g.jsxs("div",{className:"flex justify-between items-start text-slate-400 mb-1",children:[g.jsxs("span",{className:"font-mono text-[10px] select-none",children:["ID: ...",e.id.slice(-4)]}),g.jsx("button",{onClick:_=>{_.stopPropagation(),t()},className:"text-red-400 hover:text-red-600 p-0.5",title:"",children:g.jsx(Ya,{className:"w-3.5 h-3.5"})})]}),g.jsx("p",{className:`mb-1 break-words text-slate-800 ${e.status===ir.COMPLETED?"line-through text-slate-500":""}`,children:e.text||""}),g.jsx("div",{onMouseDown:m,className:"absolute right-[-5px] top-1/2 -translate-y-1/2 w-3 h-3 bg-blue-500 rounded-full cursor-crosshair hover:scale-125 transition-transform",title:""})]})}),g9=({task:e,onClose:t,onUpdateTaskCoreInfo:n,onUpdateExtendedDetails:r,generateUniqueId:a,projectGoal:l,targetDate:c})=>{var ba,D,V,L,P,B,z,fe,_e,oe,pe,ve,Re,Oe;if(!e)return null;const[u,p]=xe.useState(e),[m,x]=xe.useState(e),[y,_]=xe.useState("none"),[E,S]=xe.useState(!1),[w,C]=xe.useState(!1),[M,k]=xe.useState(!1),[b,U]=xe.useState(!1),[G,X]=xe.useState(!1),[F,W]=xe.useState(null),[O,te]=xe.useState(!1),[ne,ee]=xe.useState([]),[Se,Fe]=xe.useState([]),[we,ae]=xe.useState(!1),[me,re]=xe.useState(null),[q,N]=xe.useState([]),j=xe.useRef(null),[R,J]=xe.useState(new Map),Y=xe.useRef(null),H=xe.useRef({x:0,y:0}),[se,Ee]=xe.useState(null),ke=xe.useRef(null),De=xe.useRef(null),[Ce,Je]=xe.useState(null),[K,pt]=xe.useState({x:0,y:0}),[Ke,ft]=xe.useState([]),Me=xe.useMemo(()=>JSON.stringify(m)!==JSON.stringify(u),[m,u]),Te=xe.useMemo(()=>{var ce;const Z=((ce=u.extendedDetails)==null?void 0:ce.decisions)||[];return{decided:Z.filter(de=>de.status==="decided").length,undecided:Z.filter(de=>de.status==="undecided").length}},[(ba=u.extendedDetails)==null?void 0:ba.decisions]),He=({items:Z,onToggle:ce,onAdd:de,onUpdate:Ie,onRemove:Ge,onOpenReport:$e})=>g.jsxs("div",{className:"space-y-2 mt-2",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("h6",{className:"text-sm font-semibold text-slate-600",children:""}),g.jsx("button",{onClick:()=>te(!0),className:"p-1 rounded-full hover:bg-slate-200",title:"",children:g.jsx(Yo,{className:"w-5 h-5 text-slate-500"})})]}),g.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2",children:Z.map(Ve=>g.jsxs("div",{className:"group bg-slate-50 p-2 rounded-md transition-all border border-transparent hover:border-slate-200",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:()=>ce(Ve.id),className:"flex-shrink-0",children:Ve.completed?g.jsx(df,{className:"w-5 h-5 text-green-600"}):g.jsx(hf,{className:"w-5 h-5 text-slate-400"})}),g.jsx("div",{className:"flex-grow",onDoubleClick:()=>$e(Ve),children:g.jsx("input",{type:"text",value:Ve.text,onChange:gt=>Ie(Ve.id,{text:gt.target.value}),placeholder:"",className:`w-full text-sm bg-transparent outline-none p-1 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-white ${Ve.completed?"line-through text-slate-500":"text-slate-800"}`})}),g.jsx("button",{onClick:()=>Ge(Ve.id),className:"ml-2 text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:g.jsx(Ya,{className:"w-4 h-4"})})]}),g.jsxs("div",{className:"pl-7 pt-1.5 flex justify-end items-center gap-4 text-xs text-slate-500",children:[Ve.completed&&Ve.completedDate?g.jsxs("span",{className:"text-xs text-green-600 font-medium flex items-center mr-auto",children:[g.jsx(ff,{className:"w-4 h-4 mr-1"}),": ",new Date(Ve.completedDate+"T00:00:00Z").toLocaleDateString("ja-JP")]}):g.jsx("div",{className:"mr-auto"}),g.jsxs("div",{className:"flex items-center",children:[g.jsx("label",{htmlFor:`responsible-${Ve.id}`,className:"mr-1 flex items-center",title:"",children:g.jsx(wv,{className:"w-4 h-4"})}),g.jsx("input",{type:"text",id:`responsible-${Ve.id}`,value:Ve.responsible||"",onChange:gt=>Ie(Ve.id,{responsible:gt.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-24 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",placeholder:"",disabled:Ve.completed})]}),g.jsxs("div",{className:"flex items-center",children:[g.jsx("label",{htmlFor:`due-date-${Ve.id}`,className:"mr-1",children:":"}),g.jsx("input",{type:"date",id:`due-date-${Ve.id}`,value:Ve.dueDate||"",onChange:gt=>Ie(Ve.id,{dueDate:gt.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-28 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",style:{colorScheme:"light"},title:"",disabled:Ve.completed})]})]})]},Ve.id))}),g.jsxs("button",{onClick:de,className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[g.jsx(kh,{className:"w-4 h-4"}),""]})]});xe.useEffect(()=>{p(e),x(e),ee([]),Fe([])},[e]),xe.useEffect(()=>{var ce;const Z=new Map;(((ce=u.extendedDetails)==null?void 0:ce.subSteps)||[]).forEach(de=>{de&&de.id&&Z.set(de.id,R.get(de.id)||Fi.createRef())}),J(Z)},[(D=u.extendedDetails)==null?void 0:D.subSteps]);const ze=xe.useCallback(()=>{var ce;if(!j.current){ft([]);return}const Z=[];(((ce=u.extendedDetails)==null?void 0:ce.subSteps)||[]).forEach(de=>{var Ie,Ge;if((Ie=de==null?void 0:de.nextSubStepIds)!=null&&Ie.length){const $e=(Ge=R.get(de.id))==null?void 0:Ge.current;if($e&&de.position){const Ve={x:de.position.x+$e.offsetWidth,y:de.position.y+$e.offsetHeight/2};de.nextSubStepIds.forEach(gt=>{var Pt,Dn;const Lt=(Pt=u.extendedDetails)==null?void 0:Pt.subSteps.find(Sn=>Sn.id===gt),Ot=(Dn=R.get(gt))==null?void 0:Dn.current;if(Lt&&Ot&&Lt.position){const Sn={x:Lt.position.x,y:Lt.position.y+Ot.offsetHeight/2};Z.push({id:`subconn-${de.id}-${gt}`,from:Ve,to:Sn,sourceId:de.id,targetId:gt})}})}}}),ft(Z)},[(V=u.extendedDetails)==null?void 0:V.subSteps,R]);xe.useEffect(()=>{const Z=setTimeout(ze,100);return()=>clearTimeout(Z)},[ze]);const Ft=xe.useCallback(Z=>{p(ce=>(ee(de=>[...de,ce]),Fe([]),Z(ce)))},[]),Tt=Z=>{Ft(ce=>({...ce,...typeof Z=="function"?Z(ce):Z}))},ot=Z=>{Tt(ce=>({extendedDetails:{...ce.extendedDetails,...typeof Z=="function"?Z(ce.extendedDetails):Z}}))},fn=()=>{if(ne.length===0)return;const Z=ne[ne.length-1];ee(ce=>ce.slice(0,-1)),Fe(ce=>[u,...ce]),p(Z)},an=()=>{if(Se.length===0)return;const Z=Se[0];Fe(ce=>ce.slice(1)),ee(ce=>[...ce,u]),p(Z)},Un=async()=>{ae(!0),re(null);try{const Z=await MM(u);N(Z),C(!0)}catch(Z){re(Z instanceof Error?Z.message:"")}finally{ae(!1)}},$t=Z=>{ot(ce=>{const de=ce.subSteps||[],Ie=de.length,Ge=Z.newSubSteps.map((Ve,gt)=>({id:a("sub_ai"),text:Ve.title,notes:Ve.description,status:ir.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+(Ie+gt)%4*210,y:Math.floor((Ie+gt)/4)*90+10}}));return{subSteps:[...de.map(Ve=>{const gt=Z.newActionItems.filter(Ot=>Ot.targetSubStepId===Ve.id);if(gt.length===0)return Ve;const Lt=gt.map(Ot=>({id:a("action_ai"),text:Ot.title,completed:!1}));return{...Ve,actionItems:[...Ve.actionItems||[],...Lt]}}),...Ge]}}),C(!1)},Yt=()=>{var de,Ie;const Z=((Ie=(de=u.extendedDetails)==null?void 0:de.subSteps)==null?void 0:Ie.length)||0,ce={id:a("sub_new"),text:"",status:ir.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+Z%4*210,y:Math.floor(Z/4)*90+10}};ot(Ge=>({subSteps:[...Ge.subSteps||[],ce]})),Ee(ce.id)},at=xe.useCallback((Z,ce)=>{ot(de=>({subSteps:(de.subSteps||[]).map(Ie=>Ie.id===Z?{...Ie,...typeof ce=="function"?ce(Ie):ce}:Ie)}))},[ot]),Dt=xe.useCallback(Z=>{Ee(ce=>ce===Z?null:ce),ot(ce=>({subSteps:(ce.subSteps||[]).filter(de=>de.id!==Z).map(de=>{var Ie;return{...de,nextSubStepIds:(Ie=de.nextSubStepIds)==null?void 0:Ie.filter(Ge=>Ge!==Z)}})}))},[ot]),Ue=()=>{var Ml;const Z=(Ml=u.extendedDetails)==null?void 0:Ml.subSteps,ce=j.current;if(!Z||Z.length===0||!ce)return;const de=new Map,Ie=new Map;Z.forEach(Wt=>{de.set(Wt.id,[]),Ie.set(Wt.id,0)}),Z.forEach(Wt=>{(Wt.nextSubStepIds||[]).forEach(wn=>{de.has(wn)&&(de.get(Wt.id).push(wn),Ie.set(wn,Ie.get(wn)+1))})});const Ge=Z.filter(Wt=>Ie.get(Wt.id)===0).map(Wt=>Wt.id),$e=[];let Ve=0;for(;Ge.length>0;){const Wt=Ge.length,wn=[];for(let dn=0;dn<Wt;dn++){const ti=Ge.shift();wn.push(ti),Ve++,(de.get(ti)||[]).forEach(ka=>{Ie.set(ka,Ie.get(ka)-1),Ie.get(ka)===0&&Ge.push(ka)})}$e.push(wn)}if(Ve<Z.length){const Wt=new Set($e.flat()),wn=Z.filter(dn=>!Wt.has(dn.id)).map(dn=>dn.id);wn.length>0&&$e.push(wn)}const gt=ce.clientWidth,Lt=192,Ot=76,Pt=60,Dn=20,Sn=new Map;let Qa=10,rr=10,Bi=0;$e.forEach(Wt=>{const wn=Lt+Pt,dn=Wt.length*(Ot+Dn)-Dn;Qa>10&&Qa+wn>gt&&(Qa=10,rr+=Bi+Dn*2,Bi=0),Wt.forEach((ti,ka)=>{Sn.set(ti,{x:Qa,y:rr+ka*(Ot+Dn)})}),Qa+=wn,Bi=Math.max(Bi,dn)});let Nl=0,ei=0;Sn.forEach(Wt=>{Nl=Math.max(Nl,Wt.x+Lt),ei=Math.max(ei,Wt.y+Ot)}),ot(Wt=>({subSteps:(Wt.subSteps||[]).map(wn=>({...wn,position:Sn.get(wn.id)||wn.position})),subStepCanvasSize:{width:Nl+20,height:ei+20}}))},dt=(Z,ce)=>{Y.current=ce;const de=Z.currentTarget.getBoundingClientRect();H.current={x:Z.clientX-de.left,y:Z.clientY-de.top},Z.dataTransfer.effectAllowed="move"},jt=Z=>{Z.preventDefault(),Z.dataTransfer.dropEffect="move"},Et=Z=>{var Lt;if(Z.preventDefault(),!Y.current||!j.current)return;const ce=j.current.getBoundingClientRect(),de=(Lt=R.get(Y.current))==null?void 0:Lt.current;if(!de)return;const Ie=de.offsetWidth,Ge=de.offsetHeight;let $e=Z.clientX-ce.left-H.current.x+j.current.scrollLeft,Ve=Z.clientY-ce.top-H.current.y+j.current.scrollTop;const gt=j.current.querySelector(".substep-inner-canvas");gt&&($e=Math.max(0,Math.min($e,gt.scrollWidth-Ie)),Ve=Math.max(0,Math.min(Ve,gt.scrollHeight-Ge))),at(Y.current,{position:{x:$e,y:Ve}}),Y.current=null},Mn=Z=>{W(Z),k(!0)},Bn=(Z,ce)=>{var Ve;const de=(Ve=Z.target.files)==null?void 0:Ve[0];if(!de)return;const Ie=5,Ge=Ie*1024*1024;if(de.size>Ge){alert(`${Ie}MB`),Z.target&&(Z.target.value="");return}const $e=new FileReader;$e.onload=gt=>{var Lt;if(typeof((Lt=gt.target)==null?void 0:Lt.result)=="string"){const Ot={id:a("attach"),name:de.name,type:de.type,dataUrl:gt.target.result};ce==="task"?ot(Pt=>({attachments:[...Pt.attachments||[],Ot]})):ce==="substep"&&se&&at(se,Pt=>({attachments:[...Pt.attachments||[],Ot]}))}else alert("")},$e.onerror=()=>{alert("")},$e.readAsDataURL(de),Z.target&&(Z.target.value="")},$r=(Z,ce)=>{ce==="task"?ot(de=>{var Ie;return{attachments:(Ie=de.attachments)==null?void 0:Ie.filter(Ge=>Ge.id!==Z)}}):ce==="substep"&&se&&at(se,de=>{var Ie;return{attachments:(Ie=de.attachments)==null?void 0:Ie.filter(Ge=>Ge.id!==Z)}})},Yr=(Z,ce)=>{if(!j.current)return;const de=j.current.getBoundingClientRect(),Ie={x:ce.clientX-de.left+j.current.scrollLeft,y:ce.clientY-de.top+j.current.scrollTop};Je({fromId:Z,fromPos:Ie})},Za=Z=>{if(!Ce)return;const{fromId:ce}=Ce;if(ce===Z){Je(null);return}at(ce,de=>({...de,nextSubStepIds:Array.from(new Set([...de.nextSubStepIds||[],Z]))})),Je(null)},Sa=(Z,ce)=>{at(Z,de=>{var Ie;return{...de,nextSubStepIds:(Ie=de.nextSubStepIds)==null?void 0:Ie.filter(Ge=>Ge!==ce)}})},wa=Z=>{if(!Ce||!j.current)return;const ce=j.current.getBoundingClientRect();pt({x:Z.clientX-ce.left+j.current.scrollLeft,y:Z.clientY-ce.top+j.current.scrollTop})},Ca=()=>{Ce&&Je(null)},Pe=(Z,ce)=>{at(Z,de=>{var Ie;return{actionItems:(Ie=de.actionItems)==null?void 0:Ie.map(Ge=>Ge.id===ce.id?ce:Ge)}}),k(!1),W(null)},st=(Z,ce,de)=>{at(Z,Ie=>{var Ge;return{actionItems:(Ge=Ie.actionItems)==null?void 0:Ge.map($e=>$e.id===ce?{...$e,...de}:$e)}})},xt=(Z,ce)=>{ot(de=>({subSteps:(de.subSteps||[]).map(Ge=>{var Ot;if(Ge.id!==Z)return Ge;const $e=(Ot=Ge.actionItems)==null?void 0:Ot.map(Pt=>{if(Pt.id!==ce)return Pt;const Dn=!Pt.completed;return{...Pt,completed:Dn,completedDate:Dn?new Date().toISOString().split("T")[0]:void 0}}),Ve=$e==null?void 0:$e.every(Pt=>Pt.completed),gt=$e==null?void 0:$e.some(Pt=>Pt.completed);let Lt=Ge.status;return $e&&$e.length>0?Ve?Lt=ir.COMPLETED:gt?Lt=ir.IN_PROGRESS:Lt=ir.NOT_STARTED:Lt=ir.NOT_STARTED,{...Ge,actionItems:$e,status:Lt}})}))},sn=Z=>{at(Z,ce=>({actionItems:[...ce.actionItems||[],{id:a("action"),text:"",completed:!1}]}))},Rn=(Z,ce)=>{at(Z,de=>{var Ie;return{actionItems:(Ie=de.actionItems)==null?void 0:Ie.filter(Ge=>Ge.id!==ce)}})},En=()=>{n(u.id,{title:u.title,description:u.description,status:u.status}),r(u.id,u.extendedDetails),t()},Nr=Z=>{ot({reportDeck:Z})},Aa=()=>{X(!0)},Vn=Z=>{ot({reportDeck:Z}),X(!1),S(!0)},Zt=()=>{if(!Me){t();return}window.confirm(`

OK
`)&&t()},Qt=Z=>{ot({decisions:Z}),U(!1)},_t=((P=(L=u.extendedDetails)==null?void 0:L.subSteps)==null?void 0:P.find(Z=>Z.id===se))||null,Mr=(Z,ce)=>g.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mt-1 max-h-40 overflow-y-auto p-2 border rounded-md bg-slate-50",children:!Z||Z.length===0?g.jsx("p",{className:"col-span-full text-center text-xs text-slate-400 py-2",children:""}):Z.map(de=>g.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-20",children:[g.jsx("a",{href:de.dataUrl,download:de.name,className:"block w-full h-full","aria-label":`Download ${de.name}`,children:de.type.startsWith("image/")?g.jsx("img",{src:de.dataUrl,alt:de.name,className:"w-full h-full object-cover"}):g.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-1 hover:bg-slate-200",children:g.jsx(Mi,{className:"w-8 h-8 text-slate-500"})})}),g.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:g.jsx("p",{className:"text-white text-[10px] truncate",title:de.name,children:de.name})}),g.jsx("button",{onClick:()=>ce(de.id),className:"absolute top-1 right-1 bg-black bg-opacity-70 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:g.jsx(Ya,{className:"w-3 h-3"})})]},de.id))});return E&&((B=u.extendedDetails)!=null&&B.reportDeck)?g.jsx(Mh,{tasks:[u],initialDeck:u.extendedDetails.reportDeck,onSave:Nr,onClose:()=>S(!1),generateUniqueId:a,projectGoal:l,targetDate:c,reportScope:"task"}):w?g.jsx(sD,{proposals:q,existingSubSteps:((z=u.extendedDetails)==null?void 0:z.subSteps)||[],onConfirm:$t,onClose:()=>C(!1)}):M&&F&&_t?g.jsx(d9,{actionItem:F,onSave:Z=>Pe(_t.id,Z),onClose:()=>k(!1),generateUniqueId:a}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[g.jsx("header",{className:"flex-shrink-0 bg-white shadow-md z-10 sticky top-0",children:g.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-5 w-full max-w-screen-2xl mx-auto",children:[g.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-slate-800 truncate pr-2",children:[u.title," - "]}),g.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[g.jsx("button",{onClick:Zt,className:"px-3 sm:px-5 py-2 bg-slate-200 text-slate-700 text-sm font-medium rounded-md hover:bg-slate-300",children:""}),g.jsx("button",{onClick:En,className:"px-3 sm:px-5 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700",children:""}),g.jsx("button",{onClick:Aa,className:"px-3 sm:px-5 py-2 bg-purple-600 text-white text-sm font-semibold rounded-md hover:bg-purple-700",children:""})]})]})}),g.jsx("main",{className:"flex-grow p-4 sm:p-6 overflow-hidden w-full max-w-screen-2xl mx-auto",children:g.jsxs("div",{className:"flex gap-6 h-full",children:[g.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${y==="info"?"flex-1":y==="none"?"w-[360px] min-w-[360px]":"w-0 p-0 m-0 border-0 overflow-hidden opacity-0"}`,children:[g.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[g.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[g.jsx(BM,{className:"w-5 h-5 mr-2 text-purple-600"}),""]}),g.jsx("button",{onClick:()=>_(y==="info"?"none":"info"),className:"p-1 text-slate-500 hover:text-blue-600",title:y==="info"?"":"",children:y==="info"?g.jsx(Rd,{className:"w-5 h-5"}):g.jsx(Md,{className:"w-5 h-5"})})]}),g.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[g.jsx(ha,{label:"",name:"title",value:u.title,onChange:Z=>Tt({title:Z.target.value}),required:!0}),g.jsx(ha,{label:"",name:"description",value:u.description,onChange:Z=>Tt({description:Z.target.value}),type:"textarea",rows:3,required:!0}),g.jsx(ha,{icon:g.jsx(wv,{}),label:"/",name:"responsible",value:u.extendedDetails.responsible,onChange:Z=>ot({responsible:Z.target.value})}),g.jsx(ha,{icon:g.jsx(b2,{}),label:"",name:"dueDate",type:"date",value:u.extendedDetails.dueDate||"",onChange:Z=>ot({dueDate:Z.target.value})}),g.jsxs("div",{children:[g.jsx(ha,{icon:g.jsx(YM,{}),label:"",name:"resources",value:u.extendedDetails.resources,onChange:Z=>ot({resources:Z.target.value}),type:"textarea"}),(fe=u.extendedDetails)!=null&&fe.resourceMatrix?g.jsx("div",{className:"mt-2",children:g.jsx(S_,{matrixData:u.extendedDetails.resourceMatrix,onUpdate:Z=>ot({resourceMatrix:Z})})}):g.jsxs("button",{onClick:()=>ot({resourceMatrix:{headers:["",""],rows:[["",""]]}}),className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[g.jsx(Yo,{className:"w-4 h-4"}),""]})]}),g.jsx(ha,{icon:g.jsx($M,{}),label:"",name:"notes",value:u.extendedDetails.notes,onChange:Z=>ot({notes:Z.target.value}),type:"textarea",rows:4}),g.jsx("div",{className:"pt-4 border-t mt-4",children:g.jsxs("button",{onClick:()=>U(!0),className:"w-full text-left p-3 bg-cyan-50 hover:bg-cyan-100 rounded-lg text-cyan-800 font-semibold flex justify-between items-center",children:[g.jsxs("span",{className:"flex items-center gap-2",children:[g.jsx(R2,{className:"w-5 h-5 text-cyan-600"}),""]}),g.jsxs("div",{className:"flex gap-2 text-xs",children:[g.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-green-200 text-green-800",children:[": ",Te.decided]}),g.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-yellow-200 text-yellow-800",children:[": ",Te.undecided]})]})]})}),g.jsxs("div",{className:"pt-4",children:[g.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["",g.jsx("button",{onClick:()=>{var Z;return(Z=ke.current)==null?void 0:Z.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"",children:g.jsx(Mi,{className:"w-4 h-4 text-slate-600"})})]}),Mr((_e=u.extendedDetails)==null?void 0:_e.attachments,Z=>$r(Z,"task")),g.jsx("input",{type:"file",ref:ke,onChange:Z=>Bn(Z,"task"),className:"hidden"})]}),g.jsxs("div",{className:"pt-4",children:[g.jsxs("h4",{className:"text-lg font-semibold text-slate-700 mb-3 border-b pb-2 flex items-center",children:[g.jsx(Nh,{className:"w-5 h-5 mr-2 text-yellow-500"}),"AI"]}),g.jsx("button",{onClick:Un,disabled:we,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-700 disabled:bg-slate-400",children:we?g.jsx(na,{size:"sm"}):"AI"}),me&&g.jsx("div",{className:"mt-2",children:g.jsx(oc,{message:me})})]})]})]}),g.jsxs("section",{className:`flex flex-col space-y-4 min-w-0 transition-all duration-300 ease-in-out
                  ${y==="canvas"||y==="none"?"flex-1":"hidden"}`,children:[g.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[g.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[g.jsx(GM,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),g.jsxs("div",{className:"flex gap-2 items-center",children:[g.jsx("button",{onClick:fn,disabled:ne.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"",children:g.jsx(N2,{className:"w-3 h-3"})}),g.jsx("button",{onClick:an,disabled:Se.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"",children:g.jsx(M2,{className:"w-3 h-3"})}),g.jsxs("button",{onClick:Yt,className:"text-xs px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[g.jsx(ju,{className:"w-3 h-3"}),""]}),g.jsxs("button",{onClick:Ue,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 flex items-center gap-1",title:"",children:[g.jsx(mf,{className:"w-3 h-3"}),""]}),g.jsx("button",{onClick:()=>_(y==="canvas"?"none":"canvas"),className:"p-1 text-slate-500 hover:text-blue-600",title:y==="canvas"?"":"",children:y==="canvas"?g.jsx(Rd,{className:"w-5 h-5"}):g.jsx(Md,{className:"w-5 h-5"})})]})]}),g.jsx("div",{ref:j,onMouseMove:wa,onMouseUp:Ca,onDragOver:jt,onDrop:Et,className:`substep-canvas relative border rounded-md bg-white p-2 overflow-auto shadow-inner ${y==="canvas"?"":"flex-grow"}`,children:g.jsxs("div",{className:"substep-inner-canvas relative",style:{width:`${((pe=(oe=u.extendedDetails)==null?void 0:oe.subStepCanvasSize)==null?void 0:pe.width)||1200}px`,height:`${((Re=(ve=u.extendedDetails)==null?void 0:ve.subStepCanvasSize)==null?void 0:Re.height)||800}px`},children:[(((Oe=u.extendedDetails)==null?void 0:Oe.subSteps)||[]).map(Z=>Z?g.jsx(x9,{subStep:Z,cardRef:R.get(Z.id),isSelected:se===Z.id,onClick:()=>Ee(Z.id),onRemove:()=>Dt(Z.id),onDragStart:dt,onStartConnection:Yr,onEndConnection:Za},Z.id):null),Ke.map(Z=>g.jsx(Jo,{from:Z.from,to:Z.to,id:Z.id,onDelete:()=>Sa(Z.sourceId,Z.targetId)},Z.id)),Ce&&g.jsx(Jo,{from:Ce.fromPos,to:K,id:"preview-connector"})]})})]}),g.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${y==="details"?"flex-1":y==="none"?"w-[360px] min-w-[360px]":"hidden"}`,children:[g.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[g.jsx("h5",{className:"text-lg font-semibold text-slate-800",children:""}),g.jsx("button",{onClick:()=>_(y==="details"?"none":"details"),disabled:!_t,className:"p-1 text-slate-500 hover:text-blue-600 disabled:text-slate-300 disabled:cursor-not-allowed",title:y==="details"?"":"",children:y==="details"?g.jsx(Rd,{className:"w-5 h-5"}):g.jsx(Md,{className:"w-5 h-5"})})]}),g.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:_t?g.jsxs("div",{className:"space-y-4",children:[g.jsx(ha,{label:"",name:"text",value:_t.text,onChange:Z=>at(_t.id,{text:Z.target.value}),type:"textarea"}),g.jsx(ha,{label:"",name:"responsible",value:_t.responsible||"",onChange:Z=>at(_t.id,{responsible:Z.target.value})}),g.jsx(ha,{label:"",name:"dueDate",type:"date",value:_t.dueDate||"",onChange:Z=>at(_t.id,{dueDate:Z.target.value})}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),g.jsx("select",{value:_t.status||ir.NOT_STARTED,onChange:Z=>at(_t.id,{status:Z.target.value}),className:"w-full p-2 border rounded-md text-sm bg-white text-slate-900",children:Object.values(ir).map(Z=>g.jsx("option",{value:Z,children:Z},Z))})]}),g.jsx(ha,{label:"",name:"notes",value:_t.notes||"",onChange:Z=>at(_t.id,{notes:Z.target.value}),type:"textarea"}),g.jsx(He,{items:_t.actionItems||[],onToggle:Z=>xt(_t.id,Z),onAdd:()=>sn(_t.id),onUpdate:(Z,ce)=>st(_t.id,Z,ce),onRemove:Z=>Rn(_t.id,Z),onOpenReport:Z=>Mn(Z)}),g.jsxs("div",{children:[g.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["",g.jsx("button",{onClick:()=>{var Z;return(Z=De.current)==null?void 0:Z.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"",children:g.jsx(Mi,{className:"w-4 h-4 text-slate-600"})})]}),Mr(_t.attachments,Z=>$r(Z,"substep")),g.jsx("input",{type:"file",ref:De,onChange:Z=>Bn(Z,"substep"),className:"hidden"})]})]}):g.jsx("div",{className:"flex items-center justify-center h-full text-center text-slate-500 text-sm",children:g.jsxs("p",{children:["",g.jsx("br",{}),""]})})})]})]})})]}),b&&g.jsx(h9,{task:u,isOpen:b,onClose:()=>U(!1),onSave:Qt,generateUniqueId:a}),O&&_t&&g.jsx(m9,{actionItems:_t.actionItems||[],subStepName:_t.text,taskName:u.title,onClose:()=>te(!1)}),G&&g.jsx(p9,{task:u,isOpen:G,onClose:()=>X(!1),onReportGenerated:Vn})]})},v9=({onClose:e,onSubmit:t})=>{const[n,r]=xe.useState(""),[a,l]=xe.useState(""),[c,u]=xe.useState(""),p=m=>{if(m.preventDefault(),!n.trim()){u("");return}if(!a.trim()){u("");return}t({title:n,description:a}),u("")};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg",children:[g.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:g.jsx(sa,{className:"w-6 h-6"})})]}),g.jsxs("form",{onSubmit:p,children:[g.jsxs("div",{className:"p-6 space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"taskTitle",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),g.jsx("input",{type:"text",id:"taskTitle",value:n,onChange:m=>r(m.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:": "})]}),g.jsxs("div",{children:[g.jsx("label",{htmlFor:"taskDescription",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),g.jsx("textarea",{id:"taskDescription",value:a,onChange:m=>l(m.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:": "})]}),c&&g.jsx("p",{className:"text-sm text-red-600",children:c})]}),g.jsxs("footer",{className:"p-6 bg-slate-50 border-t border-slate-200 flex justify-end space-x-3 rounded-b-xl",children:[g.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),g.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""})]})]})]})})},y9=({onSetApiKey:e,error:t,isLoading:n})=>{const[r,a]=xe.useState(""),l=c=>{c.preventDefault(),e(r)};return g.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[g.jsxs("div",{className:"w-full max-w-md bg-white shadow-2xl rounded-xl p-8",children:[g.jsxs("div",{className:"text-center mb-8",children:[g.jsx(lc,{className:"w-12 h-12 mx-auto text-blue-600 mb-4"}),g.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"AI Project Planner"}),g.jsx("p",{className:"text-slate-600 mt-2",children:"Google Gemini API"})]}),g.jsxs("form",{onSubmit:l,className:"space-y-6",children:[g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"apiKey",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[g.jsx(I2,{className:"w-5 h-5 mr-2 text-slate-500"}),"Gemini API Key"]}),g.jsx("input",{id:"apiKey",type:"password",value:r,onChange:c=>a(c.target.value),placeholder:"API",className:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-800 placeholder-slate-400"})]}),t&&g.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:t}),g.jsx("button",{type:"submit",disabled:n||!r,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:n?g.jsx(na,{size:"sm"}):""})]}),g.jsxs("div",{className:"text-center mt-6",children:[g.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"API"}),g.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"API"})]})]}),g.jsx("footer",{className:"mt-8 text-center",children:g.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},Ii={subSteps:[],resources:"",responsible:"",notes:"",numericalTarget:void 0,dueDate:"",reportDeck:void 0,resourceMatrix:null,attachments:[],decisions:[],subStepCanvasSize:{width:1200,height:800}},T9=()=>[{id:"apqp_1",title:"1: ",description:"/",status:bt.NOT_STARTED,nextTaskIds:["apqp_2"]},{id:"apqp_2",title:"2: ",description:"DFMEA",status:bt.NOT_STARTED,nextTaskIds:["apqp_3"]},{id:"apqp_3",title:"3: ",description:"PFMEA(MSA)",status:bt.NOT_STARTED,nextTaskIds:["apqp_4"]},{id:"apqp_4",title:"4: ",description:"MSA(SPC)(PPAP)",status:bt.NOT_STARTED,nextTaskIds:["apqp_5"]},{id:"apqp_5",title:"5: ",description:"",status:bt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Ii,...t.extendedDetails||{}}})),_9=()=>[{id:"change_1",title:"1. ",description:"",status:bt.NOT_STARTED,nextTaskIds:["change_2"]},{id:"change_2",title:"2. ",description:"(CCB)",status:bt.NOT_STARTED,nextTaskIds:["change_3"]},{id:"change_3",title:"3. ",description:"",status:bt.NOT_STARTED,nextTaskIds:["change_4"]},{id:"change_4",title:"4. ",description:"FMEA",status:bt.NOT_STARTED,nextTaskIds:["change_5"]},{id:"change_5",title:"5. ",description:"",status:bt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Ii,...t.extendedDetails||{}}})),E9=()=>[{id:"eval_1",title:"1. ",description:"",status:bt.NOT_STARTED,nextTaskIds:["eval_2"]},{id:"eval_2",title:"2.  ()",description:"",status:bt.NOT_STARTED,nextTaskIds:["eval_3"]},{id:"eval_3",title:"3. ",description:"",status:bt.NOT_STARTED,nextTaskIds:["eval_4"]},{id:"eval_4",title:"4. ",description:"",status:bt.NOT_STARTED,nextTaskIds:["eval_5"]},{id:"eval_5",title:"5. ",description:"",status:bt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Ii,...t.extendedDetails||{}}})),S9=()=>[{id:"dmaic_1",title:"1:  (Define)",description:"",status:bt.NOT_STARTED,nextTaskIds:["dmaic_2"]},{id:"dmaic_2",title:"2:  (Measure)",description:"KPI",status:bt.NOT_STARTED,nextTaskIds:["dmaic_3"]},{id:"dmaic_3",title:"3:  (Analyze)",description:"",status:bt.NOT_STARTED,nextTaskIds:["dmaic_4"]},{id:"dmaic_4",title:"4:  (Improve)",description:"",status:bt.NOT_STARTED,nextTaskIds:["dmaic_5"]},{id:"dmaic_5",title:"5:  (Control)",description:"",status:bt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Ii,...t.extendedDetails||{}}})),w9=()=>[{id:"mod_1",title:"1. ",description:"",status:bt.NOT_STARTED,nextTaskIds:["mod_2"]},{id:"mod_2",title:"2. ",description:"",status:bt.NOT_STARTED,nextTaskIds:["mod_3"]},{id:"mod_3",title:"3. ",description:"",status:bt.NOT_STARTED,nextTaskIds:["mod_4"]},{id:"mod_4",title:"4. ",description:"",status:bt.NOT_STARTED,nextTaskIds:["mod_5"]},{id:"mod_5",title:"5. ",description:"",status:bt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Ii,...t.extendedDetails||{}}})),C9=()=>{const[e,t]=xe.useState(null),[n,r]=xe.useState(""),[a,l]=xe.useState(""),[c,u]=xe.useState([]),[p,m]=xe.useState(null),[x,y]=xe.useState(null),[_,E]=xe.useState(!1),[S,w]=xe.useState(null),[C,M]=xe.useState(Br.INPUT_FORM),[k,b]=xe.useState(!1),[U,G]=xe.useState([]),[X,F]=xe.useState([]),[W,O]=xe.useState(null);xe.useEffect(()=>{const Me=sessionStorage.getItem("gemini-api-key");Me&&re(Me)},[]);const te=Me=>{G(Te=>[...Te.slice(-10),Me]),F([])},ne=xe.useCallback((Me="id")=>`${Me}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,[]),ee=(Me,Te)=>{const He=JSON.stringify(Me,null,2),ze=new Blob([He],{type:"application/json"}),Ft=URL.createObjectURL(ze),Tt=document.createElement("a");Tt.href=Ft,Tt.download=Te,document.body.appendChild(Tt),Tt.click(),document.body.removeChild(Tt),URL.revokeObjectURL(Ft)},Se=Me=>new Promise((Te,He)=>{const ze=new FileReader;ze.onload=Ft=>{var Tt;try{typeof((Tt=Ft.target)==null?void 0:Tt.result)=="string"?Te(JSON.parse(Ft.target.result)):He(new Error("Failed to read file."))}catch(ot){He(new Error(`Invalid JSON: ${ot.message}`))}},ze.onerror=()=>He(new Error("File read error.")),ze.readAsText(Me)}),Fe=xe.useCallback(Me=>{if(Me.length===0)return Me;const Te=new Map(Me.map(Ue=>[Ue.id,Ue])),He=new Map(Me.map(Ue=>[Ue.id,0])),ze=new Map;Me.forEach(Ue=>{ze.set(Ue.id,[]),(Ue.nextTaskIds||[]).forEach(dt=>{var jt;Te.has(dt)&&(He.set(dt,(He.get(dt)||0)+1),(jt=ze.get(Ue.id))==null||jt.push(dt))})});const Ft=Me.filter(Ue=>(He.get(Ue.id)||0)===0).map(Ue=>Ue.id),Tt=[];let ot=0;const fn=new Set;for(;Ft.length>0;){const Ue=Ft.length;Tt[ot]=[];for(let dt=0;dt<Ue;dt++){const jt=Ft.shift();fn.add(jt),Tt[ot].push(jt),(ze.get(jt)||[]).forEach(Et=>{He.set(Et,(He.get(Et)||0)-1),(He.get(Et)||0)===0&&Ft.push(Et)})}ot++}const an=Me.filter(Ue=>!fn.has(Ue.id));an.length>0&&Tt.push(an.map(Ue=>Ue.id));const Un=380,$t=60,Yt=50,at=280,Dt=new Map;return Tt.forEach((Ue,dt)=>{const jt=Ue.length*at+(Ue.length-1)*Yt,Et=Math.max(20,(500-jt)/2);Ue.forEach((Mn,Bn)=>{Dt.set(Mn,{x:dt*(Un+$t)+20,y:Et+Bn*(at+Yt)})})}),Me.map((Ue,dt)=>({...Ue,position:Dt.get(Ue.id)||Ue.position||{x:20,y:20+dt*100}}))},[]),we=Me=>{te(c),u(Me)},ae=()=>{if(U.length>0){const Me=U[U.length-1];G(Te=>Te.slice(0,-1)),F(Te=>[c,...Te]),u(Me)}},me=()=>{if(X.length>0){const Me=X[0];F(Te=>Te.slice(1)),G(Te=>[...Te,c]),u(Me)}},re=Me=>{Me.trim()&&(Ev(Me),sessionStorage.setItem("gemini-api-key",Me),t(Me),w(null))},q=()=>{sessionStorage.removeItem("gemini-api-key"),t(null),Ev("")},N=()=>{r(""),l(""),u([]),y(null),O(null),M(Br.INPUT_FORM),w(null),G([]),F([])},j=()=>{ee({projectGoal:n,targetDate:a,tasks:c,ganttData:x},"project-plan.json")},R=async Me=>{try{const Te=await Se(Me);if(Te.projectGoal&&Te.targetDate&&Array.isArray(Te.tasks))r(Te.projectGoal),l(Te.targetDate),u(Te.tasks.map(He=>({...He,extendedDetails:{...Ii,...He.extendedDetails||{}}}))),y(Te.ganttData||null),O(null),M(Br.PROJECT_FLOW),G([]),F([]);else throw new Error("Invalid project file format.")}catch(Te){const He=Te.message;w(He),He.toLowerCase().includes("api key")&&q()}},J=({title:Me,description:Te})=>{const He={id:ne("task"),title:Me,description:Te,extendedDetails:Ii,status:bt.NOT_STARTED,position:{x:20,y:20}};we(ze=>Fe([...ze,He])),b(!1)},Y=Me=>{we(Te=>Te.filter(He=>He.id!==Me).map(He=>({...He,nextTaskIds:(He.nextTaskIds||[]).filter(ze=>ze!==Me)})))},H=(Me,Te)=>{we(He=>He.map(ze=>ze.id===Me?{...ze,status:Te}:ze))},se=(Me,Te)=>{we(He=>He.map(ze=>ze.id===Me?{...ze,nextTaskIds:Te}:ze))},Ee=(Me,Te)=>{u(He=>He.map(ze=>ze.id===Me?{...ze,position:Te}:ze))},ke=(Me,Te)=>{we(He=>He.map(ze=>ze.id===Me?{...ze,...Te}:ze))},De=(Me,Te)=>{we(He=>He.map(ze=>ze.id===Me?{...ze,extendedDetails:Te}:ze))},Ce=(Me,Te,He)=>{let ze=[];switch(Me){case"process-design":ze=T9();break;case"process-change":ze=_9();break;case"new-product-eval":ze=E9();break;case"improvement-project":ze=S9();break;case"equipment-modification":ze=w9();break}r(Te),l(He),u(Fe(ze)),y(null),O(null),M(Br.PROJECT_FLOW),G([]),F([]),w(null)},Je=async(Me,Te)=>{E(!0),w(null);try{r(Me),l(Te);const He=await NM(Me,Te),ze=Fe(He.map(Ft=>({...Ft,extendedDetails:Ii,status:bt.NOT_STARTED})));u(ze),y(null),O(null),M(Br.PROJECT_FLOW),G([]),F([])}catch(He){const ze=He.message;ze.toLowerCase().includes("api key")&&q(),w(ze)}finally{E(!1)}},K=Me=>{m(Me),M(Br.TASK_DETAIL)},pt=()=>{m(null),M(Br.PROJECT_FLOW)},Ke=Me=>{O(Me)},ft=()=>{if(!e)return g.jsx(y9,{onSetApiKey:re,error:S});if(S)return g.jsxs("div",{className:"p-4",children:[g.jsx(oc,{message:S}),g.jsx("button",{onClick:()=>{w(null),e?M(Br.INPUT_FORM):q()},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:""})]});switch(C){case Br.PROJECT_FLOW:return g.jsx(iD,{tasks:c,projectGoal:n,targetDate:a,onSelectTask:K,onUpdateTaskExtendedDetails:()=>{},onUpdateTaskPosition:Ee,onStartNewProject:N,onExportProject:j,onAddTask:()=>b(!0),onRemoveTask:Y,onUpdateTaskStatus:H,onImportSingleTask:()=>{},onAutoLayout:()=>we(Me=>Fe([...Me])),onUndo:ae,canUndo:U.length>0,onRedo:me,canRedo:X.length>0,generateUniqueId:ne,onUpdateTaskConnections:se,ganttData:x,setGanttData:y,onCustomReportGenerated:Ke,onClearApiKey:q});case Br.TASK_DETAIL:return p&&g.jsx(g9,{task:p,onClose:pt,onUpdateTaskCoreInfo:ke,onUpdateExtendedDetails:De,generateUniqueId:ne,projectGoal:n,targetDate:a});case Br.INPUT_FORM:default:return g.jsx(KM,{onSubmit:Je,isLoading:_,onImportProject:R,onLoadTemplate:Ce,initialGoal:n,initialDate:a})}};return g.jsxs("div",{className:"h-full w-full",children:[ft(),k&&g.jsx(v9,{onClose:()=>b(!1),onSubmit:J}),W&&g.jsx(Mh,{tasks:c,initialDeck:W,onSave:Me=>O(Me),onClose:()=>O(null),projectGoal:n,targetDate:a,reportScope:"project",generateUniqueId:ne})]})},w_=document.getElementById("root");if(!w_)throw new Error("Could not find root element to mount to");const A9=US.createRoot(w_);A9.render(g.jsx(Fi.StrictMode,{children:g.jsx(C9,{})}));
