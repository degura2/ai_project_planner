(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function Oy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var cd={exports:{}},pl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mx;function TS(){if(Mx)return pl;Mx=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,a,o){var c=null;if(o!==void 0&&(c=""+o),a.key!==void 0&&(c=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:e,type:r,key:c,ref:a!==void 0?a:null,props:o}}return pl.Fragment=t,pl.jsx=n,pl.jsxs=n,pl}var Rx;function _S(){return Rx||(Rx=1,cd.exports=TS()),cd.exports}var v=_S(),ud={exports:{}},ct={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dx;function ES(){if(Dx)return ct;Dx=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function _(N){return N===null||typeof N!="object"?null:(N=y&&N[y]||N["@@iterator"],typeof N=="function"?N:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,C={};function w(N,W,D){this.props=N,this.context=W,this.refs=C,this.updater=D||E}w.prototype.isReactComponent={},w.prototype.setState=function(N,W){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,W,"setState")},w.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function M(){}M.prototype=w.prototype;function k(N,W,D){this.props=N,this.context=W,this.refs=C,this.updater=D||E}var b=k.prototype=new M;b.constructor=k,S(b,w.prototype),b.isPureReactComponent=!0;var U=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},X=Object.prototype.hasOwnProperty;function F(N,W,D,J,q,G){return D=G.ref,{$$typeof:e,type:N,key:W,ref:D!==void 0?D:null,props:G}}function Y(N,W){return F(N.type,W,void 0,void 0,void 0,N.props)}function L(N){return typeof N=="object"&&N!==null&&N.$$typeof===e}function Q(N){var W={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(D){return W[D]})}var te=/\/+/g;function ee(N,W){return typeof N=="object"&&N!==null&&N.key!=null?Q(""+N.key):W.toString(36)}function _e(){}function De(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(_e,_e):(N.status="pending",N.then(function(W){N.status==="pending"&&(N.status="fulfilled",N.value=W)},function(W){N.status==="pending"&&(N.status="rejected",N.reason=W)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function Te(N,W,D,J,q){var G=typeof N;(G==="undefined"||G==="boolean")&&(N=null);var ie=!1;if(N===null)ie=!0;else switch(G){case"bigint":case"string":case"number":ie=!0;break;case"object":switch(N.$$typeof){case e:case t:ie=!0;break;case g:return ie=N._init,Te(ie(N._payload),W,D,J,q)}}if(ie)return q=q(N),ie=J===""?"."+ee(N,0):J,U(q)?(D="",ie!=null&&(D=ie.replace(te,"$&/")+"/"),Te(q,W,D,"",function(Me){return Me})):q!=null&&(L(q)&&(q=Y(q,D+(q.key==null||N&&N.key===q.key?"":(""+q.key).replace(te,"$&/")+"/")+ie)),W.push(q)),1;ie=0;var ye=J===""?".":J+":";if(U(N))for(var Ae=0;Ae<N.length;Ae++)J=N[Ae],G=ye+ee(J,Ae),ie+=Te(J,W,D,G,q);else if(Ae=_(N),typeof Ae=="function")for(N=Ae.call(N),Ae=0;!(J=N.next()).done;)J=J.value,G=ye+ee(J,Ae++),ie+=Te(J,W,D,G,q);else if(G==="object"){if(typeof N.then=="function")return Te(De(N),W,D,J,q);throw W=String(N),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return ie}function re(N,W,D){if(N==null)return N;var J=[],q=0;return Te(N,J,"","",function(G){return W.call(D,G,q++)}),J}function ce(N){if(N._status===-1){var W=N._result;W=W(),W.then(function(D){(N._status===0||N._status===-1)&&(N._status=1,N._result=D)},function(D){(N._status===0||N._status===-1)&&(N._status=2,N._result=D)}),N._status===-1&&(N._status=0,N._result=W)}if(N._status===1)return N._result.default;throw N._result}var ne=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function j(){}return ct.Children={map:re,forEach:function(N,W,D){re(N,function(){W.apply(this,arguments)},D)},count:function(N){var W=0;return re(N,function(){W++}),W},toArray:function(N){return re(N,function(W){return W})||[]},only:function(N){if(!L(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},ct.Component=w,ct.Fragment=n,ct.Profiler=a,ct.PureComponent=k,ct.StrictMode=r,ct.Suspense=p,ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,ct.__COMPILER_RUNTIME={__proto__:null,c:function(N){return B.H.useMemoCache(N)}},ct.cache=function(N){return function(){return N.apply(null,arguments)}},ct.cloneElement=function(N,W,D){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var J=S({},N.props),q=N.key,G=void 0;if(W!=null)for(ie in W.ref!==void 0&&(G=void 0),W.key!==void 0&&(q=""+W.key),W)!X.call(W,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&W.ref===void 0||(J[ie]=W[ie]);var ie=arguments.length-2;if(ie===1)J.children=D;else if(1<ie){for(var ye=Array(ie),Ae=0;Ae<ie;Ae++)ye[Ae]=arguments[Ae+2];J.children=ye}return F(N.type,q,void 0,void 0,G,J)},ct.createContext=function(N){return N={$$typeof:c,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:o,_context:N},N},ct.createElement=function(N,W,D){var J,q={},G=null;if(W!=null)for(J in W.key!==void 0&&(G=""+W.key),W)X.call(W,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(q[J]=W[J]);var ie=arguments.length-2;if(ie===1)q.children=D;else if(1<ie){for(var ye=Array(ie),Ae=0;Ae<ie;Ae++)ye[Ae]=arguments[Ae+2];q.children=ye}if(N&&N.defaultProps)for(J in ie=N.defaultProps,ie)q[J]===void 0&&(q[J]=ie[J]);return F(N,G,void 0,void 0,null,q)},ct.createRef=function(){return{current:null}},ct.forwardRef=function(N){return{$$typeof:u,render:N}},ct.isValidElement=L,ct.lazy=function(N){return{$$typeof:g,_payload:{_status:-1,_result:N},_init:ce}},ct.memo=function(N,W){return{$$typeof:h,type:N,compare:W===void 0?null:W}},ct.startTransition=function(N){var W=B.T,D={};B.T=D;try{var J=N(),q=B.S;q!==null&&q(D,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(j,ne)}catch(G){ne(G)}finally{B.T=W}},ct.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},ct.use=function(N){return B.H.use(N)},ct.useActionState=function(N,W,D){return B.H.useActionState(N,W,D)},ct.useCallback=function(N,W){return B.H.useCallback(N,W)},ct.useContext=function(N){return B.H.useContext(N)},ct.useDebugValue=function(){},ct.useDeferredValue=function(N,W){return B.H.useDeferredValue(N,W)},ct.useEffect=function(N,W,D){var J=B.H;if(typeof D=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return J.useEffect(N,W)},ct.useId=function(){return B.H.useId()},ct.useImperativeHandle=function(N,W,D){return B.H.useImperativeHandle(N,W,D)},ct.useInsertionEffect=function(N,W){return B.H.useInsertionEffect(N,W)},ct.useLayoutEffect=function(N,W){return B.H.useLayoutEffect(N,W)},ct.useMemo=function(N,W){return B.H.useMemo(N,W)},ct.useOptimistic=function(N,W){return B.H.useOptimistic(N,W)},ct.useReducer=function(N,W,D){return B.H.useReducer(N,W,D)},ct.useRef=function(N){return B.H.useRef(N)},ct.useState=function(N){return B.H.useState(N)},ct.useSyncExternalStore=function(N,W,D){return B.H.useSyncExternalStore(N,W,D)},ct.useTransition=function(){return B.H.useTransition()},ct.version="19.1.0",ct}var Ix;function ch(){return Ix||(Ix=1,ud.exports=ES()),ud.exports}var ge=ch();const so=Oy(ge);var fd={exports:{}},gl={},dd={exports:{}},hd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fx;function SS(){return Fx||(Fx=1,function(e){function t(re,ce){var ne=re.length;re.push(ce);e:for(;0<ne;){var j=ne-1>>>1,N=re[j];if(0<a(N,ce))re[j]=ce,re[ne]=N,ne=j;else break e}}function n(re){return re.length===0?null:re[0]}function r(re){if(re.length===0)return null;var ce=re[0],ne=re.pop();if(ne!==ce){re[0]=ne;e:for(var j=0,N=re.length,W=N>>>1;j<W;){var D=2*(j+1)-1,J=re[D],q=D+1,G=re[q];if(0>a(J,ne))q<N&&0>a(G,J)?(re[j]=G,re[q]=ne,j=q):(re[j]=J,re[D]=ne,j=D);else if(q<N&&0>a(G,ne))re[j]=G,re[q]=ne,j=q;else break e}}return ce}function a(re,ce){var ne=re.sortIndex-ce.sortIndex;return ne!==0?ne:re.id-ce.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var p=[],h=[],g=1,y=null,_=3,E=!1,S=!1,C=!1,w=!1,M=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function U(re){for(var ce=n(h);ce!==null;){if(ce.callback===null)r(h);else if(ce.startTime<=re)r(h),ce.sortIndex=ce.expirationTime,t(p,ce);else break;ce=n(h)}}function B(re){if(C=!1,U(re),!S)if(n(p)!==null)S=!0,X||(X=!0,ee());else{var ce=n(h);ce!==null&&Te(B,ce.startTime-re)}}var X=!1,F=-1,Y=5,L=-1;function Q(){return w?!0:!(e.unstable_now()-L<Y)}function te(){if(w=!1,X){var re=e.unstable_now();L=re;var ce=!0;try{e:{S=!1,C&&(C=!1,k(F),F=-1),E=!0;var ne=_;try{t:{for(U(re),y=n(p);y!==null&&!(y.expirationTime>re&&Q());){var j=y.callback;if(typeof j=="function"){y.callback=null,_=y.priorityLevel;var N=j(y.expirationTime<=re);if(re=e.unstable_now(),typeof N=="function"){y.callback=N,U(re),ce=!0;break t}y===n(p)&&r(p),U(re)}else r(p);y=n(p)}if(y!==null)ce=!0;else{var W=n(h);W!==null&&Te(B,W.startTime-re),ce=!1}}break e}finally{y=null,_=ne,E=!1}ce=void 0}}finally{ce?ee():X=!1}}}var ee;if(typeof b=="function")ee=function(){b(te)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,De=_e.port2;_e.port1.onmessage=te,ee=function(){De.postMessage(null)}}else ee=function(){M(te,0)};function Te(re,ce){F=M(function(){re(e.unstable_now())},ce)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_next=function(re){switch(_){case 1:case 2:case 3:var ce=3;break;default:ce=_}var ne=_;_=ce;try{return re()}finally{_=ne}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(re,ce){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var ne=_;_=re;try{return ce()}finally{_=ne}},e.unstable_scheduleCallback=function(re,ce,ne){var j=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?j+ne:j):ne=j,re){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=ne+N,re={id:g++,callback:ce,priorityLevel:re,startTime:ne,expirationTime:N,sortIndex:-1},ne>j?(re.sortIndex=ne,t(h,re),n(p)===null&&re===n(h)&&(C?(k(F),F=-1):C=!0,Te(B,ne-j))):(re.sortIndex=N,t(p,re),S||E||(S=!0,X||(X=!0,ee()))),re},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(re){var ce=_;return function(){var ne=_;_=ce;try{return re.apply(this,arguments)}finally{_=ne}}}}(hd)),hd}var Lx;function CS(){return Lx||(Lx=1,dd.exports=SS()),dd.exports}var md={exports:{}},Pn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ox;function wS(){if(Ox)return Pn;Ox=1;var e=ch();function t(p){var h="https://react.dev/errors/"+p;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+p+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(p,h,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:p,containerInfo:h,implementation:g}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(p,h){if(p==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Pn.createPortal=function(p,h){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return o(p,h,null,g)},Pn.flushSync=function(p){var h=c.T,g=r.p;try{if(c.T=null,r.p=2,p)return p()}finally{c.T=h,r.p=g,r.d.f()}},Pn.preconnect=function(p,h){typeof p=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(p,h))},Pn.prefetchDNS=function(p){typeof p=="string"&&r.d.D(p)},Pn.preinit=function(p,h){if(typeof p=="string"&&h&&typeof h.as=="string"){var g=h.as,y=u(g,h.crossOrigin),_=typeof h.integrity=="string"?h.integrity:void 0,E=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;g==="style"?r.d.S(p,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:E}):g==="script"&&r.d.X(p,{crossOrigin:y,integrity:_,fetchPriority:E,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Pn.preinitModule=function(p,h){if(typeof p=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var g=u(h.as,h.crossOrigin);r.d.M(p,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(p)},Pn.preload=function(p,h){if(typeof p=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var g=h.as,y=u(g,h.crossOrigin);r.d.L(p,g,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Pn.preloadModule=function(p,h){if(typeof p=="string")if(h){var g=u(h.as,h.crossOrigin);r.d.m(p,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(p)},Pn.requestFormReset=function(p){r.d.r(p)},Pn.unstable_batchedUpdates=function(p,h){return p(h)},Pn.useFormState=function(p,h,g){return c.H.useFormState(p,h,g)},Pn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Pn.version="19.1.0",Pn}var Px;function AS(){if(Px)return md.exports;Px=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),md.exports=wS(),md.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ux;function bS(){if(Ux)return gl;Ux=1;var e=CS(),t=ch(),n=AS();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,l=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(l=s.return),i=s.return;while(i)}return s.tag===3?l:null}function c(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(o(i)!==i)throw Error(r(188))}function p(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(r(188));return s!==i?null:i}for(var l=i,m=s;;){var x=l.return;if(x===null)break;var T=x.alternate;if(T===null){if(m=x.return,m!==null){l=m;continue}break}if(x.child===T.child){for(T=x.child;T;){if(T===l)return u(x),i;if(T===m)return u(x),s;T=T.sibling}throw Error(r(188))}if(l.return!==m.return)l=x,m=T;else{for(var A=!1,I=x.child;I;){if(I===l){A=!0,l=x,m=T;break}if(I===m){A=!0,m=x,l=T;break}I=I.sibling}if(!A){for(I=T.child;I;){if(I===l){A=!0,l=T,m=x;break}if(I===m){A=!0,m=T,l=x;break}I=I.sibling}if(!A)throw Error(r(189))}}if(l.alternate!==m)throw Error(r(190))}if(l.tag!==3)throw Error(r(188));return l.stateNode.current===l?i:s}function h(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=h(i),s!==null)return s;i=i.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),b=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function ee(i){return i===null||typeof i!="object"?null:(i=te&&i[te]||i["@@iterator"],typeof i=="function"?i:null)}var _e=Symbol.for("react.client.reference");function De(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===_e?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case S:return"Fragment";case w:return"Profiler";case C:return"StrictMode";case B:return"Suspense";case X:return"SuspenseList";case L:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case b:return(i.displayName||"Context")+".Provider";case k:return(i._context.displayName||"Context")+".Consumer";case U:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case F:return s=i.displayName||null,s!==null?s:De(i.type)||"Memo";case Y:s=i._payload,i=i._init;try{return De(i(s))}catch{}}return null}var Te=Array.isArray,re=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},j=[],N=-1;function W(i){return{current:i}}function D(i){0>N||(i.current=j[N],j[N]=null,N--)}function J(i,s){N++,j[N]=i.current,i.current=s}var q=W(null),G=W(null),ie=W(null),ye=W(null);function Ae(i,s){switch(J(ie,s),J(G,i),J(q,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?ax(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=ax(s),i=ix(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}D(q),J(q,i)}function Me(){D(q),D(G),D(ie)}function Ee(i){i.memoizedState!==null&&J(ye,i);var s=q.current,l=ix(s,i.type);s!==l&&(J(G,i),J(q,l))}function Ze(i){G.current===i&&(D(q),D(G)),ye.current===i&&(D(ye),ul._currentValue=ne)}var K=Object.prototype.hasOwnProperty,ut=e.unstable_scheduleCallback,We=e.unstable_cancelCallback,ht=e.unstable_shouldYield,Ne=e.unstable_requestPaint,xe=e.unstable_now,He=e.unstable_getCurrentPriorityLevel,je=e.unstable_ImmediatePriority,Mt=e.unstable_UserBlockingPriority,_t=e.unstable_NormalPriority,Xt=e.unstable_LowPriority,an=e.unstable_IdlePriority,Qt=e.log,An=e.unstable_setDisableYieldValue,Vt=null,Gt=null;function be(i){if(typeof Qt=="function"&&An(i),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(Vt,i)}catch{}}var Ge=Math.clz32?Math.clz32:et,Ce=Math.log,Be=Math.LN2;function et(i){return i>>>=0,i===0?32:31-(Ce(i)/Be|0)|0}var Oe=256,mt=4194304;function bn(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Qr(i,s,l){var m=i.pendingLanes;if(m===0)return 0;var x=0,T=i.suspendedLanes,A=i.pingedLanes;i=i.warmLanes;var I=m&134217727;return I!==0?(m=I&~T,m!==0?x=bn(m):(A&=I,A!==0?x=bn(A):l||(l=I&~i,l!==0&&(x=bn(l))))):(I=m&~T,I!==0?x=bn(I):A!==0?x=bn(A):l||(l=m&~i,l!==0&&(x=bn(l)))),x===0?0:s!==0&&s!==x&&(s&T)===0&&(T=x&-x,l=s&-s,T>=l||T===32&&(l&4194048)!==0)?s:x}function pa(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function ds(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ci(){var i=Oe;return Oe<<=1,(Oe&4194048)===0&&(Oe=256),i}function wi(){var i=mt;return mt<<=1,(mt&62914560)===0&&(mt=4194304),i}function Ai(i){for(var s=[],l=0;31>l;l++)s.push(i);return s}function Pe(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function lt(i,s,l,m,x,T){var A=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var I=i.entanglements,Z=i.expirationTimes,ue=i.hiddenUpdates;for(l=A&~l;0<l;){var Se=31-Ge(l),ke=1<<Se;I[Se]=0,Z[Se]=-1;var he=ue[Se];if(he!==null)for(ue[Se]=null,Se=0;Se<he.length;Se++){var pe=he[Se];pe!==null&&(pe.lane&=-536870913)}l&=~ke}m!==0&&vt(i,m,0),T!==0&&x===0&&i.tag!==0&&(i.suspendedLanes|=T&~(A&~s))}function vt(i,s,l){i.pendingLanes|=s,i.suspendedLanes&=~s;var m=31-Ge(s);i.entangledLanes|=s,i.entanglements[m]=i.entanglements[m]|1073741824|l&4194090}function cn(i,s){var l=i.entangledLanes|=s;for(i=i.entanglements;l;){var m=31-Ge(l),x=1<<m;x&s|i[m]&s&&(i[m]|=s),l&=~x}}function Ln(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function kn(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ea(){var i=ce.p;return i!==0?i:(i=window.event,i===void 0?32:Cx(i.type))}function bi(i,s){var l=ce.p;try{return ce.p=i,s()}finally{ce.p=l}}var Yn=Math.random().toString(36).slice(2),Wt="__reactFiber$"+Yn,Kt="__reactProps$"+Yn,yr="__reactContainer$"+Yn,ga="__reactEvents$"+Yn,hs="__reactListeners$"+Yn,R="__reactHandles$"+Yn,H="__reactResources$"+Yn,O="__reactMarker$"+Yn;function P(i){delete i[Wt],delete i[Kt],delete i[ga],delete i[hs],delete i[R]}function V(i){var s=i[Wt];if(s)return s;for(var l=i.parentNode;l;){if(s=l[yr]||l[Wt]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(i=cx(i);i!==null;){if(l=i[Wt])return l;i=cx(i)}return s}i=l,l=i.parentNode}return null}function z(i){if(i=i[Wt]||i[yr]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function fe(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function ve(i){var s=i[H];return s||(s=i[H]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function oe(i){i[O]=!0}var de=new Set,me={};function Re(i,s){Le(i,s),Le(i+"Capture",s)}function Le(i,s){for(me[i]=s,i=0;i<s.length;i++)de.add(s[i])}var ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ie={},Ue={};function at(i){return K.call(Ue,i)?!0:K.call(Ie,i)?!1:ze.test(i)?Ue[i]=!0:(Ie[i]=!0,!1)}function Ft(i,s,l){if(at(s))if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var m=s.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+l)}}function Lt(i,s,l){if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+l)}}function zt(i,s,l,m){if(m===null)i.removeAttribute(l);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(s,l,""+m)}}var xa,Ga;function Tr(i){if(xa===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);xa=s&&s[1]||"",Ga=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xa+i+Ga}var Gr=!1;function ki(i,s){if(!i||Gr)return"";Gr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(s){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(pe){var he=pe}Reflect.construct(i,[],ke)}else{try{ke.call()}catch(pe){he=pe}i.call(ke.prototype)}}else{try{throw Error()}catch(pe){he=pe}(ke=i())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(pe){if(pe&&he&&typeof pe.stack=="string")return[pe.stack,he.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=m.DetermineComponentFrameRoot(),A=T[0],I=T[1];if(A&&I){var Z=A.split(`
`),ue=I.split(`
`);for(x=m=0;m<Z.length&&!Z[m].includes("DetermineComponentFrameRoot");)m++;for(;x<ue.length&&!ue[x].includes("DetermineComponentFrameRoot");)x++;if(m===Z.length||x===ue.length)for(m=Z.length-1,x=ue.length-1;1<=m&&0<=x&&Z[m]!==ue[x];)x--;for(;1<=m&&0<=x;m--,x--)if(Z[m]!==ue[x]){if(m!==1||x!==1)do if(m--,x--,0>x||Z[m]!==ue[x]){var Se=`
`+Z[m].replace(" at new "," at ");return i.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",i.displayName)),Se}while(1<=m&&0<=x);break}}}finally{Gr=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?Tr(l):""}function Hr(i){switch(i.tag){case 26:case 27:case 5:return Tr(i.type);case 16:return Tr("Lazy");case 13:return Tr("Suspense");case 19:return Tr("SuspenseList");case 0:case 15:return ki(i.type,!1);case 11:return ki(i.type.render,!1);case 1:return ki(i.type,!0);case 31:return Tr("Activity");default:return""}}function Zh(i){try{var s="";do s+=Hr(i),i=i.return;while(i);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function _r(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Qh(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function p_(i){var s=Qh(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),m=""+i[s];if(!i.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var x=l.get,T=l.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return x.call(this)},set:function(A){m=""+A,T.call(this,A)}}),Object.defineProperty(i,s,{enumerable:l.enumerable}),{getValue:function(){return m},setValue:function(A){m=""+A},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function nc(i){i._valueTracker||(i._valueTracker=p_(i))}function em(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var l=s.getValue(),m="";return i&&(m=Qh(i)?i.checked?"true":"false":i.value),i=m,i!==l?(s.setValue(i),!0):!1}function rc(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var g_=/[\n"\\]/g;function Er(i){return i.replace(g_,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function sf(i,s,l,m,x,T,A,I){i.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.type=A:i.removeAttribute("type"),s!=null?A==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+_r(s)):i.value!==""+_r(s)&&(i.value=""+_r(s)):A!=="submit"&&A!=="reset"||i.removeAttribute("value"),s!=null?of(i,A,_r(s)):l!=null?of(i,A,_r(l)):m!=null&&i.removeAttribute("value"),x==null&&T!=null&&(i.defaultChecked=!!T),x!=null&&(i.checked=x&&typeof x!="function"&&typeof x!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?i.name=""+_r(I):i.removeAttribute("name")}function tm(i,s,l,m,x,T,A,I){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.type=T),s!=null||l!=null){if(!(T!=="submit"&&T!=="reset"||s!=null))return;l=l!=null?""+_r(l):"",s=s!=null?""+_r(s):l,I||s===i.value||(i.value=s),i.defaultValue=s}m=m??x,m=typeof m!="function"&&typeof m!="symbol"&&!!m,i.checked=I?i.checked:!!m,i.defaultChecked=!!m,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.name=A)}function of(i,s,l){s==="number"&&rc(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function ms(i,s,l,m){if(i=i.options,s){s={};for(var x=0;x<l.length;x++)s["$"+l[x]]=!0;for(l=0;l<i.length;l++)x=s.hasOwnProperty("$"+i[l].value),i[l].selected!==x&&(i[l].selected=x),x&&m&&(i[l].defaultSelected=!0)}else{for(l=""+_r(l),s=null,x=0;x<i.length;x++){if(i[x].value===l){i[x].selected=!0,m&&(i[x].defaultSelected=!0);return}s!==null||i[x].disabled||(s=i[x])}s!==null&&(s.selected=!0)}}function nm(i,s,l){if(s!=null&&(s=""+_r(s),s!==i.value&&(i.value=s),l==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=l!=null?""+_r(l):""}function rm(i,s,l,m){if(s==null){if(m!=null){if(l!=null)throw Error(r(92));if(Te(m)){if(1<m.length)throw Error(r(93));m=m[0]}l=m}l==null&&(l=""),s=l}l=_r(s),i.defaultValue=l,m=i.textContent,m===l&&m!==""&&m!==null&&(i.value=m)}function ps(i,s){if(s){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=s;return}}i.textContent=s}var x_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function am(i,s,l){var m=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?m?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":m?i.setProperty(s,l):typeof l!="number"||l===0||x_.has(s)?s==="float"?i.cssFloat=l:i[s]=(""+l).trim():i[s]=l+"px"}function im(i,s,l){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,l!=null){for(var m in l)!l.hasOwnProperty(m)||s!=null&&s.hasOwnProperty(m)||(m.indexOf("--")===0?i.setProperty(m,""):m==="float"?i.cssFloat="":i[m]="");for(var x in s)m=s[x],s.hasOwnProperty(x)&&l[x]!==m&&am(i,x,m)}else for(var T in s)s.hasOwnProperty(T)&&am(i,T,s[T])}function lf(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var v_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),y_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ac(i){return y_.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var cf=null;function uf(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var gs=null,xs=null;function sm(i){var s=z(i);if(s&&(i=s.stateNode)){var l=i[Kt]||null;e:switch(i=s.stateNode,s.type){case"input":if(sf(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Er(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var m=l[s];if(m!==i&&m.form===i.form){var x=m[Kt]||null;if(!x)throw Error(r(90));sf(m,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(s=0;s<l.length;s++)m=l[s],m.form===i.form&&em(m)}break e;case"textarea":nm(i,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&ms(i,!!l.multiple,s,!1)}}}var ff=!1;function om(i,s,l){if(ff)return i(s,l);ff=!0;try{var m=i(s);return m}finally{if(ff=!1,(gs!==null||xs!==null)&&(zc(),gs&&(s=gs,i=xs,xs=gs=null,sm(s),i)))for(s=0;s<i.length;s++)sm(i[s])}}function So(i,s){var l=i.stateNode;if(l===null)return null;var m=l[Kt]||null;if(m===null)return null;l=m[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(i=i.type,m=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!m;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(r(231,s,typeof l));return l}var va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),df=!1;if(va)try{var Co={};Object.defineProperty(Co,"passive",{get:function(){df=!0}}),window.addEventListener("test",Co,Co),window.removeEventListener("test",Co,Co)}catch{df=!1}var Ha=null,hf=null,ic=null;function lm(){if(ic)return ic;var i,s=hf,l=s.length,m,x="value"in Ha?Ha.value:Ha.textContent,T=x.length;for(i=0;i<l&&s[i]===x[i];i++);var A=l-i;for(m=1;m<=A&&s[l-m]===x[T-m];m++);return ic=x.slice(i,1<m?1-m:void 0)}function sc(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function oc(){return!0}function cm(){return!1}function er(i){function s(l,m,x,T,A){this._reactName=l,this._targetInst=x,this.type=m,this.nativeEvent=T,this.target=A,this.currentTarget=null;for(var I in i)i.hasOwnProperty(I)&&(l=i[I],this[I]=l?l(T):T[I]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?oc:cm,this.isPropagationStopped=cm,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=oc)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=oc)},persist:function(){},isPersistent:oc}),s}var Ni={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lc=er(Ni),wo=g({},Ni,{view:0,detail:0}),T_=er(wo),mf,pf,Ao,cc=g({},wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xf,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ao&&(Ao&&i.type==="mousemove"?(mf=i.screenX-Ao.screenX,pf=i.screenY-Ao.screenY):pf=mf=0,Ao=i),mf)},movementY:function(i){return"movementY"in i?i.movementY:pf}}),um=er(cc),__=g({},cc,{dataTransfer:0}),E_=er(__),S_=g({},wo,{relatedTarget:0}),gf=er(S_),C_=g({},Ni,{animationName:0,elapsedTime:0,pseudoElement:0}),w_=er(C_),A_=g({},Ni,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),b_=er(A_),k_=g({},Ni,{data:0}),fm=er(k_),N_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},M_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},R_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function D_(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=R_[i])?!!s[i]:!1}function xf(){return D_}var I_=g({},wo,{key:function(i){if(i.key){var s=N_[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=sc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?M_[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xf,charCode:function(i){return i.type==="keypress"?sc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?sc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),F_=er(I_),L_=g({},cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dm=er(L_),O_=g({},wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xf}),P_=er(O_),U_=g({},Ni,{propertyName:0,elapsedTime:0,pseudoElement:0}),B_=er(U_),V_=g({},cc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),G_=er(V_),H_=g({},Ni,{newState:0,oldState:0}),z_=er(H_),j_=[9,13,27,32],vf=va&&"CompositionEvent"in window,bo=null;va&&"documentMode"in document&&(bo=document.documentMode);var q_=va&&"TextEvent"in window&&!bo,hm=va&&(!vf||bo&&8<bo&&11>=bo),mm=" ",pm=!1;function gm(i,s){switch(i){case"keyup":return j_.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xm(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var vs=!1;function Y_(i,s){switch(i){case"compositionend":return xm(s);case"keypress":return s.which!==32?null:(pm=!0,mm);case"textInput":return i=s.data,i===mm&&pm?null:i;default:return null}}function $_(i,s){if(vs)return i==="compositionend"||!vf&&gm(i,s)?(i=lm(),ic=hf=Ha=null,vs=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return hm&&s.locale!=="ko"?null:s.data;default:return null}}var J_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vm(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!J_[i.type]:s==="textarea"}function ym(i,s,l,m){gs?xs?xs.push(m):xs=[m]:gs=m,s=Xc(s,"onChange"),0<s.length&&(l=new lc("onChange","change",null,l,m),i.push({event:l,listeners:s}))}var ko=null,No=null;function X_(i){Qg(i,0)}function uc(i){var s=fe(i);if(em(s))return i}function Tm(i,s){if(i==="change")return s}var _m=!1;if(va){var yf;if(va){var Tf="oninput"in document;if(!Tf){var Em=document.createElement("div");Em.setAttribute("oninput","return;"),Tf=typeof Em.oninput=="function"}yf=Tf}else yf=!1;_m=yf&&(!document.documentMode||9<document.documentMode)}function Sm(){ko&&(ko.detachEvent("onpropertychange",Cm),No=ko=null)}function Cm(i){if(i.propertyName==="value"&&uc(No)){var s=[];ym(s,No,i,uf(i)),om(X_,s)}}function W_(i,s,l){i==="focusin"?(Sm(),ko=s,No=l,ko.attachEvent("onpropertychange",Cm)):i==="focusout"&&Sm()}function K_(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return uc(No)}function Z_(i,s){if(i==="click")return uc(s)}function Q_(i,s){if(i==="input"||i==="change")return uc(s)}function eE(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var or=typeof Object.is=="function"?Object.is:eE;function Mo(i,s){if(or(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var l=Object.keys(i),m=Object.keys(s);if(l.length!==m.length)return!1;for(m=0;m<l.length;m++){var x=l[m];if(!K.call(s,x)||!or(i[x],s[x]))return!1}return!0}function wm(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Am(i,s){var l=wm(i);i=0;for(var m;l;){if(l.nodeType===3){if(m=i+l.textContent.length,i<=s&&m>=s)return{node:l,offset:s-i};i=m}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=wm(l)}}function bm(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?bm(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function km(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=rc(i.document);s instanceof i.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)i=s.contentWindow;else break;s=rc(i.document)}return s}function _f(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var tE=va&&"documentMode"in document&&11>=document.documentMode,ys=null,Ef=null,Ro=null,Sf=!1;function Nm(i,s,l){var m=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Sf||ys==null||ys!==rc(m)||(m=ys,"selectionStart"in m&&_f(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Ro&&Mo(Ro,m)||(Ro=m,m=Xc(Ef,"onSelect"),0<m.length&&(s=new lc("onSelect","select",null,s,l),i.push({event:s,listeners:m}),s.target=ys)))}function Mi(i,s){var l={};return l[i.toLowerCase()]=s.toLowerCase(),l["Webkit"+i]="webkit"+s,l["Moz"+i]="moz"+s,l}var Ts={animationend:Mi("Animation","AnimationEnd"),animationiteration:Mi("Animation","AnimationIteration"),animationstart:Mi("Animation","AnimationStart"),transitionrun:Mi("Transition","TransitionRun"),transitionstart:Mi("Transition","TransitionStart"),transitioncancel:Mi("Transition","TransitionCancel"),transitionend:Mi("Transition","TransitionEnd")},Cf={},Mm={};va&&(Mm=document.createElement("div").style,"AnimationEvent"in window||(delete Ts.animationend.animation,delete Ts.animationiteration.animation,delete Ts.animationstart.animation),"TransitionEvent"in window||delete Ts.transitionend.transition);function Ri(i){if(Cf[i])return Cf[i];if(!Ts[i])return i;var s=Ts[i],l;for(l in s)if(s.hasOwnProperty(l)&&l in Mm)return Cf[i]=s[l];return i}var Rm=Ri("animationend"),Dm=Ri("animationiteration"),Im=Ri("animationstart"),nE=Ri("transitionrun"),rE=Ri("transitionstart"),aE=Ri("transitioncancel"),Fm=Ri("transitionend"),Lm=new Map,wf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wf.push("scrollEnd");function zr(i,s){Lm.set(i,s),Re(s,[i])}var Om=new WeakMap;function Sr(i,s){if(typeof i=="object"&&i!==null){var l=Om.get(i);return l!==void 0?l:(s={value:i,source:s,stack:Zh(s)},Om.set(i,s),s)}return{value:i,source:s,stack:Zh(s)}}var Cr=[],_s=0,Af=0;function fc(){for(var i=_s,s=Af=_s=0;s<i;){var l=Cr[s];Cr[s++]=null;var m=Cr[s];Cr[s++]=null;var x=Cr[s];Cr[s++]=null;var T=Cr[s];if(Cr[s++]=null,m!==null&&x!==null){var A=m.pending;A===null?x.next=x:(x.next=A.next,A.next=x),m.pending=x}T!==0&&Pm(l,x,T)}}function dc(i,s,l,m){Cr[_s++]=i,Cr[_s++]=s,Cr[_s++]=l,Cr[_s++]=m,Af|=m,i.lanes|=m,i=i.alternate,i!==null&&(i.lanes|=m)}function bf(i,s,l,m){return dc(i,s,l,m),hc(i)}function Es(i,s){return dc(i,null,null,s),hc(i)}function Pm(i,s,l){i.lanes|=l;var m=i.alternate;m!==null&&(m.lanes|=l);for(var x=!1,T=i.return;T!==null;)T.childLanes|=l,m=T.alternate,m!==null&&(m.childLanes|=l),T.tag===22&&(i=T.stateNode,i===null||i._visibility&1||(x=!0)),i=T,T=T.return;return i.tag===3?(T=i.stateNode,x&&s!==null&&(x=31-Ge(l),i=T.hiddenUpdates,m=i[x],m===null?i[x]=[s]:m.push(s),s.lane=l|536870912),T):null}function hc(i){if(50<nl)throw nl=0,I0=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Ss={};function iE(i,s,l,m){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lr(i,s,l,m){return new iE(i,s,l,m)}function kf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ya(i,s){var l=i.alternate;return l===null?(l=lr(i.tag,s,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=s,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,s=i.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function Um(i,s){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,s=l.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function mc(i,s,l,m,x,T){var A=0;if(m=i,typeof i=="function")kf(i)&&(A=1);else if(typeof i=="string")A=oS(i,l,q.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case L:return i=lr(31,l,s,x),i.elementType=L,i.lanes=T,i;case S:return Di(l.children,x,T,s);case C:A=8,x|=24;break;case w:return i=lr(12,l,s,x|2),i.elementType=w,i.lanes=T,i;case B:return i=lr(13,l,s,x),i.elementType=B,i.lanes=T,i;case X:return i=lr(19,l,s,x),i.elementType=X,i.lanes=T,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case M:case b:A=10;break e;case k:A=9;break e;case U:A=11;break e;case F:A=14;break e;case Y:A=16,m=null;break e}A=29,l=Error(r(130,i===null?"null":typeof i,"")),m=null}return s=lr(A,l,s,x),s.elementType=i,s.type=m,s.lanes=T,s}function Di(i,s,l,m){return i=lr(7,i,m,s),i.lanes=l,i}function Nf(i,s,l){return i=lr(6,i,null,s),i.lanes=l,i}function Mf(i,s,l){return s=lr(4,i.children!==null?i.children:[],i.key,s),s.lanes=l,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Cs=[],ws=0,pc=null,gc=0,wr=[],Ar=0,Ii=null,Ta=1,_a="";function Fi(i,s){Cs[ws++]=gc,Cs[ws++]=pc,pc=i,gc=s}function Bm(i,s,l){wr[Ar++]=Ta,wr[Ar++]=_a,wr[Ar++]=Ii,Ii=i;var m=Ta;i=_a;var x=32-Ge(m)-1;m&=~(1<<x),l+=1;var T=32-Ge(s)+x;if(30<T){var A=x-x%5;T=(m&(1<<A)-1).toString(32),m>>=A,x-=A,Ta=1<<32-Ge(s)+x|l<<x|m,_a=T+i}else Ta=1<<T|l<<x|m,_a=i}function Rf(i){i.return!==null&&(Fi(i,1),Bm(i,1,0))}function Df(i){for(;i===pc;)pc=Cs[--ws],Cs[ws]=null,gc=Cs[--ws],Cs[ws]=null;for(;i===Ii;)Ii=wr[--Ar],wr[Ar]=null,_a=wr[--Ar],wr[Ar]=null,Ta=wr[--Ar],wr[Ar]=null}var $n=null,en=null,Nt=!1,Li=null,ta=!1,If=Error(r(519));function Oi(i){var s=Error(r(418,""));throw Fo(Sr(s,i)),If}function Vm(i){var s=i.stateNode,l=i.type,m=i.memoizedProps;switch(s[Wt]=i,s[Kt]=m,l){case"dialog":xt("cancel",s),xt("close",s);break;case"iframe":case"object":case"embed":xt("load",s);break;case"video":case"audio":for(l=0;l<al.length;l++)xt(al[l],s);break;case"source":xt("error",s);break;case"img":case"image":case"link":xt("error",s),xt("load",s);break;case"details":xt("toggle",s);break;case"input":xt("invalid",s),tm(s,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),nc(s);break;case"select":xt("invalid",s);break;case"textarea":xt("invalid",s),rm(s,m.value,m.defaultValue,m.children),nc(s)}l=m.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||m.suppressHydrationWarning===!0||rx(s.textContent,l)?(m.popover!=null&&(xt("beforetoggle",s),xt("toggle",s)),m.onScroll!=null&&xt("scroll",s),m.onScrollEnd!=null&&xt("scrollend",s),m.onClick!=null&&(s.onclick=Wc),s=!0):s=!1,s||Oi(i)}function Gm(i){for($n=i.return;$n;)switch($n.tag){case 5:case 13:ta=!1;return;case 27:case 3:ta=!0;return;default:$n=$n.return}}function Do(i){if(i!==$n)return!1;if(!Nt)return Gm(i),Nt=!0,!1;var s=i.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||X0(i.type,i.memoizedProps)),l=!l),l&&en&&Oi(i),Gm(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(l=i.data,l==="/$"){if(s===0){en=qr(i.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;i=i.nextSibling}en=null}}else s===27?(s=en,ai(i.type)?(i=Q0,Q0=null,en=i):en=s):en=$n?qr(i.stateNode.nextSibling):null;return!0}function Io(){en=$n=null,Nt=!1}function Hm(){var i=Li;return i!==null&&(rr===null?rr=i:rr.push.apply(rr,i),Li=null),i}function Fo(i){Li===null?Li=[i]:Li.push(i)}var Ff=W(null),Pi=null,Ea=null;function za(i,s,l){J(Ff,s._currentValue),s._currentValue=l}function Sa(i){i._currentValue=Ff.current,D(Ff)}function Lf(i,s,l){for(;i!==null;){var m=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,m!==null&&(m.childLanes|=s)):m!==null&&(m.childLanes&s)!==s&&(m.childLanes|=s),i===l)break;i=i.return}}function Of(i,s,l,m){var x=i.child;for(x!==null&&(x.return=i);x!==null;){var T=x.dependencies;if(T!==null){var A=x.child;T=T.firstContext;e:for(;T!==null;){var I=T;T=x;for(var Z=0;Z<s.length;Z++)if(I.context===s[Z]){T.lanes|=l,I=T.alternate,I!==null&&(I.lanes|=l),Lf(T.return,l,i),m||(A=null);break e}T=I.next}}else if(x.tag===18){if(A=x.return,A===null)throw Error(r(341));A.lanes|=l,T=A.alternate,T!==null&&(T.lanes|=l),Lf(A,l,i),A=null}else A=x.child;if(A!==null)A.return=x;else for(A=x;A!==null;){if(A===i){A=null;break}if(x=A.sibling,x!==null){x.return=A.return,A=x;break}A=A.return}x=A}}function Lo(i,s,l,m){i=null;for(var x=s,T=!1;x!==null;){if(!T){if((x.flags&524288)!==0)T=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var A=x.alternate;if(A===null)throw Error(r(387));if(A=A.memoizedProps,A!==null){var I=x.type;or(x.pendingProps.value,A.value)||(i!==null?i.push(I):i=[I])}}else if(x===ye.current){if(A=x.alternate,A===null)throw Error(r(387));A.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(i!==null?i.push(ul):i=[ul])}x=x.return}i!==null&&Of(s,i,l,m),s.flags|=262144}function xc(i){for(i=i.firstContext;i!==null;){if(!or(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Ui(i){Pi=i,Ea=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function On(i){return zm(Pi,i)}function vc(i,s){return Pi===null&&Ui(i),zm(i,s)}function zm(i,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},Ea===null){if(i===null)throw Error(r(308));Ea=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Ea=Ea.next=s;return l}var sE=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(l,m){i.push(m)}};this.abort=function(){s.aborted=!0,i.forEach(function(l){return l()})}},oE=e.unstable_scheduleCallback,lE=e.unstable_NormalPriority,gn={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pf(){return{controller:new sE,data:new Map,refCount:0}}function Oo(i){i.refCount--,i.refCount===0&&oE(lE,function(){i.controller.abort()})}var Po=null,Uf=0,As=0,bs=null;function cE(i,s){if(Po===null){var l=Po=[];Uf=0,As=V0(),bs={status:"pending",value:void 0,then:function(m){l.push(m)}}}return Uf++,s.then(jm,jm),s}function jm(){if(--Uf===0&&Po!==null){bs!==null&&(bs.status="fulfilled");var i=Po;Po=null,As=0,bs=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function uE(i,s){var l=[],m={status:"pending",value:null,reason:null,then:function(x){l.push(x)}};return i.then(function(){m.status="fulfilled",m.value=s;for(var x=0;x<l.length;x++)(0,l[x])(s)},function(x){for(m.status="rejected",m.reason=x,x=0;x<l.length;x++)(0,l[x])(void 0)}),m}var qm=re.S;re.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&cE(i,s),qm!==null&&qm(i,s)};var Bi=W(null);function Bf(){var i=Bi.current;return i!==null?i:jt.pooledCache}function yc(i,s){s===null?J(Bi,Bi.current):J(Bi,s.pool)}function Ym(){var i=Bf();return i===null?null:{parent:gn._currentValue,pool:i}}var Uo=Error(r(460)),$m=Error(r(474)),Tc=Error(r(542)),Vf={then:function(){}};function Jm(i){return i=i.status,i==="fulfilled"||i==="rejected"}function _c(){}function Xm(i,s,l){switch(l=i[l],l===void 0?i.push(s):l!==s&&(s.then(_c,_c),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Km(i),i;default:if(typeof s.status=="string")s.then(_c,_c);else{if(i=jt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(m){if(s.status==="pending"){var x=s;x.status="fulfilled",x.value=m}},function(m){if(s.status==="pending"){var x=s;x.status="rejected",x.reason=m}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Km(i),i}throw Bo=s,Uo}}var Bo=null;function Wm(){if(Bo===null)throw Error(r(459));var i=Bo;return Bo=null,i}function Km(i){if(i===Uo||i===Tc)throw Error(r(483))}var ja=!1;function Gf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hf(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function qa(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ya(i,s,l){var m=i.updateQueue;if(m===null)return null;if(m=m.shared,(Rt&2)!==0){var x=m.pending;return x===null?s.next=s:(s.next=x.next,x.next=s),m.pending=s,s=hc(i),Pm(i,null,l),s}return dc(i,m,s,l),hc(i)}function Vo(i,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var m=s.lanes;m&=i.pendingLanes,l|=m,s.lanes=l,cn(i,l)}}function zf(i,s){var l=i.updateQueue,m=i.alternate;if(m!==null&&(m=m.updateQueue,l===m)){var x=null,T=null;if(l=l.firstBaseUpdate,l!==null){do{var A={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};T===null?x=T=A:T=T.next=A,l=l.next}while(l!==null);T===null?x=T=s:T=T.next=s}else x=T=s;l={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:T,shared:m.shared,callbacks:m.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=s:i.next=s,l.lastBaseUpdate=s}var jf=!1;function Go(){if(jf){var i=bs;if(i!==null)throw i}}function Ho(i,s,l,m){jf=!1;var x=i.updateQueue;ja=!1;var T=x.firstBaseUpdate,A=x.lastBaseUpdate,I=x.shared.pending;if(I!==null){x.shared.pending=null;var Z=I,ue=Z.next;Z.next=null,A===null?T=ue:A.next=ue,A=Z;var Se=i.alternate;Se!==null&&(Se=Se.updateQueue,I=Se.lastBaseUpdate,I!==A&&(I===null?Se.firstBaseUpdate=ue:I.next=ue,Se.lastBaseUpdate=Z))}if(T!==null){var ke=x.baseState;A=0,Se=ue=Z=null,I=T;do{var he=I.lane&-536870913,pe=he!==I.lane;if(pe?(Et&he)===he:(m&he)===he){he!==0&&he===As&&(jf=!0),Se!==null&&(Se=Se.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var tt=i,Ke=I;he=s;var Ut=l;switch(Ke.tag){case 1:if(tt=Ke.payload,typeof tt=="function"){ke=tt.call(Ut,ke,he);break e}ke=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=Ke.payload,he=typeof tt=="function"?tt.call(Ut,ke,he):tt,he==null)break e;ke=g({},ke,he);break e;case 2:ja=!0}}he=I.callback,he!==null&&(i.flags|=64,pe&&(i.flags|=8192),pe=x.callbacks,pe===null?x.callbacks=[he]:pe.push(he))}else pe={lane:he,tag:I.tag,payload:I.payload,callback:I.callback,next:null},Se===null?(ue=Se=pe,Z=ke):Se=Se.next=pe,A|=he;if(I=I.next,I===null){if(I=x.shared.pending,I===null)break;pe=I,I=pe.next,pe.next=null,x.lastBaseUpdate=pe,x.shared.pending=null}}while(!0);Se===null&&(Z=ke),x.baseState=Z,x.firstBaseUpdate=ue,x.lastBaseUpdate=Se,T===null&&(x.shared.lanes=0),ei|=A,i.lanes=A,i.memoizedState=ke}}function Zm(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function Qm(i,s){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)Zm(l[i],s)}var ks=W(null),Ec=W(0);function ep(i,s){i=Ma,J(Ec,i),J(ks,s),Ma=i|s.baseLanes}function qf(){J(Ec,Ma),J(ks,ks.current)}function Yf(){Ma=Ec.current,D(ks),D(Ec)}var $a=0,dt=null,Ot=null,un=null,Sc=!1,Ns=!1,Vi=!1,Cc=0,zo=0,Ms=null,fE=0;function sn(){throw Error(r(321))}function $f(i,s){if(s===null)return!1;for(var l=0;l<s.length&&l<i.length;l++)if(!or(i[l],s[l]))return!1;return!0}function Jf(i,s,l,m,x,T){return $a=T,dt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,re.H=i===null||i.memoizedState===null?Pp:Up,Vi=!1,T=l(m,x),Vi=!1,Ns&&(T=np(s,l,m,x)),tp(i),T}function tp(i){re.H=Mc;var s=Ot!==null&&Ot.next!==null;if($a=0,un=Ot=dt=null,Sc=!1,zo=0,Ms=null,s)throw Error(r(300));i===null||_n||(i=i.dependencies,i!==null&&xc(i)&&(_n=!0))}function np(i,s,l,m){dt=i;var x=0;do{if(Ns&&(Ms=null),zo=0,Ns=!1,25<=x)throw Error(r(301));if(x+=1,un=Ot=null,i.updateQueue!=null){var T=i.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}re.H=vE,T=s(l,m)}while(Ns);return T}function dE(){var i=re.H,s=i.useState()[0];return s=typeof s.then=="function"?jo(s):s,i=i.useState()[0],(Ot!==null?Ot.memoizedState:null)!==i&&(dt.flags|=1024),s}function Xf(){var i=Cc!==0;return Cc=0,i}function Wf(i,s,l){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~l}function Kf(i){if(Sc){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Sc=!1}$a=0,un=Ot=dt=null,Ns=!1,zo=Cc=0,Ms=null}function tr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return un===null?dt.memoizedState=un=i:un=un.next=i,un}function fn(){if(Ot===null){var i=dt.alternate;i=i!==null?i.memoizedState:null}else i=Ot.next;var s=un===null?dt.memoizedState:un.next;if(s!==null)un=s,Ot=i;else{if(i===null)throw dt.alternate===null?Error(r(467)):Error(r(310));Ot=i,i={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},un===null?dt.memoizedState=un=i:un=un.next=i}return un}function Zf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jo(i){var s=zo;return zo+=1,Ms===null&&(Ms=[]),i=Xm(Ms,i,s),s=dt,(un===null?s.memoizedState:un.next)===null&&(s=s.alternate,re.H=s===null||s.memoizedState===null?Pp:Up),i}function wc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return jo(i);if(i.$$typeof===b)return On(i)}throw Error(r(438,String(i)))}function Qf(i){var s=null,l=dt.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var m=dt.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(s={data:m.data.map(function(x){return x.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=Zf(),dt.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(i),m=0;m<i;m++)l[m]=Q;return s.index++,l}function Ca(i,s){return typeof s=="function"?s(i):s}function Ac(i){var s=fn();return e0(s,Ot,i)}function e0(i,s,l){var m=i.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=l;var x=i.baseQueue,T=m.pending;if(T!==null){if(x!==null){var A=x.next;x.next=T.next,T.next=A}s.baseQueue=x=T,m.pending=null}if(T=i.baseState,x===null)i.memoizedState=T;else{s=x.next;var I=A=null,Z=null,ue=s,Se=!1;do{var ke=ue.lane&-536870913;if(ke!==ue.lane?(Et&ke)===ke:($a&ke)===ke){var he=ue.revertLane;if(he===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),ke===As&&(Se=!0);else if(($a&he)===he){ue=ue.next,he===As&&(Se=!0);continue}else ke={lane:0,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Z===null?(I=Z=ke,A=T):Z=Z.next=ke,dt.lanes|=he,ei|=he;ke=ue.action,Vi&&l(T,ke),T=ue.hasEagerState?ue.eagerState:l(T,ke)}else he={lane:ke,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Z===null?(I=Z=he,A=T):Z=Z.next=he,dt.lanes|=ke,ei|=ke;ue=ue.next}while(ue!==null&&ue!==s);if(Z===null?A=T:Z.next=I,!or(T,i.memoizedState)&&(_n=!0,Se&&(l=bs,l!==null)))throw l;i.memoizedState=T,i.baseState=A,i.baseQueue=Z,m.lastRenderedState=T}return x===null&&(m.lanes=0),[i.memoizedState,m.dispatch]}function t0(i){var s=fn(),l=s.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=i;var m=l.dispatch,x=l.pending,T=s.memoizedState;if(x!==null){l.pending=null;var A=x=x.next;do T=i(T,A.action),A=A.next;while(A!==x);or(T,s.memoizedState)||(_n=!0),s.memoizedState=T,s.baseQueue===null&&(s.baseState=T),l.lastRenderedState=T}return[T,m]}function rp(i,s,l){var m=dt,x=fn(),T=Nt;if(T){if(l===void 0)throw Error(r(407));l=l()}else l=s();var A=!or((Ot||x).memoizedState,l);A&&(x.memoizedState=l,_n=!0),x=x.queue;var I=sp.bind(null,m,x,i);if(qo(2048,8,I,[i]),x.getSnapshot!==s||A||un!==null&&un.memoizedState.tag&1){if(m.flags|=2048,Rs(9,bc(),ip.bind(null,m,x,l,s),null),jt===null)throw Error(r(349));T||($a&124)!==0||ap(m,s,l)}return l}function ap(i,s,l){i.flags|=16384,i={getSnapshot:s,value:l},s=dt.updateQueue,s===null?(s=Zf(),dt.updateQueue=s,s.stores=[i]):(l=s.stores,l===null?s.stores=[i]:l.push(i))}function ip(i,s,l,m){s.value=l,s.getSnapshot=m,op(s)&&lp(i)}function sp(i,s,l){return l(function(){op(s)&&lp(i)})}function op(i){var s=i.getSnapshot;i=i.value;try{var l=s();return!or(i,l)}catch{return!0}}function lp(i){var s=Es(i,2);s!==null&&hr(s,i,2)}function n0(i){var s=tr();if(typeof i=="function"){var l=i;if(i=l(),Vi){be(!0);try{l()}finally{be(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ca,lastRenderedState:i},s}function cp(i,s,l,m){return i.baseState=l,e0(i,Ot,typeof m=="function"?m:Ca)}function hE(i,s,l,m,x){if(Nc(i))throw Error(r(485));if(i=s.action,i!==null){var T={payload:x,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){T.listeners.push(A)}};re.T!==null?l(!0):T.isTransition=!1,m(T),l=s.pending,l===null?(T.next=s.pending=T,up(s,T)):(T.next=l.next,s.pending=l.next=T)}}function up(i,s){var l=s.action,m=s.payload,x=i.state;if(s.isTransition){var T=re.T,A={};re.T=A;try{var I=l(x,m),Z=re.S;Z!==null&&Z(A,I),fp(i,s,I)}catch(ue){r0(i,s,ue)}finally{re.T=T}}else try{T=l(x,m),fp(i,s,T)}catch(ue){r0(i,s,ue)}}function fp(i,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(m){dp(i,s,m)},function(m){return r0(i,s,m)}):dp(i,s,l)}function dp(i,s,l){s.status="fulfilled",s.value=l,hp(s),i.state=l,s=i.pending,s!==null&&(l=s.next,l===s?i.pending=null:(l=l.next,s.next=l,up(i,l)))}function r0(i,s,l){var m=i.pending;if(i.pending=null,m!==null){m=m.next;do s.status="rejected",s.reason=l,hp(s),s=s.next;while(s!==m)}i.action=null}function hp(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function mp(i,s){return s}function pp(i,s){if(Nt){var l=jt.formState;if(l!==null){e:{var m=dt;if(Nt){if(en){t:{for(var x=en,T=ta;x.nodeType!==8;){if(!T){x=null;break t}if(x=qr(x.nextSibling),x===null){x=null;break t}}T=x.data,x=T==="F!"||T==="F"?x:null}if(x){en=qr(x.nextSibling),m=x.data==="F!";break e}}Oi(m)}m=!1}m&&(s=l[0])}}return l=tr(),l.memoizedState=l.baseState=s,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mp,lastRenderedState:s},l.queue=m,l=Fp.bind(null,dt,m),m.dispatch=l,m=n0(!1),T=l0.bind(null,dt,!1,m.queue),m=tr(),x={state:s,dispatch:null,action:i,pending:null},m.queue=x,l=hE.bind(null,dt,x,T,l),x.dispatch=l,m.memoizedState=i,[s,l,!1]}function gp(i){var s=fn();return xp(s,Ot,i)}function xp(i,s,l){if(s=e0(i,s,mp)[0],i=Ac(Ca)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var m=jo(s)}catch(A){throw A===Uo?Tc:A}else m=s;s=fn();var x=s.queue,T=x.dispatch;return l!==s.memoizedState&&(dt.flags|=2048,Rs(9,bc(),mE.bind(null,x,l),null)),[m,T,i]}function mE(i,s){i.action=s}function vp(i){var s=fn(),l=Ot;if(l!==null)return xp(s,l,i);fn(),s=s.memoizedState,l=fn();var m=l.queue.dispatch;return l.memoizedState=i,[s,m,!1]}function Rs(i,s,l,m){return i={tag:i,create:l,deps:m,inst:s,next:null},s=dt.updateQueue,s===null&&(s=Zf(),dt.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=i.next=i:(m=l.next,l.next=i,i.next=m,s.lastEffect=i),i}function bc(){return{destroy:void 0,resource:void 0}}function yp(){return fn().memoizedState}function kc(i,s,l,m){var x=tr();m=m===void 0?null:m,dt.flags|=i,x.memoizedState=Rs(1|s,bc(),l,m)}function qo(i,s,l,m){var x=fn();m=m===void 0?null:m;var T=x.memoizedState.inst;Ot!==null&&m!==null&&$f(m,Ot.memoizedState.deps)?x.memoizedState=Rs(s,T,l,m):(dt.flags|=i,x.memoizedState=Rs(1|s,T,l,m))}function Tp(i,s){kc(8390656,8,i,s)}function _p(i,s){qo(2048,8,i,s)}function Ep(i,s){return qo(4,2,i,s)}function Sp(i,s){return qo(4,4,i,s)}function Cp(i,s){if(typeof s=="function"){i=i();var l=s(i);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function wp(i,s,l){l=l!=null?l.concat([i]):null,qo(4,4,Cp.bind(null,s,i),l)}function a0(){}function Ap(i,s){var l=fn();s=s===void 0?null:s;var m=l.memoizedState;return s!==null&&$f(s,m[1])?m[0]:(l.memoizedState=[i,s],i)}function bp(i,s){var l=fn();s=s===void 0?null:s;var m=l.memoizedState;if(s!==null&&$f(s,m[1]))return m[0];if(m=i(),Vi){be(!0);try{i()}finally{be(!1)}}return l.memoizedState=[m,s],m}function i0(i,s,l){return l===void 0||($a&1073741824)!==0?i.memoizedState=s:(i.memoizedState=l,i=Mg(),dt.lanes|=i,ei|=i,l)}function kp(i,s,l,m){return or(l,s)?l:ks.current!==null?(i=i0(i,l,m),or(i,s)||(_n=!0),i):($a&42)===0?(_n=!0,i.memoizedState=l):(i=Mg(),dt.lanes|=i,ei|=i,s)}function Np(i,s,l,m,x){var T=ce.p;ce.p=T!==0&&8>T?T:8;var A=re.T,I={};re.T=I,l0(i,!1,s,l);try{var Z=x(),ue=re.S;if(ue!==null&&ue(I,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var Se=uE(Z,m);Yo(i,s,Se,dr(i))}else Yo(i,s,m,dr(i))}catch(ke){Yo(i,s,{then:function(){},status:"rejected",reason:ke},dr())}finally{ce.p=T,re.T=A}}function pE(){}function s0(i,s,l,m){if(i.tag!==5)throw Error(r(476));var x=Mp(i).queue;Np(i,x,s,ne,l===null?pE:function(){return Rp(i),l(m)})}function Mp(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ca,lastRenderedState:ne},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ca,lastRenderedState:l},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Rp(i){var s=Mp(i).next.queue;Yo(i,s,{},dr())}function o0(){return On(ul)}function Dp(){return fn().memoizedState}function Ip(){return fn().memoizedState}function gE(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var l=dr();i=qa(l);var m=Ya(s,i,l);m!==null&&(hr(m,s,l),Vo(m,s,l)),s={cache:Pf()},i.payload=s;return}s=s.return}}function xE(i,s,l){var m=dr();l={lane:m,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Nc(i)?Lp(s,l):(l=bf(i,s,l,m),l!==null&&(hr(l,i,m),Op(l,s,m)))}function Fp(i,s,l){var m=dr();Yo(i,s,l,m)}function Yo(i,s,l,m){var x={lane:m,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Nc(i))Lp(s,x);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=s.lastRenderedReducer,T!==null))try{var A=s.lastRenderedState,I=T(A,l);if(x.hasEagerState=!0,x.eagerState=I,or(I,A))return dc(i,s,x,0),jt===null&&fc(),!1}catch{}finally{}if(l=bf(i,s,x,m),l!==null)return hr(l,i,m),Op(l,s,m),!0}return!1}function l0(i,s,l,m){if(m={lane:2,revertLane:V0(),action:m,hasEagerState:!1,eagerState:null,next:null},Nc(i)){if(s)throw Error(r(479))}else s=bf(i,l,m,2),s!==null&&hr(s,i,2)}function Nc(i){var s=i.alternate;return i===dt||s!==null&&s===dt}function Lp(i,s){Ns=Sc=!0;var l=i.pending;l===null?s.next=s:(s.next=l.next,l.next=s),i.pending=s}function Op(i,s,l){if((l&4194048)!==0){var m=s.lanes;m&=i.pendingLanes,l|=m,s.lanes=l,cn(i,l)}}var Mc={readContext:On,use:wc,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useLayoutEffect:sn,useInsertionEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useSyncExternalStore:sn,useId:sn,useHostTransitionStatus:sn,useFormState:sn,useActionState:sn,useOptimistic:sn,useMemoCache:sn,useCacheRefresh:sn},Pp={readContext:On,use:wc,useCallback:function(i,s){return tr().memoizedState=[i,s===void 0?null:s],i},useContext:On,useEffect:Tp,useImperativeHandle:function(i,s,l){l=l!=null?l.concat([i]):null,kc(4194308,4,Cp.bind(null,s,i),l)},useLayoutEffect:function(i,s){return kc(4194308,4,i,s)},useInsertionEffect:function(i,s){kc(4,2,i,s)},useMemo:function(i,s){var l=tr();s=s===void 0?null:s;var m=i();if(Vi){be(!0);try{i()}finally{be(!1)}}return l.memoizedState=[m,s],m},useReducer:function(i,s,l){var m=tr();if(l!==void 0){var x=l(s);if(Vi){be(!0);try{l(s)}finally{be(!1)}}}else x=s;return m.memoizedState=m.baseState=x,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:x},m.queue=i,i=i.dispatch=xE.bind(null,dt,i),[m.memoizedState,i]},useRef:function(i){var s=tr();return i={current:i},s.memoizedState=i},useState:function(i){i=n0(i);var s=i.queue,l=Fp.bind(null,dt,s);return s.dispatch=l,[i.memoizedState,l]},useDebugValue:a0,useDeferredValue:function(i,s){var l=tr();return i0(l,i,s)},useTransition:function(){var i=n0(!1);return i=Np.bind(null,dt,i.queue,!0,!1),tr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,l){var m=dt,x=tr();if(Nt){if(l===void 0)throw Error(r(407));l=l()}else{if(l=s(),jt===null)throw Error(r(349));(Et&124)!==0||ap(m,s,l)}x.memoizedState=l;var T={value:l,getSnapshot:s};return x.queue=T,Tp(sp.bind(null,m,T,i),[i]),m.flags|=2048,Rs(9,bc(),ip.bind(null,m,T,l,s),null),l},useId:function(){var i=tr(),s=jt.identifierPrefix;if(Nt){var l=_a,m=Ta;l=(m&~(1<<32-Ge(m)-1)).toString(32)+l,s=""+s+"R"+l,l=Cc++,0<l&&(s+="H"+l.toString(32)),s+=""}else l=fE++,s=""+s+"r"+l.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:o0,useFormState:pp,useActionState:pp,useOptimistic:function(i){var s=tr();s.memoizedState=s.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=l0.bind(null,dt,!0,l),l.dispatch=s,[i,s]},useMemoCache:Qf,useCacheRefresh:function(){return tr().memoizedState=gE.bind(null,dt)}},Up={readContext:On,use:wc,useCallback:Ap,useContext:On,useEffect:_p,useImperativeHandle:wp,useInsertionEffect:Ep,useLayoutEffect:Sp,useMemo:bp,useReducer:Ac,useRef:yp,useState:function(){return Ac(Ca)},useDebugValue:a0,useDeferredValue:function(i,s){var l=fn();return kp(l,Ot.memoizedState,i,s)},useTransition:function(){var i=Ac(Ca)[0],s=fn().memoizedState;return[typeof i=="boolean"?i:jo(i),s]},useSyncExternalStore:rp,useId:Dp,useHostTransitionStatus:o0,useFormState:gp,useActionState:gp,useOptimistic:function(i,s){var l=fn();return cp(l,Ot,i,s)},useMemoCache:Qf,useCacheRefresh:Ip},vE={readContext:On,use:wc,useCallback:Ap,useContext:On,useEffect:_p,useImperativeHandle:wp,useInsertionEffect:Ep,useLayoutEffect:Sp,useMemo:bp,useReducer:t0,useRef:yp,useState:function(){return t0(Ca)},useDebugValue:a0,useDeferredValue:function(i,s){var l=fn();return Ot===null?i0(l,i,s):kp(l,Ot.memoizedState,i,s)},useTransition:function(){var i=t0(Ca)[0],s=fn().memoizedState;return[typeof i=="boolean"?i:jo(i),s]},useSyncExternalStore:rp,useId:Dp,useHostTransitionStatus:o0,useFormState:vp,useActionState:vp,useOptimistic:function(i,s){var l=fn();return Ot!==null?cp(l,Ot,i,s):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:Qf,useCacheRefresh:Ip},Ds=null,$o=0;function Rc(i){var s=$o;return $o+=1,Ds===null&&(Ds=[]),Xm(Ds,i,s)}function Jo(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Dc(i,s){throw s.$$typeof===y?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Bp(i){var s=i._init;return s(i._payload)}function Vp(i){function s(se,ae){if(i){var le=se.deletions;le===null?(se.deletions=[ae],se.flags|=16):le.push(ae)}}function l(se,ae){if(!i)return null;for(;ae!==null;)s(se,ae),ae=ae.sibling;return null}function m(se){for(var ae=new Map;se!==null;)se.key!==null?ae.set(se.key,se):ae.set(se.index,se),se=se.sibling;return ae}function x(se,ae){return se=ya(se,ae),se.index=0,se.sibling=null,se}function T(se,ae,le){return se.index=le,i?(le=se.alternate,le!==null?(le=le.index,le<ae?(se.flags|=67108866,ae):le):(se.flags|=67108866,ae)):(se.flags|=1048576,ae)}function A(se){return i&&se.alternate===null&&(se.flags|=67108866),se}function I(se,ae,le,we){return ae===null||ae.tag!==6?(ae=Nf(le,se.mode,we),ae.return=se,ae):(ae=x(ae,le),ae.return=se,ae)}function Z(se,ae,le,we){var qe=le.type;return qe===S?Se(se,ae,le.props.children,we,le.key):ae!==null&&(ae.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===Y&&Bp(qe)===ae.type)?(ae=x(ae,le.props),Jo(ae,le),ae.return=se,ae):(ae=mc(le.type,le.key,le.props,null,se.mode,we),Jo(ae,le),ae.return=se,ae)}function ue(se,ae,le,we){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==le.containerInfo||ae.stateNode.implementation!==le.implementation?(ae=Mf(le,se.mode,we),ae.return=se,ae):(ae=x(ae,le.children||[]),ae.return=se,ae)}function Se(se,ae,le,we,qe){return ae===null||ae.tag!==7?(ae=Di(le,se.mode,we,qe),ae.return=se,ae):(ae=x(ae,le),ae.return=se,ae)}function ke(se,ae,le){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=Nf(""+ae,se.mode,le),ae.return=se,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case _:return le=mc(ae.type,ae.key,ae.props,null,se.mode,le),Jo(le,ae),le.return=se,le;case E:return ae=Mf(ae,se.mode,le),ae.return=se,ae;case Y:var we=ae._init;return ae=we(ae._payload),ke(se,ae,le)}if(Te(ae)||ee(ae))return ae=Di(ae,se.mode,le,null),ae.return=se,ae;if(typeof ae.then=="function")return ke(se,Rc(ae),le);if(ae.$$typeof===b)return ke(se,vc(se,ae),le);Dc(se,ae)}return null}function he(se,ae,le,we){var qe=ae!==null?ae.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return qe!==null?null:I(se,ae,""+le,we);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case _:return le.key===qe?Z(se,ae,le,we):null;case E:return le.key===qe?ue(se,ae,le,we):null;case Y:return qe=le._init,le=qe(le._payload),he(se,ae,le,we)}if(Te(le)||ee(le))return qe!==null?null:Se(se,ae,le,we,null);if(typeof le.then=="function")return he(se,ae,Rc(le),we);if(le.$$typeof===b)return he(se,ae,vc(se,le),we);Dc(se,le)}return null}function pe(se,ae,le,we,qe){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return se=se.get(le)||null,I(ae,se,""+we,qe);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case _:return se=se.get(we.key===null?le:we.key)||null,Z(ae,se,we,qe);case E:return se=se.get(we.key===null?le:we.key)||null,ue(ae,se,we,qe);case Y:var pt=we._init;return we=pt(we._payload),pe(se,ae,le,we,qe)}if(Te(we)||ee(we))return se=se.get(le)||null,Se(ae,se,we,qe,null);if(typeof we.then=="function")return pe(se,ae,le,Rc(we),qe);if(we.$$typeof===b)return pe(se,ae,le,vc(ae,we),qe);Dc(ae,we)}return null}function tt(se,ae,le,we){for(var qe=null,pt=null,Xe=ae,Qe=ae=0,Sn=null;Xe!==null&&Qe<le.length;Qe++){Xe.index>Qe?(Sn=Xe,Xe=null):Sn=Xe.sibling;var bt=he(se,Xe,le[Qe],we);if(bt===null){Xe===null&&(Xe=Sn);break}i&&Xe&&bt.alternate===null&&s(se,Xe),ae=T(bt,ae,Qe),pt===null?qe=bt:pt.sibling=bt,pt=bt,Xe=Sn}if(Qe===le.length)return l(se,Xe),Nt&&Fi(se,Qe),qe;if(Xe===null){for(;Qe<le.length;Qe++)Xe=ke(se,le[Qe],we),Xe!==null&&(ae=T(Xe,ae,Qe),pt===null?qe=Xe:pt.sibling=Xe,pt=Xe);return Nt&&Fi(se,Qe),qe}for(Xe=m(Xe);Qe<le.length;Qe++)Sn=pe(Xe,se,Qe,le[Qe],we),Sn!==null&&(i&&Sn.alternate!==null&&Xe.delete(Sn.key===null?Qe:Sn.key),ae=T(Sn,ae,Qe),pt===null?qe=Sn:pt.sibling=Sn,pt=Sn);return i&&Xe.forEach(function(ci){return s(se,ci)}),Nt&&Fi(se,Qe),qe}function Ke(se,ae,le,we){if(le==null)throw Error(r(151));for(var qe=null,pt=null,Xe=ae,Qe=ae=0,Sn=null,bt=le.next();Xe!==null&&!bt.done;Qe++,bt=le.next()){Xe.index>Qe?(Sn=Xe,Xe=null):Sn=Xe.sibling;var ci=he(se,Xe,bt.value,we);if(ci===null){Xe===null&&(Xe=Sn);break}i&&Xe&&ci.alternate===null&&s(se,Xe),ae=T(ci,ae,Qe),pt===null?qe=ci:pt.sibling=ci,pt=ci,Xe=Sn}if(bt.done)return l(se,Xe),Nt&&Fi(se,Qe),qe;if(Xe===null){for(;!bt.done;Qe++,bt=le.next())bt=ke(se,bt.value,we),bt!==null&&(ae=T(bt,ae,Qe),pt===null?qe=bt:pt.sibling=bt,pt=bt);return Nt&&Fi(se,Qe),qe}for(Xe=m(Xe);!bt.done;Qe++,bt=le.next())bt=pe(Xe,se,Qe,bt.value,we),bt!==null&&(i&&bt.alternate!==null&&Xe.delete(bt.key===null?Qe:bt.key),ae=T(bt,ae,Qe),pt===null?qe=bt:pt.sibling=bt,pt=bt);return i&&Xe.forEach(function(yS){return s(se,yS)}),Nt&&Fi(se,Qe),qe}function Ut(se,ae,le,we){if(typeof le=="object"&&le!==null&&le.type===S&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case _:e:{for(var qe=le.key;ae!==null;){if(ae.key===qe){if(qe=le.type,qe===S){if(ae.tag===7){l(se,ae.sibling),we=x(ae,le.props.children),we.return=se,se=we;break e}}else if(ae.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===Y&&Bp(qe)===ae.type){l(se,ae.sibling),we=x(ae,le.props),Jo(we,le),we.return=se,se=we;break e}l(se,ae);break}else s(se,ae);ae=ae.sibling}le.type===S?(we=Di(le.props.children,se.mode,we,le.key),we.return=se,se=we):(we=mc(le.type,le.key,le.props,null,se.mode,we),Jo(we,le),we.return=se,se=we)}return A(se);case E:e:{for(qe=le.key;ae!==null;){if(ae.key===qe)if(ae.tag===4&&ae.stateNode.containerInfo===le.containerInfo&&ae.stateNode.implementation===le.implementation){l(se,ae.sibling),we=x(ae,le.children||[]),we.return=se,se=we;break e}else{l(se,ae);break}else s(se,ae);ae=ae.sibling}we=Mf(le,se.mode,we),we.return=se,se=we}return A(se);case Y:return qe=le._init,le=qe(le._payload),Ut(se,ae,le,we)}if(Te(le))return tt(se,ae,le,we);if(ee(le)){if(qe=ee(le),typeof qe!="function")throw Error(r(150));return le=qe.call(le),Ke(se,ae,le,we)}if(typeof le.then=="function")return Ut(se,ae,Rc(le),we);if(le.$$typeof===b)return Ut(se,ae,vc(se,le),we);Dc(se,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,ae!==null&&ae.tag===6?(l(se,ae.sibling),we=x(ae,le),we.return=se,se=we):(l(se,ae),we=Nf(le,se.mode,we),we.return=se,se=we),A(se)):l(se,ae)}return function(se,ae,le,we){try{$o=0;var qe=Ut(se,ae,le,we);return Ds=null,qe}catch(Xe){if(Xe===Uo||Xe===Tc)throw Xe;var pt=lr(29,Xe,null,se.mode);return pt.lanes=we,pt.return=se,pt}finally{}}}var Is=Vp(!0),Gp=Vp(!1),br=W(null),na=null;function Ja(i){var s=i.alternate;J(xn,xn.current&1),J(br,i),na===null&&(s===null||ks.current!==null||s.memoizedState!==null)&&(na=i)}function Hp(i){if(i.tag===22){if(J(xn,xn.current),J(br,i),na===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(na=i)}}else Xa()}function Xa(){J(xn,xn.current),J(br,br.current)}function wa(i){D(br),na===i&&(na=null),D(xn)}var xn=W(0);function Ic(i){for(var s=i;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||Z0(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function c0(i,s,l,m){s=i.memoizedState,l=l(m,s),l=l==null?s:g({},s,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var u0={enqueueSetState:function(i,s,l){i=i._reactInternals;var m=dr(),x=qa(m);x.payload=s,l!=null&&(x.callback=l),s=Ya(i,x,m),s!==null&&(hr(s,i,m),Vo(s,i,m))},enqueueReplaceState:function(i,s,l){i=i._reactInternals;var m=dr(),x=qa(m);x.tag=1,x.payload=s,l!=null&&(x.callback=l),s=Ya(i,x,m),s!==null&&(hr(s,i,m),Vo(s,i,m))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var l=dr(),m=qa(l);m.tag=2,s!=null&&(m.callback=s),s=Ya(i,m,l),s!==null&&(hr(s,i,l),Vo(s,i,l))}};function zp(i,s,l,m,x,T,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(m,T,A):s.prototype&&s.prototype.isPureReactComponent?!Mo(l,m)||!Mo(x,T):!0}function jp(i,s,l,m){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,m),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,m),s.state!==i&&u0.enqueueReplaceState(s,s.state,null)}function Gi(i,s){var l=s;if("ref"in s){l={};for(var m in s)m!=="ref"&&(l[m]=s[m])}if(i=i.defaultProps){l===s&&(l=g({},l));for(var x in i)l[x]===void 0&&(l[x]=i[x])}return l}var Fc=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function qp(i){Fc(i)}function Yp(i){console.error(i)}function $p(i){Fc(i)}function Lc(i,s){try{var l=i.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(m){setTimeout(function(){throw m})}}function Jp(i,s,l){try{var m=i.onCaughtError;m(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function f0(i,s,l){return l=qa(l),l.tag=3,l.payload={element:null},l.callback=function(){Lc(i,s)},l}function Xp(i){return i=qa(i),i.tag=3,i}function Wp(i,s,l,m){var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var T=m.value;i.payload=function(){return x(T)},i.callback=function(){Jp(s,l,m)}}var A=l.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(i.callback=function(){Jp(s,l,m),typeof x!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var I=m.stack;this.componentDidCatch(m.value,{componentStack:I!==null?I:""})})}function yE(i,s,l,m,x){if(l.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(s=l.alternate,s!==null&&Lo(s,l,x,!0),l=br.current,l!==null){switch(l.tag){case 13:return na===null?L0():l.alternate===null&&tn===0&&(tn=3),l.flags&=-257,l.flags|=65536,l.lanes=x,m===Vf?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([m]):s.add(m),P0(i,m,x)),!1;case 22:return l.flags|=65536,m===Vf?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([m])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([m]):l.add(m)),P0(i,m,x)),!1}throw Error(r(435,l.tag))}return P0(i,m,x),L0(),!1}if(Nt)return s=br.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=x,m!==If&&(i=Error(r(422),{cause:m}),Fo(Sr(i,l)))):(m!==If&&(s=Error(r(423),{cause:m}),Fo(Sr(s,l))),i=i.current.alternate,i.flags|=65536,x&=-x,i.lanes|=x,m=Sr(m,l),x=f0(i.stateNode,m,x),zf(i,x),tn!==4&&(tn=2)),!1;var T=Error(r(520),{cause:m});if(T=Sr(T,l),tl===null?tl=[T]:tl.push(T),tn!==4&&(tn=2),s===null)return!0;m=Sr(m,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,i=x&-x,l.lanes|=i,i=f0(l.stateNode,m,i),zf(l,i),!1;case 1:if(s=l.type,T=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(ti===null||!ti.has(T))))return l.flags|=65536,x&=-x,l.lanes|=x,x=Xp(x),Wp(x,i,l,m),zf(l,x),!1}l=l.return}while(l!==null);return!1}var Kp=Error(r(461)),_n=!1;function Nn(i,s,l,m){s.child=i===null?Gp(s,null,l,m):Is(s,i.child,l,m)}function Zp(i,s,l,m,x){l=l.render;var T=s.ref;if("ref"in m){var A={};for(var I in m)I!=="ref"&&(A[I]=m[I])}else A=m;return Ui(s),m=Jf(i,s,l,A,T,x),I=Xf(),i!==null&&!_n?(Wf(i,s,x),Aa(i,s,x)):(Nt&&I&&Rf(s),s.flags|=1,Nn(i,s,m,x),s.child)}function Qp(i,s,l,m,x){if(i===null){var T=l.type;return typeof T=="function"&&!kf(T)&&T.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=T,eg(i,s,T,m,x)):(i=mc(l.type,null,m,s,s.mode,x),i.ref=s.ref,i.return=s,s.child=i)}if(T=i.child,!y0(i,x)){var A=T.memoizedProps;if(l=l.compare,l=l!==null?l:Mo,l(A,m)&&i.ref===s.ref)return Aa(i,s,x)}return s.flags|=1,i=ya(T,m),i.ref=s.ref,i.return=s,s.child=i}function eg(i,s,l,m,x){if(i!==null){var T=i.memoizedProps;if(Mo(T,m)&&i.ref===s.ref)if(_n=!1,s.pendingProps=m=T,y0(i,x))(i.flags&131072)!==0&&(_n=!0);else return s.lanes=i.lanes,Aa(i,s,x)}return d0(i,s,l,m,x)}function tg(i,s,l){var m=s.pendingProps,x=m.children,T=i!==null?i.memoizedState:null;if(m.mode==="hidden"){if((s.flags&128)!==0){if(m=T!==null?T.baseLanes|l:l,i!==null){for(x=s.child=i.child,T=0;x!==null;)T=T|x.lanes|x.childLanes,x=x.sibling;s.childLanes=T&~m}else s.childLanes=0,s.child=null;return ng(i,s,m,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&yc(s,T!==null?T.cachePool:null),T!==null?ep(s,T):qf(),Hp(s);else return s.lanes=s.childLanes=536870912,ng(i,s,T!==null?T.baseLanes|l:l,l)}else T!==null?(yc(s,T.cachePool),ep(s,T),Xa(),s.memoizedState=null):(i!==null&&yc(s,null),qf(),Xa());return Nn(i,s,x,l),s.child}function ng(i,s,l,m){var x=Bf();return x=x===null?null:{parent:gn._currentValue,pool:x},s.memoizedState={baseLanes:l,cachePool:x},i!==null&&yc(s,null),qf(),Hp(s),i!==null&&Lo(i,s,m,!0),null}function Oc(i,s){var l=s.ref;if(l===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(r(284));(i===null||i.ref!==l)&&(s.flags|=4194816)}}function d0(i,s,l,m,x){return Ui(s),l=Jf(i,s,l,m,void 0,x),m=Xf(),i!==null&&!_n?(Wf(i,s,x),Aa(i,s,x)):(Nt&&m&&Rf(s),s.flags|=1,Nn(i,s,l,x),s.child)}function rg(i,s,l,m,x,T){return Ui(s),s.updateQueue=null,l=np(s,m,l,x),tp(i),m=Xf(),i!==null&&!_n?(Wf(i,s,T),Aa(i,s,T)):(Nt&&m&&Rf(s),s.flags|=1,Nn(i,s,l,T),s.child)}function ag(i,s,l,m,x){if(Ui(s),s.stateNode===null){var T=Ss,A=l.contextType;typeof A=="object"&&A!==null&&(T=On(A)),T=new l(m,T),s.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=u0,s.stateNode=T,T._reactInternals=s,T=s.stateNode,T.props=m,T.state=s.memoizedState,T.refs={},Gf(s),A=l.contextType,T.context=typeof A=="object"&&A!==null?On(A):Ss,T.state=s.memoizedState,A=l.getDerivedStateFromProps,typeof A=="function"&&(c0(s,l,A,m),T.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(A=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),A!==T.state&&u0.enqueueReplaceState(T,T.state,null),Ho(s,m,T,x),Go(),T.state=s.memoizedState),typeof T.componentDidMount=="function"&&(s.flags|=4194308),m=!0}else if(i===null){T=s.stateNode;var I=s.memoizedProps,Z=Gi(l,I);T.props=Z;var ue=T.context,Se=l.contextType;A=Ss,typeof Se=="object"&&Se!==null&&(A=On(Se));var ke=l.getDerivedStateFromProps;Se=typeof ke=="function"||typeof T.getSnapshotBeforeUpdate=="function",I=s.pendingProps!==I,Se||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(I||ue!==A)&&jp(s,T,m,A),ja=!1;var he=s.memoizedState;T.state=he,Ho(s,m,T,x),Go(),ue=s.memoizedState,I||he!==ue||ja?(typeof ke=="function"&&(c0(s,l,ke,m),ue=s.memoizedState),(Z=ja||zp(s,l,Z,m,he,ue,A))?(Se||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(s.flags|=4194308)):(typeof T.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=m,s.memoizedState=ue),T.props=m,T.state=ue,T.context=A,m=Z):(typeof T.componentDidMount=="function"&&(s.flags|=4194308),m=!1)}else{T=s.stateNode,Hf(i,s),A=s.memoizedProps,Se=Gi(l,A),T.props=Se,ke=s.pendingProps,he=T.context,ue=l.contextType,Z=Ss,typeof ue=="object"&&ue!==null&&(Z=On(ue)),I=l.getDerivedStateFromProps,(ue=typeof I=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(A!==ke||he!==Z)&&jp(s,T,m,Z),ja=!1,he=s.memoizedState,T.state=he,Ho(s,m,T,x),Go();var pe=s.memoizedState;A!==ke||he!==pe||ja||i!==null&&i.dependencies!==null&&xc(i.dependencies)?(typeof I=="function"&&(c0(s,l,I,m),pe=s.memoizedState),(Se=ja||zp(s,l,Se,m,he,pe,Z)||i!==null&&i.dependencies!==null&&xc(i.dependencies))?(ue||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(m,pe,Z),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(m,pe,Z)),typeof T.componentDidUpdate=="function"&&(s.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof T.componentDidUpdate!="function"||A===i.memoizedProps&&he===i.memoizedState||(s.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&he===i.memoizedState||(s.flags|=1024),s.memoizedProps=m,s.memoizedState=pe),T.props=m,T.state=pe,T.context=Z,m=Se):(typeof T.componentDidUpdate!="function"||A===i.memoizedProps&&he===i.memoizedState||(s.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&he===i.memoizedState||(s.flags|=1024),m=!1)}return T=m,Oc(i,s),m=(s.flags&128)!==0,T||m?(T=s.stateNode,l=m&&typeof l.getDerivedStateFromError!="function"?null:T.render(),s.flags|=1,i!==null&&m?(s.child=Is(s,i.child,null,x),s.child=Is(s,null,l,x)):Nn(i,s,l,x),s.memoizedState=T.state,i=s.child):i=Aa(i,s,x),i}function ig(i,s,l,m){return Io(),s.flags|=256,Nn(i,s,l,m),s.child}var h0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function m0(i){return{baseLanes:i,cachePool:Ym()}}function p0(i,s,l){return i=i!==null?i.childLanes&~l:0,s&&(i|=kr),i}function sg(i,s,l){var m=s.pendingProps,x=!1,T=(s.flags&128)!==0,A;if((A=T)||(A=i!==null&&i.memoizedState===null?!1:(xn.current&2)!==0),A&&(x=!0,s.flags&=-129),A=(s.flags&32)!==0,s.flags&=-33,i===null){if(Nt){if(x?Ja(s):Xa(),Nt){var I=en,Z;if(Z=I){e:{for(Z=I,I=ta;Z.nodeType!==8;){if(!I){I=null;break e}if(Z=qr(Z.nextSibling),Z===null){I=null;break e}}I=Z}I!==null?(s.memoizedState={dehydrated:I,treeContext:Ii!==null?{id:Ta,overflow:_a}:null,retryLane:536870912,hydrationErrors:null},Z=lr(18,null,null,0),Z.stateNode=I,Z.return=s,s.child=Z,$n=s,en=null,Z=!0):Z=!1}Z||Oi(s)}if(I=s.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return Z0(I)?s.lanes=32:s.lanes=536870912,null;wa(s)}return I=m.children,m=m.fallback,x?(Xa(),x=s.mode,I=Pc({mode:"hidden",children:I},x),m=Di(m,x,l,null),I.return=s,m.return=s,I.sibling=m,s.child=I,x=s.child,x.memoizedState=m0(l),x.childLanes=p0(i,A,l),s.memoizedState=h0,m):(Ja(s),g0(s,I))}if(Z=i.memoizedState,Z!==null&&(I=Z.dehydrated,I!==null)){if(T)s.flags&256?(Ja(s),s.flags&=-257,s=x0(i,s,l)):s.memoizedState!==null?(Xa(),s.child=i.child,s.flags|=128,s=null):(Xa(),x=m.fallback,I=s.mode,m=Pc({mode:"visible",children:m.children},I),x=Di(x,I,l,null),x.flags|=2,m.return=s,x.return=s,m.sibling=x,s.child=m,Is(s,i.child,null,l),m=s.child,m.memoizedState=m0(l),m.childLanes=p0(i,A,l),s.memoizedState=h0,s=x);else if(Ja(s),Z0(I)){if(A=I.nextSibling&&I.nextSibling.dataset,A)var ue=A.dgst;A=ue,m=Error(r(419)),m.stack="",m.digest=A,Fo({value:m,source:null,stack:null}),s=x0(i,s,l)}else if(_n||Lo(i,s,l,!1),A=(l&i.childLanes)!==0,_n||A){if(A=jt,A!==null&&(m=l&-l,m=(m&42)!==0?1:Ln(m),m=(m&(A.suspendedLanes|l))!==0?0:m,m!==0&&m!==Z.retryLane))throw Z.retryLane=m,Es(i,m),hr(A,i,m),Kp;I.data==="$?"||L0(),s=x0(i,s,l)}else I.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=Z.treeContext,en=qr(I.nextSibling),$n=s,Nt=!0,Li=null,ta=!1,i!==null&&(wr[Ar++]=Ta,wr[Ar++]=_a,wr[Ar++]=Ii,Ta=i.id,_a=i.overflow,Ii=s),s=g0(s,m.children),s.flags|=4096);return s}return x?(Xa(),x=m.fallback,I=s.mode,Z=i.child,ue=Z.sibling,m=ya(Z,{mode:"hidden",children:m.children}),m.subtreeFlags=Z.subtreeFlags&65011712,ue!==null?x=ya(ue,x):(x=Di(x,I,l,null),x.flags|=2),x.return=s,m.return=s,m.sibling=x,s.child=m,m=x,x=s.child,I=i.child.memoizedState,I===null?I=m0(l):(Z=I.cachePool,Z!==null?(ue=gn._currentValue,Z=Z.parent!==ue?{parent:ue,pool:ue}:Z):Z=Ym(),I={baseLanes:I.baseLanes|l,cachePool:Z}),x.memoizedState=I,x.childLanes=p0(i,A,l),s.memoizedState=h0,m):(Ja(s),l=i.child,i=l.sibling,l=ya(l,{mode:"visible",children:m.children}),l.return=s,l.sibling=null,i!==null&&(A=s.deletions,A===null?(s.deletions=[i],s.flags|=16):A.push(i)),s.child=l,s.memoizedState=null,l)}function g0(i,s){return s=Pc({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Pc(i,s){return i=lr(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function x0(i,s,l){return Is(s,i.child,null,l),i=g0(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function og(i,s,l){i.lanes|=s;var m=i.alternate;m!==null&&(m.lanes|=s),Lf(i.return,s,l)}function v0(i,s,l,m,x){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:m,tail:l,tailMode:x}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=m,T.tail=l,T.tailMode=x)}function lg(i,s,l){var m=s.pendingProps,x=m.revealOrder,T=m.tail;if(Nn(i,s,m.children,l),m=xn.current,(m&2)!==0)m=m&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&og(i,l,s);else if(i.tag===19)og(i,l,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}m&=1}switch(J(xn,m),x){case"forwards":for(l=s.child,x=null;l!==null;)i=l.alternate,i!==null&&Ic(i)===null&&(x=l),l=l.sibling;l=x,l===null?(x=s.child,s.child=null):(x=l.sibling,l.sibling=null),v0(s,!1,x,l,T);break;case"backwards":for(l=null,x=s.child,s.child=null;x!==null;){if(i=x.alternate,i!==null&&Ic(i)===null){s.child=x;break}i=x.sibling,x.sibling=l,l=x,x=i}v0(s,!0,l,null,T);break;case"together":v0(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Aa(i,s,l){if(i!==null&&(s.dependencies=i.dependencies),ei|=s.lanes,(l&s.childLanes)===0)if(i!==null){if(Lo(i,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,l=ya(i,i.pendingProps),s.child=l,l.return=s;i.sibling!==null;)i=i.sibling,l=l.sibling=ya(i,i.pendingProps),l.return=s;l.sibling=null}return s.child}function y0(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&xc(i)))}function TE(i,s,l){switch(s.tag){case 3:Ae(s,s.stateNode.containerInfo),za(s,gn,i.memoizedState.cache),Io();break;case 27:case 5:Ee(s);break;case 4:Ae(s,s.stateNode.containerInfo);break;case 10:za(s,s.type,s.memoizedProps.value);break;case 13:var m=s.memoizedState;if(m!==null)return m.dehydrated!==null?(Ja(s),s.flags|=128,null):(l&s.child.childLanes)!==0?sg(i,s,l):(Ja(s),i=Aa(i,s,l),i!==null?i.sibling:null);Ja(s);break;case 19:var x=(i.flags&128)!==0;if(m=(l&s.childLanes)!==0,m||(Lo(i,s,l,!1),m=(l&s.childLanes)!==0),x){if(m)return lg(i,s,l);s.flags|=128}if(x=s.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),J(xn,xn.current),m)break;return null;case 22:case 23:return s.lanes=0,tg(i,s,l);case 24:za(s,gn,i.memoizedState.cache)}return Aa(i,s,l)}function cg(i,s,l){if(i!==null)if(i.memoizedProps!==s.pendingProps)_n=!0;else{if(!y0(i,l)&&(s.flags&128)===0)return _n=!1,TE(i,s,l);_n=(i.flags&131072)!==0}else _n=!1,Nt&&(s.flags&1048576)!==0&&Bm(s,gc,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var m=s.elementType,x=m._init;if(m=x(m._payload),s.type=m,typeof m=="function")kf(m)?(i=Gi(m,i),s.tag=1,s=ag(null,s,m,i,l)):(s.tag=0,s=d0(null,s,m,i,l));else{if(m!=null){if(x=m.$$typeof,x===U){s.tag=11,s=Zp(null,s,m,i,l);break e}else if(x===F){s.tag=14,s=Qp(null,s,m,i,l);break e}}throw s=De(m)||m,Error(r(306,s,""))}}return s;case 0:return d0(i,s,s.type,s.pendingProps,l);case 1:return m=s.type,x=Gi(m,s.pendingProps),ag(i,s,m,x,l);case 3:e:{if(Ae(s,s.stateNode.containerInfo),i===null)throw Error(r(387));m=s.pendingProps;var T=s.memoizedState;x=T.element,Hf(i,s),Ho(s,m,null,l);var A=s.memoizedState;if(m=A.cache,za(s,gn,m),m!==T.cache&&Of(s,[gn],l,!0),Go(),m=A.element,T.isDehydrated)if(T={element:m,isDehydrated:!1,cache:A.cache},s.updateQueue.baseState=T,s.memoizedState=T,s.flags&256){s=ig(i,s,m,l);break e}else if(m!==x){x=Sr(Error(r(424)),s),Fo(x),s=ig(i,s,m,l);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(en=qr(i.firstChild),$n=s,Nt=!0,Li=null,ta=!0,l=Gp(s,null,m,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Io(),m===x){s=Aa(i,s,l);break e}Nn(i,s,m,l)}s=s.child}return s;case 26:return Oc(i,s),i===null?(l=hx(s.type,null,s.pendingProps,null))?s.memoizedState=l:Nt||(l=s.type,i=s.pendingProps,m=Kc(ie.current).createElement(l),m[Wt]=s,m[Kt]=i,Rn(m,l,i),oe(m),s.stateNode=m):s.memoizedState=hx(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Ee(s),i===null&&Nt&&(m=s.stateNode=ux(s.type,s.pendingProps,ie.current),$n=s,ta=!0,x=en,ai(s.type)?(Q0=x,en=qr(m.firstChild)):en=x),Nn(i,s,s.pendingProps.children,l),Oc(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Nt&&((x=m=en)&&(m=JE(m,s.type,s.pendingProps,ta),m!==null?(s.stateNode=m,$n=s,en=qr(m.firstChild),ta=!1,x=!0):x=!1),x||Oi(s)),Ee(s),x=s.type,T=s.pendingProps,A=i!==null?i.memoizedProps:null,m=T.children,X0(x,T)?m=null:A!==null&&X0(x,A)&&(s.flags|=32),s.memoizedState!==null&&(x=Jf(i,s,dE,null,null,l),ul._currentValue=x),Oc(i,s),Nn(i,s,m,l),s.child;case 6:return i===null&&Nt&&((i=l=en)&&(l=XE(l,s.pendingProps,ta),l!==null?(s.stateNode=l,$n=s,en=null,i=!0):i=!1),i||Oi(s)),null;case 13:return sg(i,s,l);case 4:return Ae(s,s.stateNode.containerInfo),m=s.pendingProps,i===null?s.child=Is(s,null,m,l):Nn(i,s,m,l),s.child;case 11:return Zp(i,s,s.type,s.pendingProps,l);case 7:return Nn(i,s,s.pendingProps,l),s.child;case 8:return Nn(i,s,s.pendingProps.children,l),s.child;case 12:return Nn(i,s,s.pendingProps.children,l),s.child;case 10:return m=s.pendingProps,za(s,s.type,m.value),Nn(i,s,m.children,l),s.child;case 9:return x=s.type._context,m=s.pendingProps.children,Ui(s),x=On(x),m=m(x),s.flags|=1,Nn(i,s,m,l),s.child;case 14:return Qp(i,s,s.type,s.pendingProps,l);case 15:return eg(i,s,s.type,s.pendingProps,l);case 19:return lg(i,s,l);case 31:return m=s.pendingProps,l=s.mode,m={mode:m.mode,children:m.children},i===null?(l=Pc(m,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=ya(i.child,m),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return tg(i,s,l);case 24:return Ui(s),m=On(gn),i===null?(x=Bf(),x===null&&(x=jt,T=Pf(),x.pooledCache=T,T.refCount++,T!==null&&(x.pooledCacheLanes|=l),x=T),s.memoizedState={parent:m,cache:x},Gf(s),za(s,gn,x)):((i.lanes&l)!==0&&(Hf(i,s),Ho(s,null,null,l),Go()),x=i.memoizedState,T=s.memoizedState,x.parent!==m?(x={parent:m,cache:m},s.memoizedState=x,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=x),za(s,gn,m)):(m=T.cache,za(s,gn,m),m!==x.cache&&Of(s,[gn],l,!0))),Nn(i,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function ba(i){i.flags|=4}function ug(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!vx(s)){if(s=br.current,s!==null&&((Et&4194048)===Et?na!==null:(Et&62914560)!==Et&&(Et&536870912)===0||s!==na))throw Bo=Vf,$m;i.flags|=8192}}function Uc(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?wi():536870912,i.lanes|=s,Ps|=s)}function Xo(i,s){if(!Nt)switch(i.tailMode){case"hidden":s=i.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var m=null;l!==null;)l.alternate!==null&&(m=l),l=l.sibling;m===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:m.sibling=null}}function Zt(i){var s=i.alternate!==null&&i.alternate.child===i.child,l=0,m=0;if(s)for(var x=i.child;x!==null;)l|=x.lanes|x.childLanes,m|=x.subtreeFlags&65011712,m|=x.flags&65011712,x.return=i,x=x.sibling;else for(x=i.child;x!==null;)l|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=i,x=x.sibling;return i.subtreeFlags|=m,i.childLanes=l,s}function _E(i,s,l){var m=s.pendingProps;switch(Df(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(s),null;case 1:return Zt(s),null;case 3:return l=s.stateNode,m=null,i!==null&&(m=i.memoizedState.cache),s.memoizedState.cache!==m&&(s.flags|=2048),Sa(gn),Me(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(Do(s)?ba(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Hm())),Zt(s),null;case 26:return l=s.memoizedState,i===null?(ba(s),l!==null?(Zt(s),ug(s,l)):(Zt(s),s.flags&=-16777217)):l?l!==i.memoizedState?(ba(s),Zt(s),ug(s,l)):(Zt(s),s.flags&=-16777217):(i.memoizedProps!==m&&ba(s),Zt(s),s.flags&=-16777217),null;case 27:Ze(s),l=ie.current;var x=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==m&&ba(s);else{if(!m){if(s.stateNode===null)throw Error(r(166));return Zt(s),null}i=q.current,Do(s)?Vm(s):(i=ux(x,m,l),s.stateNode=i,ba(s))}return Zt(s),null;case 5:if(Ze(s),l=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==m&&ba(s);else{if(!m){if(s.stateNode===null)throw Error(r(166));return Zt(s),null}if(i=q.current,Do(s))Vm(s);else{switch(x=Kc(ie.current),i){case 1:i=x.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:i=x.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":i=x.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":i=x.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":i=x.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof m.is=="string"?x.createElement("select",{is:m.is}):x.createElement("select"),m.multiple?i.multiple=!0:m.size&&(i.size=m.size);break;default:i=typeof m.is=="string"?x.createElement(l,{is:m.is}):x.createElement(l)}}i[Wt]=s,i[Kt]=m;e:for(x=s.child;x!==null;){if(x.tag===5||x.tag===6)i.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===s)break e;for(;x.sibling===null;){if(x.return===null||x.return===s)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}s.stateNode=i;e:switch(Rn(i,l,m),l){case"button":case"input":case"select":case"textarea":i=!!m.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&ba(s)}}return Zt(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==m&&ba(s);else{if(typeof m!="string"&&s.stateNode===null)throw Error(r(166));if(i=ie.current,Do(s)){if(i=s.stateNode,l=s.memoizedProps,m=null,x=$n,x!==null)switch(x.tag){case 27:case 5:m=x.memoizedProps}i[Wt]=s,i=!!(i.nodeValue===l||m!==null&&m.suppressHydrationWarning===!0||rx(i.nodeValue,l)),i||Oi(s)}else i=Kc(i).createTextNode(m),i[Wt]=s,s.stateNode=i}return Zt(s),null;case 13:if(m=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(x=Do(s),m!==null&&m.dehydrated!==null){if(i===null){if(!x)throw Error(r(318));if(x=s.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[Wt]=s}else Io(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Zt(s),x=!1}else x=Hm(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=x),x=!0;if(!x)return s.flags&256?(wa(s),s):(wa(s),null)}if(wa(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=m!==null,i=i!==null&&i.memoizedState!==null,l){m=s.child,x=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(x=m.alternate.memoizedState.cachePool.pool);var T=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(T=m.memoizedState.cachePool.pool),T!==x&&(m.flags|=2048)}return l!==i&&l&&(s.child.flags|=8192),Uc(s,s.updateQueue),Zt(s),null;case 4:return Me(),i===null&&j0(s.stateNode.containerInfo),Zt(s),null;case 10:return Sa(s.type),Zt(s),null;case 19:if(D(xn),x=s.memoizedState,x===null)return Zt(s),null;if(m=(s.flags&128)!==0,T=x.rendering,T===null)if(m)Xo(x,!1);else{if(tn!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(T=Ic(i),T!==null){for(s.flags|=128,Xo(x,!1),i=T.updateQueue,s.updateQueue=i,Uc(s,i),s.subtreeFlags=0,i=l,l=s.child;l!==null;)Um(l,i),l=l.sibling;return J(xn,xn.current&1|2),s.child}i=i.sibling}x.tail!==null&&xe()>Gc&&(s.flags|=128,m=!0,Xo(x,!1),s.lanes=4194304)}else{if(!m)if(i=Ic(T),i!==null){if(s.flags|=128,m=!0,i=i.updateQueue,s.updateQueue=i,Uc(s,i),Xo(x,!0),x.tail===null&&x.tailMode==="hidden"&&!T.alternate&&!Nt)return Zt(s),null}else 2*xe()-x.renderingStartTime>Gc&&l!==536870912&&(s.flags|=128,m=!0,Xo(x,!1),s.lanes=4194304);x.isBackwards?(T.sibling=s.child,s.child=T):(i=x.last,i!==null?i.sibling=T:s.child=T,x.last=T)}return x.tail!==null?(s=x.tail,x.rendering=s,x.tail=s.sibling,x.renderingStartTime=xe(),s.sibling=null,i=xn.current,J(xn,m?i&1|2:i&1),s):(Zt(s),null);case 22:case 23:return wa(s),Yf(),m=s.memoizedState!==null,i!==null?i.memoizedState!==null!==m&&(s.flags|=8192):m&&(s.flags|=8192),m?(l&536870912)!==0&&(s.flags&128)===0&&(Zt(s),s.subtreeFlags&6&&(s.flags|=8192)):Zt(s),l=s.updateQueue,l!==null&&Uc(s,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),m=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(m=s.memoizedState.cachePool.pool),m!==l&&(s.flags|=2048),i!==null&&D(Bi),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),Sa(gn),Zt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function EE(i,s){switch(Df(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Sa(gn),Me(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Ze(s),null;case 13:if(wa(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Io()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return D(xn),null;case 4:return Me(),null;case 10:return Sa(s.type),null;case 22:case 23:return wa(s),Yf(),i!==null&&D(Bi),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Sa(gn),null;case 25:return null;default:return null}}function fg(i,s){switch(Df(s),s.tag){case 3:Sa(gn),Me();break;case 26:case 27:case 5:Ze(s);break;case 4:Me();break;case 13:wa(s);break;case 19:D(xn);break;case 10:Sa(s.type);break;case 22:case 23:wa(s),Yf(),i!==null&&D(Bi);break;case 24:Sa(gn)}}function Wo(i,s){try{var l=s.updateQueue,m=l!==null?l.lastEffect:null;if(m!==null){var x=m.next;l=x;do{if((l.tag&i)===i){m=void 0;var T=l.create,A=l.inst;m=T(),A.destroy=m}l=l.next}while(l!==x)}}catch(I){Ht(s,s.return,I)}}function Wa(i,s,l){try{var m=s.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var T=x.next;m=T;do{if((m.tag&i)===i){var A=m.inst,I=A.destroy;if(I!==void 0){A.destroy=void 0,x=s;var Z=l,ue=I;try{ue()}catch(Se){Ht(x,Z,Se)}}}m=m.next}while(m!==T)}}catch(Se){Ht(s,s.return,Se)}}function dg(i){var s=i.updateQueue;if(s!==null){var l=i.stateNode;try{Qm(s,l)}catch(m){Ht(i,i.return,m)}}}function hg(i,s,l){l.props=Gi(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(m){Ht(i,s,m)}}function Ko(i,s){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var m=i.stateNode;break;case 30:m=i.stateNode;break;default:m=i.stateNode}typeof l=="function"?i.refCleanup=l(m):l.current=m}}catch(x){Ht(i,s,x)}}function ra(i,s){var l=i.ref,m=i.refCleanup;if(l!==null)if(typeof m=="function")try{m()}catch(x){Ht(i,s,x)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(x){Ht(i,s,x)}else l.current=null}function mg(i){var s=i.type,l=i.memoizedProps,m=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&m.focus();break e;case"img":l.src?m.src=l.src:l.srcSet&&(m.srcset=l.srcSet)}}catch(x){Ht(i,i.return,x)}}function T0(i,s,l){try{var m=i.stateNode;zE(m,i.type,l,s),m[Kt]=s}catch(x){Ht(i,i.return,x)}}function pg(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&ai(i.type)||i.tag===4}function _0(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||pg(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&ai(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function E0(i,s,l){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(i),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Wc));else if(m!==4&&(m===27&&ai(i.type)&&(l=i.stateNode,s=null),i=i.child,i!==null))for(E0(i,s,l),i=i.sibling;i!==null;)E0(i,s,l),i=i.sibling}function Bc(i,s,l){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?l.insertBefore(i,s):l.appendChild(i);else if(m!==4&&(m===27&&ai(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(Bc(i,s,l),i=i.sibling;i!==null;)Bc(i,s,l),i=i.sibling}function gg(i){var s=i.stateNode,l=i.memoizedProps;try{for(var m=i.type,x=s.attributes;x.length;)s.removeAttributeNode(x[0]);Rn(s,m,l),s[Wt]=i,s[Kt]=l}catch(T){Ht(i,i.return,T)}}var ka=!1,on=!1,S0=!1,xg=typeof WeakSet=="function"?WeakSet:Set,En=null;function SE(i,s){if(i=i.containerInfo,$0=ru,i=km(i),_f(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var m=l.getSelection&&l.getSelection();if(m&&m.rangeCount!==0){l=m.anchorNode;var x=m.anchorOffset,T=m.focusNode;m=m.focusOffset;try{l.nodeType,T.nodeType}catch{l=null;break e}var A=0,I=-1,Z=-1,ue=0,Se=0,ke=i,he=null;t:for(;;){for(var pe;ke!==l||x!==0&&ke.nodeType!==3||(I=A+x),ke!==T||m!==0&&ke.nodeType!==3||(Z=A+m),ke.nodeType===3&&(A+=ke.nodeValue.length),(pe=ke.firstChild)!==null;)he=ke,ke=pe;for(;;){if(ke===i)break t;if(he===l&&++ue===x&&(I=A),he===T&&++Se===m&&(Z=A),(pe=ke.nextSibling)!==null)break;ke=he,he=ke.parentNode}ke=pe}l=I===-1||Z===-1?null:{start:I,end:Z}}else l=null}l=l||{start:0,end:0}}else l=null;for(J0={focusedElem:i,selectionRange:l},ru=!1,En=s;En!==null;)if(s=En,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,En=i;else for(;En!==null;){switch(s=En,T=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&T!==null){i=void 0,l=s,x=T.memoizedProps,T=T.memoizedState,m=l.stateNode;try{var tt=Gi(l.type,x,l.elementType===l.type);i=m.getSnapshotBeforeUpdate(tt,T),m.__reactInternalSnapshotBeforeUpdate=i}catch(Ke){Ht(l,l.return,Ke)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,l=i.nodeType,l===9)K0(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":K0(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,En=i;break}En=s.return}}function vg(i,s,l){var m=l.flags;switch(l.tag){case 0:case 11:case 15:Ka(i,l),m&4&&Wo(5,l);break;case 1:if(Ka(i,l),m&4)if(i=l.stateNode,s===null)try{i.componentDidMount()}catch(A){Ht(l,l.return,A)}else{var x=Gi(l.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(x,s,i.__reactInternalSnapshotBeforeUpdate)}catch(A){Ht(l,l.return,A)}}m&64&&dg(l),m&512&&Ko(l,l.return);break;case 3:if(Ka(i,l),m&64&&(i=l.updateQueue,i!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{Qm(i,s)}catch(A){Ht(l,l.return,A)}}break;case 27:s===null&&m&4&&gg(l);case 26:case 5:Ka(i,l),s===null&&m&4&&mg(l),m&512&&Ko(l,l.return);break;case 12:Ka(i,l);break;case 13:Ka(i,l),m&4&&_g(i,l),m&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=DE.bind(null,l),WE(i,l))));break;case 22:if(m=l.memoizedState!==null||ka,!m){s=s!==null&&s.memoizedState!==null||on,x=ka;var T=on;ka=m,(on=s)&&!T?Za(i,l,(l.subtreeFlags&8772)!==0):Ka(i,l),ka=x,on=T}break;case 30:break;default:Ka(i,l)}}function yg(i){var s=i.alternate;s!==null&&(i.alternate=null,yg(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&P(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var $t=null,nr=!1;function Na(i,s,l){for(l=l.child;l!==null;)Tg(i,s,l),l=l.sibling}function Tg(i,s,l){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(Vt,l)}catch{}switch(l.tag){case 26:on||ra(l,s),Na(i,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:on||ra(l,s);var m=$t,x=nr;ai(l.type)&&($t=l.stateNode,nr=!1),Na(i,s,l),sl(l.stateNode),$t=m,nr=x;break;case 5:on||ra(l,s);case 6:if(m=$t,x=nr,$t=null,Na(i,s,l),$t=m,nr=x,$t!==null)if(nr)try{($t.nodeType===9?$t.body:$t.nodeName==="HTML"?$t.ownerDocument.body:$t).removeChild(l.stateNode)}catch(T){Ht(l,s,T)}else try{$t.removeChild(l.stateNode)}catch(T){Ht(l,s,T)}break;case 18:$t!==null&&(nr?(i=$t,lx(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),ml(i)):lx($t,l.stateNode));break;case 4:m=$t,x=nr,$t=l.stateNode.containerInfo,nr=!0,Na(i,s,l),$t=m,nr=x;break;case 0:case 11:case 14:case 15:on||Wa(2,l,s),on||Wa(4,l,s),Na(i,s,l);break;case 1:on||(ra(l,s),m=l.stateNode,typeof m.componentWillUnmount=="function"&&hg(l,s,m)),Na(i,s,l);break;case 21:Na(i,s,l);break;case 22:on=(m=on)||l.memoizedState!==null,Na(i,s,l),on=m;break;default:Na(i,s,l)}}function _g(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ml(i)}catch(l){Ht(s,s.return,l)}}function CE(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new xg),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new xg),s;default:throw Error(r(435,i.tag))}}function C0(i,s){var l=CE(i);s.forEach(function(m){var x=IE.bind(null,i,m);l.has(m)||(l.add(m),m.then(x,x))})}function cr(i,s){var l=s.deletions;if(l!==null)for(var m=0;m<l.length;m++){var x=l[m],T=i,A=s,I=A;e:for(;I!==null;){switch(I.tag){case 27:if(ai(I.type)){$t=I.stateNode,nr=!1;break e}break;case 5:$t=I.stateNode,nr=!1;break e;case 3:case 4:$t=I.stateNode.containerInfo,nr=!0;break e}I=I.return}if($t===null)throw Error(r(160));Tg(T,A,x),$t=null,nr=!1,T=x.alternate,T!==null&&(T.return=null),x.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Eg(s,i),s=s.sibling}var jr=null;function Eg(i,s){var l=i.alternate,m=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:cr(s,i),ur(i),m&4&&(Wa(3,i,i.return),Wo(3,i),Wa(5,i,i.return));break;case 1:cr(s,i),ur(i),m&512&&(on||l===null||ra(l,l.return)),m&64&&ka&&(i=i.updateQueue,i!==null&&(m=i.callbacks,m!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?m:l.concat(m))));break;case 26:var x=jr;if(cr(s,i),ur(i),m&512&&(on||l===null||ra(l,l.return)),m&4){var T=l!==null?l.memoizedState:null;if(m=i.memoizedState,l===null)if(m===null)if(i.stateNode===null){e:{m=i.type,l=i.memoizedProps,x=x.ownerDocument||x;t:switch(m){case"title":T=x.getElementsByTagName("title")[0],(!T||T[O]||T[Wt]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=x.createElement(m),x.head.insertBefore(T,x.querySelector("head > title"))),Rn(T,m,l),T[Wt]=i,oe(T),m=T;break e;case"link":var A=gx("link","href",x).get(m+(l.href||""));if(A){for(var I=0;I<A.length;I++)if(T=A[I],T.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&T.getAttribute("rel")===(l.rel==null?null:l.rel)&&T.getAttribute("title")===(l.title==null?null:l.title)&&T.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){A.splice(I,1);break t}}T=x.createElement(m),Rn(T,m,l),x.head.appendChild(T);break;case"meta":if(A=gx("meta","content",x).get(m+(l.content||""))){for(I=0;I<A.length;I++)if(T=A[I],T.getAttribute("content")===(l.content==null?null:""+l.content)&&T.getAttribute("name")===(l.name==null?null:l.name)&&T.getAttribute("property")===(l.property==null?null:l.property)&&T.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&T.getAttribute("charset")===(l.charSet==null?null:l.charSet)){A.splice(I,1);break t}}T=x.createElement(m),Rn(T,m,l),x.head.appendChild(T);break;default:throw Error(r(468,m))}T[Wt]=i,oe(T),m=T}i.stateNode=m}else xx(x,i.type,i.stateNode);else i.stateNode=px(x,m,i.memoizedProps);else T!==m?(T===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):T.count--,m===null?xx(x,i.type,i.stateNode):px(x,m,i.memoizedProps)):m===null&&i.stateNode!==null&&T0(i,i.memoizedProps,l.memoizedProps)}break;case 27:cr(s,i),ur(i),m&512&&(on||l===null||ra(l,l.return)),l!==null&&m&4&&T0(i,i.memoizedProps,l.memoizedProps);break;case 5:if(cr(s,i),ur(i),m&512&&(on||l===null||ra(l,l.return)),i.flags&32){x=i.stateNode;try{ps(x,"")}catch(pe){Ht(i,i.return,pe)}}m&4&&i.stateNode!=null&&(x=i.memoizedProps,T0(i,x,l!==null?l.memoizedProps:x)),m&1024&&(S0=!0);break;case 6:if(cr(s,i),ur(i),m&4){if(i.stateNode===null)throw Error(r(162));m=i.memoizedProps,l=i.stateNode;try{l.nodeValue=m}catch(pe){Ht(i,i.return,pe)}}break;case 3:if(eu=null,x=jr,jr=Zc(s.containerInfo),cr(s,i),jr=x,ur(i),m&4&&l!==null&&l.memoizedState.isDehydrated)try{ml(s.containerInfo)}catch(pe){Ht(i,i.return,pe)}S0&&(S0=!1,Sg(i));break;case 4:m=jr,jr=Zc(i.stateNode.containerInfo),cr(s,i),ur(i),jr=m;break;case 12:cr(s,i),ur(i);break;case 13:cr(s,i),ur(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(M0=xe()),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,C0(i,m)));break;case 22:x=i.memoizedState!==null;var Z=l!==null&&l.memoizedState!==null,ue=ka,Se=on;if(ka=ue||x,on=Se||Z,cr(s,i),on=Se,ka=ue,ur(i),m&8192)e:for(s=i.stateNode,s._visibility=x?s._visibility&-2:s._visibility|1,x&&(l===null||Z||ka||on||Hi(i)),l=null,s=i;;){if(s.tag===5||s.tag===26){if(l===null){Z=l=s;try{if(T=Z.stateNode,x)A=T.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{I=Z.stateNode;var ke=Z.memoizedProps.style,he=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;I.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(pe){Ht(Z,Z.return,pe)}}}else if(s.tag===6){if(l===null){Z=s;try{Z.stateNode.nodeValue=x?"":Z.memoizedProps}catch(pe){Ht(Z,Z.return,pe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}m&4&&(m=i.updateQueue,m!==null&&(l=m.retryQueue,l!==null&&(m.retryQueue=null,C0(i,l))));break;case 19:cr(s,i),ur(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,C0(i,m)));break;case 30:break;case 21:break;default:cr(s,i),ur(i)}}function ur(i){var s=i.flags;if(s&2){try{for(var l,m=i.return;m!==null;){if(pg(m)){l=m;break}m=m.return}if(l==null)throw Error(r(160));switch(l.tag){case 27:var x=l.stateNode,T=_0(i);Bc(i,T,x);break;case 5:var A=l.stateNode;l.flags&32&&(ps(A,""),l.flags&=-33);var I=_0(i);Bc(i,I,A);break;case 3:case 4:var Z=l.stateNode.containerInfo,ue=_0(i);E0(i,ue,Z);break;default:throw Error(r(161))}}catch(Se){Ht(i,i.return,Se)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Sg(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Sg(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ka(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)vg(i,s.alternate,s),s=s.sibling}function Hi(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Wa(4,s,s.return),Hi(s);break;case 1:ra(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&hg(s,s.return,l),Hi(s);break;case 27:sl(s.stateNode);case 26:case 5:ra(s,s.return),Hi(s);break;case 22:s.memoizedState===null&&Hi(s);break;case 30:Hi(s);break;default:Hi(s)}i=i.sibling}}function Za(i,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var m=s.alternate,x=i,T=s,A=T.flags;switch(T.tag){case 0:case 11:case 15:Za(x,T,l),Wo(4,T);break;case 1:if(Za(x,T,l),m=T,x=m.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ue){Ht(m,m.return,ue)}if(m=T,x=m.updateQueue,x!==null){var I=m.stateNode;try{var Z=x.shared.hiddenCallbacks;if(Z!==null)for(x.shared.hiddenCallbacks=null,x=0;x<Z.length;x++)Zm(Z[x],I)}catch(ue){Ht(m,m.return,ue)}}l&&A&64&&dg(T),Ko(T,T.return);break;case 27:gg(T);case 26:case 5:Za(x,T,l),l&&m===null&&A&4&&mg(T),Ko(T,T.return);break;case 12:Za(x,T,l);break;case 13:Za(x,T,l),l&&A&4&&_g(x,T);break;case 22:T.memoizedState===null&&Za(x,T,l),Ko(T,T.return);break;case 30:break;default:Za(x,T,l)}s=s.sibling}}function w0(i,s){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&Oo(l))}function A0(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Oo(i))}function aa(i,s,l,m){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Cg(i,s,l,m),s=s.sibling}function Cg(i,s,l,m){var x=s.flags;switch(s.tag){case 0:case 11:case 15:aa(i,s,l,m),x&2048&&Wo(9,s);break;case 1:aa(i,s,l,m);break;case 3:aa(i,s,l,m),x&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Oo(i)));break;case 12:if(x&2048){aa(i,s,l,m),i=s.stateNode;try{var T=s.memoizedProps,A=T.id,I=T.onPostCommit;typeof I=="function"&&I(A,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Z){Ht(s,s.return,Z)}}else aa(i,s,l,m);break;case 13:aa(i,s,l,m);break;case 23:break;case 22:T=s.stateNode,A=s.alternate,s.memoizedState!==null?T._visibility&2?aa(i,s,l,m):Zo(i,s):T._visibility&2?aa(i,s,l,m):(T._visibility|=2,Fs(i,s,l,m,(s.subtreeFlags&10256)!==0)),x&2048&&w0(A,s);break;case 24:aa(i,s,l,m),x&2048&&A0(s.alternate,s);break;default:aa(i,s,l,m)}}function Fs(i,s,l,m,x){for(x=x&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var T=i,A=s,I=l,Z=m,ue=A.flags;switch(A.tag){case 0:case 11:case 15:Fs(T,A,I,Z,x),Wo(8,A);break;case 23:break;case 22:var Se=A.stateNode;A.memoizedState!==null?Se._visibility&2?Fs(T,A,I,Z,x):Zo(T,A):(Se._visibility|=2,Fs(T,A,I,Z,x)),x&&ue&2048&&w0(A.alternate,A);break;case 24:Fs(T,A,I,Z,x),x&&ue&2048&&A0(A.alternate,A);break;default:Fs(T,A,I,Z,x)}s=s.sibling}}function Zo(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=i,m=s,x=m.flags;switch(m.tag){case 22:Zo(l,m),x&2048&&w0(m.alternate,m);break;case 24:Zo(l,m),x&2048&&A0(m.alternate,m);break;default:Zo(l,m)}s=s.sibling}}var Qo=8192;function Ls(i){if(i.subtreeFlags&Qo)for(i=i.child;i!==null;)wg(i),i=i.sibling}function wg(i){switch(i.tag){case 26:Ls(i),i.flags&Qo&&i.memoizedState!==null&&cS(jr,i.memoizedState,i.memoizedProps);break;case 5:Ls(i);break;case 3:case 4:var s=jr;jr=Zc(i.stateNode.containerInfo),Ls(i),jr=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=Qo,Qo=16777216,Ls(i),Qo=s):Ls(i));break;default:Ls(i)}}function Ag(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function el(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var m=s[l];En=m,kg(m,i)}Ag(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)bg(i),i=i.sibling}function bg(i){switch(i.tag){case 0:case 11:case 15:el(i),i.flags&2048&&Wa(9,i,i.return);break;case 3:el(i);break;case 12:el(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Vc(i)):el(i);break;default:el(i)}}function Vc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var m=s[l];En=m,kg(m,i)}Ag(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Wa(8,s,s.return),Vc(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,Vc(s));break;default:Vc(s)}i=i.sibling}}function kg(i,s){for(;En!==null;){var l=En;switch(l.tag){case 0:case 11:case 15:Wa(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var m=l.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Oo(l.memoizedState.cache)}if(m=l.child,m!==null)m.return=l,En=m;else e:for(l=i;En!==null;){m=En;var x=m.sibling,T=m.return;if(yg(m),m===l){En=null;break e}if(x!==null){x.return=T,En=x;break e}En=T}}}var wE={getCacheForType:function(i){var s=On(gn),l=s.data.get(i);return l===void 0&&(l=i(),s.data.set(i,l)),l}},AE=typeof WeakMap=="function"?WeakMap:Map,Rt=0,jt=null,gt=null,Et=0,Dt=0,fr=null,Qa=!1,Os=!1,b0=!1,Ma=0,tn=0,ei=0,zi=0,k0=0,kr=0,Ps=0,tl=null,rr=null,N0=!1,M0=0,Gc=1/0,Hc=null,ti=null,Mn=0,ni=null,Us=null,Bs=0,R0=0,D0=null,Ng=null,nl=0,I0=null;function dr(){if((Rt&2)!==0&&Et!==0)return Et&-Et;if(re.T!==null){var i=As;return i!==0?i:V0()}return ea()}function Mg(){kr===0&&(kr=(Et&536870912)===0||Nt?Ci():536870912);var i=br.current;return i!==null&&(i.flags|=32),kr}function hr(i,s,l){(i===jt&&(Dt===2||Dt===9)||i.cancelPendingCommit!==null)&&(Vs(i,0),ri(i,Et,kr,!1)),Pe(i,l),((Rt&2)===0||i!==jt)&&(i===jt&&((Rt&2)===0&&(zi|=l),tn===4&&ri(i,Et,kr,!1)),ia(i))}function Rg(i,s,l){if((Rt&6)!==0)throw Error(r(327));var m=!l&&(s&124)===0&&(s&i.expiredLanes)===0||pa(i,s),x=m?NE(i,s):O0(i,s,!0),T=m;do{if(x===0){Os&&!m&&ri(i,s,0,!1);break}else{if(l=i.current.alternate,T&&!bE(l)){x=O0(i,s,!1),T=!1;continue}if(x===2){if(T=s,i.errorRecoveryDisabledLanes&T)var A=0;else A=i.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){s=A;e:{var I=i;x=tl;var Z=I.current.memoizedState.isDehydrated;if(Z&&(Vs(I,A).flags|=256),A=O0(I,A,!1),A!==2){if(b0&&!Z){I.errorRecoveryDisabledLanes|=T,zi|=T,x=4;break e}T=rr,rr=x,T!==null&&(rr===null?rr=T:rr.push.apply(rr,T))}x=A}if(T=!1,x!==2)continue}}if(x===1){Vs(i,0),ri(i,s,0,!0);break}e:{switch(m=i,T=x,T){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:ri(m,s,kr,!Qa);break e;case 2:rr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(x=M0+300-xe(),10<x)){if(ri(m,s,kr,!Qa),Qr(m,0,!0)!==0)break e;m.timeoutHandle=sx(Dg.bind(null,m,l,rr,Hc,N0,s,kr,zi,Ps,Qa,T,2,-0,0),x);break e}Dg(m,l,rr,Hc,N0,s,kr,zi,Ps,Qa,T,0,-0,0)}}break}while(!0);ia(i)}function Dg(i,s,l,m,x,T,A,I,Z,ue,Se,ke,he,pe){if(i.timeoutHandle=-1,ke=s.subtreeFlags,(ke&8192||(ke&16785408)===16785408)&&(cl={stylesheets:null,count:0,unsuspend:lS},wg(s),ke=uS(),ke!==null)){i.cancelPendingCommit=ke(Bg.bind(null,i,s,T,l,m,x,A,I,Z,Se,1,he,pe)),ri(i,T,A,!ue);return}Bg(i,s,T,l,m,x,A,I,Z)}function bE(i){for(var s=i;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var m=0;m<l.length;m++){var x=l[m],T=x.getSnapshot;x=x.value;try{if(!or(T(),x))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ri(i,s,l,m){s&=~k0,s&=~zi,i.suspendedLanes|=s,i.pingedLanes&=~s,m&&(i.warmLanes|=s),m=i.expirationTimes;for(var x=s;0<x;){var T=31-Ge(x),A=1<<T;m[T]=-1,x&=~A}l!==0&&vt(i,l,s)}function zc(){return(Rt&6)===0?(rl(0),!1):!0}function F0(){if(gt!==null){if(Dt===0)var i=gt.return;else i=gt,Ea=Pi=null,Kf(i),Ds=null,$o=0,i=gt;for(;i!==null;)fg(i.alternate,i),i=i.return;gt=null}}function Vs(i,s){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,qE(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),F0(),jt=i,gt=l=ya(i.current,null),Et=s,Dt=0,fr=null,Qa=!1,Os=pa(i,s),b0=!1,Ps=kr=k0=zi=ei=tn=0,rr=tl=null,N0=!1,(s&8)!==0&&(s|=s&32);var m=i.entangledLanes;if(m!==0)for(i=i.entanglements,m&=s;0<m;){var x=31-Ge(m),T=1<<x;s|=i[x],m&=~T}return Ma=s,fc(),l}function Ig(i,s){dt=null,re.H=Mc,s===Uo||s===Tc?(s=Wm(),Dt=3):s===$m?(s=Wm(),Dt=4):Dt=s===Kp?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,fr=s,gt===null&&(tn=1,Lc(i,Sr(s,i.current)))}function Fg(){var i=re.H;return re.H=Mc,i===null?Mc:i}function Lg(){var i=re.A;return re.A=wE,i}function L0(){tn=4,Qa||(Et&4194048)!==Et&&br.current!==null||(Os=!0),(ei&134217727)===0&&(zi&134217727)===0||jt===null||ri(jt,Et,kr,!1)}function O0(i,s,l){var m=Rt;Rt|=2;var x=Fg(),T=Lg();(jt!==i||Et!==s)&&(Hc=null,Vs(i,s)),s=!1;var A=tn;e:do try{if(Dt!==0&&gt!==null){var I=gt,Z=fr;switch(Dt){case 8:F0(),A=6;break e;case 3:case 2:case 9:case 6:br.current===null&&(s=!0);var ue=Dt;if(Dt=0,fr=null,Gs(i,I,Z,ue),l&&Os){A=0;break e}break;default:ue=Dt,Dt=0,fr=null,Gs(i,I,Z,ue)}}kE(),A=tn;break}catch(Se){Ig(i,Se)}while(!0);return s&&i.shellSuspendCounter++,Ea=Pi=null,Rt=m,re.H=x,re.A=T,gt===null&&(jt=null,Et=0,fc()),A}function kE(){for(;gt!==null;)Og(gt)}function NE(i,s){var l=Rt;Rt|=2;var m=Fg(),x=Lg();jt!==i||Et!==s?(Hc=null,Gc=xe()+500,Vs(i,s)):Os=pa(i,s);e:do try{if(Dt!==0&&gt!==null){s=gt;var T=fr;t:switch(Dt){case 1:Dt=0,fr=null,Gs(i,s,T,1);break;case 2:case 9:if(Jm(T)){Dt=0,fr=null,Pg(s);break}s=function(){Dt!==2&&Dt!==9||jt!==i||(Dt=7),ia(i)},T.then(s,s);break e;case 3:Dt=7;break e;case 4:Dt=5;break e;case 7:Jm(T)?(Dt=0,fr=null,Pg(s)):(Dt=0,fr=null,Gs(i,s,T,7));break;case 5:var A=null;switch(gt.tag){case 26:A=gt.memoizedState;case 5:case 27:var I=gt;if(!A||vx(A)){Dt=0,fr=null;var Z=I.sibling;if(Z!==null)gt=Z;else{var ue=I.return;ue!==null?(gt=ue,jc(ue)):gt=null}break t}}Dt=0,fr=null,Gs(i,s,T,5);break;case 6:Dt=0,fr=null,Gs(i,s,T,6);break;case 8:F0(),tn=6;break e;default:throw Error(r(462))}}ME();break}catch(Se){Ig(i,Se)}while(!0);return Ea=Pi=null,re.H=m,re.A=x,Rt=l,gt!==null?0:(jt=null,Et=0,fc(),tn)}function ME(){for(;gt!==null&&!ht();)Og(gt)}function Og(i){var s=cg(i.alternate,i,Ma);i.memoizedProps=i.pendingProps,s===null?jc(i):gt=s}function Pg(i){var s=i,l=s.alternate;switch(s.tag){case 15:case 0:s=rg(l,s,s.pendingProps,s.type,void 0,Et);break;case 11:s=rg(l,s,s.pendingProps,s.type.render,s.ref,Et);break;case 5:Kf(s);default:fg(l,s),s=gt=Um(s,Ma),s=cg(l,s,Ma)}i.memoizedProps=i.pendingProps,s===null?jc(i):gt=s}function Gs(i,s,l,m){Ea=Pi=null,Kf(s),Ds=null,$o=0;var x=s.return;try{if(yE(i,x,s,l,Et)){tn=1,Lc(i,Sr(l,i.current)),gt=null;return}}catch(T){if(x!==null)throw gt=x,T;tn=1,Lc(i,Sr(l,i.current)),gt=null;return}s.flags&32768?(Nt||m===1?i=!0:Os||(Et&536870912)!==0?i=!1:(Qa=i=!0,(m===2||m===9||m===3||m===6)&&(m=br.current,m!==null&&m.tag===13&&(m.flags|=16384))),Ug(s,i)):jc(s)}function jc(i){var s=i;do{if((s.flags&32768)!==0){Ug(s,Qa);return}i=s.return;var l=_E(s.alternate,s,Ma);if(l!==null){gt=l;return}if(s=s.sibling,s!==null){gt=s;return}gt=s=i}while(s!==null);tn===0&&(tn=5)}function Ug(i,s){do{var l=EE(i.alternate,i);if(l!==null){l.flags&=32767,gt=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(i=i.sibling,i!==null)){gt=i;return}gt=i=l}while(i!==null);tn=6,gt=null}function Bg(i,s,l,m,x,T,A,I,Z){i.cancelPendingCommit=null;do qc();while(Mn!==0);if((Rt&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(T=s.lanes|s.childLanes,T|=Af,lt(i,l,T,A,I,Z),i===jt&&(gt=jt=null,Et=0),Us=s,ni=i,Bs=l,R0=T,D0=x,Ng=m,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,FE(_t,function(){return jg(),null})):(i.callbackNode=null,i.callbackPriority=0),m=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||m){m=re.T,re.T=null,x=ce.p,ce.p=2,A=Rt,Rt|=4;try{SE(i,s,l)}finally{Rt=A,ce.p=x,re.T=m}}Mn=1,Vg(),Gg(),Hg()}}function Vg(){if(Mn===1){Mn=0;var i=ni,s=Us,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=re.T,re.T=null;var m=ce.p;ce.p=2;var x=Rt;Rt|=4;try{Eg(s,i);var T=J0,A=km(i.containerInfo),I=T.focusedElem,Z=T.selectionRange;if(A!==I&&I&&I.ownerDocument&&bm(I.ownerDocument.documentElement,I)){if(Z!==null&&_f(I)){var ue=Z.start,Se=Z.end;if(Se===void 0&&(Se=ue),"selectionStart"in I)I.selectionStart=ue,I.selectionEnd=Math.min(Se,I.value.length);else{var ke=I.ownerDocument||document,he=ke&&ke.defaultView||window;if(he.getSelection){var pe=he.getSelection(),tt=I.textContent.length,Ke=Math.min(Z.start,tt),Ut=Z.end===void 0?Ke:Math.min(Z.end,tt);!pe.extend&&Ke>Ut&&(A=Ut,Ut=Ke,Ke=A);var se=Am(I,Ke),ae=Am(I,Ut);if(se&&ae&&(pe.rangeCount!==1||pe.anchorNode!==se.node||pe.anchorOffset!==se.offset||pe.focusNode!==ae.node||pe.focusOffset!==ae.offset)){var le=ke.createRange();le.setStart(se.node,se.offset),pe.removeAllRanges(),Ke>Ut?(pe.addRange(le),pe.extend(ae.node,ae.offset)):(le.setEnd(ae.node,ae.offset),pe.addRange(le))}}}}for(ke=[],pe=I;pe=pe.parentNode;)pe.nodeType===1&&ke.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<ke.length;I++){var we=ke[I];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}ru=!!$0,J0=$0=null}finally{Rt=x,ce.p=m,re.T=l}}i.current=s,Mn=2}}function Gg(){if(Mn===2){Mn=0;var i=ni,s=Us,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=re.T,re.T=null;var m=ce.p;ce.p=2;var x=Rt;Rt|=4;try{vg(i,s.alternate,s)}finally{Rt=x,ce.p=m,re.T=l}}Mn=3}}function Hg(){if(Mn===4||Mn===3){Mn=0,Ne();var i=ni,s=Us,l=Bs,m=Ng;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Mn=5:(Mn=0,Us=ni=null,zg(i,i.pendingLanes));var x=i.pendingLanes;if(x===0&&(ti=null),kn(l),s=s.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(Vt,s,void 0,(s.current.flags&128)===128)}catch{}if(m!==null){s=re.T,x=ce.p,ce.p=2,re.T=null;try{for(var T=i.onRecoverableError,A=0;A<m.length;A++){var I=m[A];T(I.value,{componentStack:I.stack})}}finally{re.T=s,ce.p=x}}(Bs&3)!==0&&qc(),ia(i),x=i.pendingLanes,(l&4194090)!==0&&(x&42)!==0?i===I0?nl++:(nl=0,I0=i):nl=0,rl(0)}}function zg(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Oo(s)))}function qc(i){return Vg(),Gg(),Hg(),jg()}function jg(){if(Mn!==5)return!1;var i=ni,s=R0;R0=0;var l=kn(Bs),m=re.T,x=ce.p;try{ce.p=32>l?32:l,re.T=null,l=D0,D0=null;var T=ni,A=Bs;if(Mn=0,Us=ni=null,Bs=0,(Rt&6)!==0)throw Error(r(331));var I=Rt;if(Rt|=4,bg(T.current),Cg(T,T.current,A,l),Rt=I,rl(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(Vt,T)}catch{}return!0}finally{ce.p=x,re.T=m,zg(i,s)}}function qg(i,s,l){s=Sr(l,s),s=f0(i.stateNode,s,2),i=Ya(i,s,2),i!==null&&(Pe(i,2),ia(i))}function Ht(i,s,l){if(i.tag===3)qg(i,i,l);else for(;s!==null;){if(s.tag===3){qg(s,i,l);break}else if(s.tag===1){var m=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(ti===null||!ti.has(m))){i=Sr(l,i),l=Xp(2),m=Ya(s,l,2),m!==null&&(Wp(l,m,s,i),Pe(m,2),ia(m));break}}s=s.return}}function P0(i,s,l){var m=i.pingCache;if(m===null){m=i.pingCache=new AE;var x=new Set;m.set(s,x)}else x=m.get(s),x===void 0&&(x=new Set,m.set(s,x));x.has(l)||(b0=!0,x.add(l),i=RE.bind(null,i,s,l),s.then(i,i))}function RE(i,s,l){var m=i.pingCache;m!==null&&m.delete(s),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,jt===i&&(Et&l)===l&&(tn===4||tn===3&&(Et&62914560)===Et&&300>xe()-M0?(Rt&2)===0&&Vs(i,0):k0|=l,Ps===Et&&(Ps=0)),ia(i)}function Yg(i,s){s===0&&(s=wi()),i=Es(i,s),i!==null&&(Pe(i,s),ia(i))}function DE(i){var s=i.memoizedState,l=0;s!==null&&(l=s.retryLane),Yg(i,l)}function IE(i,s){var l=0;switch(i.tag){case 13:var m=i.stateNode,x=i.memoizedState;x!==null&&(l=x.retryLane);break;case 19:m=i.stateNode;break;case 22:m=i.stateNode._retryCache;break;default:throw Error(r(314))}m!==null&&m.delete(s),Yg(i,l)}function FE(i,s){return ut(i,s)}var Yc=null,Hs=null,U0=!1,$c=!1,B0=!1,ji=0;function ia(i){i!==Hs&&i.next===null&&(Hs===null?Yc=Hs=i:Hs=Hs.next=i),$c=!0,U0||(U0=!0,OE())}function rl(i,s){if(!B0&&$c){B0=!0;do for(var l=!1,m=Yc;m!==null;){if(i!==0){var x=m.pendingLanes;if(x===0)var T=0;else{var A=m.suspendedLanes,I=m.pingedLanes;T=(1<<31-Ge(42|i)+1)-1,T&=x&~(A&~I),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(l=!0,Wg(m,T))}else T=Et,T=Qr(m,m===jt?T:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(T&3)===0||pa(m,T)||(l=!0,Wg(m,T));m=m.next}while(l);B0=!1}}function LE(){$g()}function $g(){$c=U0=!1;var i=0;ji!==0&&(jE()&&(i=ji),ji=0);for(var s=xe(),l=null,m=Yc;m!==null;){var x=m.next,T=Jg(m,s);T===0?(m.next=null,l===null?Yc=x:l.next=x,x===null&&(Hs=l)):(l=m,(i!==0||(T&3)!==0)&&($c=!0)),m=x}rl(i)}function Jg(i,s){for(var l=i.suspendedLanes,m=i.pingedLanes,x=i.expirationTimes,T=i.pendingLanes&-62914561;0<T;){var A=31-Ge(T),I=1<<A,Z=x[A];Z===-1?((I&l)===0||(I&m)!==0)&&(x[A]=ds(I,s)):Z<=s&&(i.expiredLanes|=I),T&=~I}if(s=jt,l=Et,l=Qr(i,i===s?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m=i.callbackNode,l===0||i===s&&(Dt===2||Dt===9)||i.cancelPendingCommit!==null)return m!==null&&m!==null&&We(m),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||pa(i,l)){if(s=l&-l,s===i.callbackPriority)return s;switch(m!==null&&We(m),kn(l)){case 2:case 8:l=Mt;break;case 32:l=_t;break;case 268435456:l=an;break;default:l=_t}return m=Xg.bind(null,i),l=ut(l,m),i.callbackPriority=s,i.callbackNode=l,s}return m!==null&&m!==null&&We(m),i.callbackPriority=2,i.callbackNode=null,2}function Xg(i,s){if(Mn!==0&&Mn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(qc()&&i.callbackNode!==l)return null;var m=Et;return m=Qr(i,i===jt?m:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m===0?null:(Rg(i,m,s),Jg(i,xe()),i.callbackNode!=null&&i.callbackNode===l?Xg.bind(null,i):null)}function Wg(i,s){if(qc())return null;Rg(i,s,!0)}function OE(){YE(function(){(Rt&6)!==0?ut(je,LE):$g()})}function V0(){return ji===0&&(ji=Ci()),ji}function Kg(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ac(""+i)}function Zg(i,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,i.id&&l.setAttribute("form",i.id),s.parentNode.insertBefore(l,s),i=new FormData(i),l.parentNode.removeChild(l),i}function PE(i,s,l,m,x){if(s==="submit"&&l&&l.stateNode===x){var T=Kg((x[Kt]||null).action),A=m.submitter;A&&(s=(s=A[Kt]||null)?Kg(s.formAction):A.getAttribute("formAction"),s!==null&&(T=s,A=null));var I=new lc("action","action",null,m,x);i.push({event:I,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(ji!==0){var Z=A?Zg(x,A):new FormData(x);s0(l,{pending:!0,data:Z,method:x.method,action:T},null,Z)}}else typeof T=="function"&&(I.preventDefault(),Z=A?Zg(x,A):new FormData(x),s0(l,{pending:!0,data:Z,method:x.method,action:T},T,Z))},currentTarget:x}]})}}for(var G0=0;G0<wf.length;G0++){var H0=wf[G0],UE=H0.toLowerCase(),BE=H0[0].toUpperCase()+H0.slice(1);zr(UE,"on"+BE)}zr(Rm,"onAnimationEnd"),zr(Dm,"onAnimationIteration"),zr(Im,"onAnimationStart"),zr("dblclick","onDoubleClick"),zr("focusin","onFocus"),zr("focusout","onBlur"),zr(nE,"onTransitionRun"),zr(rE,"onTransitionStart"),zr(aE,"onTransitionCancel"),zr(Fm,"onTransitionEnd"),Le("onMouseEnter",["mouseout","mouseover"]),Le("onMouseLeave",["mouseout","mouseover"]),Le("onPointerEnter",["pointerout","pointerover"]),Le("onPointerLeave",["pointerout","pointerover"]),Re("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Re("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Re("onBeforeInput",["compositionend","keypress","textInput","paste"]),Re("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var al="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(al));function Qg(i,s){s=(s&4)!==0;for(var l=0;l<i.length;l++){var m=i[l],x=m.event;m=m.listeners;e:{var T=void 0;if(s)for(var A=m.length-1;0<=A;A--){var I=m[A],Z=I.instance,ue=I.currentTarget;if(I=I.listener,Z!==T&&x.isPropagationStopped())break e;T=I,x.currentTarget=ue;try{T(x)}catch(Se){Fc(Se)}x.currentTarget=null,T=Z}else for(A=0;A<m.length;A++){if(I=m[A],Z=I.instance,ue=I.currentTarget,I=I.listener,Z!==T&&x.isPropagationStopped())break e;T=I,x.currentTarget=ue;try{T(x)}catch(Se){Fc(Se)}x.currentTarget=null,T=Z}}}}function xt(i,s){var l=s[ga];l===void 0&&(l=s[ga]=new Set);var m=i+"__bubble";l.has(m)||(ex(s,i,2,!1),l.add(m))}function z0(i,s,l){var m=0;s&&(m|=4),ex(l,i,m,s)}var Jc="_reactListening"+Math.random().toString(36).slice(2);function j0(i){if(!i[Jc]){i[Jc]=!0,de.forEach(function(l){l!=="selectionchange"&&(VE.has(l)||z0(l,!1,i),z0(l,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Jc]||(s[Jc]=!0,z0("selectionchange",!1,s))}}function ex(i,s,l,m){switch(Cx(s)){case 2:var x=hS;break;case 8:x=mS;break;default:x=ad}l=x.bind(null,s,l,i),x=void 0,!df||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(x=!0),m?x!==void 0?i.addEventListener(s,l,{capture:!0,passive:x}):i.addEventListener(s,l,!0):x!==void 0?i.addEventListener(s,l,{passive:x}):i.addEventListener(s,l,!1)}function q0(i,s,l,m,x){var T=m;if((s&1)===0&&(s&2)===0&&m!==null)e:for(;;){if(m===null)return;var A=m.tag;if(A===3||A===4){var I=m.stateNode.containerInfo;if(I===x)break;if(A===4)for(A=m.return;A!==null;){var Z=A.tag;if((Z===3||Z===4)&&A.stateNode.containerInfo===x)return;A=A.return}for(;I!==null;){if(A=V(I),A===null)return;if(Z=A.tag,Z===5||Z===6||Z===26||Z===27){m=T=A;continue e}I=I.parentNode}}m=m.return}om(function(){var ue=T,Se=uf(l),ke=[];e:{var he=Lm.get(i);if(he!==void 0){var pe=lc,tt=i;switch(i){case"keypress":if(sc(l)===0)break e;case"keydown":case"keyup":pe=F_;break;case"focusin":tt="focus",pe=gf;break;case"focusout":tt="blur",pe=gf;break;case"beforeblur":case"afterblur":pe=gf;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=um;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=E_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=P_;break;case Rm:case Dm:case Im:pe=w_;break;case Fm:pe=B_;break;case"scroll":case"scrollend":pe=T_;break;case"wheel":pe=G_;break;case"copy":case"cut":case"paste":pe=b_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=dm;break;case"toggle":case"beforetoggle":pe=z_}var Ke=(s&4)!==0,Ut=!Ke&&(i==="scroll"||i==="scrollend"),se=Ke?he!==null?he+"Capture":null:he;Ke=[];for(var ae=ue,le;ae!==null;){var we=ae;if(le=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||le===null||se===null||(we=So(ae,se),we!=null&&Ke.push(il(ae,we,le))),Ut)break;ae=ae.return}0<Ke.length&&(he=new pe(he,tt,null,l,Se),ke.push({event:he,listeners:Ke}))}}if((s&7)===0){e:{if(he=i==="mouseover"||i==="pointerover",pe=i==="mouseout"||i==="pointerout",he&&l!==cf&&(tt=l.relatedTarget||l.fromElement)&&(V(tt)||tt[yr]))break e;if((pe||he)&&(he=Se.window===Se?Se:(he=Se.ownerDocument)?he.defaultView||he.parentWindow:window,pe?(tt=l.relatedTarget||l.toElement,pe=ue,tt=tt?V(tt):null,tt!==null&&(Ut=o(tt),Ke=tt.tag,tt!==Ut||Ke!==5&&Ke!==27&&Ke!==6)&&(tt=null)):(pe=null,tt=ue),pe!==tt)){if(Ke=um,we="onMouseLeave",se="onMouseEnter",ae="mouse",(i==="pointerout"||i==="pointerover")&&(Ke=dm,we="onPointerLeave",se="onPointerEnter",ae="pointer"),Ut=pe==null?he:fe(pe),le=tt==null?he:fe(tt),he=new Ke(we,ae+"leave",pe,l,Se),he.target=Ut,he.relatedTarget=le,we=null,V(Se)===ue&&(Ke=new Ke(se,ae+"enter",tt,l,Se),Ke.target=le,Ke.relatedTarget=Ut,we=Ke),Ut=we,pe&&tt)t:{for(Ke=pe,se=tt,ae=0,le=Ke;le;le=zs(le))ae++;for(le=0,we=se;we;we=zs(we))le++;for(;0<ae-le;)Ke=zs(Ke),ae--;for(;0<le-ae;)se=zs(se),le--;for(;ae--;){if(Ke===se||se!==null&&Ke===se.alternate)break t;Ke=zs(Ke),se=zs(se)}Ke=null}else Ke=null;pe!==null&&tx(ke,he,pe,Ke,!1),tt!==null&&Ut!==null&&tx(ke,Ut,tt,Ke,!0)}}e:{if(he=ue?fe(ue):window,pe=he.nodeName&&he.nodeName.toLowerCase(),pe==="select"||pe==="input"&&he.type==="file")var qe=Tm;else if(vm(he))if(_m)qe=Q_;else{qe=K_;var pt=W_}else pe=he.nodeName,!pe||pe.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?ue&&lf(ue.elementType)&&(qe=Tm):qe=Z_;if(qe&&(qe=qe(i,ue))){ym(ke,qe,l,Se);break e}pt&&pt(i,he,ue),i==="focusout"&&ue&&he.type==="number"&&ue.memoizedProps.value!=null&&of(he,"number",he.value)}switch(pt=ue?fe(ue):window,i){case"focusin":(vm(pt)||pt.contentEditable==="true")&&(ys=pt,Ef=ue,Ro=null);break;case"focusout":Ro=Ef=ys=null;break;case"mousedown":Sf=!0;break;case"contextmenu":case"mouseup":case"dragend":Sf=!1,Nm(ke,l,Se);break;case"selectionchange":if(tE)break;case"keydown":case"keyup":Nm(ke,l,Se)}var Xe;if(vf)e:{switch(i){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else vs?gm(i,l)&&(Qe="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(Qe="onCompositionStart");Qe&&(hm&&l.locale!=="ko"&&(vs||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&vs&&(Xe=lm()):(Ha=Se,hf="value"in Ha?Ha.value:Ha.textContent,vs=!0)),pt=Xc(ue,Qe),0<pt.length&&(Qe=new fm(Qe,i,null,l,Se),ke.push({event:Qe,listeners:pt}),Xe?Qe.data=Xe:(Xe=xm(l),Xe!==null&&(Qe.data=Xe)))),(Xe=q_?Y_(i,l):$_(i,l))&&(Qe=Xc(ue,"onBeforeInput"),0<Qe.length&&(pt=new fm("onBeforeInput","beforeinput",null,l,Se),ke.push({event:pt,listeners:Qe}),pt.data=Xe)),PE(ke,i,ue,l,Se)}Qg(ke,s)})}function il(i,s,l){return{instance:i,listener:s,currentTarget:l}}function Xc(i,s){for(var l=s+"Capture",m=[];i!==null;){var x=i,T=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||T===null||(x=So(i,l),x!=null&&m.unshift(il(i,x,T)),x=So(i,s),x!=null&&m.push(il(i,x,T))),i.tag===3)return m;i=i.return}return[]}function zs(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function tx(i,s,l,m,x){for(var T=s._reactName,A=[];l!==null&&l!==m;){var I=l,Z=I.alternate,ue=I.stateNode;if(I=I.tag,Z!==null&&Z===m)break;I!==5&&I!==26&&I!==27||ue===null||(Z=ue,x?(ue=So(l,T),ue!=null&&A.unshift(il(l,ue,Z))):x||(ue=So(l,T),ue!=null&&A.push(il(l,ue,Z)))),l=l.return}A.length!==0&&i.push({event:s,listeners:A})}var GE=/\r\n?/g,HE=/\u0000|\uFFFD/g;function nx(i){return(typeof i=="string"?i:""+i).replace(GE,`
`).replace(HE,"")}function rx(i,s){return s=nx(s),nx(i)===s}function Wc(){}function Pt(i,s,l,m,x,T){switch(l){case"children":typeof m=="string"?s==="body"||s==="textarea"&&m===""||ps(i,m):(typeof m=="number"||typeof m=="bigint")&&s!=="body"&&ps(i,""+m);break;case"className":Lt(i,"class",m);break;case"tabIndex":Lt(i,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Lt(i,l,m);break;case"style":im(i,m,T);break;case"data":if(s!=="object"){Lt(i,"data",m);break}case"src":case"href":if(m===""&&(s!=="a"||l!=="href")){i.removeAttribute(l);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(l);break}m=ac(""+m),i.setAttribute(l,m);break;case"action":case"formAction":if(typeof m=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(l==="formAction"?(s!=="input"&&Pt(i,s,"name",x.name,x,null),Pt(i,s,"formEncType",x.formEncType,x,null),Pt(i,s,"formMethod",x.formMethod,x,null),Pt(i,s,"formTarget",x.formTarget,x,null)):(Pt(i,s,"encType",x.encType,x,null),Pt(i,s,"method",x.method,x,null),Pt(i,s,"target",x.target,x,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(l);break}m=ac(""+m),i.setAttribute(l,m);break;case"onClick":m!=null&&(i.onclick=Wc);break;case"onScroll":m!=null&&xt("scroll",i);break;case"onScrollEnd":m!=null&&xt("scrollend",i);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(l=m.__html,l!=null){if(x.children!=null)throw Error(r(60));i.innerHTML=l}}break;case"multiple":i.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":i.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){i.removeAttribute("xlink:href");break}l=ac(""+m),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(l,""+m):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":m===!0?i.setAttribute(l,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(l,m):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?i.setAttribute(l,m):i.removeAttribute(l);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?i.removeAttribute(l):i.setAttribute(l,m);break;case"popover":xt("beforetoggle",i),xt("toggle",i),Ft(i,"popover",m);break;case"xlinkActuate":zt(i,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":zt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":zt(i,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":zt(i,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":zt(i,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":zt(i,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":zt(i,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":zt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":zt(i,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Ft(i,"is",m);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=v_.get(l)||l,Ft(i,l,m))}}function Y0(i,s,l,m,x,T){switch(l){case"style":im(i,m,T);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(l=m.__html,l!=null){if(x.children!=null)throw Error(r(60));i.innerHTML=l}}break;case"children":typeof m=="string"?ps(i,m):(typeof m=="number"||typeof m=="bigint")&&ps(i,""+m);break;case"onScroll":m!=null&&xt("scroll",i);break;case"onScrollEnd":m!=null&&xt("scrollend",i);break;case"onClick":m!=null&&(i.onclick=Wc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!me.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(x=l.endsWith("Capture"),s=l.slice(2,x?l.length-7:void 0),T=i[Kt]||null,T=T!=null?T[l]:null,typeof T=="function"&&i.removeEventListener(s,T,x),typeof m=="function")){typeof T!="function"&&T!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(s,m,x);break e}l in i?i[l]=m:m===!0?i.setAttribute(l,""):Ft(i,l,m)}}}function Rn(i,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xt("error",i),xt("load",i);var m=!1,x=!1,T;for(T in l)if(l.hasOwnProperty(T)){var A=l[T];if(A!=null)switch(T){case"src":m=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Pt(i,s,T,A,l,null)}}x&&Pt(i,s,"srcSet",l.srcSet,l,null),m&&Pt(i,s,"src",l.src,l,null);return;case"input":xt("invalid",i);var I=T=A=x=null,Z=null,ue=null;for(m in l)if(l.hasOwnProperty(m)){var Se=l[m];if(Se!=null)switch(m){case"name":x=Se;break;case"type":A=Se;break;case"checked":Z=Se;break;case"defaultChecked":ue=Se;break;case"value":T=Se;break;case"defaultValue":I=Se;break;case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(r(137,s));break;default:Pt(i,s,m,Se,l,null)}}tm(i,T,I,Z,ue,A,x,!1),nc(i);return;case"select":xt("invalid",i),m=A=T=null;for(x in l)if(l.hasOwnProperty(x)&&(I=l[x],I!=null))switch(x){case"value":T=I;break;case"defaultValue":A=I;break;case"multiple":m=I;default:Pt(i,s,x,I,l,null)}s=T,l=A,i.multiple=!!m,s!=null?ms(i,!!m,s,!1):l!=null&&ms(i,!!m,l,!0);return;case"textarea":xt("invalid",i),T=x=m=null;for(A in l)if(l.hasOwnProperty(A)&&(I=l[A],I!=null))switch(A){case"value":m=I;break;case"defaultValue":x=I;break;case"children":T=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(r(91));break;default:Pt(i,s,A,I,l,null)}rm(i,m,x,T),nc(i);return;case"option":for(Z in l)if(l.hasOwnProperty(Z)&&(m=l[Z],m!=null))switch(Z){case"selected":i.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Pt(i,s,Z,m,l,null)}return;case"dialog":xt("beforetoggle",i),xt("toggle",i),xt("cancel",i),xt("close",i);break;case"iframe":case"object":xt("load",i);break;case"video":case"audio":for(m=0;m<al.length;m++)xt(al[m],i);break;case"image":xt("error",i),xt("load",i);break;case"details":xt("toggle",i);break;case"embed":case"source":case"link":xt("error",i),xt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in l)if(l.hasOwnProperty(ue)&&(m=l[ue],m!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Pt(i,s,ue,m,l,null)}return;default:if(lf(s)){for(Se in l)l.hasOwnProperty(Se)&&(m=l[Se],m!==void 0&&Y0(i,s,Se,m,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(m=l[I],m!=null&&Pt(i,s,I,m,l,null))}function zE(i,s,l,m){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,T=null,A=null,I=null,Z=null,ue=null,Se=null;for(pe in l){var ke=l[pe];if(l.hasOwnProperty(pe)&&ke!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":Z=ke;default:m.hasOwnProperty(pe)||Pt(i,s,pe,null,m,ke)}}for(var he in m){var pe=m[he];if(ke=l[he],m.hasOwnProperty(he)&&(pe!=null||ke!=null))switch(he){case"type":T=pe;break;case"name":x=pe;break;case"checked":ue=pe;break;case"defaultChecked":Se=pe;break;case"value":A=pe;break;case"defaultValue":I=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(r(137,s));break;default:pe!==ke&&Pt(i,s,he,pe,m,ke)}}sf(i,A,I,Z,ue,Se,T,x);return;case"select":pe=A=I=he=null;for(T in l)if(Z=l[T],l.hasOwnProperty(T)&&Z!=null)switch(T){case"value":break;case"multiple":pe=Z;default:m.hasOwnProperty(T)||Pt(i,s,T,null,m,Z)}for(x in m)if(T=m[x],Z=l[x],m.hasOwnProperty(x)&&(T!=null||Z!=null))switch(x){case"value":he=T;break;case"defaultValue":I=T;break;case"multiple":A=T;default:T!==Z&&Pt(i,s,x,T,m,Z)}s=I,l=A,m=pe,he!=null?ms(i,!!l,he,!1):!!m!=!!l&&(s!=null?ms(i,!!l,s,!0):ms(i,!!l,l?[]:"",!1));return;case"textarea":pe=he=null;for(I in l)if(x=l[I],l.hasOwnProperty(I)&&x!=null&&!m.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:Pt(i,s,I,null,m,x)}for(A in m)if(x=m[A],T=l[A],m.hasOwnProperty(A)&&(x!=null||T!=null))switch(A){case"value":he=x;break;case"defaultValue":pe=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==T&&Pt(i,s,A,x,m,T)}nm(i,he,pe);return;case"option":for(var tt in l)if(he=l[tt],l.hasOwnProperty(tt)&&he!=null&&!m.hasOwnProperty(tt))switch(tt){case"selected":i.selected=!1;break;default:Pt(i,s,tt,null,m,he)}for(Z in m)if(he=m[Z],pe=l[Z],m.hasOwnProperty(Z)&&he!==pe&&(he!=null||pe!=null))switch(Z){case"selected":i.selected=he&&typeof he!="function"&&typeof he!="symbol";break;default:Pt(i,s,Z,he,m,pe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in l)he=l[Ke],l.hasOwnProperty(Ke)&&he!=null&&!m.hasOwnProperty(Ke)&&Pt(i,s,Ke,null,m,he);for(ue in m)if(he=m[ue],pe=l[ue],m.hasOwnProperty(ue)&&he!==pe&&(he!=null||pe!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,s));break;default:Pt(i,s,ue,he,m,pe)}return;default:if(lf(s)){for(var Ut in l)he=l[Ut],l.hasOwnProperty(Ut)&&he!==void 0&&!m.hasOwnProperty(Ut)&&Y0(i,s,Ut,void 0,m,he);for(Se in m)he=m[Se],pe=l[Se],!m.hasOwnProperty(Se)||he===pe||he===void 0&&pe===void 0||Y0(i,s,Se,he,m,pe);return}}for(var se in l)he=l[se],l.hasOwnProperty(se)&&he!=null&&!m.hasOwnProperty(se)&&Pt(i,s,se,null,m,he);for(ke in m)he=m[ke],pe=l[ke],!m.hasOwnProperty(ke)||he===pe||he==null&&pe==null||Pt(i,s,ke,he,m,pe)}var $0=null,J0=null;function Kc(i){return i.nodeType===9?i:i.ownerDocument}function ax(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ix(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function X0(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var W0=null;function jE(){var i=window.event;return i&&i.type==="popstate"?i===W0?!1:(W0=i,!0):(W0=null,!1)}var sx=typeof setTimeout=="function"?setTimeout:void 0,qE=typeof clearTimeout=="function"?clearTimeout:void 0,ox=typeof Promise=="function"?Promise:void 0,YE=typeof queueMicrotask=="function"?queueMicrotask:typeof ox<"u"?function(i){return ox.resolve(null).then(i).catch($E)}:sx;function $E(i){setTimeout(function(){throw i})}function ai(i){return i==="head"}function lx(i,s){var l=s,m=0,x=0;do{var T=l.nextSibling;if(i.removeChild(l),T&&T.nodeType===8)if(l=T.data,l==="/$"){if(0<m&&8>m){l=m;var A=i.ownerDocument;if(l&1&&sl(A.documentElement),l&2&&sl(A.body),l&4)for(l=A.head,sl(l),A=l.firstChild;A;){var I=A.nextSibling,Z=A.nodeName;A[O]||Z==="SCRIPT"||Z==="STYLE"||Z==="LINK"&&A.rel.toLowerCase()==="stylesheet"||l.removeChild(A),A=I}}if(x===0){i.removeChild(T),ml(s);return}x--}else l==="$"||l==="$?"||l==="$!"?x++:m=l.charCodeAt(0)-48;else m=0;l=T}while(l);ml(s)}function K0(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":K0(l),P(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function JE(i,s,l,m){for(;i.nodeType===1;){var x=l;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!m&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(m){if(!i[O])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(T=i.getAttribute("rel"),T==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(T!==x.rel||i.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||i.getAttribute("title")!==(x.title==null?null:x.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(T=i.getAttribute("src"),(T!==(x.src==null?null:x.src)||i.getAttribute("type")!==(x.type==null?null:x.type)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&T&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var T=x.name==null?null:""+x.name;if(x.type==="hidden"&&i.getAttribute("name")===T)return i}else return i;if(i=qr(i.nextSibling),i===null)break}return null}function XE(i,s,l){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=qr(i.nextSibling),i===null))return null;return i}function Z0(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function WE(i,s){var l=i.ownerDocument;if(i.data!=="$?"||l.readyState==="complete")s();else{var m=function(){s(),l.removeEventListener("DOMContentLoaded",m)};l.addEventListener("DOMContentLoaded",m),i._reactRetry=m}}function qr(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var Q0=null;function cx(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return i;s--}else l==="/$"&&s++}i=i.previousSibling}return null}function ux(i,s,l){switch(s=Kc(l),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function sl(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);P(i)}var Nr=new Map,fx=new Set;function Zc(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ra=ce.d;ce.d={f:KE,r:ZE,D:QE,C:eS,L:tS,m:nS,X:aS,S:rS,M:iS};function KE(){var i=Ra.f(),s=zc();return i||s}function ZE(i){var s=z(i);s!==null&&s.tag===5&&s.type==="form"?Rp(s):Ra.r(i)}var js=typeof document>"u"?null:document;function dx(i,s,l){var m=js;if(m&&typeof s=="string"&&s){var x=Er(s);x='link[rel="'+i+'"][href="'+x+'"]',typeof l=="string"&&(x+='[crossorigin="'+l+'"]'),fx.has(x)||(fx.add(x),i={rel:i,crossOrigin:l,href:s},m.querySelector(x)===null&&(s=m.createElement("link"),Rn(s,"link",i),oe(s),m.head.appendChild(s)))}}function QE(i){Ra.D(i),dx("dns-prefetch",i,null)}function eS(i,s){Ra.C(i,s),dx("preconnect",i,s)}function tS(i,s,l){Ra.L(i,s,l);var m=js;if(m&&i&&s){var x='link[rel="preload"][as="'+Er(s)+'"]';s==="image"&&l&&l.imageSrcSet?(x+='[imagesrcset="'+Er(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(x+='[imagesizes="'+Er(l.imageSizes)+'"]')):x+='[href="'+Er(i)+'"]';var T=x;switch(s){case"style":T=qs(i);break;case"script":T=Ys(i)}Nr.has(T)||(i=g({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:i,as:s},l),Nr.set(T,i),m.querySelector(x)!==null||s==="style"&&m.querySelector(ol(T))||s==="script"&&m.querySelector(ll(T))||(s=m.createElement("link"),Rn(s,"link",i),oe(s),m.head.appendChild(s)))}}function nS(i,s){Ra.m(i,s);var l=js;if(l&&i){var m=s&&typeof s.as=="string"?s.as:"script",x='link[rel="modulepreload"][as="'+Er(m)+'"][href="'+Er(i)+'"]',T=x;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Ys(i)}if(!Nr.has(T)&&(i=g({rel:"modulepreload",href:i},s),Nr.set(T,i),l.querySelector(x)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(ll(T)))return}m=l.createElement("link"),Rn(m,"link",i),oe(m),l.head.appendChild(m)}}}function rS(i,s,l){Ra.S(i,s,l);var m=js;if(m&&i){var x=ve(m).hoistableStyles,T=qs(i);s=s||"default";var A=x.get(T);if(!A){var I={loading:0,preload:null};if(A=m.querySelector(ol(T)))I.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":s},l),(l=Nr.get(T))&&ed(i,l);var Z=A=m.createElement("link");oe(Z),Rn(Z,"link",i),Z._p=new Promise(function(ue,Se){Z.onload=ue,Z.onerror=Se}),Z.addEventListener("load",function(){I.loading|=1}),Z.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Qc(A,s,m)}A={type:"stylesheet",instance:A,count:1,state:I},x.set(T,A)}}}function aS(i,s){Ra.X(i,s);var l=js;if(l&&i){var m=ve(l).hoistableScripts,x=Ys(i),T=m.get(x);T||(T=l.querySelector(ll(x)),T||(i=g({src:i,async:!0},s),(s=Nr.get(x))&&td(i,s),T=l.createElement("script"),oe(T),Rn(T,"link",i),l.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(x,T))}}function iS(i,s){Ra.M(i,s);var l=js;if(l&&i){var m=ve(l).hoistableScripts,x=Ys(i),T=m.get(x);T||(T=l.querySelector(ll(x)),T||(i=g({src:i,async:!0,type:"module"},s),(s=Nr.get(x))&&td(i,s),T=l.createElement("script"),oe(T),Rn(T,"link",i),l.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(x,T))}}function hx(i,s,l,m){var x=(x=ie.current)?Zc(x):null;if(!x)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=qs(l.href),l=ve(x).hoistableStyles,m=l.get(s),m||(m={type:"style",instance:null,count:0,state:null},l.set(s,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=qs(l.href);var T=ve(x).hoistableStyles,A=T.get(i);if(A||(x=x.ownerDocument||x,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(i,A),(T=x.querySelector(ol(i)))&&!T._p&&(A.instance=T,A.state.loading=5),Nr.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Nr.set(i,l),T||sS(x,i,l,A.state))),s&&m===null)throw Error(r(528,""));return A}if(s&&m!==null)throw Error(r(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Ys(l),l=ve(x).hoistableScripts,m=l.get(s),m||(m={type:"script",instance:null,count:0,state:null},l.set(s,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function qs(i){return'href="'+Er(i)+'"'}function ol(i){return'link[rel="stylesheet"]['+i+"]"}function mx(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function sS(i,s,l,m){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?m.loading=1:(s=i.createElement("link"),m.preload=s,s.addEventListener("load",function(){return m.loading|=1}),s.addEventListener("error",function(){return m.loading|=2}),Rn(s,"link",l),oe(s),i.head.appendChild(s))}function Ys(i){return'[src="'+Er(i)+'"]'}function ll(i){return"script[async]"+i}function px(i,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var m=i.querySelector('style[data-href~="'+Er(l.href)+'"]');if(m)return s.instance=m,oe(m),m;var x=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return m=(i.ownerDocument||i).createElement("style"),oe(m),Rn(m,"style",x),Qc(m,l.precedence,i),s.instance=m;case"stylesheet":x=qs(l.href);var T=i.querySelector(ol(x));if(T)return s.state.loading|=4,s.instance=T,oe(T),T;m=mx(l),(x=Nr.get(x))&&ed(m,x),T=(i.ownerDocument||i).createElement("link"),oe(T);var A=T;return A._p=new Promise(function(I,Z){A.onload=I,A.onerror=Z}),Rn(T,"link",m),s.state.loading|=4,Qc(T,l.precedence,i),s.instance=T;case"script":return T=Ys(l.src),(x=i.querySelector(ll(T)))?(s.instance=x,oe(x),x):(m=l,(x=Nr.get(T))&&(m=g({},l),td(m,x)),i=i.ownerDocument||i,x=i.createElement("script"),oe(x),Rn(x,"link",m),i.head.appendChild(x),s.instance=x);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(m=s.instance,s.state.loading|=4,Qc(m,l.precedence,i));return s.instance}function Qc(i,s,l){for(var m=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=m.length?m[m.length-1]:null,T=x,A=0;A<m.length;A++){var I=m[A];if(I.dataset.precedence===s)T=I;else if(T!==x)break}T?T.parentNode.insertBefore(i,T.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(i,s.firstChild))}function ed(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function td(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var eu=null;function gx(i,s,l){if(eu===null){var m=new Map,x=eu=new Map;x.set(l,m)}else x=eu,m=x.get(l),m||(m=new Map,x.set(l,m));if(m.has(i))return m;for(m.set(i,null),l=l.getElementsByTagName(i),x=0;x<l.length;x++){var T=l[x];if(!(T[O]||T[Wt]||i==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var A=T.getAttribute(s)||"";A=i+A;var I=m.get(A);I?I.push(T):m.set(A,[T])}}return m}function xx(i,s,l){i=i.ownerDocument||i,i.head.insertBefore(l,s==="title"?i.querySelector("head > title"):null)}function oS(i,s,l){if(l===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function vx(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var cl=null;function lS(){}function cS(i,s,l){if(cl===null)throw Error(r(475));var m=cl;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var x=qs(l.href),T=i.querySelector(ol(x));if(T){i=T._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(m.count++,m=tu.bind(m),i.then(m,m)),s.state.loading|=4,s.instance=T,oe(T);return}T=i.ownerDocument||i,l=mx(l),(x=Nr.get(x))&&ed(l,x),T=T.createElement("link"),oe(T);var A=T;A._p=new Promise(function(I,Z){A.onload=I,A.onerror=Z}),Rn(T,"link",l),s.instance=T}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(m.count++,s=tu.bind(m),i.addEventListener("load",s),i.addEventListener("error",s))}}function uS(){if(cl===null)throw Error(r(475));var i=cl;return i.stylesheets&&i.count===0&&nd(i,i.stylesheets),0<i.count?function(s){var l=setTimeout(function(){if(i.stylesheets&&nd(i,i.stylesheets),i.unsuspend){var m=i.unsuspend;i.unsuspend=null,m()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(l)}}:null}function tu(){if(this.count--,this.count===0){if(this.stylesheets)nd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var nu=null;function nd(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,nu=new Map,s.forEach(fS,i),nu=null,tu.call(i))}function fS(i,s){if(!(s.state.loading&4)){var l=nu.get(i);if(l)var m=l.get(null);else{l=new Map,nu.set(i,l);for(var x=i.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<x.length;T++){var A=x[T];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(l.set(A.dataset.precedence,A),m=A)}m&&l.set(null,m)}x=s.instance,A=x.getAttribute("data-precedence"),T=l.get(A)||m,T===m&&l.set(null,x),l.set(A,x),this.count++,m=tu.bind(this),x.addEventListener("load",m),x.addEventListener("error",m),T?T.parentNode.insertBefore(x,T.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(x,i.firstChild)),s.state.loading|=4}}var ul={$$typeof:b,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function dS(i,s,l,m,x,T,A,I){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ai(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ai(0),this.hiddenUpdates=Ai(null),this.identifierPrefix=m,this.onUncaughtError=x,this.onCaughtError=T,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function yx(i,s,l,m,x,T,A,I,Z,ue,Se,ke){return i=new dS(i,s,l,A,I,Z,ue,ke),s=1,T===!0&&(s|=24),T=lr(3,null,null,s),i.current=T,T.stateNode=i,s=Pf(),s.refCount++,i.pooledCache=s,s.refCount++,T.memoizedState={element:m,isDehydrated:l,cache:s},Gf(T),i}function Tx(i){return i?(i=Ss,i):Ss}function _x(i,s,l,m,x,T){x=Tx(x),m.context===null?m.context=x:m.pendingContext=x,m=qa(s),m.payload={element:l},T=T===void 0?null:T,T!==null&&(m.callback=T),l=Ya(i,m,s),l!==null&&(hr(l,i,s),Vo(l,i,s))}function Ex(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<s?l:s}}function rd(i,s){Ex(i,s),(i=i.alternate)&&Ex(i,s)}function Sx(i){if(i.tag===13){var s=Es(i,67108864);s!==null&&hr(s,i,67108864),rd(i,67108864)}}var ru=!0;function hS(i,s,l,m){var x=re.T;re.T=null;var T=ce.p;try{ce.p=2,ad(i,s,l,m)}finally{ce.p=T,re.T=x}}function mS(i,s,l,m){var x=re.T;re.T=null;var T=ce.p;try{ce.p=8,ad(i,s,l,m)}finally{ce.p=T,re.T=x}}function ad(i,s,l,m){if(ru){var x=id(m);if(x===null)q0(i,s,m,au,l),wx(i,m);else if(gS(x,i,s,l,m))m.stopPropagation();else if(wx(i,m),s&4&&-1<pS.indexOf(i)){for(;x!==null;){var T=z(x);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var A=bn(T.pendingLanes);if(A!==0){var I=T;for(I.pendingLanes|=2,I.entangledLanes|=2;A;){var Z=1<<31-Ge(A);I.entanglements[1]|=Z,A&=~Z}ia(T),(Rt&6)===0&&(Gc=xe()+500,rl(0))}}break;case 13:I=Es(T,2),I!==null&&hr(I,T,2),zc(),rd(T,2)}if(T=id(m),T===null&&q0(i,s,m,au,l),T===x)break;x=T}x!==null&&m.stopPropagation()}else q0(i,s,m,null,l)}}function id(i){return i=uf(i),sd(i)}var au=null;function sd(i){if(au=null,i=V(i),i!==null){var s=o(i);if(s===null)i=null;else{var l=s.tag;if(l===13){if(i=c(s),i!==null)return i;i=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return au=i,null}function Cx(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(He()){case je:return 2;case Mt:return 8;case _t:case Xt:return 32;case an:return 268435456;default:return 32}default:return 32}}var od=!1,ii=null,si=null,oi=null,fl=new Map,dl=new Map,li=[],pS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wx(i,s){switch(i){case"focusin":case"focusout":ii=null;break;case"dragenter":case"dragleave":si=null;break;case"mouseover":case"mouseout":oi=null;break;case"pointerover":case"pointerout":fl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":dl.delete(s.pointerId)}}function hl(i,s,l,m,x,T){return i===null||i.nativeEvent!==T?(i={blockedOn:s,domEventName:l,eventSystemFlags:m,nativeEvent:T,targetContainers:[x]},s!==null&&(s=z(s),s!==null&&Sx(s)),i):(i.eventSystemFlags|=m,s=i.targetContainers,x!==null&&s.indexOf(x)===-1&&s.push(x),i)}function gS(i,s,l,m,x){switch(s){case"focusin":return ii=hl(ii,i,s,l,m,x),!0;case"dragenter":return si=hl(si,i,s,l,m,x),!0;case"mouseover":return oi=hl(oi,i,s,l,m,x),!0;case"pointerover":var T=x.pointerId;return fl.set(T,hl(fl.get(T)||null,i,s,l,m,x)),!0;case"gotpointercapture":return T=x.pointerId,dl.set(T,hl(dl.get(T)||null,i,s,l,m,x)),!0}return!1}function Ax(i){var s=V(i.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=c(l),s!==null){i.blockedOn=s,bi(i.priority,function(){if(l.tag===13){var m=dr();m=Ln(m);var x=Es(l,m);x!==null&&hr(x,l,m),rd(l,m)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function iu(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var l=id(i.nativeEvent);if(l===null){l=i.nativeEvent;var m=new l.constructor(l.type,l);cf=m,l.target.dispatchEvent(m),cf=null}else return s=z(l),s!==null&&Sx(s),i.blockedOn=l,!1;s.shift()}return!0}function bx(i,s,l){iu(i)&&l.delete(s)}function xS(){od=!1,ii!==null&&iu(ii)&&(ii=null),si!==null&&iu(si)&&(si=null),oi!==null&&iu(oi)&&(oi=null),fl.forEach(bx),dl.forEach(bx)}function su(i,s){i.blockedOn===s&&(i.blockedOn=null,od||(od=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,xS)))}var ou=null;function kx(i){ou!==i&&(ou=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){ou===i&&(ou=null);for(var s=0;s<i.length;s+=3){var l=i[s],m=i[s+1],x=i[s+2];if(typeof m!="function"){if(sd(m||l)===null)continue;break}var T=z(l);T!==null&&(i.splice(s,3),s-=3,s0(T,{pending:!0,data:x,method:l.method,action:m},m,x))}}))}function ml(i){function s(Z){return su(Z,i)}ii!==null&&su(ii,i),si!==null&&su(si,i),oi!==null&&su(oi,i),fl.forEach(s),dl.forEach(s);for(var l=0;l<li.length;l++){var m=li[l];m.blockedOn===i&&(m.blockedOn=null)}for(;0<li.length&&(l=li[0],l.blockedOn===null);)Ax(l),l.blockedOn===null&&li.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(m=0;m<l.length;m+=3){var x=l[m],T=l[m+1],A=x[Kt]||null;if(typeof T=="function")A||kx(l);else if(A){var I=null;if(T&&T.hasAttribute("formAction")){if(x=T,A=T[Kt]||null)I=A.formAction;else if(sd(x)!==null)continue}else I=A.action;typeof I=="function"?l[m+1]=I:(l.splice(m,3),m-=3),kx(l)}}}function ld(i){this._internalRoot=i}lu.prototype.render=ld.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var l=s.current,m=dr();_x(l,m,i,s,null,null)},lu.prototype.unmount=ld.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;_x(i.current,2,null,i,null,null),zc(),s[yr]=null}};function lu(i){this._internalRoot=i}lu.prototype.unstable_scheduleHydration=function(i){if(i){var s=ea();i={blockedOn:null,target:i,priority:s};for(var l=0;l<li.length&&s!==0&&s<li[l].priority;l++);li.splice(l,0,i),l===0&&Ax(i)}};var Nx=t.version;if(Nx!=="19.1.0")throw Error(r(527,Nx,"19.1.0"));ce.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=p(s),i=i!==null?h(i):null,i=i===null?null:i.stateNode,i};var vS={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:re,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cu.isDisabled&&cu.supportsFiber)try{Vt=cu.inject(vS),Gt=cu}catch{}}return gl.createRoot=function(i,s){if(!a(i))throw Error(r(299));var l=!1,m="",x=qp,T=Yp,A=$p,I=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(m=s.identifierPrefix),s.onUncaughtError!==void 0&&(x=s.onUncaughtError),s.onCaughtError!==void 0&&(T=s.onCaughtError),s.onRecoverableError!==void 0&&(A=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(I=s.unstable_transitionCallbacks)),s=yx(i,1,!1,null,null,l,m,x,T,A,I,null),i[yr]=s.current,j0(i),new ld(s)},gl.hydrateRoot=function(i,s,l){if(!a(i))throw Error(r(299));var m=!1,x="",T=qp,A=Yp,I=$p,Z=null,ue=null;return l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onUncaughtError!==void 0&&(T=l.onUncaughtError),l.onCaughtError!==void 0&&(A=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(Z=l.unstable_transitionCallbacks),l.formState!==void 0&&(ue=l.formState)),s=yx(i,1,!0,s,l??null,m,x,T,A,I,Z,ue),s.context=Tx(null),l=s.current,m=dr(),m=Ln(m),x=qa(m),x.callback=null,Ya(l,x,m),l=m,s.current.lanes=l,Pe(s,l),ia(s),i[yr]=s.current,j0(i),new lu(s)},gl.version="19.1.0",gl}var Bx;function kS(){if(Bx)return fd.exports;Bx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),fd.exports=bS(),fd.exports}var NS=kS();const MS=Oy(NS);var ar=(e=>(e.NOT_STARTED="Not Started",e.IN_PROGRESS="In Progress",e.COMPLETED="Completed",e))(ar||{}),Nd=(e=>(e.PENDING="pending",e.ACHIEVED="achieved",e.MISSED="missed",e))(Nd||{}),Ct=(e=>(e.NOT_STARTED="Not Started",e.IN_PROGRESS="In Progress",e.COMPLETED="Completed",e.BLOCKED="Blocked",e))(Ct||{}),Rr=(e=>(e[e.INPUT_FORM=0]="INPUT_FORM",e[e.PROJECT_FLOW=1]="PROJECT_FLOW",e[e.TASK_DETAIL=2]="TASK_DETAIL",e))(Rr||{}),kt;(function(e){e.assertEqual=a=>{};function t(a){}e.assertIs=t;function n(a){throw new Error}e.assertNever=n,e.arrayToEnum=a=>{const o={};for(const c of a)o[c]=c;return o},e.getValidEnumValues=a=>{const o=e.objectKeys(a).filter(u=>typeof a[a[u]]!="number"),c={};for(const u of o)c[u]=a[u];return e.objectValues(c)},e.objectValues=a=>e.objectKeys(a).map(function(o){return a[o]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const o=[];for(const c in a)Object.prototype.hasOwnProperty.call(a,c)&&o.push(c);return o},e.find=(a,o)=>{for(const c of a)if(o(c))return c},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,o=" | "){return a.map(c=>typeof c=="string"?`'${c}'`:c).join(o)}e.joinValues=r,e.jsonStringifyReplacer=(a,o)=>typeof o=="bigint"?o.toString():o})(kt||(kt={}));var Vx;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(Vx||(Vx={}));const Ye=kt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),fi=e=>{switch(typeof e){case"undefined":return Ye.undefined;case"string":return Ye.string;case"number":return Number.isNaN(e)?Ye.nan:Ye.number;case"boolean":return Ye.boolean;case"function":return Ye.function;case"bigint":return Ye.bigint;case"symbol":return Ye.symbol;case"object":return Array.isArray(e)?Ye.array:e===null?Ye.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Ye.promise:typeof Map<"u"&&e instanceof Map?Ye.map:typeof Set<"u"&&e instanceof Set?Ye.set:typeof Date<"u"&&e instanceof Date?Ye.date:Ye.object;default:return Ye.unknown}},Fe=kt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Oa extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(o){return o.message},r={_errors:[]},a=o=>{for(const c of o.issues)if(c.code==="invalid_union")c.unionErrors.map(a);else if(c.code==="invalid_return_type")a(c.returnTypeError);else if(c.code==="invalid_arguments")a(c.argumentsError);else if(c.path.length===0)r._errors.push(n(c));else{let u=r,p=0;for(;p<c.path.length;){const h=c.path[p];p===c.path.length-1?(u[h]=u[h]||{_errors:[]},u[h]._errors.push(n(c))):u[h]=u[h]||{_errors:[]},u=u[h],p++}}};return a(this),r}static assert(t){if(!(t instanceof Oa))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,kt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const a of this.issues)if(a.path.length>0){const o=a.path[0];n[o]=n[o]||[],n[o].push(t(a))}else r.push(t(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Oa.create=e=>new Oa(e);const Md=(e,t)=>{let n;switch(e.code){case Fe.invalid_type:e.received===Ye.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Fe.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,kt.jsonStringifyReplacer)}`;break;case Fe.unrecognized_keys:n=`Unrecognized key(s) in object: ${kt.joinValues(e.keys,", ")}`;break;case Fe.invalid_union:n="Invalid input";break;case Fe.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${kt.joinValues(e.options)}`;break;case Fe.invalid_enum_value:n=`Invalid enum value. Expected ${kt.joinValues(e.options)}, received '${e.received}'`;break;case Fe.invalid_arguments:n="Invalid function arguments";break;case Fe.invalid_return_type:n="Invalid function return type";break;case Fe.invalid_date:n="Invalid date";break;case Fe.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:kt.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Fe.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Fe.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Fe.custom:n="Invalid input";break;case Fe.invalid_intersection_types:n="Intersection results could not be merged";break;case Fe.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Fe.not_finite:n="Number must be finite";break;default:n=t.defaultError,kt.assertNever(e)}return{message:n}};let RS=Md;function DS(){return RS}const IS=e=>{const{data:t,path:n,errorMaps:r,issueData:a}=e,o=[...n,...a.path||[]],c={...a,path:o};if(a.message!==void 0)return{...a,path:o,message:a.message};let u="";const p=r.filter(h=>!!h).slice().reverse();for(const h of p)u=h(c,{data:t,defaultError:u}).message;return{...a,path:o,message:u}};function Ve(e,t){const n=DS(),r=IS({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Md?void 0:Md].filter(a=>!!a)});e.common.issues.push(r)}class Zn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const a of n){if(a.status==="aborted")return it;a.status==="dirty"&&t.dirty(),r.push(a.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const a of n){const o=await a.key,c=await a.value;r.push({key:o,value:c})}return Zn.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const a of n){const{key:o,value:c}=a;if(o.status==="aborted"||c.status==="aborted")return it;o.status==="dirty"&&t.dirty(),c.status==="dirty"&&t.dirty(),o.value!=="__proto__"&&(typeof c.value<"u"||a.alwaysSet)&&(r[o.value]=c.value)}return{status:t.value,value:r}}}const it=Object.freeze({status:"aborted"}),vl=e=>({status:"dirty",value:e}),Pr=e=>({status:"valid",value:e}),Gx=e=>e.status==="aborted",Hx=e=>e.status==="dirty",oo=e=>e.status==="valid",wu=e=>typeof Promise<"u"&&e instanceof Promise;var $e;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})($e||($e={}));class fa{constructor(t,n,r,a){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const zx=(e,t)=>{if(oo(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Oa(e.common.issues);return this._error=n,this._error}}};function ft(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(c,u)=>{const{message:p}=e;return c.code==="invalid_enum_value"?{message:p??u.defaultError}:typeof u.data>"u"?{message:p??r??u.defaultError}:c.code!=="invalid_type"?{message:u.defaultError}:{message:p??n??u.defaultError}},description:a}}class Tt{get description(){return this._def.description}_getType(t){return fi(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:fi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Zn,ctx:{common:t.parent.common,data:t.data,parsedType:fi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(wu(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:fi(t)},a=this._parseSync({data:t,path:r.path,parent:r});return zx(r,a)}"~validate"(t){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:fi(t)};if(!this["~standard"].async)try{const o=this._parseSync({data:t,path:[],parent:n});return oo(o)?{value:o.value}:{issues:n.common.issues}}catch(o){(a=(r=o==null?void 0:o.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(o=>oo(o)?{value:o.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:fi(t)},a=this._parse({data:t,path:r.path,parent:r}),o=await(wu(a)?a:Promise.resolve(a));return zx(r,o)}refine(t,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,o)=>{const c=t(a),u=()=>o.addIssue({code:Fe.custom,...r(a)});return typeof Promise<"u"&&c instanceof Promise?c.then(p=>p?!0:(u(),!1)):c?!0:(u(),!1)})}refinement(t,n){return this._refinement((r,a)=>t(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(t){return new uo({schema:this,typeName:rt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return pi.create(this,this._def)}nullable(){return fo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ua.create(this)}promise(){return Mu.create(this,this._def)}or(t){return bu.create([this,t],this._def)}and(t){return ku.create(this,t,this._def)}transform(t){return new uo({...ft(this._def),schema:this,typeName:rt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Fd({...ft(this._def),innerType:this,defaultValue:n,typeName:rt.ZodDefault})}brand(){return new nC({typeName:rt.ZodBranded,type:this,...ft(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Ld({...ft(this._def),innerType:this,catchValue:n,typeName:rt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return uh.create(this,t)}readonly(){return Od.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const FS=/^c[^\s-]{8,}$/i,LS=/^[0-9a-z]+$/,OS=/^[0-9A-HJKMNP-TV-Z]{26}$/i,PS=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,US=/^[a-z0-9_-]{21}$/i,BS=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,VS=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,GS=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,HS="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let pd;const zS=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,jS=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,qS=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,YS=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,$S=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,JS=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Py="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",XS=new RegExp(`^${Py}$`);function Uy(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function WS(e){return new RegExp(`^${Uy(e)}$`)}function KS(e){let t=`${Py}T${Uy(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function ZS(e,t){return!!((t==="v4"||!t)&&zS.test(e)||(t==="v6"||!t)&&qS.test(e))}function QS(e,t){if(!BS.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function eC(e,t){return!!((t==="v4"||!t)&&jS.test(e)||(t==="v6"||!t)&&YS.test(e))}class la extends Tt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Ye.string){const o=this._getOrReturnCtx(t);return Ve(o,{code:Fe.invalid_type,expected:Ye.string,received:o.parsedType}),it}const r=new Zn;let a;for(const o of this._def.checks)if(o.kind==="min")t.data.length<o.value&&(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="max")t.data.length>o.value&&(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="length"){const c=t.data.length>o.value,u=t.data.length<o.value;(c||u)&&(a=this._getOrReturnCtx(t,a),c?Ve(a,{code:Fe.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):u&&Ve(a,{code:Fe.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),r.dirty())}else if(o.kind==="email")GS.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"email",code:Fe.invalid_string,message:o.message}),r.dirty());else if(o.kind==="emoji")pd||(pd=new RegExp(HS,"u")),pd.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"emoji",code:Fe.invalid_string,message:o.message}),r.dirty());else if(o.kind==="uuid")PS.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"uuid",code:Fe.invalid_string,message:o.message}),r.dirty());else if(o.kind==="nanoid")US.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"nanoid",code:Fe.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid")FS.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"cuid",code:Fe.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid2")LS.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"cuid2",code:Fe.invalid_string,message:o.message}),r.dirty());else if(o.kind==="ulid")OS.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"ulid",code:Fe.invalid_string,message:o.message}),r.dirty());else if(o.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Ve(a,{validation:"url",code:Fe.invalid_string,message:o.message}),r.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"regex",code:Fe.invalid_string,message:o.message}),r.dirty())):o.kind==="trim"?t.data=t.data.trim():o.kind==="includes"?t.data.includes(o.value,o.position)||(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),r.dirty()):o.kind==="toLowerCase"?t.data=t.data.toLowerCase():o.kind==="toUpperCase"?t.data=t.data.toUpperCase():o.kind==="startsWith"?t.data.startsWith(o.value)||(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.invalid_string,validation:{startsWith:o.value},message:o.message}),r.dirty()):o.kind==="endsWith"?t.data.endsWith(o.value)||(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.invalid_string,validation:{endsWith:o.value},message:o.message}),r.dirty()):o.kind==="datetime"?KS(o).test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.invalid_string,validation:"datetime",message:o.message}),r.dirty()):o.kind==="date"?XS.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.invalid_string,validation:"date",message:o.message}),r.dirty()):o.kind==="time"?WS(o).test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.invalid_string,validation:"time",message:o.message}),r.dirty()):o.kind==="duration"?VS.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"duration",code:Fe.invalid_string,message:o.message}),r.dirty()):o.kind==="ip"?ZS(t.data,o.version)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"ip",code:Fe.invalid_string,message:o.message}),r.dirty()):o.kind==="jwt"?QS(t.data,o.alg)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"jwt",code:Fe.invalid_string,message:o.message}),r.dirty()):o.kind==="cidr"?eC(t.data,o.version)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"cidr",code:Fe.invalid_string,message:o.message}),r.dirty()):o.kind==="base64"?$S.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"base64",code:Fe.invalid_string,message:o.message}),r.dirty()):o.kind==="base64url"?JS.test(t.data)||(a=this._getOrReturnCtx(t,a),Ve(a,{validation:"base64url",code:Fe.invalid_string,message:o.message}),r.dirty()):kt.assertNever(o);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(a=>t.test(a),{validation:n,code:Fe.invalid_string,...$e.errToObj(r)})}_addCheck(t){return new la({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...$e.errToObj(t)})}url(t){return this._addCheck({kind:"url",...$e.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...$e.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...$e.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...$e.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...$e.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...$e.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...$e.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...$e.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...$e.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...$e.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...$e.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...$e.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...$e.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...$e.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...$e.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...$e.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...$e.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...$e.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...$e.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...$e.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...$e.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...$e.errToObj(n)})}nonempty(t){return this.min(1,$e.errToObj(t))}trim(){return new la({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new la({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new la({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}la.create=e=>new la({checks:[],typeName:rt.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...ft(e)});function tC(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r,o=Number.parseInt(e.toFixed(a).replace(".","")),c=Number.parseInt(t.toFixed(a).replace(".",""));return o%c/10**a}class Wi extends Tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Ye.number){const o=this._getOrReturnCtx(t);return Ve(o,{code:Fe.invalid_type,expected:Ye.number,received:o.parsedType}),it}let r;const a=new Zn;for(const o of this._def.checks)o.kind==="int"?kt.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),Ve(r,{code:Fe.invalid_type,expected:"integer",received:"float",message:o.message}),a.dirty()):o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),Ve(r,{code:Fe.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),Ve(r,{code:Fe.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="multipleOf"?tC(t.data,o.value)!==0&&(r=this._getOrReturnCtx(t,r),Ve(r,{code:Fe.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):o.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),Ve(r,{code:Fe.not_finite,message:o.message}),a.dirty()):kt.assertNever(o);return{status:a.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,$e.toString(n))}gt(t,n){return this.setLimit("min",t,!1,$e.toString(n))}lte(t,n){return this.setLimit("max",t,!0,$e.toString(n))}lt(t,n){return this.setLimit("max",t,!1,$e.toString(n))}setLimit(t,n,r,a){return new Wi({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:$e.toString(a)}]})}_addCheck(t){return new Wi({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:$e.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:$e.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:$e.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:$e.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:$e.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:$e.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:$e.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:$e.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:$e.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&kt.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Wi.create=e=>new Wi({checks:[],typeName:rt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...ft(e)});class Ki extends Tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Ye.bigint)return this._getInvalidInput(t);let r;const a=new Zn;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),Ve(r,{code:Fe.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),Ve(r,{code:Fe.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="multipleOf"?t.data%o.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),Ve(r,{code:Fe.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):kt.assertNever(o);return{status:a.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return Ve(n,{code:Fe.invalid_type,expected:Ye.bigint,received:n.parsedType}),it}gte(t,n){return this.setLimit("min",t,!0,$e.toString(n))}gt(t,n){return this.setLimit("min",t,!1,$e.toString(n))}lte(t,n){return this.setLimit("max",t,!0,$e.toString(n))}lt(t,n){return this.setLimit("max",t,!1,$e.toString(n))}setLimit(t,n,r,a){return new Ki({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:$e.toString(a)}]})}_addCheck(t){return new Ki({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:$e.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:$e.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:$e.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:$e.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:$e.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Ki.create=e=>new Ki({checks:[],typeName:rt.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...ft(e)});class Au extends Tt{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Ye.boolean){const r=this._getOrReturnCtx(t);return Ve(r,{code:Fe.invalid_type,expected:Ye.boolean,received:r.parsedType}),it}return Pr(t.data)}}Au.create=e=>new Au({typeName:rt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...ft(e)});class lo extends Tt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Ye.date){const o=this._getOrReturnCtx(t);return Ve(o,{code:Fe.invalid_type,expected:Ye.date,received:o.parsedType}),it}if(Number.isNaN(t.data.getTime())){const o=this._getOrReturnCtx(t);return Ve(o,{code:Fe.invalid_date}),it}const r=new Zn;let a;for(const o of this._def.checks)o.kind==="min"?t.data.getTime()<o.value&&(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),r.dirty()):o.kind==="max"?t.data.getTime()>o.value&&(a=this._getOrReturnCtx(t,a),Ve(a,{code:Fe.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),r.dirty()):kt.assertNever(o);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new lo({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:$e.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:$e.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}lo.create=e=>new lo({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:rt.ZodDate,...ft(e)});class jx extends Tt{_parse(t){if(this._getType(t)!==Ye.symbol){const r=this._getOrReturnCtx(t);return Ve(r,{code:Fe.invalid_type,expected:Ye.symbol,received:r.parsedType}),it}return Pr(t.data)}}jx.create=e=>new jx({typeName:rt.ZodSymbol,...ft(e)});class qx extends Tt{_parse(t){if(this._getType(t)!==Ye.undefined){const r=this._getOrReturnCtx(t);return Ve(r,{code:Fe.invalid_type,expected:Ye.undefined,received:r.parsedType}),it}return Pr(t.data)}}qx.create=e=>new qx({typeName:rt.ZodUndefined,...ft(e)});class Yx extends Tt{_parse(t){if(this._getType(t)!==Ye.null){const r=this._getOrReturnCtx(t);return Ve(r,{code:Fe.invalid_type,expected:Ye.null,received:r.parsedType}),it}return Pr(t.data)}}Yx.create=e=>new Yx({typeName:rt.ZodNull,...ft(e)});class $x extends Tt{constructor(){super(...arguments),this._any=!0}_parse(t){return Pr(t.data)}}$x.create=e=>new $x({typeName:rt.ZodAny,...ft(e)});class Rd extends Tt{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Pr(t.data)}}Rd.create=e=>new Rd({typeName:rt.ZodUnknown,...ft(e)});class yi extends Tt{_parse(t){const n=this._getOrReturnCtx(t);return Ve(n,{code:Fe.invalid_type,expected:Ye.never,received:n.parsedType}),it}}yi.create=e=>new yi({typeName:rt.ZodNever,...ft(e)});class Jx extends Tt{_parse(t){if(this._getType(t)!==Ye.undefined){const r=this._getOrReturnCtx(t);return Ve(r,{code:Fe.invalid_type,expected:Ye.void,received:r.parsedType}),it}return Pr(t.data)}}Jx.create=e=>new Jx({typeName:rt.ZodVoid,...ft(e)});class ua extends Tt{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),a=this._def;if(n.parsedType!==Ye.array)return Ve(n,{code:Fe.invalid_type,expected:Ye.array,received:n.parsedType}),it;if(a.exactLength!==null){const c=n.data.length>a.exactLength.value,u=n.data.length<a.exactLength.value;(c||u)&&(Ve(n,{code:c?Fe.too_big:Fe.too_small,minimum:u?a.exactLength.value:void 0,maximum:c?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Ve(n,{code:Fe.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Ve(n,{code:Fe.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((c,u)=>a.type._parseAsync(new fa(n,c,n.path,u)))).then(c=>Zn.mergeArray(r,c));const o=[...n.data].map((c,u)=>a.type._parseSync(new fa(n,c,n.path,u)));return Zn.mergeArray(r,o)}get element(){return this._def.type}min(t,n){return new ua({...this._def,minLength:{value:t,message:$e.toString(n)}})}max(t,n){return new ua({...this._def,maxLength:{value:t,message:$e.toString(n)}})}length(t,n){return new ua({...this._def,exactLength:{value:t,message:$e.toString(n)}})}nonempty(t){return this.min(1,t)}}ua.create=(e,t)=>new ua({type:e,minLength:null,maxLength:null,exactLength:null,typeName:rt.ZodArray,...ft(t)});function Ks(e){if(e instanceof pn){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=pi.create(Ks(r))}return new pn({...e._def,shape:()=>t})}else return e instanceof ua?new ua({...e._def,type:Ks(e.element)}):e instanceof pi?pi.create(Ks(e.unwrap())):e instanceof fo?fo.create(Ks(e.unwrap())):e instanceof Zi?Zi.create(e.items.map(t=>Ks(t))):e}class pn extends Tt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=kt.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==Ye.object){const h=this._getOrReturnCtx(t);return Ve(h,{code:Fe.invalid_type,expected:Ye.object,received:h.parsedType}),it}const{status:r,ctx:a}=this._processInputParams(t),{shape:o,keys:c}=this._getCached(),u=[];if(!(this._def.catchall instanceof yi&&this._def.unknownKeys==="strip"))for(const h in a.data)c.includes(h)||u.push(h);const p=[];for(const h of c){const g=o[h],y=a.data[h];p.push({key:{status:"valid",value:h},value:g._parse(new fa(a,y,a.path,h)),alwaysSet:h in a.data})}if(this._def.catchall instanceof yi){const h=this._def.unknownKeys;if(h==="passthrough")for(const g of u)p.push({key:{status:"valid",value:g},value:{status:"valid",value:a.data[g]}});else if(h==="strict")u.length>0&&(Ve(a,{code:Fe.unrecognized_keys,keys:u}),r.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const g of u){const y=a.data[g];p.push({key:{status:"valid",value:g},value:h._parse(new fa(a,y,a.path,g)),alwaysSet:g in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const h=[];for(const g of p){const y=await g.key,_=await g.value;h.push({key:y,value:_,alwaysSet:g.alwaysSet})}return h}).then(h=>Zn.mergeObjectSync(r,h)):Zn.mergeObjectSync(r,p)}get shape(){return this._def.shape()}strict(t){return $e.errToObj,new pn({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var o,c;const a=((c=(o=this._def).errorMap)==null?void 0:c.call(o,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:$e.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new pn({...this._def,unknownKeys:"strip"})}passthrough(){return new pn({...this._def,unknownKeys:"passthrough"})}extend(t){return new pn({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new pn({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:rt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new pn({...this._def,catchall:t})}pick(t){const n={};for(const r of kt.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new pn({...this._def,shape:()=>n})}omit(t){const n={};for(const r of kt.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new pn({...this._def,shape:()=>n})}deepPartial(){return Ks(this)}partial(t){const n={};for(const r of kt.objectKeys(this.shape)){const a=this.shape[r];t&&!t[r]?n[r]=a:n[r]=a.optional()}return new pn({...this._def,shape:()=>n})}required(t){const n={};for(const r of kt.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let o=this.shape[r];for(;o instanceof pi;)o=o._def.innerType;n[r]=o}return new pn({...this._def,shape:()=>n})}keyof(){return By(kt.objectKeys(this.shape))}}pn.create=(e,t)=>new pn({shape:()=>e,unknownKeys:"strip",catchall:yi.create(),typeName:rt.ZodObject,...ft(t)});pn.strictCreate=(e,t)=>new pn({shape:()=>e,unknownKeys:"strict",catchall:yi.create(),typeName:rt.ZodObject,...ft(t)});pn.lazycreate=(e,t)=>new pn({shape:e,unknownKeys:"strip",catchall:yi.create(),typeName:rt.ZodObject,...ft(t)});class bu extends Tt{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function a(o){for(const u of o)if(u.result.status==="valid")return u.result;for(const u of o)if(u.result.status==="dirty")return n.common.issues.push(...u.ctx.common.issues),u.result;const c=o.map(u=>new Oa(u.ctx.common.issues));return Ve(n,{code:Fe.invalid_union,unionErrors:c}),it}if(n.common.async)return Promise.all(r.map(async o=>{const c={...n,common:{...n.common,issues:[]},parent:null};return{result:await o._parseAsync({data:n.data,path:n.path,parent:c}),ctx:c}})).then(a);{let o;const c=[];for(const p of r){const h={...n,common:{...n.common,issues:[]},parent:null},g=p._parseSync({data:n.data,path:n.path,parent:h});if(g.status==="valid")return g;g.status==="dirty"&&!o&&(o={result:g,ctx:h}),h.common.issues.length&&c.push(h.common.issues)}if(o)return n.common.issues.push(...o.ctx.common.issues),o.result;const u=c.map(p=>new Oa(p));return Ve(n,{code:Fe.invalid_union,unionErrors:u}),it}}get options(){return this._def.options}}bu.create=(e,t)=>new bu({options:e,typeName:rt.ZodUnion,...ft(t)});function Dd(e,t){const n=fi(e),r=fi(t);if(e===t)return{valid:!0,data:e};if(n===Ye.object&&r===Ye.object){const a=kt.objectKeys(t),o=kt.objectKeys(e).filter(u=>a.indexOf(u)!==-1),c={...e,...t};for(const u of o){const p=Dd(e[u],t[u]);if(!p.valid)return{valid:!1};c[u]=p.data}return{valid:!0,data:c}}else if(n===Ye.array&&r===Ye.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let o=0;o<e.length;o++){const c=e[o],u=t[o],p=Dd(c,u);if(!p.valid)return{valid:!1};a.push(p.data)}return{valid:!0,data:a}}else return n===Ye.date&&r===Ye.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ku extends Tt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=(o,c)=>{if(Gx(o)||Gx(c))return it;const u=Dd(o.value,c.value);return u.valid?((Hx(o)||Hx(c))&&n.dirty(),{status:n.value,value:u.data}):(Ve(r,{code:Fe.invalid_intersection_types}),it)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([o,c])=>a(o,c)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ku.create=(e,t,n)=>new ku({left:e,right:t,typeName:rt.ZodIntersection,...ft(n)});class Zi extends Tt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ye.array)return Ve(r,{code:Fe.invalid_type,expected:Ye.array,received:r.parsedType}),it;if(r.data.length<this._def.items.length)return Ve(r,{code:Fe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),it;!this._def.rest&&r.data.length>this._def.items.length&&(Ve(r,{code:Fe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const o=[...r.data].map((c,u)=>{const p=this._def.items[u]||this._def.rest;return p?p._parse(new fa(r,c,r.path,u)):null}).filter(c=>!!c);return r.common.async?Promise.all(o).then(c=>Zn.mergeArray(n,c)):Zn.mergeArray(n,o)}get items(){return this._def.items}rest(t){return new Zi({...this._def,rest:t})}}Zi.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Zi({items:e,typeName:rt.ZodTuple,rest:null,...ft(t)})};class Nu extends Tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ye.object)return Ve(r,{code:Fe.invalid_type,expected:Ye.object,received:r.parsedType}),it;const a=[],o=this._def.keyType,c=this._def.valueType;for(const u in r.data)a.push({key:o._parse(new fa(r,u,r.path,u)),value:c._parse(new fa(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?Zn.mergeObjectAsync(n,a):Zn.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Tt?new Nu({keyType:t,valueType:n,typeName:rt.ZodRecord,...ft(r)}):new Nu({keyType:la.create(),valueType:t,typeName:rt.ZodRecord,...ft(n)})}}class Xx extends Tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ye.map)return Ve(r,{code:Fe.invalid_type,expected:Ye.map,received:r.parsedType}),it;const a=this._def.keyType,o=this._def.valueType,c=[...r.data.entries()].map(([u,p],h)=>({key:a._parse(new fa(r,u,r.path,[h,"key"])),value:o._parse(new fa(r,p,r.path,[h,"value"]))}));if(r.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const p of c){const h=await p.key,g=await p.value;if(h.status==="aborted"||g.status==="aborted")return it;(h.status==="dirty"||g.status==="dirty")&&n.dirty(),u.set(h.value,g.value)}return{status:n.value,value:u}})}else{const u=new Map;for(const p of c){const h=p.key,g=p.value;if(h.status==="aborted"||g.status==="aborted")return it;(h.status==="dirty"||g.status==="dirty")&&n.dirty(),u.set(h.value,g.value)}return{status:n.value,value:u}}}}Xx.create=(e,t,n)=>new Xx({valueType:t,keyType:e,typeName:rt.ZodMap,...ft(n)});class Ol extends Tt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ye.set)return Ve(r,{code:Fe.invalid_type,expected:Ye.set,received:r.parsedType}),it;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Ve(r,{code:Fe.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Ve(r,{code:Fe.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const o=this._def.valueType;function c(p){const h=new Set;for(const g of p){if(g.status==="aborted")return it;g.status==="dirty"&&n.dirty(),h.add(g.value)}return{status:n.value,value:h}}const u=[...r.data.values()].map((p,h)=>o._parse(new fa(r,p,r.path,h)));return r.common.async?Promise.all(u).then(p=>c(p)):c(u)}min(t,n){return new Ol({...this._def,minSize:{value:t,message:$e.toString(n)}})}max(t,n){return new Ol({...this._def,maxSize:{value:t,message:$e.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Ol.create=(e,t)=>new Ol({valueType:e,minSize:null,maxSize:null,typeName:rt.ZodSet,...ft(t)});class Id extends Tt{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Id.create=(e,t)=>new Id({getter:e,typeName:rt.ZodLazy,...ft(t)});class Wx extends Tt{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Ve(n,{received:n.data,code:Fe.invalid_literal,expected:this._def.value}),it}return{status:"valid",value:t.data}}get value(){return this._def.value}}Wx.create=(e,t)=>new Wx({value:e,typeName:rt.ZodLiteral,...ft(t)});function By(e,t){return new co({values:e,typeName:rt.ZodEnum,...ft(t)})}class co extends Tt{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return Ve(n,{expected:kt.joinValues(r),received:n.parsedType,code:Fe.invalid_type}),it}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return Ve(n,{received:n.data,code:Fe.invalid_enum_value,options:r}),it}return Pr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return co.create(t,{...this._def,...n})}exclude(t,n=this._def){return co.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}co.create=By;class Kx extends Tt{_parse(t){const n=kt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==Ye.string&&r.parsedType!==Ye.number){const a=kt.objectValues(n);return Ve(r,{expected:kt.joinValues(a),received:r.parsedType,code:Fe.invalid_type}),it}if(this._cache||(this._cache=new Set(kt.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=kt.objectValues(n);return Ve(r,{received:r.data,code:Fe.invalid_enum_value,options:a}),it}return Pr(t.data)}get enum(){return this._def.values}}Kx.create=(e,t)=>new Kx({values:e,typeName:rt.ZodNativeEnum,...ft(t)});class Mu extends Tt{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Ye.promise&&n.common.async===!1)return Ve(n,{code:Fe.invalid_type,expected:Ye.promise,received:n.parsedType}),it;const r=n.parsedType===Ye.promise?n.data:Promise.resolve(n.data);return Pr(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Mu.create=(e,t)=>new Mu({type:e,typeName:rt.ZodPromise,...ft(t)});class uo extends Tt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===rt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=this._def.effect||null,o={addIssue:c=>{Ve(r,c),c.fatal?n.abort():n.dirty()},get path(){return r.path}};if(o.addIssue=o.addIssue.bind(o),a.type==="preprocess"){const c=a.transform(r.data,o);if(r.common.async)return Promise.resolve(c).then(async u=>{if(n.value==="aborted")return it;const p=await this._def.schema._parseAsync({data:u,path:r.path,parent:r});return p.status==="aborted"?it:p.status==="dirty"||n.value==="dirty"?vl(p.value):p});{if(n.value==="aborted")return it;const u=this._def.schema._parseSync({data:c,path:r.path,parent:r});return u.status==="aborted"?it:u.status==="dirty"||n.value==="dirty"?vl(u.value):u}}if(a.type==="refinement"){const c=u=>{const p=a.refinement(u,o);if(r.common.async)return Promise.resolve(p);if(p instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(r.common.async===!1){const u=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return u.status==="aborted"?it:(u.status==="dirty"&&n.dirty(),c(u.value),{status:n.value,value:u.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(u=>u.status==="aborted"?it:(u.status==="dirty"&&n.dirty(),c(u.value).then(()=>({status:n.value,value:u.value}))))}if(a.type==="transform")if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!oo(c))return it;const u=a.transform(c.value,o);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:u}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>oo(c)?Promise.resolve(a.transform(c.value,o)).then(u=>({status:n.value,value:u})):it);kt.assertNever(a)}}uo.create=(e,t,n)=>new uo({schema:e,typeName:rt.ZodEffects,effect:t,...ft(n)});uo.createWithPreprocess=(e,t,n)=>new uo({schema:t,effect:{type:"preprocess",transform:e},typeName:rt.ZodEffects,...ft(n)});class pi extends Tt{_parse(t){return this._getType(t)===Ye.undefined?Pr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}pi.create=(e,t)=>new pi({innerType:e,typeName:rt.ZodOptional,...ft(t)});class fo extends Tt{_parse(t){return this._getType(t)===Ye.null?Pr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}fo.create=(e,t)=>new fo({innerType:e,typeName:rt.ZodNullable,...ft(t)});class Fd extends Tt{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===Ye.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Fd.create=(e,t)=>new Fd({innerType:e,typeName:rt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ft(t)});class Ld extends Tt{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return wu(a)?a.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Oa(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Oa(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Ld.create=(e,t)=>new Ld({innerType:e,typeName:rt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ft(t)});class Zx extends Tt{_parse(t){if(this._getType(t)!==Ye.nan){const r=this._getOrReturnCtx(t);return Ve(r,{code:Fe.invalid_type,expected:Ye.nan,received:r.parsedType}),it}return{status:"valid",value:t.data}}}Zx.create=e=>new Zx({typeName:rt.ZodNaN,...ft(e)});class nC extends Tt{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class uh extends Tt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?it:o.status==="dirty"?(n.dirty(),vl(o.value)):this._def.out._parseAsync({data:o.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?it:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(t,n){return new uh({in:t,out:n,typeName:rt.ZodPipeline})}}class Od extends Tt{_parse(t){const n=this._def.innerType._parse(t),r=a=>(oo(a)&&(a.value=Object.freeze(a.value)),a);return wu(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}Od.create=(e,t)=>new Od({innerType:e,typeName:rt.ZodReadonly,...ft(t)});var rt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(rt||(rt={}));const qi=la.create,Qx=Wi.create;Ki.create;const rC=Au.create;lo.create;const e1=Rd.create;yi.create;const yl=ua.create,aC=pn.create,iC=bu.create;ku.create;Zi.create;const sC=Nu.create,oC=Id.create,lC=co.create;Mu.create;pi.create;fo.create;const $s={string:e=>la.create({...e,coerce:!0}),number:e=>Wi.create({...e,coerce:!0}),boolean:e=>Au.create({...e,coerce:!0}),bigint:e=>Ki.create({...e,coerce:!0}),date:e=>lo.create({...e,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let cC,uC;function fC(){return{geminiUrl:cC,vertexUrl:uC}}function dC(e,t,n){var r,a,o;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const c=fC();return e.vertexai?(a=c.vertexUrl)!==null&&a!==void 0?a:t:(o=c.geminiUrl)!==null&&o!==void 0?o:n}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class is{}function Je(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(t,a)){const o=t[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function d(e,t,n){for(let o=0;o<t.length-1;o++){const c=t[o];if(c.endsWith("[]")){const u=c.slice(0,-2);if(!(u in e))if(Array.isArray(n))e[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(e[u])){const p=e[u];if(Array.isArray(n))for(let h=0;h<p.length;h++){const g=p[h];d(g,t.slice(o+1),n[h])}else for(const h of p)d(h,t.slice(o+1),n)}return}else if(c.endsWith("[0]")){const u=c.slice(0,-3);u in e||(e[u]=[{}]);const p=e[u];d(p[0],t.slice(o+1),n);return}(!e[c]||typeof e[c]!="object")&&(e[c]={}),e=e[c]}const r=t[t.length-1],a=e[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=n}function f(e,t){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return;const r=t[n];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const o=e[a];return Array.isArray(o)?o.map(c=>f(c,t.slice(n+1))):void 0}else return}else e=e[r]}return e}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var t1;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(t1||(t1={}));var n1;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(n1||(n1={}));var ca;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(ca||(ca={}));var r1;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(r1||(r1={}));var a1;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(a1||(a1={}));var i1;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(i1||(i1={}));var s1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(s1||(s1={}));var o1;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(o1||(o1={}));var l1;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(l1||(l1={}));var c1;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(c1||(c1={}));var u1;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(u1||(u1={}));var f1;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(f1||(f1={}));var d1;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(d1||(d1={}));var h1;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(h1||(h1={}));var m1;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"})(m1||(m1={}));var p1;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(p1||(p1={}));var Ru;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Ru||(Ru={}));var g1;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(g1||(g1={}));var Pd;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Pd||(Pd={}));var x1;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(x1||(x1={}));var v1;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(v1||(v1={}));var y1;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(y1||(y1={}));var T1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(T1||(T1={}));var _1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(_1||(_1={}));var E1;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(E1||(E1={}));var S1;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(S1||(S1={}));var C1;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(C1||(C1={}));var w1;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(w1||(w1={}));var A1;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(A1||(A1={}));var b1;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(b1||(b1={}));var k1;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(k1||(k1={}));var N1;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(N1||(N1={}));var M1;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(M1||(M1={}));var R1;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(R1||(R1={}));var D1;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(D1||(D1={}));var I1;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(I1||(I1={}));var F1;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(F1||(F1={}));var L1;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(L1||(L1={}));var O1;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(O1||(O1={}));var P1;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(P1||(P1={}));var U1;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(U1||(U1={}));var Qs;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Qs||(Qs={}));class Ud{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class xl{get text(){var t,n,r,a,o,c,u,p;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",g=!1;const y=[];for(const _ of(p=(u=(c=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)!==null&&p!==void 0?p:[]){for(const[E,S]of Object.entries(_))E!=="text"&&E!=="thought"&&(S!==null||S!==void 0)&&y.push(E);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;g=!0,h+=_.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?h:void 0}get data(){var t,n,r,a,o,c,u,p;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const g=[];for(const y of(p=(u=(c=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)!==null&&p!==void 0?p:[]){for(const[_,E]of Object.entries(y))_!=="inlineData"&&(E!==null||E!==void 0)&&g.push(_);y.inlineData&&typeof y.inlineData.data=="string"&&(h+=atob(y.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,n,r,a,o,c,u,p;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(p=(u=(c=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)===null||p===void 0?void 0:p.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,n,r,a,o,c,u,p,h;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(p=(u=(c=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)===null||p===void 0?void 0:p.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(h=g==null?void 0:g[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,n,r,a,o,c,u,p,h;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(p=(u=(c=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)===null||p===void 0?void 0:p.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(h=g==null?void 0:g[0])===null||h===void 0?void 0:h.output}}class B1{}class V1{}class hC{}class mC{}class G1{}class H1{}class z1{}class pC{}class j1{}class q1{}class Y1{}class gC{}class xC{}class vC{}class $1{}class yC{get text(){var t,n,r;let a="",o=!1;const c=[];for(const u of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[p,h]of Object.entries(u))p!=="text"&&p!=="thought"&&h!==null&&c.push(p);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;o=!0,a+=u.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var t,n,r;let a="";const o=[];for(const c of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,p]of Object.entries(c))u!=="inlineData"&&p!==null&&o.push(u);c.inlineData&&typeof c.inlineData.data=="string"&&(a+=atob(c.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class TC{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function It(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function Vy(e,t){const n=It(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function Gy(e){return Array.isArray(e)?e.map(t=>Du(t)):[Du(e)]}function Du(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Hy(e){const t=Du(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function zy(e){const t=Du(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function J1(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function jy(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>J1(t)):[J1(e)]}function Bd(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function X1(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function W1(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Gn(e){if(e==null)throw new Error("ContentUnion is required");return Bd(e)?e:{role:"user",parts:jy(e)}}function qy(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=Gn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=Gn(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Gn(n)):[Gn(t)]}function Fr(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(X1(e)||W1(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Gn(e)]}const t=[],n=[],r=Bd(e[0]);for(const a of e){const o=Bd(a);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(a);else{if(X1(a)||W1(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||t.push({role:"user",parts:jy(n)}),t}const _C=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),K1=lC(["string","number","integer","object","array","boolean","null"]),EC=iC([K1,yl(K1)]);function SC(e=!0){const t=oC(()=>{const n=aC({type:EC.optional(),format:qi().optional(),title:qi().optional(),description:qi().optional(),default:e1().optional(),items:t.optional(),minItems:$s.string().optional(),maxItems:$s.string().optional(),enum:yl(e1()).optional(),properties:sC(qi(),t).optional(),required:yl(qi()).optional(),minProperties:$s.string().optional(),maxProperties:$s.string().optional(),propertyOrdering:yl(qi()).optional(),minimum:Qx().optional(),maximum:Qx().optional(),minLength:$s.string().optional(),maxLength:$s.string().optional(),pattern:qi().optional(),anyOf:yl(t).optional(),additionalProperties:rC().optional()});return e?n.strict():n});return t}function CC(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(ca).includes(n[0].toUpperCase())?n[0].toUpperCase():ca.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(ca).includes(r.toUpperCase())?r.toUpperCase():ca.TYPE_UNSPECIFIED})}}function to(e){const t={},n=["items"],r=["anyOf"],a=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=e.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(t.nullable=!0,e=o[1]):o[1].type==="null"&&(t.nullable=!0,e=o[0])),e.type instanceof Array&&CC(e.type,t);for(const[c,u]of Object.entries(e))if(u!=null)if(c=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;t.type=Object.values(ca).includes(u.toUpperCase())?u.toUpperCase():ca.TYPE_UNSPECIFIED}else if(n.includes(c))t[c]=to(u);else if(r.includes(c)){const p=[];for(const h of u){if(h.type=="null"){t.nullable=!0;continue}p.push(to(h))}t[c]=p}else if(a.includes(c)){const p={};for(const[h,g]of Object.entries(u))p[h]=to(g);t[c]=p}else{if(c==="additionalProperties")continue;t[c]=u}return t}function Pl(e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=SC().parse(e);return to(t)}else return to(e)}function fh(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function dh(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function go(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=Pl(t.parameters)),t.response&&(t.response=Pl(t.response));return e}function xo(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function wC(e,t,n,r=1){const a=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:a?`${n}/${t}`:t}function Ua(e,t){if(typeof t!="string")throw new Error("name must be a string");return wC(e,t,"cachedContents")}function Yy(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Ba(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function AC(e){return e!=null&&typeof e=="object"&&"name"in e}function bC(e){return e!=null&&typeof e=="object"&&"video"in e}function kC(e){return e!=null&&typeof e=="object"&&"uri"in e}function $y(e){var t;let n;if(AC(e)&&(n=e.name),!(kC(e)&&(n=e.uri,n===void 0))&&!(bC(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Jy(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function Xy(e){for(const t of["models","tunedModels","publisherModels"])if(NC(e,t))return e[t];return[]}function NC(e,t){return e!==null&&typeof e=="object"&&t in e}function MC(e,t={}){const n=e,r={name:n.name,description:n.description,parameters:to($u(n.inputSchema))};return t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function RC(e,t={}){const n=[],r=new Set;for(const a of e){const o=a.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const c=MC(a,t);c.functionDeclarations&&n.push(...c.functionDeclarations)}return{functionDeclarations:n}}function DC(e){const t=[];for(const n of e)t.push($u(n));return t}function IC(e){const t={};for(const[n,r]of Object.entries(e)){const a=r;t[n]=$u(a)}return t}function $u(e){const t=new Set(["items"]),n=new Set(["anyOf"]),r=new Set(["properties"]),a={};for(const[o,c]of Object.entries(e))if(t.has(o))a[o]=$u(c);else if(n.has(o))a[o]=DC(c);else if(r.has(o))a[o]=IC(c);else if(o==="type"){const u=c.toUpperCase();a[o]=Object.values(ca).includes(u)?u:ca.TYPE_UNSPECIFIED}else _C.has(o)&&(a[o]=c);return a}function Wy(e,t){if(typeof t!="string"&&!Array.isArray(t)){if(e&&e.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}else{if(Array.isArray(t))return{inlinedRequests:t};if(typeof t=="string"){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}}throw new Error(`Unsupported source: ${t}`)}function FC(e){const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function vo(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Ky(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LC(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function OC(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function PC(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function UC(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],LC(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],OC(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],PC(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function Zy(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>UC(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function BC(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const o=f(e,["enum"]);o!=null&&d(t,["enum"],o);const c=f(e,["example"]);c!=null&&d(t,["example"],c);const u=f(e,["format"]);u!=null&&d(t,["format"],u);const p=f(e,["items"]);p!=null&&d(t,["items"],p);const h=f(e,["maxItems"]);h!=null&&d(t,["maxItems"],h);const g=f(e,["maxLength"]);g!=null&&d(t,["maxLength"],g);const y=f(e,["maxProperties"]);y!=null&&d(t,["maxProperties"],y);const _=f(e,["maximum"]);_!=null&&d(t,["maximum"],_);const E=f(e,["minItems"]);E!=null&&d(t,["minItems"],E);const S=f(e,["minLength"]);S!=null&&d(t,["minLength"],S);const C=f(e,["minProperties"]);C!=null&&d(t,["minProperties"],C);const w=f(e,["minimum"]);w!=null&&d(t,["minimum"],w);const M=f(e,["nullable"]);M!=null&&d(t,["nullable"],M);const k=f(e,["pattern"]);k!=null&&d(t,["pattern"],k);const b=f(e,["properties"]);b!=null&&d(t,["properties"],b);const U=f(e,["propertyOrdering"]);U!=null&&d(t,["propertyOrdering"],U);const B=f(e,["required"]);B!=null&&d(t,["required"],B);const X=f(e,["title"]);X!=null&&d(t,["title"],X);const F=f(e,["type"]);return F!=null&&d(t,["type"],F),t}function VC(e){const t={};if(f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(e,["category"]);n!=null&&d(t,["category"],n);const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function GC(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const o=f(e,["parameters"]);o!=null&&d(t,["parameters"],o);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function HC(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function zC(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],HC(n)),t}function jC(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function qC(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],jC(n)),t}function YC(){return{}}function $C(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(h=>GC(h))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],zC(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],qC(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],YC());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function JC(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function XC(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function WC(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],XC(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function KC(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],JC(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],WC(r)),t}function ZC(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function Qy(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],ZC(n)),t}function QC(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],Qy(r)),t}function ew(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>QC(a))),d(t,["speakerVoiceConfigs"],r)}return t}function tw(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],Qy(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],ew(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function nw(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function rw(e,t,n){const r={},a=f(t,["systemInstruction"]);n!==void 0&&a!=null&&d(n,["systemInstruction"],Zy(Gn(a)));const o=f(t,["temperature"]);o!=null&&d(r,["temperature"],o);const c=f(t,["topP"]);c!=null&&d(r,["topP"],c);const u=f(t,["topK"]);u!=null&&d(r,["topK"],u);const p=f(t,["candidateCount"]);p!=null&&d(r,["candidateCount"],p);const h=f(t,["maxOutputTokens"]);h!=null&&d(r,["maxOutputTokens"],h);const g=f(t,["stopSequences"]);g!=null&&d(r,["stopSequences"],g);const y=f(t,["responseLogprobs"]);y!=null&&d(r,["responseLogprobs"],y);const _=f(t,["logprobs"]);_!=null&&d(r,["logprobs"],_);const E=f(t,["presencePenalty"]);E!=null&&d(r,["presencePenalty"],E);const S=f(t,["frequencyPenalty"]);S!=null&&d(r,["frequencyPenalty"],S);const C=f(t,["seed"]);C!=null&&d(r,["seed"],C);const w=f(t,["responseMimeType"]);w!=null&&d(r,["responseMimeType"],w);const M=f(t,["responseSchema"]);M!=null&&d(r,["responseSchema"],BC(Pl(M)));const k=f(t,["responseJsonSchema"]);if(k!=null&&d(r,["responseJsonSchema"],k),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=f(t,["safetySettings"]);if(n!==void 0&&b!=null){let te=b;Array.isArray(te)&&(te=te.map(ee=>VC(ee))),d(n,["safetySettings"],te)}const U=f(t,["tools"]);if(n!==void 0&&U!=null){let te=xo(U);Array.isArray(te)&&(te=te.map(ee=>$C(go(ee)))),d(n,["tools"],te)}const B=f(t,["toolConfig"]);if(n!==void 0&&B!=null&&d(n,["toolConfig"],KC(B)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const X=f(t,["cachedContent"]);n!==void 0&&X!=null&&d(n,["cachedContent"],Ua(e,X));const F=f(t,["responseModalities"]);F!=null&&d(r,["responseModalities"],F);const Y=f(t,["mediaResolution"]);Y!=null&&d(r,["mediaResolution"],Y);const L=f(t,["speechConfig"]);if(L!=null&&d(r,["speechConfig"],tw(fh(L))),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=f(t,["thinkingConfig"]);return Q!=null&&d(r,["thinkingConfig"],nw(Q)),r}function aw(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["request","model"],It(e,r));const a=f(t,["contents"]);if(a!=null){let c=Fr(a);Array.isArray(c)&&(c=c.map(u=>Zy(u))),d(n,["request","contents"],c)}const o=f(t,["config"]);return o!=null&&d(n,["request","generationConfig"],rw(e,o,n)),n}function iw(e,t){const n={};if(f(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=f(t,["fileName"]);r!=null&&d(n,["fileName"],r);const a=f(t,["inlinedRequests"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(c=>aw(e,c))),d(n,["requests","requests"],o)}return n}function sw(e,t){const n={},r=f(e,["displayName"]);if(t!==void 0&&r!=null&&d(t,["batch","displayName"],r),f(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function ow(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["src"]);a!=null&&d(n,["batch","inputConfig"],iw(e,Wy(e,a)));const o=f(t,["config"]);return o!=null&&d(n,["config"],sw(o,n)),n}function lw(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],vo(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function cw(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],vo(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function uw(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);if(t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),f(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function fw(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],uw(n,t)),t}function dw(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],vo(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function hw(e){const t={},n=f(e,["format"]);n!=null&&d(t,["instancesFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsSource","uris"],r);const a=f(e,["bigqueryUri"]);if(a!=null&&d(t,["bigquerySource","inputUri"],a),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function mw(e){const t={},n=f(e,["format"]);n!=null&&d(t,["predictionsFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsDestination","outputUriPrefix"],r);const a=f(e,["bigqueryUri"]);if(a!=null&&d(t,["bigqueryDestination","outputUri"],a),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}function pw(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const a=f(e,["dest"]);return t!==void 0&&a!=null&&d(t,["outputConfig"],mw(FC(a))),n}function gw(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],It(e,r));const a=f(t,["src"]);a!=null&&d(n,["inputConfig"],hw(Wy(e,a)));const o=f(t,["config"]);return o!=null&&d(n,["config"],pw(o,n)),n}function xw(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],vo(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function vw(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],vo(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function yw(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const o=f(e,["filter"]);return t!==void 0&&o!=null&&d(t,["_query","filter"],o),n}function Tw(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],yw(n,t)),t}function _w(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],vo(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function eT(){return{}}function Ew(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function Sw(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Cw(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function ww(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Ew(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],Sw(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],Cw(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function Aw(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>ww(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function bw(e){const t={},n=f(e,["citationSources"]);return n!=null&&d(t,["citations"],n),t}function kw(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function Nw(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>kw(a))),d(t,["urlMetadata"],r)}return t}function Mw(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],Aw(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],bw(r));const a=f(e,["tokenCount"]);a!=null&&d(t,["tokenCount"],a);const o=f(e,["finishReason"]);o!=null&&d(t,["finishReason"],o);const c=f(e,["urlContextMetadata"]);c!=null&&d(t,["urlContextMetadata"],Nw(c));const u=f(e,["avgLogprobs"]);u!=null&&d(t,["avgLogprobs"],u);const p=f(e,["groundingMetadata"]);p!=null&&d(t,["groundingMetadata"],p);const h=f(e,["index"]);h!=null&&d(t,["index"],h);const g=f(e,["logprobsResult"]);g!=null&&d(t,["logprobsResult"],g);const y=f(e,["safetyRatings"]);return y!=null&&d(t,["safetyRatings"],y),t}function Rw(e){const t={},n=f(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>Mw(u))),d(t,["candidates"],c)}const r=f(e,["modelVersion"]);r!=null&&d(t,["modelVersion"],r);const a=f(e,["promptFeedback"]);a!=null&&d(t,["promptFeedback"],a);const o=f(e,["usageMetadata"]);return o!=null&&d(t,["usageMetadata"],o),t}function Dw(e){const t={},n=f(e,["response"]);return n!=null&&d(t,["response"],Rw(n)),f(e,["error"])!=null&&d(t,["error"],eT()),t}function Iw(e){const t={},n=f(e,["responsesFile"]);n!=null&&d(t,["fileName"],n);const r=f(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Dw(o))),d(t,["inlinedResponses"],a)}return t}function Vd(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata","displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["metadata","state"]);a!=null&&d(t,["state"],Ky(a));const o=f(e,["metadata","createTime"]);o!=null&&d(t,["createTime"],o);const c=f(e,["metadata","endTime"]);c!=null&&d(t,["endTime"],c);const u=f(e,["metadata","updateTime"]);u!=null&&d(t,["updateTime"],u);const p=f(e,["metadata","model"]);p!=null&&d(t,["model"],p);const h=f(e,["metadata","output"]);return h!=null&&d(t,["dest"],Iw(h)),t}function Fw(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Vd(o))),d(t,["batchJobs"],a)}return t}function Lw(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["done"]);return r!=null&&d(t,["done"],r),f(e,["error"])!=null&&d(t,["error"],eT()),t}function tT(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["code"]);r!=null&&d(t,["code"],r);const a=f(e,["message"]);return a!=null&&d(t,["message"],a),t}function Ow(e){const t={},n=f(e,["instancesFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsSource","uris"]);r!=null&&d(t,["gcsUri"],r);const a=f(e,["bigquerySource","inputUri"]);return a!=null&&d(t,["bigqueryUri"],a),t}function Pw(e){const t={},n=f(e,["predictionsFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsDestination","outputUriPrefix"]);r!=null&&d(t,["gcsUri"],r);const a=f(e,["bigqueryDestination","outputUri"]);return a!=null&&d(t,["bigqueryUri"],a),t}function Gd(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["state"]);a!=null&&d(t,["state"],Ky(a));const o=f(e,["error"]);o!=null&&d(t,["error"],tT(o));const c=f(e,["createTime"]);c!=null&&d(t,["createTime"],c);const u=f(e,["startTime"]);u!=null&&d(t,["startTime"],u);const p=f(e,["endTime"]);p!=null&&d(t,["endTime"],p);const h=f(e,["updateTime"]);h!=null&&d(t,["updateTime"],h);const g=f(e,["model"]);g!=null&&d(t,["model"],g);const y=f(e,["inputConfig"]);y!=null&&d(t,["src"],Ow(y));const _=f(e,["outputConfig"]);return _!=null&&d(t,["dest"],Pw(_)),t}function Uw(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Gd(o))),d(t,["batchJobs"],a)}return t}function Bw(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["done"]);r!=null&&d(t,["done"],r);const a=f(e,["error"]);return a!=null&&d(t,["error"],tT(a)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Qi;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Qi||(Qi={}));class Xl{constructor(t,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,a)}init(t,n,r){var a,o;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let c={config:{}};r?typeof r=="object"?c=Object.assign({},r):c=r:c={config:{}},c.config&&(c.config.pageToken=n.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(o=(a=c.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vw extends is{constructor(t){super(),this.apiClient=t,this.create=async n=>{if(this.apiClient.isVertexAI()){const a=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${a}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new Xl(Qi.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=gw(this.apiClient,t);return u=Je("batchPredictionJobs",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>Gd(g))}else{const h=ow(this.apiClient,t);return u=Je("{model}:batchGenerateContent",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>Vd(g))}}async get(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=xw(this.apiClient,t);return u=Je("batchPredictionJobs/{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>Gd(g))}else{const h=lw(this.apiClient,t);return u=Je("batches/{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>Vd(g))}}async cancel(t){var n,r,a,o;let c="",u={};if(this.apiClient.isVertexAI()){const p=vw(this.apiClient,t);c=Je("batchPredictionJobs/{name}:cancel",p._url),u=p._query,delete p.config,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const p=cw(this.apiClient,t);c=Je("batches/{name}:cancel",p._url),u=p._query,delete p.config,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=Tw(t);return u=Je("batchPredictionJobs",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>{const y=Uw(g),_=new $1;return Object.assign(_,y),_})}else{const h=fw(t);return u=Je("batches",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>{const y=Fw(g),_=new $1;return Object.assign(_,y),_})}}async delete(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=_w(this.apiClient,t);return u=Je("batchPredictionJobs/{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>Bw(g))}else{const h=dw(this.apiClient,t);return u=Je("batches/{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>Lw(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gw(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function Hw(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function zw(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function jw(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Gw(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],Hw(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],zw(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function Z1(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>jw(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function qw(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const o=f(e,["parameters"]);o!=null&&d(t,["parameters"],o);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function Yw(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function $w(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Yw(n)),t}function Jw(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Xw(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Jw(n)),t}function Ww(){return{}}function Kw(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(h=>qw(h))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],$w(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],Xw(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],Ww());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function Zw(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function Qw(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function eA(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],Qw(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function tA(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],Zw(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],eA(r)),t}function nA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);t!==void 0&&a!=null&&d(t,["expireTime"],a);const o=f(e,["displayName"]);t!==void 0&&o!=null&&d(t,["displayName"],o);const c=f(e,["contents"]);if(t!==void 0&&c!=null){let g=Fr(c);Array.isArray(g)&&(g=g.map(y=>Z1(y))),d(t,["contents"],g)}const u=f(e,["systemInstruction"]);t!==void 0&&u!=null&&d(t,["systemInstruction"],Z1(Gn(u)));const p=f(e,["tools"]);if(t!==void 0&&p!=null){let g=p;Array.isArray(g)&&(g=g.map(y=>Kw(y))),d(t,["tools"],g)}const h=f(e,["toolConfig"]);if(t!==void 0&&h!=null&&d(t,["toolConfig"],tA(h)),f(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function rA(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],Vy(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],nA(a,n)),n}function aA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Ua(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function iA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Ua(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function sA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);return t!==void 0&&a!=null&&d(t,["expireTime"],a),n}function oA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Ua(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],sA(a,n)),n}function lA(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);return t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),n}function cA(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],lA(n,t)),t}function uA(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function fA(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function dA(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function hA(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],uA(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],fA(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],dA(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function Q1(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>hA(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function mA(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const a=f(e,["parameters"]);a!=null&&d(t,["parameters"],a);const o=f(e,["parametersJsonSchema"]);o!=null&&d(t,["parametersJsonSchema"],o);const c=f(e,["response"]);c!=null&&d(t,["response"],c);const u=f(e,["responseJsonSchema"]);return u!=null&&d(t,["responseJsonSchema"],u),t}function pA(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function gA(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],pA(n)),t}function xA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function vA(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],xA(n)),t}function yA(){return{}}function TA(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function _A(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],TA(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const a=f(e,["googleServiceAccountConfig"]);a!=null&&d(t,["googleServiceAccountConfig"],a);const o=f(e,["httpBasicAuthConfig"]);o!=null&&d(t,["httpBasicAuthConfig"],o);const c=f(e,["oauthConfig"]);c!=null&&d(t,["oauthConfig"],c);const u=f(e,["oidcConfig"]);return u!=null&&d(t,["oidcConfig"],u),t}function EA(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],_A(n)),t}function SA(){return{}}function CA(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>mA(_))),d(t,["functionDeclarations"],y)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const a=f(e,["googleSearch"]);a!=null&&d(t,["googleSearch"],gA(a));const o=f(e,["googleSearchRetrieval"]);o!=null&&d(t,["googleSearchRetrieval"],vA(o)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],yA());const u=f(e,["googleMaps"]);u!=null&&d(t,["googleMaps"],EA(u)),f(e,["urlContext"])!=null&&d(t,["urlContext"],SA());const h=f(e,["codeExecution"]);h!=null&&d(t,["codeExecution"],h);const g=f(e,["computerUse"]);return g!=null&&d(t,["computerUse"],g),t}function wA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function AA(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function bA(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],AA(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function kA(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],wA(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],bA(r)),t}function NA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);t!==void 0&&a!=null&&d(t,["expireTime"],a);const o=f(e,["displayName"]);t!==void 0&&o!=null&&d(t,["displayName"],o);const c=f(e,["contents"]);if(t!==void 0&&c!=null){let y=Fr(c);Array.isArray(y)&&(y=y.map(_=>Q1(_))),d(t,["contents"],y)}const u=f(e,["systemInstruction"]);t!==void 0&&u!=null&&d(t,["systemInstruction"],Q1(Gn(u)));const p=f(e,["tools"]);if(t!==void 0&&p!=null){let y=p;Array.isArray(y)&&(y=y.map(_=>CA(_))),d(t,["tools"],y)}const h=f(e,["toolConfig"]);t!==void 0&&h!=null&&d(t,["toolConfig"],kA(h));const g=f(e,["kmsKeyName"]);return t!==void 0&&g!=null&&d(t,["encryption_spec","kmsKeyName"],g),n}function MA(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],Vy(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],NA(a,n)),n}function RA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Ua(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function DA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Ua(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function IA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);return t!==void 0&&a!=null&&d(t,["expireTime"],a),n}function FA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Ua(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],IA(a,n)),n}function LA(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);return t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),n}function OA(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],LA(n,t)),t}function Eu(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["model"]);a!=null&&d(t,["model"],a);const o=f(e,["createTime"]);o!=null&&d(t,["createTime"],o);const c=f(e,["updateTime"]);c!=null&&d(t,["updateTime"],c);const u=f(e,["expireTime"]);u!=null&&d(t,["expireTime"],u);const p=f(e,["usageMetadata"]);return p!=null&&d(t,["usageMetadata"],p),t}function PA(){return{}}function UA(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Eu(o))),d(t,["cachedContents"],a)}return t}function Su(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["model"]);a!=null&&d(t,["model"],a);const o=f(e,["createTime"]);o!=null&&d(t,["createTime"],o);const c=f(e,["updateTime"]);c!=null&&d(t,["updateTime"],c);const u=f(e,["expireTime"]);u!=null&&d(t,["expireTime"],u);const p=f(e,["usageMetadata"]);return p!=null&&d(t,["usageMetadata"],p),t}function BA(){return{}}function VA(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Su(o))),d(t,["cachedContents"],a)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GA extends is{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Xl(Qi.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=MA(this.apiClient,t);return u=Je("cachedContents",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>Su(g))}else{const h=rA(this.apiClient,t);return u=Je("cachedContents",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>Eu(g))}}async get(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=RA(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>Su(g))}else{const h=aA(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>Eu(g))}}async delete(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=DA(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(()=>{const g=BA(),y=new q1;return Object.assign(y,g),y})}else{const h=iA(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(()=>{const g=PA(),y=new q1;return Object.assign(y,g),y})}}async update(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=FA(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>Su(g))}else{const h=oA(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>Eu(g))}}async listInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=OA(t);return u=Je("cachedContents",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>{const y=VA(g),_=new Y1;return Object.assign(_,y),_})}else{const h=cA(t);return u=Je("cachedContents",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>{const y=UA(g),_=new Y1;return Object.assign(_,y),_})}}}function ev(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yt(e){return this instanceof Yt?(this.v=e,this):new Yt(e)}function no(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(E){return function(S){return Promise.resolve(S).then(E,y)}}function u(E,S){r[E]&&(a[E]=function(C){return new Promise(function(w,M){o.push([E,C,w,M])>1||p(E,C)})},S&&(a[E]=S(a[E])))}function p(E,S){try{h(r[E](S))}catch(C){_(o[0][3],C)}}function h(E){E.value instanceof Yt?Promise.resolve(E.value.v).then(g,y):_(o[0][2],E)}function g(E){p("next",E)}function y(E){p("throw",E)}function _(E,S){E(S),o.shift(),o.length&&p(o[0][0],o[0][1])}}function wl(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof ev=="function"?ev(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(c){return new Promise(function(u,p){c=e[o](c),a(u,p,c.done,c.value)})}}function a(o,c,u,p){Promise.resolve(p).then(function(h){o({value:h,done:u})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HA(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:nT(n)}function nT(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0||!t.thought&&t.text!==void 0&&t.text==="")return!1;return!0}function zA(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function tv(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const a=[];let o=!0;for(;r<n&&e[r].role==="model";)a.push(e[r]),o&&!nT(e[r])&&(o=!1),r++;o?t.push(...a):t.pop()}return t}class jA{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new qA(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class qA{constructor(t,n,r,a={},o=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),zA(o)}async sendMessage(t){var n;await this.sendPromise;const r=Gn(t.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,c,u;const p=await a,h=(c=(o=p.candidates)===null||o===void 0?void 0:o[0])===null||c===void 0?void 0:c.content,g=p.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let _=[];g!=null&&(_=(u=g.slice(y))!==null&&u!==void 0?u:[]);const E=h?[h]:[];this.recordHistory(r,E,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(t){var n;await this.sendPromise;const r=Gn(t.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,r)}getHistory(t=!1){const n=t?tv(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,a;return no(this,arguments,function*(){var c,u,p,h;const g=[];try{for(var y=!0,_=wl(t),E;E=yield Yt(_.next()),c=E.done,!c;y=!0){h=E.value,y=!1;const S=h;if(HA(S)){const C=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;C!==void 0&&g.push(C)}yield yield Yt(S)}}catch(S){u={error:S}}finally{try{!y&&!c&&(p=_.return)&&(yield Yt(p.call(_)))}finally{if(u)throw u.error}}this.recordHistory(n,g)})}recordHistory(t,n,r){let a=[];n.length>0&&n.every(o=>o.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...tv(r)):this.history.push(t),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ju extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Ju.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YA(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);return t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),n}function $A(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],YA(n,t)),t}function JA(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["message"]);r!=null&&d(t,["message"],r);const a=f(e,["code"]);return a!=null&&d(t,["code"],a),t}function XA(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["mimeType"]);a!=null&&d(t,["mimeType"],a);const o=f(e,["sizeBytes"]);o!=null&&d(t,["sizeBytes"],o);const c=f(e,["createTime"]);c!=null&&d(t,["createTime"],c);const u=f(e,["expirationTime"]);u!=null&&d(t,["expirationTime"],u);const p=f(e,["updateTime"]);p!=null&&d(t,["updateTime"],p);const h=f(e,["sha256Hash"]);h!=null&&d(t,["sha256Hash"],h);const g=f(e,["uri"]);g!=null&&d(t,["uri"],g);const y=f(e,["downloadUri"]);y!=null&&d(t,["downloadUri"],y);const _=f(e,["state"]);_!=null&&d(t,["state"],_);const E=f(e,["source"]);E!=null&&d(t,["source"],E);const S=f(e,["videoMetadata"]);S!=null&&d(t,["videoMetadata"],S);const C=f(e,["error"]);return C!=null&&d(t,["error"],JA(C)),t}function WA(e){const t={},n=f(e,["file"]);n!=null&&d(t,["file"],XA(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function KA(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","file"],$y(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function ZA(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","file"],$y(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function QA(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["message"]);r!=null&&d(t,["message"],r);const a=f(e,["code"]);return a!=null&&d(t,["code"],a),t}function Hd(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["mimeType"]);a!=null&&d(t,["mimeType"],a);const o=f(e,["sizeBytes"]);o!=null&&d(t,["sizeBytes"],o);const c=f(e,["createTime"]);c!=null&&d(t,["createTime"],c);const u=f(e,["expirationTime"]);u!=null&&d(t,["expirationTime"],u);const p=f(e,["updateTime"]);p!=null&&d(t,["updateTime"],p);const h=f(e,["sha256Hash"]);h!=null&&d(t,["sha256Hash"],h);const g=f(e,["uri"]);g!=null&&d(t,["uri"],g);const y=f(e,["downloadUri"]);y!=null&&d(t,["downloadUri"],y);const _=f(e,["state"]);_!=null&&d(t,["state"],_);const E=f(e,["source"]);E!=null&&d(t,["source"],E);const S=f(e,["videoMetadata"]);S!=null&&d(t,["videoMetadata"],S);const C=f(e,["error"]);return C!=null&&d(t,["error"],QA(C)),t}function eb(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Hd(o))),d(t,["files"],a)}return t}function tb(){return{}}function nb(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rb extends is{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Xl(Qi.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>Hd(n))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=$A(t);return o=Je("files",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const h=eb(p),g=new gC;return Object.assign(g,h),g})}}async createInternal(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=WA(t);return o=Je("upload/v1beta/files",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(()=>{const p=tb(),h=new xC;return Object.assign(h,p),h})}}async get(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=KA(t);return o=Je("files/{file}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>Hd(p))}}async delete(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ZA(t);return o=Je("files/{file}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(()=>{const p=nb(),h=new vC;return Object.assign(h,p),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ab(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function ib(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function rT(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],ab(n)),t}function sb(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],ib(n)),t}function ob(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],rT(r)),t}function lb(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>ob(a))),d(t,["speakerVoiceConfigs"],r)}return t}function cb(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],rT(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],lb(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function ub(e){const t={},n=f(e,["voiceConfig"]);if(n!=null&&d(t,["voiceConfig"],sb(n)),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function fb(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function db(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function hb(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function mb(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function pb(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function gb(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function xb(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],fb(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],hb(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],pb(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function vb(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],db(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],mb(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],gb(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function yb(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>xb(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Tb(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>vb(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function _b(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const o=f(e,["parameters"]);o!=null&&d(t,["parameters"],o);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function Eb(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const a=f(e,["parameters"]);a!=null&&d(t,["parameters"],a);const o=f(e,["parametersJsonSchema"]);o!=null&&d(t,["parametersJsonSchema"],o);const c=f(e,["response"]);c!=null&&d(t,["response"],c);const u=f(e,["responseJsonSchema"]);return u!=null&&d(t,["responseJsonSchema"],u),t}function Sb(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function Cb(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function wb(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Sb(n)),t}function Ab(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Cb(n)),t}function bb(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function kb(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Nb(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],bb(n)),t}function Mb(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],kb(n)),t}function Rb(){return{}}function Db(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function Ib(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],Db(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const a=f(e,["googleServiceAccountConfig"]);a!=null&&d(t,["googleServiceAccountConfig"],a);const o=f(e,["httpBasicAuthConfig"]);o!=null&&d(t,["httpBasicAuthConfig"],o);const c=f(e,["oauthConfig"]);c!=null&&d(t,["oauthConfig"],c);const u=f(e,["oidcConfig"]);return u!=null&&d(t,["oidcConfig"],u),t}function Fb(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],Ib(n)),t}function Lb(){return{}}function Ob(){return{}}function Pb(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(h=>_b(h))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],wb(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],Nb(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],Lb());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function Ub(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>Eb(_))),d(t,["functionDeclarations"],y)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const a=f(e,["googleSearch"]);a!=null&&d(t,["googleSearch"],Ab(a));const o=f(e,["googleSearchRetrieval"]);o!=null&&d(t,["googleSearchRetrieval"],Mb(o)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],Rb());const u=f(e,["googleMaps"]);u!=null&&d(t,["googleMaps"],Fb(u)),f(e,["urlContext"])!=null&&d(t,["urlContext"],Ob());const h=f(e,["codeExecution"]);h!=null&&d(t,["codeExecution"],h);const g=f(e,["computerUse"]);return g!=null&&d(t,["computerUse"],g),t}function Bb(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Vb(e){const t={},n=f(e,["handle"]);n!=null&&d(t,["handle"],n);const r=f(e,["transparent"]);return r!=null&&d(t,["transparent"],r),t}function nv(){return{}}function rv(){return{}}function Gb(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const a=f(e,["endOfSpeechSensitivity"]);a!=null&&d(t,["endOfSpeechSensitivity"],a);const o=f(e,["prefixPaddingMs"]);o!=null&&d(t,["prefixPaddingMs"],o);const c=f(e,["silenceDurationMs"]);return c!=null&&d(t,["silenceDurationMs"],c),t}function Hb(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const a=f(e,["endOfSpeechSensitivity"]);a!=null&&d(t,["endOfSpeechSensitivity"],a);const o=f(e,["prefixPaddingMs"]);o!=null&&d(t,["prefixPaddingMs"],o);const c=f(e,["silenceDurationMs"]);return c!=null&&d(t,["silenceDurationMs"],c),t}function zb(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],Gb(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const a=f(e,["turnCoverage"]);return a!=null&&d(t,["turnCoverage"],a),t}function jb(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],Hb(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const a=f(e,["turnCoverage"]);return a!=null&&d(t,["turnCoverage"],a),t}function qb(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function Yb(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function $b(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],qb(r)),t}function Jb(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],Yb(r)),t}function Xb(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function Wb(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function Kb(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const a=f(e,["responseModalities"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","responseModalities"],a);const o=f(e,["temperature"]);t!==void 0&&o!=null&&d(t,["setup","generationConfig","temperature"],o);const c=f(e,["topP"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","topP"],c);const u=f(e,["topK"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","topK"],u);const p=f(e,["maxOutputTokens"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","maxOutputTokens"],p);const h=f(e,["mediaResolution"]);t!==void 0&&h!=null&&d(t,["setup","generationConfig","mediaResolution"],h);const g=f(e,["seed"]);t!==void 0&&g!=null&&d(t,["setup","generationConfig","seed"],g);const y=f(e,["speechConfig"]);t!==void 0&&y!=null&&d(t,["setup","generationConfig","speechConfig"],cb(dh(y)));const _=f(e,["enableAffectiveDialog"]);t!==void 0&&_!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],_);const E=f(e,["systemInstruction"]);t!==void 0&&E!=null&&d(t,["setup","systemInstruction"],yb(Gn(E)));const S=f(e,["tools"]);if(t!==void 0&&S!=null){let B=xo(S);Array.isArray(B)&&(B=B.map(X=>Pb(go(X)))),d(t,["setup","tools"],B)}const C=f(e,["sessionResumption"]);t!==void 0&&C!=null&&d(t,["setup","sessionResumption"],Bb(C));const w=f(e,["inputAudioTranscription"]);t!==void 0&&w!=null&&d(t,["setup","inputAudioTranscription"],nv());const M=f(e,["outputAudioTranscription"]);t!==void 0&&M!=null&&d(t,["setup","outputAudioTranscription"],nv());const k=f(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&d(t,["setup","realtimeInputConfig"],zb(k));const b=f(e,["contextWindowCompression"]);t!==void 0&&b!=null&&d(t,["setup","contextWindowCompression"],$b(b));const U=f(e,["proactivity"]);return t!==void 0&&U!=null&&d(t,["setup","proactivity"],Xb(U)),n}function Zb(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const a=f(e,["responseModalities"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","responseModalities"],a);const o=f(e,["temperature"]);t!==void 0&&o!=null&&d(t,["setup","generationConfig","temperature"],o);const c=f(e,["topP"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","topP"],c);const u=f(e,["topK"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","topK"],u);const p=f(e,["maxOutputTokens"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","maxOutputTokens"],p);const h=f(e,["mediaResolution"]);t!==void 0&&h!=null&&d(t,["setup","generationConfig","mediaResolution"],h);const g=f(e,["seed"]);t!==void 0&&g!=null&&d(t,["setup","generationConfig","seed"],g);const y=f(e,["speechConfig"]);t!==void 0&&y!=null&&d(t,["setup","generationConfig","speechConfig"],ub(dh(y)));const _=f(e,["enableAffectiveDialog"]);t!==void 0&&_!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],_);const E=f(e,["systemInstruction"]);t!==void 0&&E!=null&&d(t,["setup","systemInstruction"],Tb(Gn(E)));const S=f(e,["tools"]);if(t!==void 0&&S!=null){let B=xo(S);Array.isArray(B)&&(B=B.map(X=>Ub(go(X)))),d(t,["setup","tools"],B)}const C=f(e,["sessionResumption"]);t!==void 0&&C!=null&&d(t,["setup","sessionResumption"],Vb(C));const w=f(e,["inputAudioTranscription"]);t!==void 0&&w!=null&&d(t,["setup","inputAudioTranscription"],rv());const M=f(e,["outputAudioTranscription"]);t!==void 0&&M!=null&&d(t,["setup","outputAudioTranscription"],rv());const k=f(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&d(t,["setup","realtimeInputConfig"],jb(k));const b=f(e,["contextWindowCompression"]);t!==void 0&&b!=null&&d(t,["setup","contextWindowCompression"],Jb(b));const U=f(e,["proactivity"]);return t!==void 0&&U!=null&&d(t,["setup","proactivity"],Wb(U)),n}function Qb(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],It(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],Kb(a,n)),n}function ek(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],It(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],Zb(a,n)),n}function tk(){return{}}function nk(){return{}}function rk(){return{}}function ak(){return{}}function ik(e){const t={},n=f(e,["media"]);n!=null&&d(t,["mediaChunks"],Gy(n));const r=f(e,["audio"]);r!=null&&d(t,["audio"],zy(r));const a=f(e,["audioStreamEnd"]);a!=null&&d(t,["audioStreamEnd"],a);const o=f(e,["video"]);o!=null&&d(t,["video"],Hy(o));const c=f(e,["text"]);return c!=null&&d(t,["text"],c),f(e,["activityStart"])!=null&&d(t,["activityStart"],tk()),f(e,["activityEnd"])!=null&&d(t,["activityEnd"],rk()),t}function sk(e){const t={},n=f(e,["media"]);n!=null&&d(t,["mediaChunks"],Gy(n));const r=f(e,["audio"]);r!=null&&d(t,["audio"],zy(r));const a=f(e,["audioStreamEnd"]);a!=null&&d(t,["audioStreamEnd"],a);const o=f(e,["video"]);o!=null&&d(t,["video"],Hy(o));const c=f(e,["text"]);return c!=null&&d(t,["text"],c),f(e,["activityStart"])!=null&&d(t,["activityStart"],nk()),f(e,["activityEnd"])!=null&&d(t,["activityEnd"],ak()),t}function aT(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["weight"]);return r!=null&&d(t,["weight"],r),t}function ok(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>aT(a))),d(t,["weightedPrompts"],r)}return t}function iT(e){const t={},n=f(e,["temperature"]);n!=null&&d(t,["temperature"],n);const r=f(e,["topK"]);r!=null&&d(t,["topK"],r);const a=f(e,["seed"]);a!=null&&d(t,["seed"],a);const o=f(e,["guidance"]);o!=null&&d(t,["guidance"],o);const c=f(e,["bpm"]);c!=null&&d(t,["bpm"],c);const u=f(e,["density"]);u!=null&&d(t,["density"],u);const p=f(e,["brightness"]);p!=null&&d(t,["brightness"],p);const h=f(e,["scale"]);h!=null&&d(t,["scale"],h);const g=f(e,["muteBass"]);g!=null&&d(t,["muteBass"],g);const y=f(e,["muteDrums"]);y!=null&&d(t,["muteDrums"],y);const _=f(e,["onlyBassAndDrums"]);return _!=null&&d(t,["onlyBassAndDrums"],_),t}function lk(e){const t={},n=f(e,["musicGenerationConfig"]);return n!=null&&d(t,["musicGenerationConfig"],iT(n)),t}function sT(e){const t={},n=f(e,["model"]);return n!=null&&d(t,["model"],n),t}function oT(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>aT(a))),d(t,["weightedPrompts"],r)}return t}function zd(e){const t={},n=f(e,["setup"]);n!=null&&d(t,["setup"],sT(n));const r=f(e,["clientContent"]);r!=null&&d(t,["clientContent"],oT(r));const a=f(e,["musicGenerationConfig"]);a!=null&&d(t,["musicGenerationConfig"],iT(a));const o=f(e,["playbackControl"]);return o!=null&&d(t,["playbackControl"],o),t}function ck(){return{}}function uk(e){const t={},n=f(e,["sessionId"]);return n!=null&&d(t,["sessionId"],n),t}function fk(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function dk(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function hk(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function mk(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function pk(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function gk(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function xk(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],fk(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],hk(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],pk(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function vk(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],dk(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],mk(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],gk(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function yk(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>xk(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Tk(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>vk(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function av(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["finished"]);return r!=null&&d(t,["finished"],r),t}function iv(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["finished"]);return r!=null&&d(t,["finished"],r),t}function _k(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function Ek(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>_k(a))),d(t,["urlMetadata"],r)}return t}function Sk(e){const t={},n=f(e,["modelTurn"]);n!=null&&d(t,["modelTurn"],yk(n));const r=f(e,["turnComplete"]);r!=null&&d(t,["turnComplete"],r);const a=f(e,["interrupted"]);a!=null&&d(t,["interrupted"],a);const o=f(e,["groundingMetadata"]);o!=null&&d(t,["groundingMetadata"],o);const c=f(e,["generationComplete"]);c!=null&&d(t,["generationComplete"],c);const u=f(e,["inputTranscription"]);u!=null&&d(t,["inputTranscription"],av(u));const p=f(e,["outputTranscription"]);p!=null&&d(t,["outputTranscription"],av(p));const h=f(e,["urlContextMetadata"]);return h!=null&&d(t,["urlContextMetadata"],Ek(h)),t}function Ck(e){const t={},n=f(e,["modelTurn"]);n!=null&&d(t,["modelTurn"],Tk(n));const r=f(e,["turnComplete"]);r!=null&&d(t,["turnComplete"],r);const a=f(e,["interrupted"]);a!=null&&d(t,["interrupted"],a);const o=f(e,["groundingMetadata"]);o!=null&&d(t,["groundingMetadata"],o);const c=f(e,["generationComplete"]);c!=null&&d(t,["generationComplete"],c);const u=f(e,["inputTranscription"]);u!=null&&d(t,["inputTranscription"],iv(u));const p=f(e,["outputTranscription"]);return p!=null&&d(t,["outputTranscription"],iv(p)),t}function wk(e){const t={},n=f(e,["id"]);n!=null&&d(t,["id"],n);const r=f(e,["args"]);r!=null&&d(t,["args"],r);const a=f(e,["name"]);return a!=null&&d(t,["name"],a),t}function Ak(e){const t={},n=f(e,["args"]);n!=null&&d(t,["args"],n);const r=f(e,["name"]);return r!=null&&d(t,["name"],r),t}function bk(e){const t={},n=f(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>wk(a))),d(t,["functionCalls"],r)}return t}function kk(e){const t={},n=f(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Ak(a))),d(t,["functionCalls"],r)}return t}function Nk(e){const t={},n=f(e,["ids"]);return n!=null&&d(t,["ids"],n),t}function Mk(e){const t={},n=f(e,["ids"]);return n!=null&&d(t,["ids"],n),t}function uu(e){const t={},n=f(e,["modality"]);n!=null&&d(t,["modality"],n);const r=f(e,["tokenCount"]);return r!=null&&d(t,["tokenCount"],r),t}function fu(e){const t={},n=f(e,["modality"]);n!=null&&d(t,["modality"],n);const r=f(e,["tokenCount"]);return r!=null&&d(t,["tokenCount"],r),t}function Rk(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&d(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&d(t,["cachedContentTokenCount"],r);const a=f(e,["responseTokenCount"]);a!=null&&d(t,["responseTokenCount"],a);const o=f(e,["toolUsePromptTokenCount"]);o!=null&&d(t,["toolUsePromptTokenCount"],o);const c=f(e,["thoughtsTokenCount"]);c!=null&&d(t,["thoughtsTokenCount"],c);const u=f(e,["totalTokenCount"]);u!=null&&d(t,["totalTokenCount"],u);const p=f(e,["promptTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(E=>uu(E))),d(t,["promptTokensDetails"],_)}const h=f(e,["cacheTokensDetails"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(E=>uu(E))),d(t,["cacheTokensDetails"],_)}const g=f(e,["responseTokensDetails"]);if(g!=null){let _=g;Array.isArray(_)&&(_=_.map(E=>uu(E))),d(t,["responseTokensDetails"],_)}const y=f(e,["toolUsePromptTokensDetails"]);if(y!=null){let _=y;Array.isArray(_)&&(_=_.map(E=>uu(E))),d(t,["toolUsePromptTokensDetails"],_)}return t}function Dk(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&d(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&d(t,["cachedContentTokenCount"],r);const a=f(e,["candidatesTokenCount"]);a!=null&&d(t,["responseTokenCount"],a);const o=f(e,["toolUsePromptTokenCount"]);o!=null&&d(t,["toolUsePromptTokenCount"],o);const c=f(e,["thoughtsTokenCount"]);c!=null&&d(t,["thoughtsTokenCount"],c);const u=f(e,["totalTokenCount"]);u!=null&&d(t,["totalTokenCount"],u);const p=f(e,["promptTokensDetails"]);if(p!=null){let E=p;Array.isArray(E)&&(E=E.map(S=>fu(S))),d(t,["promptTokensDetails"],E)}const h=f(e,["cacheTokensDetails"]);if(h!=null){let E=h;Array.isArray(E)&&(E=E.map(S=>fu(S))),d(t,["cacheTokensDetails"],E)}const g=f(e,["candidatesTokensDetails"]);if(g!=null){let E=g;Array.isArray(E)&&(E=E.map(S=>fu(S))),d(t,["responseTokensDetails"],E)}const y=f(e,["toolUsePromptTokensDetails"]);if(y!=null){let E=y;Array.isArray(E)&&(E=E.map(S=>fu(S))),d(t,["toolUsePromptTokensDetails"],E)}const _=f(e,["trafficType"]);return _!=null&&d(t,["trafficType"],_),t}function Ik(e){const t={},n=f(e,["timeLeft"]);return n!=null&&d(t,["timeLeft"],n),t}function Fk(e){const t={},n=f(e,["timeLeft"]);return n!=null&&d(t,["timeLeft"],n),t}function Lk(e){const t={},n=f(e,["newHandle"]);n!=null&&d(t,["newHandle"],n);const r=f(e,["resumable"]);r!=null&&d(t,["resumable"],r);const a=f(e,["lastConsumedClientMessageIndex"]);return a!=null&&d(t,["lastConsumedClientMessageIndex"],a),t}function Ok(e){const t={},n=f(e,["newHandle"]);n!=null&&d(t,["newHandle"],n);const r=f(e,["resumable"]);r!=null&&d(t,["resumable"],r);const a=f(e,["lastConsumedClientMessageIndex"]);return a!=null&&d(t,["lastConsumedClientMessageIndex"],a),t}function Pk(e){const t={};f(e,["setupComplete"])!=null&&d(t,["setupComplete"],ck());const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],Sk(r));const a=f(e,["toolCall"]);a!=null&&d(t,["toolCall"],bk(a));const o=f(e,["toolCallCancellation"]);o!=null&&d(t,["toolCallCancellation"],Nk(o));const c=f(e,["usageMetadata"]);c!=null&&d(t,["usageMetadata"],Rk(c));const u=f(e,["goAway"]);u!=null&&d(t,["goAway"],Ik(u));const p=f(e,["sessionResumptionUpdate"]);return p!=null&&d(t,["sessionResumptionUpdate"],Lk(p)),t}function Uk(e){const t={},n=f(e,["setupComplete"]);n!=null&&d(t,["setupComplete"],uk(n));const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],Ck(r));const a=f(e,["toolCall"]);a!=null&&d(t,["toolCall"],kk(a));const o=f(e,["toolCallCancellation"]);o!=null&&d(t,["toolCallCancellation"],Mk(o));const c=f(e,["usageMetadata"]);c!=null&&d(t,["usageMetadata"],Dk(c));const u=f(e,["goAway"]);u!=null&&d(t,["goAway"],Fk(u));const p=f(e,["sessionResumptionUpdate"]);return p!=null&&d(t,["sessionResumptionUpdate"],Ok(p)),t}function Bk(){return{}}function Vk(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["weight"]);return r!=null&&d(t,["weight"],r),t}function Gk(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Vk(a))),d(t,["weightedPrompts"],r)}return t}function Hk(e){const t={},n=f(e,["temperature"]);n!=null&&d(t,["temperature"],n);const r=f(e,["topK"]);r!=null&&d(t,["topK"],r);const a=f(e,["seed"]);a!=null&&d(t,["seed"],a);const o=f(e,["guidance"]);o!=null&&d(t,["guidance"],o);const c=f(e,["bpm"]);c!=null&&d(t,["bpm"],c);const u=f(e,["density"]);u!=null&&d(t,["density"],u);const p=f(e,["brightness"]);p!=null&&d(t,["brightness"],p);const h=f(e,["scale"]);h!=null&&d(t,["scale"],h);const g=f(e,["muteBass"]);g!=null&&d(t,["muteBass"],g);const y=f(e,["muteDrums"]);y!=null&&d(t,["muteDrums"],y);const _=f(e,["onlyBassAndDrums"]);return _!=null&&d(t,["onlyBassAndDrums"],_),t}function zk(e){const t={},n=f(e,["clientContent"]);n!=null&&d(t,["clientContent"],Gk(n));const r=f(e,["musicGenerationConfig"]);return r!=null&&d(t,["musicGenerationConfig"],Hk(r)),t}function jk(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);r!=null&&d(t,["mimeType"],r);const a=f(e,["sourceMetadata"]);return a!=null&&d(t,["sourceMetadata"],zk(a)),t}function qk(e){const t={},n=f(e,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>jk(a))),d(t,["audioChunks"],r)}return t}function Yk(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["filteredReason"]);return r!=null&&d(t,["filteredReason"],r),t}function $k(e){const t={};f(e,["setupComplete"])!=null&&d(t,["setupComplete"],Bk());const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],qk(r));const a=f(e,["filteredPrompt"]);return a!=null&&d(t,["filteredPrompt"],Yk(a)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jk(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function Xk(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Wk(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Kk(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Jk(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],Xk(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],Wk(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function Xu(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>Kk(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Zk(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const o=f(e,["enum"]);o!=null&&d(t,["enum"],o);const c=f(e,["example"]);c!=null&&d(t,["example"],c);const u=f(e,["format"]);u!=null&&d(t,["format"],u);const p=f(e,["items"]);p!=null&&d(t,["items"],p);const h=f(e,["maxItems"]);h!=null&&d(t,["maxItems"],h);const g=f(e,["maxLength"]);g!=null&&d(t,["maxLength"],g);const y=f(e,["maxProperties"]);y!=null&&d(t,["maxProperties"],y);const _=f(e,["maximum"]);_!=null&&d(t,["maximum"],_);const E=f(e,["minItems"]);E!=null&&d(t,["minItems"],E);const S=f(e,["minLength"]);S!=null&&d(t,["minLength"],S);const C=f(e,["minProperties"]);C!=null&&d(t,["minProperties"],C);const w=f(e,["minimum"]);w!=null&&d(t,["minimum"],w);const M=f(e,["nullable"]);M!=null&&d(t,["nullable"],M);const k=f(e,["pattern"]);k!=null&&d(t,["pattern"],k);const b=f(e,["properties"]);b!=null&&d(t,["properties"],b);const U=f(e,["propertyOrdering"]);U!=null&&d(t,["propertyOrdering"],U);const B=f(e,["required"]);B!=null&&d(t,["required"],B);const X=f(e,["title"]);X!=null&&d(t,["title"],X);const F=f(e,["type"]);return F!=null&&d(t,["type"],F),t}function Qk(e){const t={};if(f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(e,["category"]);n!=null&&d(t,["category"],n);const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function e4(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const o=f(e,["parameters"]);o!=null&&d(t,["parameters"],o);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function t4(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function n4(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],t4(n)),t}function r4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function a4(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],r4(n)),t}function i4(){return{}}function s4(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(h=>e4(h))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],n4(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],a4(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],i4());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function o4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function l4(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function c4(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],l4(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function u4(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],o4(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],c4(r)),t}function f4(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function lT(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],f4(n)),t}function d4(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],lT(r)),t}function h4(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>d4(a))),d(t,["speakerVoiceConfigs"],r)}return t}function m4(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],lT(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],h4(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function p4(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function g4(e,t,n){const r={},a=f(t,["systemInstruction"]);n!==void 0&&a!=null&&d(n,["systemInstruction"],Xu(Gn(a)));const o=f(t,["temperature"]);o!=null&&d(r,["temperature"],o);const c=f(t,["topP"]);c!=null&&d(r,["topP"],c);const u=f(t,["topK"]);u!=null&&d(r,["topK"],u);const p=f(t,["candidateCount"]);p!=null&&d(r,["candidateCount"],p);const h=f(t,["maxOutputTokens"]);h!=null&&d(r,["maxOutputTokens"],h);const g=f(t,["stopSequences"]);g!=null&&d(r,["stopSequences"],g);const y=f(t,["responseLogprobs"]);y!=null&&d(r,["responseLogprobs"],y);const _=f(t,["logprobs"]);_!=null&&d(r,["logprobs"],_);const E=f(t,["presencePenalty"]);E!=null&&d(r,["presencePenalty"],E);const S=f(t,["frequencyPenalty"]);S!=null&&d(r,["frequencyPenalty"],S);const C=f(t,["seed"]);C!=null&&d(r,["seed"],C);const w=f(t,["responseMimeType"]);w!=null&&d(r,["responseMimeType"],w);const M=f(t,["responseSchema"]);M!=null&&d(r,["responseSchema"],Zk(Pl(M)));const k=f(t,["responseJsonSchema"]);if(k!=null&&d(r,["responseJsonSchema"],k),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=f(t,["safetySettings"]);if(n!==void 0&&b!=null){let te=b;Array.isArray(te)&&(te=te.map(ee=>Qk(ee))),d(n,["safetySettings"],te)}const U=f(t,["tools"]);if(n!==void 0&&U!=null){let te=xo(U);Array.isArray(te)&&(te=te.map(ee=>s4(go(ee)))),d(n,["tools"],te)}const B=f(t,["toolConfig"]);if(n!==void 0&&B!=null&&d(n,["toolConfig"],u4(B)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const X=f(t,["cachedContent"]);n!==void 0&&X!=null&&d(n,["cachedContent"],Ua(e,X));const F=f(t,["responseModalities"]);F!=null&&d(r,["responseModalities"],F);const Y=f(t,["mediaResolution"]);Y!=null&&d(r,["mediaResolution"],Y);const L=f(t,["speechConfig"]);if(L!=null&&d(r,["speechConfig"],m4(fh(L))),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=f(t,["thinkingConfig"]);return Q!=null&&d(r,["thinkingConfig"],p4(Q)),r}function sv(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["contents"]);if(a!=null){let c=Fr(a);Array.isArray(c)&&(c=c.map(u=>Xu(u))),d(n,["contents"],c)}const o=f(t,["config"]);return o!=null&&d(n,["generationConfig"],g4(e,o,n)),n}function x4(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["requests[]","taskType"],r);const a=f(e,["title"]);t!==void 0&&a!=null&&d(t,["requests[]","title"],a);const o=f(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&d(t,["requests[]","outputDimensionality"],o),f(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function v4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["contents"]);a!=null&&d(n,["requests[]","content"],qy(e,a));const o=f(t,["config"]);o!=null&&d(n,["config"],x4(o,n));const c=f(t,["model"]);return c!==void 0&&d(n,["requests[]","model"],It(e,c)),n}function y4(e,t){const n={};if(f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=f(e,["numberOfImages"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const a=f(e,["aspectRatio"]);t!==void 0&&a!=null&&d(t,["parameters","aspectRatio"],a);const o=f(e,["guidanceScale"]);if(t!==void 0&&o!=null&&d(t,["parameters","guidanceScale"],o),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=f(e,["safetyFilterLevel"]);t!==void 0&&c!=null&&d(t,["parameters","safetySetting"],c);const u=f(e,["personGeneration"]);t!==void 0&&u!=null&&d(t,["parameters","personGeneration"],u);const p=f(e,["includeSafetyAttributes"]);t!==void 0&&p!=null&&d(t,["parameters","includeSafetyAttributes"],p);const h=f(e,["includeRaiReason"]);t!==void 0&&h!=null&&d(t,["parameters","includeRaiReason"],h);const g=f(e,["language"]);t!==void 0&&g!=null&&d(t,["parameters","language"],g);const y=f(e,["outputMimeType"]);t!==void 0&&y!=null&&d(t,["parameters","outputOptions","mimeType"],y);const _=f(e,["outputCompressionQuality"]);if(t!==void 0&&_!=null&&d(t,["parameters","outputOptions","compressionQuality"],_),f(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function T4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const o=f(t,["config"]);return o!=null&&d(n,["config"],y4(o,n)),n}function _4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],It(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function E4(e,t,n){const r={},a=f(t,["pageSize"]);n!==void 0&&a!=null&&d(n,["_query","pageSize"],a);const o=f(t,["pageToken"]);n!==void 0&&o!=null&&d(n,["_query","pageToken"],o);const c=f(t,["filter"]);n!==void 0&&c!=null&&d(n,["_query","filter"],c);const u=f(t,["queryBase"]);return n!==void 0&&u!=null&&d(n,["_url","models_url"],Jy(e,u)),r}function S4(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],E4(e,r,n)),n}function C4(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);t!==void 0&&a!=null&&d(t,["description"],a);const o=f(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&d(t,["defaultCheckpointId"],o),n}function w4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],It(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],C4(a,n)),n}function A4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],It(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function b4(e){const t={};if(f(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function k4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["contents"]);if(a!=null){let c=Fr(a);Array.isArray(c)&&(c=c.map(u=>Xu(u))),d(n,["contents"],c)}const o=f(t,["config"]);return o!=null&&d(n,["config"],b4(o)),n}function N4(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=f(e,["imageBytes"]);n!=null&&d(t,["bytesBase64Encoded"],Ba(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function M4(e,t){const n={},r=f(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r),f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=f(e,["durationSeconds"]);if(t!==void 0&&a!=null&&d(t,["parameters","durationSeconds"],a),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=f(e,["aspectRatio"]);if(t!==void 0&&o!=null&&d(t,["parameters","aspectRatio"],o),f(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const c=f(e,["personGeneration"]);if(t!==void 0&&c!=null&&d(t,["parameters","personGeneration"],c),f(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=f(e,["negativePrompt"]);t!==void 0&&u!=null&&d(t,["parameters","negativePrompt"],u);const p=f(e,["enhancePrompt"]);if(t!==void 0&&p!=null&&d(t,["parameters","enhancePrompt"],p),f(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(f(e,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(f(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function R4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const o=f(t,["image"]);if(o!=null&&d(n,["instances[0]","image"],N4(o)),f(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const c=f(t,["config"]);return c!=null&&d(n,["config"],M4(c,n)),n}function D4(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function I4(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function F4(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function L4(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],D4(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],I4(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],F4(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function yo(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>L4(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function O4(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const o=f(e,["enum"]);o!=null&&d(t,["enum"],o);const c=f(e,["example"]);c!=null&&d(t,["example"],c);const u=f(e,["format"]);u!=null&&d(t,["format"],u);const p=f(e,["items"]);p!=null&&d(t,["items"],p);const h=f(e,["maxItems"]);h!=null&&d(t,["maxItems"],h);const g=f(e,["maxLength"]);g!=null&&d(t,["maxLength"],g);const y=f(e,["maxProperties"]);y!=null&&d(t,["maxProperties"],y);const _=f(e,["maximum"]);_!=null&&d(t,["maximum"],_);const E=f(e,["minItems"]);E!=null&&d(t,["minItems"],E);const S=f(e,["minLength"]);S!=null&&d(t,["minLength"],S);const C=f(e,["minProperties"]);C!=null&&d(t,["minProperties"],C);const w=f(e,["minimum"]);w!=null&&d(t,["minimum"],w);const M=f(e,["nullable"]);M!=null&&d(t,["nullable"],M);const k=f(e,["pattern"]);k!=null&&d(t,["pattern"],k);const b=f(e,["properties"]);b!=null&&d(t,["properties"],b);const U=f(e,["propertyOrdering"]);U!=null&&d(t,["propertyOrdering"],U);const B=f(e,["required"]);B!=null&&d(t,["required"],B);const X=f(e,["title"]);X!=null&&d(t,["title"],X);const F=f(e,["type"]);return F!=null&&d(t,["type"],F),t}function P4(e){const t={},n=f(e,["featureSelectionPreference"]);return n!=null&&d(t,["featureSelectionPreference"],n),t}function U4(e){const t={},n=f(e,["method"]);n!=null&&d(t,["method"],n);const r=f(e,["category"]);r!=null&&d(t,["category"],r);const a=f(e,["threshold"]);return a!=null&&d(t,["threshold"],a),t}function B4(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const a=f(e,["parameters"]);a!=null&&d(t,["parameters"],a);const o=f(e,["parametersJsonSchema"]);o!=null&&d(t,["parametersJsonSchema"],o);const c=f(e,["response"]);c!=null&&d(t,["response"],c);const u=f(e,["responseJsonSchema"]);return u!=null&&d(t,["responseJsonSchema"],u),t}function V4(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function G4(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],V4(n)),t}function H4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function z4(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],H4(n)),t}function j4(){return{}}function q4(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function Y4(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],q4(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const a=f(e,["googleServiceAccountConfig"]);a!=null&&d(t,["googleServiceAccountConfig"],a);const o=f(e,["httpBasicAuthConfig"]);o!=null&&d(t,["httpBasicAuthConfig"],o);const c=f(e,["oauthConfig"]);c!=null&&d(t,["oauthConfig"],c);const u=f(e,["oidcConfig"]);return u!=null&&d(t,["oidcConfig"],u),t}function $4(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],Y4(n)),t}function J4(){return{}}function cT(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>B4(_))),d(t,["functionDeclarations"],y)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const a=f(e,["googleSearch"]);a!=null&&d(t,["googleSearch"],G4(a));const o=f(e,["googleSearchRetrieval"]);o!=null&&d(t,["googleSearchRetrieval"],z4(o)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],j4());const u=f(e,["googleMaps"]);u!=null&&d(t,["googleMaps"],$4(u)),f(e,["urlContext"])!=null&&d(t,["urlContext"],J4());const h=f(e,["codeExecution"]);h!=null&&d(t,["codeExecution"],h);const g=f(e,["computerUse"]);return g!=null&&d(t,["computerUse"],g),t}function X4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function W4(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function K4(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],W4(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function Z4(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],X4(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],K4(r)),t}function Q4(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function eN(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],Q4(n)),t}function tN(e){const t={},n=f(e,["voiceConfig"]);if(n!=null&&d(t,["voiceConfig"],eN(n)),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function nN(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function rN(e,t,n){const r={},a=f(t,["systemInstruction"]);n!==void 0&&a!=null&&d(n,["systemInstruction"],yo(Gn(a)));const o=f(t,["temperature"]);o!=null&&d(r,["temperature"],o);const c=f(t,["topP"]);c!=null&&d(r,["topP"],c);const u=f(t,["topK"]);u!=null&&d(r,["topK"],u);const p=f(t,["candidateCount"]);p!=null&&d(r,["candidateCount"],p);const h=f(t,["maxOutputTokens"]);h!=null&&d(r,["maxOutputTokens"],h);const g=f(t,["stopSequences"]);g!=null&&d(r,["stopSequences"],g);const y=f(t,["responseLogprobs"]);y!=null&&d(r,["responseLogprobs"],y);const _=f(t,["logprobs"]);_!=null&&d(r,["logprobs"],_);const E=f(t,["presencePenalty"]);E!=null&&d(r,["presencePenalty"],E);const S=f(t,["frequencyPenalty"]);S!=null&&d(r,["frequencyPenalty"],S);const C=f(t,["seed"]);C!=null&&d(r,["seed"],C);const w=f(t,["responseMimeType"]);w!=null&&d(r,["responseMimeType"],w);const M=f(t,["responseSchema"]);M!=null&&d(r,["responseSchema"],O4(Pl(M)));const k=f(t,["responseJsonSchema"]);k!=null&&d(r,["responseJsonSchema"],k);const b=f(t,["routingConfig"]);b!=null&&d(r,["routingConfig"],b);const U=f(t,["modelSelectionConfig"]);U!=null&&d(r,["modelConfig"],P4(U));const B=f(t,["safetySettings"]);if(n!==void 0&&B!=null){let Te=B;Array.isArray(Te)&&(Te=Te.map(re=>U4(re))),d(n,["safetySettings"],Te)}const X=f(t,["tools"]);if(n!==void 0&&X!=null){let Te=xo(X);Array.isArray(Te)&&(Te=Te.map(re=>cT(go(re)))),d(n,["tools"],Te)}const F=f(t,["toolConfig"]);n!==void 0&&F!=null&&d(n,["toolConfig"],Z4(F));const Y=f(t,["labels"]);n!==void 0&&Y!=null&&d(n,["labels"],Y);const L=f(t,["cachedContent"]);n!==void 0&&L!=null&&d(n,["cachedContent"],Ua(e,L));const Q=f(t,["responseModalities"]);Q!=null&&d(r,["responseModalities"],Q);const te=f(t,["mediaResolution"]);te!=null&&d(r,["mediaResolution"],te);const ee=f(t,["speechConfig"]);ee!=null&&d(r,["speechConfig"],tN(fh(ee)));const _e=f(t,["audioTimestamp"]);_e!=null&&d(r,["audioTimestamp"],_e);const De=f(t,["thinkingConfig"]);return De!=null&&d(r,["thinkingConfig"],nN(De)),r}function ov(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["contents"]);if(a!=null){let c=Fr(a);Array.isArray(c)&&(c=c.map(u=>yo(u))),d(n,["contents"],c)}const o=f(t,["config"]);return o!=null&&d(n,["generationConfig"],rN(e,o,n)),n}function aN(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["instances[]","task_type"],r);const a=f(e,["title"]);t!==void 0&&a!=null&&d(t,["instances[]","title"],a);const o=f(e,["outputDimensionality"]);t!==void 0&&o!=null&&d(t,["parameters","outputDimensionality"],o);const c=f(e,["mimeType"]);t!==void 0&&c!=null&&d(t,["instances[]","mimeType"],c);const u=f(e,["autoTruncate"]);return t!==void 0&&u!=null&&d(t,["parameters","autoTruncate"],u),n}function iN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["contents"]);a!=null&&d(n,["instances[]","content"],qy(e,a));const o=f(t,["config"]);return o!=null&&d(n,["config"],aN(o,n)),n}function sN(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const a=f(e,["negativePrompt"]);t!==void 0&&a!=null&&d(t,["parameters","negativePrompt"],a);const o=f(e,["numberOfImages"]);t!==void 0&&o!=null&&d(t,["parameters","sampleCount"],o);const c=f(e,["aspectRatio"]);t!==void 0&&c!=null&&d(t,["parameters","aspectRatio"],c);const u=f(e,["guidanceScale"]);t!==void 0&&u!=null&&d(t,["parameters","guidanceScale"],u);const p=f(e,["seed"]);t!==void 0&&p!=null&&d(t,["parameters","seed"],p);const h=f(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&d(t,["parameters","safetySetting"],h);const g=f(e,["personGeneration"]);t!==void 0&&g!=null&&d(t,["parameters","personGeneration"],g);const y=f(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&d(t,["parameters","includeSafetyAttributes"],y);const _=f(e,["includeRaiReason"]);t!==void 0&&_!=null&&d(t,["parameters","includeRaiReason"],_);const E=f(e,["language"]);t!==void 0&&E!=null&&d(t,["parameters","language"],E);const S=f(e,["outputMimeType"]);t!==void 0&&S!=null&&d(t,["parameters","outputOptions","mimeType"],S);const C=f(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&d(t,["parameters","outputOptions","compressionQuality"],C);const w=f(e,["addWatermark"]);t!==void 0&&w!=null&&d(t,["parameters","addWatermark"],w);const M=f(e,["enhancePrompt"]);return t!==void 0&&M!=null&&d(t,["parameters","enhancePrompt"],M),n}function oN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const o=f(t,["config"]);return o!=null&&d(n,["config"],sN(o,n)),n}function Wu(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["imageBytes"]);r!=null&&d(t,["bytesBase64Encoded"],Ba(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function lN(e){const t={},n=f(e,["maskMode"]);n!=null&&d(t,["maskMode"],n);const r=f(e,["segmentationClasses"]);r!=null&&d(t,["maskClasses"],r);const a=f(e,["maskDilation"]);return a!=null&&d(t,["dilation"],a),t}function cN(e){const t={},n=f(e,["controlType"]);n!=null&&d(t,["controlType"],n);const r=f(e,["enableControlImageComputation"]);return r!=null&&d(t,["computeControl"],r),t}function uN(e){const t={},n=f(e,["styleDescription"]);return n!=null&&d(t,["styleDescription"],n),t}function fN(e){const t={},n=f(e,["subjectType"]);n!=null&&d(t,["subjectType"],n);const r=f(e,["subjectDescription"]);return r!=null&&d(t,["subjectDescription"],r),t}function dN(e){const t={},n=f(e,["referenceImage"]);n!=null&&d(t,["referenceImage"],Wu(n));const r=f(e,["referenceId"]);r!=null&&d(t,["referenceId"],r);const a=f(e,["referenceType"]);a!=null&&d(t,["referenceType"],a);const o=f(e,["maskImageConfig"]);o!=null&&d(t,["maskImageConfig"],lN(o));const c=f(e,["controlImageConfig"]);c!=null&&d(t,["controlImageConfig"],cN(c));const u=f(e,["styleImageConfig"]);u!=null&&d(t,["styleImageConfig"],uN(u));const p=f(e,["subjectImageConfig"]);return p!=null&&d(t,["subjectImageConfig"],fN(p)),t}function hN(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const a=f(e,["negativePrompt"]);t!==void 0&&a!=null&&d(t,["parameters","negativePrompt"],a);const o=f(e,["numberOfImages"]);t!==void 0&&o!=null&&d(t,["parameters","sampleCount"],o);const c=f(e,["aspectRatio"]);t!==void 0&&c!=null&&d(t,["parameters","aspectRatio"],c);const u=f(e,["guidanceScale"]);t!==void 0&&u!=null&&d(t,["parameters","guidanceScale"],u);const p=f(e,["seed"]);t!==void 0&&p!=null&&d(t,["parameters","seed"],p);const h=f(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&d(t,["parameters","safetySetting"],h);const g=f(e,["personGeneration"]);t!==void 0&&g!=null&&d(t,["parameters","personGeneration"],g);const y=f(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&d(t,["parameters","includeSafetyAttributes"],y);const _=f(e,["includeRaiReason"]);t!==void 0&&_!=null&&d(t,["parameters","includeRaiReason"],_);const E=f(e,["language"]);t!==void 0&&E!=null&&d(t,["parameters","language"],E);const S=f(e,["outputMimeType"]);t!==void 0&&S!=null&&d(t,["parameters","outputOptions","mimeType"],S);const C=f(e,["outputCompressionQuality"]);t!==void 0&&C!=null&&d(t,["parameters","outputOptions","compressionQuality"],C);const w=f(e,["editMode"]);t!==void 0&&w!=null&&d(t,["parameters","editMode"],w);const M=f(e,["baseSteps"]);return t!==void 0&&M!=null&&d(t,["parameters","editConfig","baseSteps"],M),n}function mN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const o=f(t,["referenceImages"]);if(o!=null){let u=o;Array.isArray(u)&&(u=u.map(p=>dN(p))),d(n,["instances[0]","referenceImages"],u)}const c=f(t,["config"]);return c!=null&&d(n,["config"],hN(c,n)),n}function pN(e,t){const n={},r=f(e,["includeRaiReason"]);t!==void 0&&r!=null&&d(t,["parameters","includeRaiReason"],r);const a=f(e,["outputMimeType"]);t!==void 0&&a!=null&&d(t,["parameters","outputOptions","mimeType"],a);const o=f(e,["outputCompressionQuality"]);t!==void 0&&o!=null&&d(t,["parameters","outputOptions","compressionQuality"],o);const c=f(e,["enhanceInputImage"]);t!==void 0&&c!=null&&d(t,["parameters","upscaleConfig","enhanceInputImage"],c);const u=f(e,["imagePreservationFactor"]);t!==void 0&&u!=null&&d(t,["parameters","upscaleConfig","imagePreservationFactor"],u);const p=f(e,["numberOfImages"]);t!==void 0&&p!=null&&d(t,["parameters","sampleCount"],p);const h=f(e,["mode"]);return t!==void 0&&h!=null&&d(t,["parameters","mode"],h),n}function gN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["image"]);a!=null&&d(n,["instances[0]","image"],Wu(a));const o=f(t,["upscaleFactor"]);o!=null&&d(n,["parameters","upscaleConfig","upscaleFactor"],o);const c=f(t,["config"]);return c!=null&&d(n,["config"],pN(c,n)),n}function xN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],It(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function vN(e,t,n){const r={},a=f(t,["pageSize"]);n!==void 0&&a!=null&&d(n,["_query","pageSize"],a);const o=f(t,["pageToken"]);n!==void 0&&o!=null&&d(n,["_query","pageToken"],o);const c=f(t,["filter"]);n!==void 0&&c!=null&&d(n,["_query","filter"],c);const u=f(t,["queryBase"]);return n!==void 0&&u!=null&&d(n,["_url","models_url"],Jy(e,u)),r}function yN(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],vN(e,r,n)),n}function TN(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);t!==void 0&&a!=null&&d(t,["description"],a);const o=f(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&d(t,["defaultCheckpointId"],o),n}function _N(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],TN(a,n)),n}function EN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],It(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function SN(e,t){const n={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&d(t,["systemInstruction"],yo(Gn(r)));const a=f(e,["tools"]);if(t!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(u=>cT(u))),d(t,["tools"],c)}const o=f(e,["generationConfig"]);return t!==void 0&&o!=null&&d(t,["generationConfig"],o),n}function CN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["contents"]);if(a!=null){let c=Fr(a);Array.isArray(c)&&(c=c.map(u=>yo(u))),d(n,["contents"],c)}const o=f(t,["config"]);return o!=null&&d(n,["config"],SN(o,n)),n}function wN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["contents"]);if(a!=null){let c=Fr(a);Array.isArray(c)&&(c=c.map(u=>yo(u))),d(n,["contents"],c)}const o=f(t,["config"]);return o!=null&&d(n,["config"],o),n}function AN(e){const t={},n=f(e,["uri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["videoBytes"]);r!=null&&d(t,["bytesBase64Encoded"],Ba(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function bN(e,t){const n={},r=f(e,["numberOfVideos"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const a=f(e,["outputGcsUri"]);t!==void 0&&a!=null&&d(t,["parameters","storageUri"],a);const o=f(e,["fps"]);t!==void 0&&o!=null&&d(t,["parameters","fps"],o);const c=f(e,["durationSeconds"]);t!==void 0&&c!=null&&d(t,["parameters","durationSeconds"],c);const u=f(e,["seed"]);t!==void 0&&u!=null&&d(t,["parameters","seed"],u);const p=f(e,["aspectRatio"]);t!==void 0&&p!=null&&d(t,["parameters","aspectRatio"],p);const h=f(e,["resolution"]);t!==void 0&&h!=null&&d(t,["parameters","resolution"],h);const g=f(e,["personGeneration"]);t!==void 0&&g!=null&&d(t,["parameters","personGeneration"],g);const y=f(e,["pubsubTopic"]);t!==void 0&&y!=null&&d(t,["parameters","pubsubTopic"],y);const _=f(e,["negativePrompt"]);t!==void 0&&_!=null&&d(t,["parameters","negativePrompt"],_);const E=f(e,["enhancePrompt"]);t!==void 0&&E!=null&&d(t,["parameters","enhancePrompt"],E);const S=f(e,["generateAudio"]);t!==void 0&&S!=null&&d(t,["parameters","generateAudio"],S);const C=f(e,["lastFrame"]);t!==void 0&&C!=null&&d(t,["instances[0]","lastFrame"],Wu(C));const w=f(e,["compressionQuality"]);return t!==void 0&&w!=null&&d(t,["parameters","compressionQuality"],w),n}function kN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],It(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const o=f(t,["image"]);o!=null&&d(n,["instances[0]","image"],Wu(o));const c=f(t,["video"]);c!=null&&d(n,["instances[0]","video"],AN(c));const u=f(t,["config"]);return u!=null&&d(n,["config"],bN(u,n)),n}function NN(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function MN(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function RN(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function DN(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],NN(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],MN(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],RN(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function IN(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>DN(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function FN(e){const t={},n=f(e,["citationSources"]);return n!=null&&d(t,["citations"],n),t}function LN(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function ON(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>LN(a))),d(t,["urlMetadata"],r)}return t}function PN(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],IN(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],FN(r));const a=f(e,["tokenCount"]);a!=null&&d(t,["tokenCount"],a);const o=f(e,["finishReason"]);o!=null&&d(t,["finishReason"],o);const c=f(e,["urlContextMetadata"]);c!=null&&d(t,["urlContextMetadata"],ON(c));const u=f(e,["avgLogprobs"]);u!=null&&d(t,["avgLogprobs"],u);const p=f(e,["groundingMetadata"]);p!=null&&d(t,["groundingMetadata"],p);const h=f(e,["index"]);h!=null&&d(t,["index"],h);const g=f(e,["logprobsResult"]);g!=null&&d(t,["logprobsResult"],g);const y=f(e,["safetyRatings"]);return y!=null&&d(t,["safetyRatings"],y),t}function lv(e){const t={},n=f(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>PN(u))),d(t,["candidates"],c)}const r=f(e,["modelVersion"]);r!=null&&d(t,["modelVersion"],r);const a=f(e,["promptFeedback"]);a!=null&&d(t,["promptFeedback"],a);const o=f(e,["usageMetadata"]);return o!=null&&d(t,["usageMetadata"],o),t}function UN(e){const t={},n=f(e,["values"]);return n!=null&&d(t,["values"],n),t}function BN(){return{}}function VN(e){const t={},n=f(e,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>UN(o))),d(t,["embeddings"],a)}return f(e,["metadata"])!=null&&d(t,["metadata"],BN()),t}function GN(e){const t={},n=f(e,["bytesBase64Encoded"]);n!=null&&d(t,["imageBytes"],Ba(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function uT(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const a=f(e,["contentType"]);return a!=null&&d(t,["contentType"],a),t}function HN(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],GN(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const a=f(e,["_self"]);return a!=null&&d(t,["safetyAttributes"],uT(a)),t}function zN(e){const t={},n=f(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>HN(o))),d(t,["generatedImages"],a)}const r=f(e,["positivePromptSafetyAttributes"]);return r!=null&&d(t,["positivePromptSafetyAttributes"],uT(r)),t}function jN(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const a=f(e,["updateTime"]);return a!=null&&d(t,["updateTime"],a),t}function jd(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const o=f(e,["version"]);o!=null&&d(t,["version"],o);const c=f(e,["_self"]);c!=null&&d(t,["tunedModelInfo"],jN(c));const u=f(e,["inputTokenLimit"]);u!=null&&d(t,["inputTokenLimit"],u);const p=f(e,["outputTokenLimit"]);p!=null&&d(t,["outputTokenLimit"],p);const h=f(e,["supportedGenerationMethods"]);return h!=null&&d(t,["supportedActions"],h),t}function qN(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["_self"]);if(r!=null){let a=Xy(r);Array.isArray(a)&&(a=a.map(o=>jd(o))),d(t,["models"],a)}return t}function YN(){return{}}function $N(e){const t={},n=f(e,["totalTokens"]);n!=null&&d(t,["totalTokens"],n);const r=f(e,["cachedContentTokenCount"]);return r!=null&&d(t,["cachedContentTokenCount"],r),t}function JN(e){const t={},n=f(e,["video","uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["video","encodedVideo"]);r!=null&&d(t,["videoBytes"],Ba(r));const a=f(e,["encoding"]);return a!=null&&d(t,["mimeType"],a),t}function XN(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],JN(n)),t}function WN(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(c=>XN(c))),d(t,["generatedVideos"],o)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function KN(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const o=f(e,["error"]);o!=null&&d(t,["error"],o);const c=f(e,["response","generateVideoResponse"]);return c!=null&&d(t,["response"],WN(c)),t}function ZN(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function QN(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function e3(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function t3(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],ZN(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],QN(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],e3(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function n3(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>t3(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function r3(e){const t={},n=f(e,["citations"]);return n!=null&&d(t,["citations"],n),t}function a3(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function i3(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>a3(a))),d(t,["urlMetadata"],r)}return t}function s3(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],n3(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],r3(r));const a=f(e,["finishMessage"]);a!=null&&d(t,["finishMessage"],a);const o=f(e,["finishReason"]);o!=null&&d(t,["finishReason"],o);const c=f(e,["urlContextMetadata"]);c!=null&&d(t,["urlContextMetadata"],i3(c));const u=f(e,["avgLogprobs"]);u!=null&&d(t,["avgLogprobs"],u);const p=f(e,["groundingMetadata"]);p!=null&&d(t,["groundingMetadata"],p);const h=f(e,["index"]);h!=null&&d(t,["index"],h);const g=f(e,["logprobsResult"]);g!=null&&d(t,["logprobsResult"],g);const y=f(e,["safetyRatings"]);return y!=null&&d(t,["safetyRatings"],y),t}function cv(e){const t={},n=f(e,["candidates"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(h=>s3(h))),d(t,["candidates"],p)}const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const a=f(e,["responseId"]);a!=null&&d(t,["responseId"],a);const o=f(e,["modelVersion"]);o!=null&&d(t,["modelVersion"],o);const c=f(e,["promptFeedback"]);c!=null&&d(t,["promptFeedback"],c);const u=f(e,["usageMetadata"]);return u!=null&&d(t,["usageMetadata"],u),t}function o3(e){const t={},n=f(e,["truncated"]);n!=null&&d(t,["truncated"],n);const r=f(e,["token_count"]);return r!=null&&d(t,["tokenCount"],r),t}function l3(e){const t={},n=f(e,["values"]);n!=null&&d(t,["values"],n);const r=f(e,["statistics"]);return r!=null&&d(t,["statistics"],o3(r)),t}function c3(e){const t={},n=f(e,["billableCharacterCount"]);return n!=null&&d(t,["billableCharacterCount"],n),t}function u3(e){const t={},n=f(e,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>l3(o))),d(t,["embeddings"],a)}const r=f(e,["metadata"]);return r!=null&&d(t,["metadata"],c3(r)),t}function f3(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["imageBytes"],Ba(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function fT(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const a=f(e,["contentType"]);return a!=null&&d(t,["contentType"],a),t}function hh(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],f3(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const a=f(e,["_self"]);a!=null&&d(t,["safetyAttributes"],fT(a));const o=f(e,["prompt"]);return o!=null&&d(t,["enhancedPrompt"],o),t}function d3(e){const t={},n=f(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>hh(o))),d(t,["generatedImages"],a)}const r=f(e,["positivePromptSafetyAttributes"]);return r!=null&&d(t,["positivePromptSafetyAttributes"],fT(r)),t}function h3(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>hh(a))),d(t,["generatedImages"],r)}return t}function m3(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>hh(a))),d(t,["generatedImages"],r)}return t}function p3(e){const t={},n=f(e,["endpoint"]);n!=null&&d(t,["name"],n);const r=f(e,["deployedModelId"]);return r!=null&&d(t,["deployedModelId"],r),t}function g3(e){const t={},n=f(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const a=f(e,["updateTime"]);return a!=null&&d(t,["updateTime"],a),t}function x3(e){const t={},n=f(e,["checkpointId"]);n!=null&&d(t,["checkpointId"],n);const r=f(e,["epoch"]);r!=null&&d(t,["epoch"],r);const a=f(e,["step"]);return a!=null&&d(t,["step"],a),t}function qd(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const o=f(e,["versionId"]);o!=null&&d(t,["version"],o);const c=f(e,["deployedModels"]);if(c!=null){let y=c;Array.isArray(y)&&(y=y.map(_=>p3(_))),d(t,["endpoints"],y)}const u=f(e,["labels"]);u!=null&&d(t,["labels"],u);const p=f(e,["_self"]);p!=null&&d(t,["tunedModelInfo"],g3(p));const h=f(e,["defaultCheckpointId"]);h!=null&&d(t,["defaultCheckpointId"],h);const g=f(e,["checkpoints"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(_=>x3(_))),d(t,["checkpoints"],y)}return t}function v3(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["_self"]);if(r!=null){let a=Xy(r);Array.isArray(a)&&(a=a.map(o=>qd(o))),d(t,["models"],a)}return t}function y3(){return{}}function T3(e){const t={},n=f(e,["totalTokens"]);return n!=null&&d(t,["totalTokens"],n),t}function _3(e){const t={},n=f(e,["tokensInfo"]);return n!=null&&d(t,["tokensInfo"],n),t}function E3(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["videoBytes"],Ba(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function S3(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],E3(n)),t}function C3(e){const t={},n=f(e,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(c=>S3(c))),d(t,["generatedVideos"],o)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function w3(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const o=f(e,["error"]);o!=null&&d(t,["error"],o);const c=f(e,["response"]);return c!=null&&d(t,["response"],C3(c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const A3="Content-Type",b3="X-Server-Timeout",k3="User-Agent",Yd="x-goog-api-client",N3="1.8.0",M3=`google-genai-sdk/${N3}`,R3="v1beta1",D3="v1beta",uv=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class I3{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:R3,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:D3,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),t!==""&&a.push(t),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),a=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[c,u]of Object.entries(t.queryParams))a.searchParams.append(c,String(u));let o={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=t.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,t.abortSignal),this.unaryApiCall(a,o,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[a,o]of Object.entries(n))typeof o=="object"?r[a]=Object.assign(Object.assign({},r[a]),o):o!==void 0&&(r[a]=o);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),a=this.constructUrl(t.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=t.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,t.abortSignal),this.streamApiCall(a,o,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r){if(n&&n.timeout||r){const a=new AbortController,o=a.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>a.abort(),n.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),t.signal=o}return n&&n.extraBody!==null&&F3(t,n.extraBody),t.headers=await this.getHeadersInternal(n),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await fv(a),new Ud(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await fv(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(t){var n;return no(this,arguments,function*(){const a=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let c="";for(;;){const{done:u,value:p}=yield Yt(a.read());if(u){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=o.decode(p);try{const y=JSON.parse(h);if("error"in y){const _=JSON.parse(JSON.stringify(y.error)),E=_.status,S=_.code,C=`got status: ${E}. ${JSON.stringify(y)}`;if(S>=400&&S<600)throw new Ju({message:C,status:S})}}catch(y){if(y.name==="ApiError")throw y}c+=h;let g=c.match(uv);for(;g;){const y=g[1];try{const _=new Response(y,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Yt(new Ud(_)),c=c.slice(g[0].length),g=c.match(uv)}catch(_){throw new Error(`exception parsing stream chunk ${y}. ${_}`)}}}}finally{a.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=M3+" "+this.clientOptions.userAgentExtra;return t[k3]=n,t[Yd]=n,t[A3]="application/json",t}async getHeadersInternal(t){const n=new Headers;if(t&&t.headers){for(const[r,a]of Object.entries(t.headers))n.append(r,a);t.timeout&&t.timeout>0&&n.append(b3,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(t,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,c=await o.stat(t);a.sizeBytes=String(c.size);const u=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:c.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=u;const p=await this.fetchUploadUrl(a,n);return o.upload(t,p,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n){var r;let a={};n!=null&&n.httpOptions?a=n.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const o={file:t},c=await this.request({path:Je("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(r=c==null?void 0:c.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function fv(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new Ju({message:a,status:n}):new Error(a)}}function F3(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const o=JSON.parse(e.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,c){const u=Object.assign({},o);for(const p in c)if(Object.prototype.hasOwnProperty.call(c,p)){const h=c[p],g=u[p];h&&typeof h=="object"&&!Array.isArray(h)&&g&&typeof g=="object"&&!Array.isArray(g)?u[p]=r(g,h):(g&&h&&typeof g!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${p}". Original type: ${typeof g}, New type: ${typeof h}. Overwriting.`),u[p]=h)}return u}const a=r(n,t);e.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const L3="mcp_used/unknown";function dT(e){for(const t of e)if(mh(t)||typeof t=="object"&&"inputSchema"in t)return!0;return!1}function hT(e){var t;const n=(t=e[Yd])!==null&&t!==void 0?t:"";e[Yd]=(n+` ${L3}`).trimStart()}function O3(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(a=>mh(a)))!==null&&r!==void 0?r:!1}function P3(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(a=>!mh(a)))!==null&&r!==void 0?r:!1}function mh(e){return e!==null&&typeof e=="object"&&e instanceof ph}function U3(e,t=100){return no(this,arguments,function*(){let r,a=0;for(;a<t;){const o=yield Yt(e.listTools({cursor:r}));for(const c of o.tools)yield yield Yt(c),a++;if(!o.nextCursor)break;r=o.nextCursor}})}class ph{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new ph(t,n)}async initialize(){var t,n,r,a;if(this.mcpTools.length>0)return;const o={},c=[];for(const g of this.mcpClients)try{for(var u=!0,p=(n=void 0,wl(U3(g))),h;h=await p.next(),t=h.done,!t;u=!0){a=h.value,u=!1;const y=a;c.push(y);const _=y.name;if(o[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);o[_]=g}}catch(y){n={error:y}}finally{try{!u&&!t&&(r=p.return)&&await r.call(p)}finally{if(n)throw n.error}}this.mcpTools=c,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),RC(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const c=await a.callTool({name:r.name,arguments:r.args},void 0,o);n.push({functionResponse:{name:r.name,response:c.isError?{error:c}:c}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function B3(e,t,n){const r=new TC;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data);const o=$k(a);Object.assign(r,o),t(r)}class V3{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),c=z3(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),p=`${a}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${u}`;let h=()=>{};const g=new Promise(b=>{h=b}),y=t.callbacks,_=function(){h({})},E=this.apiClient,S={onopen:_,onmessage:b=>{B3(E,y.onmessage,b)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(b){},onclose:(r=y==null?void 0:y.onclose)!==null&&r!==void 0?r:function(b){}},C=this.webSocketFactory.create(p,H3(c),S);C.connect(),await g;const w=It(this.apiClient,t.model),M=sT({model:w}),k=zd({setup:M});return C.send(JSON.stringify(k)),new G3(C,this.apiClient)}}class G3{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=ok(t),r=oT(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=lk(t),r=zd(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const n=zd({playbackControl:t});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Qs.PLAY)}pause(){this.sendPlaybackControl(Qs.PAUSE)}stop(){this.sendPlaybackControl(Qs.STOP)}resetContext(){this.sendPlaybackControl(Qs.RESET_CONTEXT)}close(){this.conn.close()}}function H3(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function z3(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const j3="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function q3(e,t,n){const r=new yC;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const o=JSON.parse(a);if(e.isVertexAI()){const c=Uk(o);Object.assign(r,c)}else{const c=Pk(o);Object.assign(r,c)}t(r)}class Y3{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new V3(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,a,o,c,u;const p=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let g;const y=this.apiClient.getDefaultHeaders();t.config&&t.config.tools&&dT(t.config.tools)&&hT(y);const _=W3(y);if(this.apiClient.isVertexAI())g=`${p}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_);else{const L=this.apiClient.getApiKey();let Q="BidiGenerateContent",te="key";L!=null&&L.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),Q="BidiGenerateContentConstrained",te="access_token"),g=`${p}/ws/google.ai.generativelanguage.${h}.GenerativeService.${Q}?${te}=${L}`}let E=()=>{};const S=new Promise(L=>{E=L}),C=t.callbacks,w=function(){var L;(L=C==null?void 0:C.onopen)===null||L===void 0||L.call(C),E({})},M=this.apiClient,k={onopen:w,onmessage:L=>{q3(M,C.onmessage,L)},onerror:(n=C==null?void 0:C.onerror)!==null&&n!==void 0?n:function(L){},onclose:(r=C==null?void 0:C.onclose)!==null&&r!==void 0?r:function(L){}},b=this.webSocketFactory.create(g,X3(_),k);b.connect(),await S;let U=It(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&U.startsWith("publishers/")){const L=this.apiClient.getProject(),Q=this.apiClient.getLocation();U=`projects/${L}/locations/${Q}/`+U}let B={};this.apiClient.isVertexAI()&&((a=t.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Ru.AUDIO]}:t.config.responseModalities=[Ru.AUDIO]),!((o=t.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const X=(u=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&u!==void 0?u:[],F=[];for(const L of X)if(this.isCallableTool(L)){const Q=L;F.push(await Q.tool())}else F.push(L);F.length>0&&(t.config.tools=F);const Y={model:U,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?B=ek(this.apiClient,Y):B=Qb(this.apiClient,Y),delete B.config,b.send(JSON.stringify(B)),new J3(b,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const $3={turnComplete:!0};class J3{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Fr(n.turns),t.isVertexAI()?r=r.map(a=>yo(a)):r=r.map(a=>Xu(a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!t.isVertexAI()&&!("id"in o))throw new Error(j3)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},$3),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:sk(t)}:n={realtimeInput:ik(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function X3(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function W3(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dv=10;function hv(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let a=!1;for(const c of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Cu(c)){a=!0;break}if(!a)return!0;const o=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Cu(e){return"callTool"in e&&typeof e.callTool=="function"}function mv(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class K3 extends is{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,a,o,c,u;const p=await this.processParamsForMcpUsage(n);if(!O3(n)||hv(n.config))return await this.generateContentInternal(p);if(P3(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,g;const y=Fr(p.contents),_=(o=(a=(r=p.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&o!==void 0?o:dv;let E=0;for(;E<_&&(h=await this.generateContentInternal(p),!(!h.functionCalls||h.functionCalls.length===0));){const S=h.candidates[0].content,C=[];for(const w of(u=(c=n.config)===null||c===void 0?void 0:c.tools)!==null&&u!==void 0?u:[])if(Cu(w)){const k=await w.callTool(h.functionCalls);C.push(...k)}E++,g={role:"user",parts:C},p.contents=Fr(p.contents),p.contents.push(S),p.contents.push(g),mv(p.config)&&(y.push(S),y.push(g))}return mv(p.config)&&(h.automaticFunctionCallingHistory=y),h},this.generateContentStream=async n=>{if(hv(n.config)){const r=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let o;const c=[];if(r!=null&&r.generatedImages)for(const p of r.generatedImages)p&&(p!=null&&p.safetyAttributes)&&((a=p==null?void 0:p.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=p==null?void 0:p.safetyAttributes:c.push(p);let u;return o?u={generatedImages:c,positivePromptSafetyAttributes:o}:u={generatedImages:c},u}),this.list=async n=>{var r;const c={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((r=c.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new Xl(Qi.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(c),c)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async processParamsForMcpUsage(t){var n,r,a;const o=(n=t.config)===null||n===void 0?void 0:n.tools;if(!o)return t;const c=await Promise.all(o.map(async p=>Cu(p)?await p.tool():p)),u={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:c})};if(u.config.tools=c,t.config&&t.config.tools&&dT(t.config.tools)){const p=(a=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let h=Object.assign({},p);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),hT(h),u.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:h})}return u}async initAfcToolsMap(t){var n,r,a;const o=new Map;for(const c of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Cu(c)){const u=c,p=await u.tool();for(const h of(a=p.functionDeclarations)!==null&&a!==void 0?a:[]){if(!h.name)throw new Error("Function declaration name is required.");if(o.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);o.set(h.name,u)}}return o}async processAfcStream(t){var n,r,a;const o=(a=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:dv;let c=!1,u=0;const p=await this.initAfcToolsMap(t);return function(h,g,y){var _,E;return no(this,arguments,function*(){for(var S,C,w,M;u<o;){c&&(u++,c=!1);const B=yield Yt(h.processParamsForMcpUsage(y)),X=yield Yt(h.generateContentStreamInternal(B)),F=[],Y=[];try{for(var k=!0,b=(C=void 0,wl(X)),U;U=yield Yt(b.next()),S=U.done,!S;k=!0){M=U.value,k=!1;const L=M;if(yield yield Yt(L),L.candidates&&(!((_=L.candidates[0])===null||_===void 0)&&_.content)){Y.push(L.candidates[0].content);for(const Q of(E=L.candidates[0].content.parts)!==null&&E!==void 0?E:[])if(u<o&&Q.functionCall){if(!Q.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(Q.functionCall.name)){const te=yield Yt(g.get(Q.functionCall.name).callTool([Q.functionCall]));F.push(...te)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${Q.functionCall.name}`)}}}}catch(L){C={error:L}}finally{try{!k&&!S&&(w=b.return)&&(yield Yt(w.call(b)))}finally{if(C)throw C.error}}if(F.length>0){c=!0;const L=new xl;L.candidates=[{content:{role:"user",parts:F}}],yield yield Yt(L);const Q=[];Q.push(...Y),Q.push({role:"user",parts:F});const te=Fr(y.contents).concat(Q);y.contents=te}else break}})}(this,p,t)}async generateContentInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=ov(this.apiClient,t);return u=Je("{model}:generateContent",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>{const y=cv(g),_=new xl;return Object.assign(_,y),_})}else{const h=sv(this.apiClient,t);return u=Je("{model}:generateContent",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>{const y=lv(g),_=new xl;return Object.assign(_,y),_})}}async generateContentStreamInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=ov(this.apiClient,t);return u=Je("{model}:streamGenerateContent?alt=sse",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.requestStream({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),c.then(function(y){return no(this,arguments,function*(){var _,E,S,C;try{for(var w=!0,M=wl(y),k;k=yield Yt(M.next()),_=k.done,!_;w=!0){C=k.value,w=!1;const U=cv(yield Yt(C.json())),B=new xl;Object.assign(B,U),yield yield Yt(B)}}catch(b){E={error:b}}finally{try{!w&&!_&&(S=M.return)&&(yield Yt(S.call(M)))}finally{if(E)throw E.error}}})})}else{const h=sv(this.apiClient,t);return u=Je("{model}:streamGenerateContent?alt=sse",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.requestStream({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}),c.then(function(y){return no(this,arguments,function*(){var _,E,S,C;try{for(var w=!0,M=wl(y),k;k=yield Yt(M.next()),_=k.done,!_;w=!0){C=k.value,w=!1;const U=lv(yield Yt(C.json())),B=new xl;Object.assign(B,U),yield yield Yt(B)}}catch(b){E={error:b}}finally{try{!w&&!_&&(S=M.return)&&(yield Yt(S.call(M)))}finally{if(E)throw E.error}}})})}}async embedContent(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=iN(this.apiClient,t);return u=Je("{model}:predict",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>{const y=u3(g),_=new B1;return Object.assign(_,y),_})}else{const h=v4(this.apiClient,t);return u=Je("{model}:batchEmbedContents",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>{const y=VN(g),_=new B1;return Object.assign(_,y),_})}}async generateImagesInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=oN(this.apiClient,t);return u=Je("{model}:predict",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>{const y=d3(g),_=new V1;return Object.assign(_,y),_})}else{const h=T4(this.apiClient,t);return u=Je("{model}:predict",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>{const y=zN(g),_=new V1;return Object.assign(_,y),_})}}async editImageInternal(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI()){const u=mN(this.apiClient,t);return o=Je("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const h=h3(p),g=new hC;return Object.assign(g,h),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI()){const u=gN(this.apiClient,t);return o=Je("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const h=m3(p),g=new mC;return Object.assign(g,h),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=xN(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>qd(g))}else{const h=_4(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>jd(g))}}async listInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=yN(this.apiClient,t);return u=Je("{models_url}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>{const y=v3(g),_=new G1;return Object.assign(_,y),_})}else{const h=S4(this.apiClient,t);return u=Je("{models_url}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>{const y=qN(g),_=new G1;return Object.assign(_,y),_})}}async update(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=_N(this.apiClient,t);return u=Je("{model}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>qd(g))}else{const h=w4(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>jd(g))}}async delete(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=EN(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(()=>{const g=y3(),y=new H1;return Object.assign(y,g),y})}else{const h=A4(this.apiClient,t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(()=>{const g=YN(),y=new H1;return Object.assign(y,g),y})}}async countTokens(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=CN(this.apiClient,t);return u=Je("{model}:countTokens",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>{const y=T3(g),_=new z1;return Object.assign(_,y),_})}else{const h=k4(this.apiClient,t);return u=Je("{model}:countTokens",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>{const y=$N(g),_=new z1;return Object.assign(_,y),_})}}async computeTokens(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI()){const u=wN(this.apiClient,t);return o=Je("{model}:computeTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const h=_3(p),g=new pC;return Object.assign(g,h),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=kN(this.apiClient,t);return u=Je("{model}:predictLongRunning",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>w3(g))}else{const h=R4(this.apiClient,t);return u=Je("{model}:predictLongRunning",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>KN(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Z3(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["_url","operationName"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function Q3(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["_url","operationName"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function e5(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["operationName"],n);const r=f(e,["resourceName"]);r!=null&&d(t,["_url","resourceName"],r);const a=f(e,["config"]);return a!=null&&d(t,["config"],a),t}function t5(e){const t={},n=f(e,["video","uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["video","encodedVideo"]);r!=null&&d(t,["videoBytes"],Ba(r));const a=f(e,["encoding"]);return a!=null&&d(t,["mimeType"],a),t}function n5(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],t5(n)),t}function r5(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(c=>n5(c))),d(t,["generatedVideos"],o)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function a5(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const o=f(e,["error"]);o!=null&&d(t,["error"],o);const c=f(e,["response","generateVideoResponse"]);return c!=null&&d(t,["response"],r5(c)),t}function i5(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["videoBytes"],Ba(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function s5(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],i5(n)),t}function o5(e){const t={},n=f(e,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(c=>s5(c))),d(t,["generatedVideos"],o)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function pv(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const o=f(e,["error"]);o!=null&&d(t,["error"],o);const c=f(e,["response"]);return c!=null&&d(t,["response"],o5(c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class l5 extends is{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let o;return r&&"httpOptions"in r&&(o=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=Q3(t);return u=Je("{operationName}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>pv(g))}else{const h=Z3(t);return u=Je("{operationName}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>a5(g))}}async fetchPredictVideosOperationInternal(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI()){const u=e5(t);return o=Je("{resourceName}:fetchPredictOperation",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>pv(p))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function c5(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function mT(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],c5(n)),t}function u5(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],mT(r)),t}function f5(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>u5(a))),d(t,["speakerVoiceConfigs"],r)}return t}function d5(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],mT(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],f5(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function h5(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function m5(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function p5(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function g5(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],h5(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],m5(a));const o=f(e,["fileData"]);o!=null&&d(t,["fileData"],p5(o));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const h=f(e,["functionCall"]);h!=null&&d(t,["functionCall"],h);const g=f(e,["functionResponse"]);g!=null&&d(t,["functionResponse"],g);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function x5(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>g5(o))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function v5(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const o=f(e,["parameters"]);o!=null&&d(t,["parameters"],o);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function y5(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function T5(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],y5(n)),t}function _5(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function E5(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],_5(n)),t}function S5(){return{}}function C5(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(h=>v5(h))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],T5(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],E5(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],S5());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function w5(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function gv(){return{}}function A5(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const a=f(e,["endOfSpeechSensitivity"]);a!=null&&d(t,["endOfSpeechSensitivity"],a);const o=f(e,["prefixPaddingMs"]);o!=null&&d(t,["prefixPaddingMs"],o);const c=f(e,["silenceDurationMs"]);return c!=null&&d(t,["silenceDurationMs"],c),t}function b5(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],A5(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const a=f(e,["turnCoverage"]);return a!=null&&d(t,["turnCoverage"],a),t}function k5(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function N5(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],k5(r)),t}function M5(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function R5(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const a=f(e,["responseModalities"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","responseModalities"],a);const o=f(e,["temperature"]);t!==void 0&&o!=null&&d(t,["setup","generationConfig","temperature"],o);const c=f(e,["topP"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","topP"],c);const u=f(e,["topK"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","topK"],u);const p=f(e,["maxOutputTokens"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","maxOutputTokens"],p);const h=f(e,["mediaResolution"]);t!==void 0&&h!=null&&d(t,["setup","generationConfig","mediaResolution"],h);const g=f(e,["seed"]);t!==void 0&&g!=null&&d(t,["setup","generationConfig","seed"],g);const y=f(e,["speechConfig"]);t!==void 0&&y!=null&&d(t,["setup","generationConfig","speechConfig"],d5(dh(y)));const _=f(e,["enableAffectiveDialog"]);t!==void 0&&_!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],_);const E=f(e,["systemInstruction"]);t!==void 0&&E!=null&&d(t,["setup","systemInstruction"],x5(Gn(E)));const S=f(e,["tools"]);if(t!==void 0&&S!=null){let B=xo(S);Array.isArray(B)&&(B=B.map(X=>C5(go(X)))),d(t,["setup","tools"],B)}const C=f(e,["sessionResumption"]);t!==void 0&&C!=null&&d(t,["setup","sessionResumption"],w5(C));const w=f(e,["inputAudioTranscription"]);t!==void 0&&w!=null&&d(t,["setup","inputAudioTranscription"],gv());const M=f(e,["outputAudioTranscription"]);t!==void 0&&M!=null&&d(t,["setup","outputAudioTranscription"],gv());const k=f(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&d(t,["setup","realtimeInputConfig"],b5(k));const b=f(e,["contextWindowCompression"]);t!==void 0&&b!=null&&d(t,["setup","contextWindowCompression"],N5(b));const U=f(e,["proactivity"]);return t!==void 0&&U!=null&&d(t,["setup","proactivity"],M5(U)),n}function D5(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],It(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],R5(a,n)),n}function I5(e,t,n){const r={},a=f(t,["expireTime"]);n!==void 0&&a!=null&&d(n,["expireTime"],a);const o=f(t,["newSessionExpireTime"]);n!==void 0&&o!=null&&d(n,["newSessionExpireTime"],o);const c=f(t,["uses"]);n!==void 0&&c!=null&&d(n,["uses"],c);const u=f(t,["liveConnectConstraints"]);n!==void 0&&u!=null&&d(n,["bidiGenerateContentSetup"],D5(e,u));const p=f(t,["lockAdditionalFields"]);return n!==void 0&&p!=null&&d(n,["fieldMask"],p),r}function F5(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],I5(e,r,n)),n}function L5(e){const t={},n=f(e,["name"]);return n!=null&&d(t,["name"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function O5(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(o=>`${n}.${o}`);t.push(...a)}else t.push(n)}return t.join(",")}function P5(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(e.bidiGenerateContentSetup=o,n=o):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const a=e.fieldMask;if(n){const o=O5(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)o?e.fieldMask=o:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];a.length>0&&(u=a.map(h=>c.includes(h)?`generationConfig.${h}`:h));const p=[];o&&p.push(o),u.length>0&&p.push(...u),p.length>0?e.fieldMask=p.join(","):delete e.fieldMask}else delete e.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?e.fieldMask=a.join(","):delete e.fieldMask;return e}class U5 extends is{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=F5(this.apiClient,t);o=Je("auth_tokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const p=P5(u,t.config);return a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),a.then(h=>L5(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function B5(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function V5(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const o=f(e,["filter"]);return t!==void 0&&o!=null&&d(t,["_query","filter"],o),n}function G5(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],V5(n,t)),t}function H5(e){const t={},n=f(e,["textInput"]);n!=null&&d(t,["textInput"],n);const r=f(e,["output"]);return r!=null&&d(t,["output"],r),t}function z5(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=f(e,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>H5(a))),d(t,["examples","examples"],r)}return t}function j5(e,t){const n={};if(f(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=f(e,["tunedModelDisplayName"]);if(t!==void 0&&r!=null&&d(t,["displayName"],r),f(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=f(e,["epochCount"]);t!==void 0&&a!=null&&d(t,["tuningTask","hyperparameters","epochCount"],a);const o=f(e,["learningRateMultiplier"]);if(o!=null&&d(n,["tuningTask","hyperparameters","learningRateMultiplier"],o),f(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=f(e,["batchSize"]);t!==void 0&&c!=null&&d(t,["tuningTask","hyperparameters","batchSize"],c);const u=f(e,["learningRate"]);return t!==void 0&&u!=null&&d(t,["tuningTask","hyperparameters","learningRate"],u),n}function q5(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["trainingDataset"]);r!=null&&d(t,["tuningTask","trainingData"],z5(r));const a=f(e,["config"]);return a!=null&&d(t,["config"],j5(a,t)),t}function Y5(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function $5(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const o=f(e,["filter"]);return t!==void 0&&o!=null&&d(t,["_query","filter"],o),n}function J5(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],$5(n,t)),t}function X5(e,t){const n={},r=f(e,["gcsUri"]);t!==void 0&&r!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],r);const a=f(e,["vertexDatasetResource"]);if(t!==void 0&&a!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],a),f(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function W5(e,t){const n={},r=f(e,["gcsUri"]);r!=null&&d(n,["validationDatasetUri"],r);const a=f(e,["vertexDatasetResource"]);return t!==void 0&&a!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],a),n}function K5(e,t){const n={},r=f(e,["validationDataset"]);t!==void 0&&r!=null&&d(t,["supervisedTuningSpec"],W5(r,n));const a=f(e,["tunedModelDisplayName"]);t!==void 0&&a!=null&&d(t,["tunedModelDisplayName"],a);const o=f(e,["description"]);t!==void 0&&o!=null&&d(t,["description"],o);const c=f(e,["epochCount"]);t!==void 0&&c!=null&&d(t,["supervisedTuningSpec","hyperParameters","epochCount"],c);const u=f(e,["learningRateMultiplier"]);t!==void 0&&u!=null&&d(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const p=f(e,["exportLastCheckpointOnly"]);t!==void 0&&p!=null&&d(t,["supervisedTuningSpec","exportLastCheckpointOnly"],p);const h=f(e,["adapterSize"]);if(t!==void 0&&h!=null&&d(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),f(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function Z5(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["trainingDataset"]);r!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],X5(r,t));const a=f(e,["config"]);return a!=null&&d(t,["config"],K5(a,t)),t}function Q5(e){const t={},n=f(e,["name"]);n!=null&&d(t,["model"],n);const r=f(e,["name"]);return r!=null&&d(t,["endpoint"],r),t}function pT(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["state"]);r!=null&&d(t,["state"],Yy(r));const a=f(e,["createTime"]);a!=null&&d(t,["createTime"],a);const o=f(e,["tuningTask","startTime"]);o!=null&&d(t,["startTime"],o);const c=f(e,["tuningTask","completeTime"]);c!=null&&d(t,["endTime"],c);const u=f(e,["updateTime"]);u!=null&&d(t,["updateTime"],u);const p=f(e,["description"]);p!=null&&d(t,["description"],p);const h=f(e,["baseModel"]);h!=null&&d(t,["baseModel"],h);const g=f(e,["_self"]);g!=null&&d(t,["tunedModel"],Q5(g));const y=f(e,["distillationSpec"]);y!=null&&d(t,["distillationSpec"],y);const _=f(e,["experiment"]);_!=null&&d(t,["experiment"],_);const E=f(e,["labels"]);E!=null&&d(t,["labels"],E);const S=f(e,["pipelineJob"]);S!=null&&d(t,["pipelineJob"],S);const C=f(e,["satisfiesPzi"]);C!=null&&d(t,["satisfiesPzi"],C);const w=f(e,["satisfiesPzs"]);w!=null&&d(t,["satisfiesPzs"],w);const M=f(e,["serviceAccount"]);M!=null&&d(t,["serviceAccount"],M);const k=f(e,["tunedModelDisplayName"]);return k!=null&&d(t,["tunedModelDisplayName"],k),t}function eM(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>pT(o))),d(t,["tuningJobs"],a)}return t}function tM(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const o=f(e,["error"]);return o!=null&&d(t,["error"],o),t}function nM(e){const t={},n=f(e,["checkpointId"]);n!=null&&d(t,["checkpointId"],n);const r=f(e,["epoch"]);r!=null&&d(t,["epoch"],r);const a=f(e,["step"]);a!=null&&d(t,["step"],a);const o=f(e,["endpoint"]);return o!=null&&d(t,["endpoint"],o),t}function rM(e){const t={},n=f(e,["model"]);n!=null&&d(t,["model"],n);const r=f(e,["endpoint"]);r!=null&&d(t,["endpoint"],r);const a=f(e,["checkpoints"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(c=>nM(c))),d(t,["checkpoints"],o)}return t}function $d(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["state"]);r!=null&&d(t,["state"],Yy(r));const a=f(e,["createTime"]);a!=null&&d(t,["createTime"],a);const o=f(e,["startTime"]);o!=null&&d(t,["startTime"],o);const c=f(e,["endTime"]);c!=null&&d(t,["endTime"],c);const u=f(e,["updateTime"]);u!=null&&d(t,["updateTime"],u);const p=f(e,["error"]);p!=null&&d(t,["error"],p);const h=f(e,["description"]);h!=null&&d(t,["description"],h);const g=f(e,["baseModel"]);g!=null&&d(t,["baseModel"],g);const y=f(e,["tunedModel"]);y!=null&&d(t,["tunedModel"],rM(y));const _=f(e,["supervisedTuningSpec"]);_!=null&&d(t,["supervisedTuningSpec"],_);const E=f(e,["tuningDataStats"]);E!=null&&d(t,["tuningDataStats"],E);const S=f(e,["encryptionSpec"]);S!=null&&d(t,["encryptionSpec"],S);const C=f(e,["partnerModelTuningSpec"]);C!=null&&d(t,["partnerModelTuningSpec"],C);const w=f(e,["distillationSpec"]);w!=null&&d(t,["distillationSpec"],w);const M=f(e,["experiment"]);M!=null&&d(t,["experiment"],M);const k=f(e,["labels"]);k!=null&&d(t,["labels"],k);const b=f(e,["pipelineJob"]);b!=null&&d(t,["pipelineJob"],b);const U=f(e,["satisfiesPzi"]);U!=null&&d(t,["satisfiesPzi"],U);const B=f(e,["satisfiesPzs"]);B!=null&&d(t,["satisfiesPzs"],B);const X=f(e,["serviceAccount"]);X!=null&&d(t,["serviceAccount"],X);const F=f(e,["tunedModelDisplayName"]);return F!=null&&d(t,["tunedModelDisplayName"],F),t}function aM(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>$d(o))),d(t,["tuningJobs"],a)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iM extends is{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Xl(Qi.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:Pd.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=Y5(t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>$d(g))}else{const h=B5(t);return u=Je("{name}",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>pT(g))}}async listInternal(t){var n,r,a,o;let c,u="",p={};if(this.apiClient.isVertexAI()){const h=J5(t);return u=Je("tuningJobs",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),c.then(g=>{const y=aM(g),_=new j1;return Object.assign(_,y),_})}else{const h=G5(t);return u=Je("tunedModels",h._url),p=h._query,delete h.config,delete h._url,delete h._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),c.then(g=>{const y=eM(g),_=new j1;return Object.assign(_,y),_})}}async tuneInternal(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI()){const u=Z5(t);return o=Je("tuningJobs",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>$d(p))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let a,o="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=q5(t);return o=Je("tunedModels",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>tM(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sM{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const oM=1024*1024*8,lM=3,cM=1e3,uM=2,gd="x-goog-upload-status";async function fM(e,t,n){var r,a,o;let c=0,u=0,p=new Ud(new Response),h="upload";for(c=e.size;u<c;){const y=Math.min(oM,c-u),_=e.slice(u,u+y);u+y>=c&&(h+=", finalize");let E=0,S=cM;for(;E<lM&&(p=await n.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(u),"Content-Length":String(y)}}}),!(!((r=p==null?void 0:p.headers)===null||r===void 0)&&r[gd]));)E++,await hM(S),S=S*uM;if(u+=y,((a=p==null?void 0:p.headers)===null||a===void 0?void 0:a[gd])!=="active")break;if(c<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const g=await(p==null?void 0:p.json());if(((o=p==null?void 0:p.headers)===null||o===void 0?void 0:o[gd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return g.file}async function dM(e){return{size:e.size,type:e.type}}function hM(e){return new Promise(t=>setTimeout(t,e))}class mM{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await fM(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await dM(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pM{create(t,n,r){return new gM(t,n,r)}}class gM{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xv="x-goog-api-key";class xM{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(t.get(xv)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(xv,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vM="gl-node/";class yM{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=dC(t,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const a=new xM(this.apiKey);this.apiClient=new I3({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:vM+"web",uploader:new mM,downloader:new sM}),this.models=new K3(this.apiClient),this.live=new Y3(this.apiClient,a,new pM),this.batches=new Vw(this.apiClient),this.chats=new jA(this.models,this.apiClient),this.caches=new GA(this.apiClient),this.files=new rb(this.apiClient),this.operations=new l5(this.apiClient),this.authTokens=new U5(this.apiClient),this.tunings=new iM(this.apiClient)}}const Ur="gemini-2.5-flash-preview-04-17";let Bt=null;const vv=e=>{if(!e){Bt=null;return}try{Bt=new yM({apiKey:e})}catch(t){console.error("Failed to initialize Gemini AI:",t),Bt=null}},Ei=e=>{const t=n=>{const{position:r,extendedDetails:a,...o}=n,c={...o};if(a){const{reportDeck:u,attachments:p,subSteps:h,decisions:g,...y}=a,_={...y};u&&u.slides.length>0&&(_.reportDeckExists=!0,_.reportDeckSlideCount=u.slides.length),p&&p.length>0&&(_.attachments=p.map(E=>({id:E.id,name:E.name,type:E.type}))),h&&h.length>0&&(_.subSteps=h.map(E=>{const{position:S,attachments:C,actionItems:w,...M}=E,k={...M};return C&&C.length>0&&(k.attachments=C.map(b=>({id:b.id,name:b.name,type:b.type}))),w&&w.length>0&&(k.actionItems=w.map(b=>{const{report:U,...B}=b,X={...B};if(U){const{attachments:F,...Y}=U,L={...Y};F&&F.length>0&&(L.attachments=F.map(Q=>({id:Q.id,name:Q.name,type:Q.type}))),X.report=L}return X})),k})),c.extendedDetails=_}return c};return Array.isArray(e)?e.map(t):t(e)},Ku=e=>({...e,slides:e.slides.map(t=>{if(t.isLocked)return{id:t.id,isLocked:!0,summary:`Locked Slide: Contains ${t.elements.length} elements. Content is preserved and must not be changed.`,elements:[]};const{elements:n,...r}=t;return{...r,elements:n.map(a=>{var o;if(a.type==="flowchart"&&((o=a.data)!=null&&o.subSteps)){const c=a;return{...c,data:{subStepCount:c.data.subSteps.length,subSteps:`[Sub-step data omitted for brevity, count: ${c.data.subSteps.length}]`}}}return a})}})}),TM=e=>{const t=/"dependencies"\s*:\s*\[([\s\S]*?)\]/g;return e.replace(t,(n,r)=>{const a=r.match(/"[^"]*"/g);return`"dependencies": [${a?a.join(", "):""}]`})},Zr=e=>{let t=e.trim();const n=/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s,r=t.match(n);if(r&&r[1]&&(t=r[1].trim()),t=TM(t),t=t.replace(/"((?:\\.|[^"\\])*)"/g,(a,o)=>`"${o.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`),!r){const a=t.indexOf("{"),o=t.indexOf("[");if(a===-1&&o===-1)throw console.error("No JSON object or array found in the response string.",e),new Error(`AI response did not contain a valid JSON structure. Raw response: ${e.substring(0,500)}...`);const c=a===-1?o:o===-1?a:Math.min(a,o),u=t.lastIndexOf("}"),p=t.lastIndexOf("]"),h=Math.max(u,p);c>-1&&h>c&&(t=t.substring(c,h+1))}try{return JSON.parse(t)}catch(a){throw console.error("Failed to parse JSON response:",a,`
Original text:`,e,`
Processed string:`,t),new Error(`Failed to parse AI response as JSON. Raw response: ${e.substring(0,500)}...`)}},Br=(e,t)=>{console.error(`Error in Gemini API call during ${t}:`,e);let n=`AI (${t})`;if(e instanceof Error){const r=e.message.toLowerCase();r.includes("api key not valid")||r.includes("api key is invalid")?n="API(API key not valid. Please pass a valid API key.)":r.includes("quota")?n="APIGoogle AI Platform(You have exceeded your API quota.)":n=`AI (${t}): ${e.message}`}throw new Error(n)},_M=async(e,t)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
    You are an expert project planner. Your task is to break down a high-level project goal into a sequence of actionable tasks.
    CONTEXT:
    - Project Goal: "${e}"
    - Target Completion Date: "${t}"
    INSTRUCTIONS:
    1.  Generate a sequence of 3 to 7 high-level, actionable tasks.
    2.  Provide a concise title (max 10 words) and a brief description (1-2 sentences) for each.
    3.  Your response MUST be a single, valid JSON array of objects. Do NOT include any explanations or markdown fences.
    4.  The language of the output should match the language of the input goal.
    5.  Each object MUST have this structure: { "id": "unique_string_id", "title": "Task Title", "description": "Task Description" }
  `;try{const r=await Bt.models.generateContent({model:Ur,contents:n,config:{responseMimeType:"application/json"}}),a=Zr(r.text);if(!a||!Array.isArray(a)||a.some(o=>!o.id||!o.title||!o.description))throw new Error("AI returned an unexpected format for project tasks.");return a}catch(r){Br(r,"project plan generation")}},EM=async e=>{var n;if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const t=`
    You are a project management expert. Analyze the given task and propose a list of concrete next steps to accomplish it.
    CONTEXT:
    - Task Title: "${e.title}"
    - Task Description: "${e.description}"
    - Required Resources: "${((n=e.extendedDetails)==null?void 0:n.resources)||"Not specified"}"
    INSTRUCTIONS:
    1.  Generate a list of 3 to 6 actionable proposals (sub-steps).
    2.  Each proposal must have a concise 'title' and a 'description'.
    3.  Focus on breaking down the main task into logical phases or components.
    4.  Your response MUST be a single, valid JSON array of objects. Do not include any explanations.
    5.  The language must match the input task language.
    6.  The JSON structure for each item must be: { "title": "...", "description": "..." }
  `;try{const r=await Bt.models.generateContent({model:Ur,contents:t,config:{responseMimeType:"application/json"}}),a=Zr(r.text);if(!a||!Array.isArray(a)||a.some(o=>!o.title||!o.description))throw new Error("AI returned an unexpected format for step proposals.");if(a.length===0)throw new Error("AI did not generate any proposals. The task might be too abstract.");return a}catch(r){Br(r,"step proposal generation")}},SM=async(e,t)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a senior project analyst AI. Your task is to intelligently update a list of critical project decisions based on the latest task data. You will merge new findings with an existing list.

        CONTEXT:
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Ei(e))}
        - Existing Decisions List: ${JSON.stringify(t)}
        - Today's Date: ${new Date().toISOString().split("T")[0]}

        INSTRUCTIONS:
        1.  **Analyze Task Data**: Holistically review the 'Full Task Data' to understand the current state, including sub-steps, action items, and notes.
        2.  **Review Existing Decisions**: Go through each item in the 'Existing Decisions List'.
        3.  **Merge and Update**:
            *   **For each existing decision**: Check if the latest task data provides new information.
                *   If an 'undecided' item now has a clear answer in the task data, update its 'status' to 'decided', fill in the 'decision' and 'reasoning', and set the 'date'.
                *   You may also refine the 'question' or 'reasoning' of existing items if the new data provides more clarity.
                *   Keep the original 'id' for all existing items.
            *   **Identify New Decisions**: Look for any *new* critical questions or decision points in the task data that are NOT present in the existing list.
            *   For each new decision you find, create a new decision object.
        4.  **Construct Final List**: Your output MUST be a single JSON array containing the complete, merged list of decisions. This list must include:
            *   All the original decisions, updated as necessary.
            *   All the newly identified decisions.
        5.  **JSON Structure**: Every object in the output array MUST strictly follow this structure. For new items, you MUST set the 'id' field to 'NEW'. For existing items, you MUST preserve their original 'id'.
            {
              "id": "string (original ID or 'NEW' for new items)",
              "question": "The question that needs a decision.",
              "decision": "The final outcome (string, or empty string for 'undecided').",
              "reasoning": "Justification for the decision, or explanation of importance for 'undecided'.",
              "date": "YYYY-MM-DD (string, or empty string for 'undecided').",
              "status": "'decided' or 'undecided'."
            }
        6.  **Language and Format**: The output language must match the input task language. The response must be only the JSON array, without any markdown or explanations.
    `;try{const r=await Bt.models.generateContent({model:Ur,contents:n,config:{responseMimeType:"application/json"}}),a=Zr(r.text);if(!a||!Array.isArray(a)||a.some(o=>!o.question||!o.status||!o.id))throw new Error("AI returned an unexpected format for decisions. Expected fields: id, question, status.");return a}catch(r){Br(r,"decision generation")}},CM=async(e,t)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a professional presentation designer and project analyst. Your task is to create a project status report slide deck based on ALL the provided data.
        CONTEXT:
        - Overall Project Goal: "${t}"
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Ei(e))}
        INSTRUCTIONS:
        1.  Generate a comprehensive slide deck (5-8 slides).
        2.  The response MUST be a single, valid JSON object. Do NOT use markdown.
        3.  The JSON must follow this structure: { "slides": [ { "id": "...", "layout": "...", "isLocked": false, "elements": [ ... ] } ] }.
        4.  Available element types: 'textbox', 'image', 'table', 'chart', 'flowchart'.
        5.  For 'textbox' elements, you MUST use a "content" field for the text.
        6.  **CRITICAL SYNTHESIS**:
            - Create a title slide and an overview slide.
            - **Flowchart Slide**: If the task has sub-steps, create one slide dedicated to visualizing the workflow. This slide should have a 'textbox' title (e.g., "") and a 'flowchart' element. The 'flowchart' element must have this structure: \`{"id": "...", "type": "flowchart", "position": {"x": 5, "y": 15, "width": 90, "height": 75}, "data": {"subSteps": [...]}}\`. You MUST copy the entire 'subSteps' array from the input JSON into the \`data.subSteps\` field.
            - **Decision Log Slide**: If the task's 'extendedDetails.decisions' array is present and not empty, create a dedicated slide titled "". Use textboxes to create a clear summary. For each 'decided' item, show the question and decision. For 'undecided' items, list the question and why it's important.
            - **ACTION ITEM FOCUS**: For significant Sub-Steps, create additional summary slides. Analyze 'actionItems' and report on completion status.
            - Create slides for key challenges and a final summary.
        7.  Write concise, professional text in the same language as the input task.
        8.  Position elements logically. Do not let them overlap.
    `;try{const r=await Bt.models.generateContent({model:Ur,contents:n,config:{responseMimeType:"application/json"}}),a=Zr(r.text);if(!a||!Array.isArray(a.slides))throw new Error("AI returned an invalid format for the slide deck.");return a.slides.forEach(o=>{o.elements.forEach(c=>{c.type==="textbox"&&typeof c.text<"u"&&(c.content=c.text,delete c.text)})}),a}catch(r){Br(r,"initial slide deck generation")}},wM=async(e,t,n)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a presentation designer and project analyst. Your task is to update a project status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Updated Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Ei(t))}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(Ku(e))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked), REGENERATE their content from scratch based on the 'updatedTaskData'.
      3.  This includes regenerating 'flowchart' slides to reflect the latest sub-step data.
      4.  **ACTION ITEM FOCUS**: When regenerating, pay close attention to the progress and reports within each sub-step's 'actionItems'.
      5.  The final output MUST be a single, valid JSON object representing the complete slide deck, with all slides (locked and regenerated) in their original order.
      6.  Follow the same JSON structure and rules as the initial generation.
    `;try{const a=await Bt.models.generateContent({model:Ur,contents:r,config:{responseMimeType:"application/json"}}),o=Zr(a.text);if(!o||!Array.isArray(o.slides))throw new Error("AI returned an invalid format for the regenerated slide deck.");return o}catch(a){Br(a,"slide deck regeneration")}},AM=async e=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const t=`
        You are an expert presentation designer. The following JSON represents a slide deck.
        Analyze its content and structure. Your task is to improve the layout, wording, and visual hierarchy for maximum clarity and impact.
        You can rephrase text for conciseness, change element positions and sizes, and adjust font properties. Do not change element types or IDs.
        Return the updated slide deck as a valid JSON object with the exact same structure as the input. Do not use markdown.
        CRITICAL: Textbox elements use a "content" field, NOT a "text" field.
        
        Input Deck (pruned for brevity):
        ${JSON.stringify(Ku(e))}
    `;try{const n=await Bt.models.generateContent({model:Ur,contents:t,config:{responseMimeType:"application/json"}}),r=Zr(n.text);if(!r||!Array.isArray(r.slides))throw new Error("AI returned an invalid format for the optimized slide deck.");return r}catch(n){Br(n,"slide layout optimization")}},bM=async(e,t,n)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a senior project manager AI. Your task is to conduct a holistic health check of the entire project.
      CONTEXT:
      - Overall Project Goal: "${t}"
      - Final Target Date: "${n}"
      - Current Date: "${new Date().toISOString().split("T")[0]}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Ei(e),null,2)}

      INSTRUCTIONS:
      1.  **Holistic Analysis**: Review ALL provided data. Compare task/sub-step due dates with the current date. Analyze dependencies, blockers, and the completion rate of action items.
      2.  **Determine Overall Status**: Categorize the project's health as 'On Track', 'At Risk', or 'Off Track'.
      3.  **Identify Positives**: List 2-3 key accomplishments or areas that are progressing well.
      4.  **Identify Concerns**: List the most critical risks or issues. For each, explain WHY it's a concern (e.g., "Task 'X' is 2 weeks overdue and blocking 3 other tasks"). Note the related task IDs.
      5.  **Propose Solutions**: For each major concern, provide concrete, actionable suggestions for improvement. (e.g., "Re-allocate resources from Task Y to Task X", "Hold a risk mitigation meeting for Z").
      6.  **Summarize**: Write a concise, executive-level summary of the project's current state.
      7.  **JSON Output**: Your response MUST be a single, valid JSON object following the ProjectHealthReport structure. Do not include markdown or explanations.
      8.  **The output language MUST be Japanese.**

      JSON Structure to follow:
      {
        "overallStatus": "'On Track' | 'At Risk' | 'Off Track'",
        "summary": "string",
        "positivePoints": ["string"],
        "areasOfConcern": [{ "description": "string", "relatedTaskIds": ["string"] }],
        "suggestions": ["string"]
      }
    `;try{const a=await Bt.models.generateContent({model:Ur,contents:r,config:{responseMimeType:"application/json"}}),o=Zr(a.text);if(!o||!o.overallStatus||!o.summary)throw new Error("AI returned an invalid format for the project health report.");return o}catch(a){Br(a,"project health report generation")}},kM=async(e,t,n)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
        You are a senior project analyst AI. Your task is to create a comprehensive slide deck summarizing the ENTIRE project status.
        CONTEXT:
        - Overall Project Goal: "${t}"
        - Final Target Date: "${n}"
        - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Ei(e),null,2)}
        INSTRUCTIONS:
        1.  Synthesize a comprehensive slide deck (6-10 slides) summarizing the entire project.
        2.  The response MUST be a single, valid JSON object following the SlideDeck structure. Do NOT use markdown.
        3.  The output language MUST be Japanese.
        4.  **CRITICAL SYNTHESIS**:
            - **Title & Overview**: Create a title slide and a project overview slide.
            - **Task Summary & Flowchart**: For each major task in the 'tasks' array, create one or two summary slides. One slide should show a \`flowchart\` of its sub-steps if they exist, following the structure \`{"type": "flowchart", "data": {"subSteps": [...]}}\`. You MUST copy the task's specific \`subSteps\` array from the input JSON into the \`data.subSteps\` field. Another slide can summarize the task's status and outcomes.
            - **Key Project Decisions**: Analyze the 'decisions' data from all tasks. Create a dedicated slide titled "". List the top 3-5 most important 'decided' items and their outcomes. Separately, list any critical 'undecided' questions that pose a risk to the project timeline or goals.
            - **Key Achievements & Risks**: Create dedicated slides for significant achievements and project-level risks.
            - **Conclusion**: A final slide summarizing the project's outlook and next steps.
        5.  Use the standard JSON format for slides and elements. Remember "content" for textboxes.
    `;try{const a=await Bt.models.generateContent({model:Ur,contents:r,config:{responseMimeType:"application/json"}}),o=Zr(a.text);if(!o||!Array.isArray(o.slides))throw new Error("AI returned an invalid format for the project slide deck.");return o}catch(a){Br(a,"project report deck generation")}},NM=async(e,t,n,r)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const a=`
      You are a senior project analyst AI. Your task is to update a project-wide status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Final Target Date: "${r}"
      - Updated Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Ei(t),null,2)}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(Ku(e))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked slides), REGENERATE their content from scratch based on the updated project data.
      3.  This includes regenerating any 'flowchart' elements on unlocked slides to show the latest sub-step data.
      4.  Synthesize information across all tasks to provide a holistic project view in the regenerated slides.
      5.  The final output MUST be a single, valid JSON object for the complete slide deck, in the original slide order.
      6.  The output language MUST be Japanese.
    `;try{const o=await Bt.models.generateContent({model:Ur,contents:a,config:{responseMimeType:"application/json"}}),c=Zr(o.text);if(!c||!Array.isArray(c.slides))throw new Error("AI returned an invalid format for the regenerated project slide deck.");return c}catch(o){Br(o,"project report deck regeneration")}},MM=e=>{const t=e.match(/^data:(.+);base64,(.*)$/);return t?{mimeType:t[1],data:t[2]}:null},gT=e=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const t=[];for(const n of e){if(t.push({text:`
--- START OF SOURCE: ${n.name} ---
`}),n.type==="image"&&typeof n.content=="string"){const r=MM(n.content);r?t.push({inlineData:{mimeType:r.mimeType,data:r.data}}):t.push({text:"[Image data was invalid or in wrong format]"})}else if(n.type==="json"){const r=n.content.slides?Ku(n.content):Ei(n.content);t.push({text:`Type: JSON Data
Content: ${JSON.stringify(r,null,2)}`})}else t.push({text:`Type: Text
Content: ${n.content}`});t.push({text:`
--- END OF SOURCE: ${n.name} ---
`})}return t},xT=async(e,t)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are a professional presentation designer AI. Your task is to create a slide deck based on a user's objective and provided source materials.

        **USER OBJECTIVE**: "${t}"

        **CRITICAL INSTRUCTIONS**:
        1.  **Strict JSON Output**: Your entire response MUST be a single, valid JSON object. Do NOT include any text, explanations, or markdown fences (like \`\`\`json\`) outside of the JSON object. Your response should start with \`{\` and end with \`}\`.
        2.  **Schema Adherence**: The JSON object MUST strictly conform to the following TypeScript interfaces for \`SlideDeck\`, \`Slide\`, and \`SlideElement\`.
            \`\`\`typescript
            // The main container for the presentation
            interface SlideDeck {
              slides: Slide[];
              theme?: 'light' | 'dark' | 'business';
            }

            // Represents a single slide in the deck
            interface Slide {
              id: string; // A unique identifier for the slide
              layout: 'title_slide' | 'title_and_content' | 'section_header' | 'two_column' | 'blank';
              elements: SlideElement[];
              isLocked?: boolean; // Must be false for all generated slides
              notes?: string; // Optional speaker notes
            }

            // Union type for all possible elements on a slide
            type SlideElement = TextboxElement | ImageElement | TableElement | ChartElement | FlowchartElement;

            // Base interface for all elements
            interface BaseSlideElement {
              id: string; // A unique identifier for the element
              type: 'textbox' | 'image' | 'table' | 'chart' | 'flowchart';
              position: { x: number; y: number; width: number; height: number; }; // Position in percentages
            }

            // For displaying text
            interface TextboxElement extends BaseSlideElement {
              type: 'textbox';
              content: string; // IMPORTANT: The text content field MUST be named "content".
            }
            
            // For displaying an image from the source materials
            interface ImageElement extends BaseSlideElement {
              type: 'image';
              // You MUST find a relevant image from the source materials and reference its properties here.
              // These IDs must correspond to actual data in the sources provided.
              subStepId: string;
              actionItemId: string; 
              attachmentId: string;
            }

            // For displaying a flowchart of sub-steps
            interface FlowchartElement extends BaseSlideElement {
                type: 'flowchart';
                // You MUST copy the entire 'subSteps' array from the source task data into this field.
                data: {
                    subSteps: any[]; 
                };
            }
            \`\`\`
        3.  **Content Synthesis**:
            *   Analyze ALL provided source materials to create a coherent 4-7 slide presentation that directly addresses the user's objective.
            *   If image sources are provided, you MUST incorporate them into the slides using the 'image' element type.
            *   Do not just copy-paste. Interpret, summarize, and visualize the information effectively.
        4.  **Language**: The output language MUST be Japanese.
        5.  **IDs**: Generate unique string IDs for all 'id' fields in slides and elements.

        **SOURCE MATERIALS FOLLOW**:
    `},...gT(e)];r.push({text:`
Reminder: Create the slide deck now based on the objective and all the sources provided above. The response must be only the JSON object.`});try{const a=await Bt.models.generateContent({model:Ur,contents:{parts:r},config:{responseMimeType:"application/json"}}),o=Zr(a.text);if(!o||!Array.isArray(o.slides))throw new Error("AI returned an invalid format for the custom slide deck.");return o}catch(a){Br(a,"custom slide deck generation")}},RM=async(e,t)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are an expert project analyst. Your task is to write a text-based report based on a specific user objective and a collection of source materials.
        USER OBJECTIVE:
        "${t}"
        INSTRUCTIONS:
        1.  Synthesize the information from ALL provided source materials to create a coherent and insightful report that directly addresses the user's objective.
        2.  Do not simply copy-paste data. Interpret and summarize the information in a clear, professional manner.
        3.  Format the output using Markdown for readability (e.g., use headings, bullet points, bold text).
        4.  If image sources are provided, reference them by name in your report (e.g., "(see image: 'chart.png')"). Do not try to embed them.
        5.  The language of the output should be Japanese.
        6.  Your response MUST be only the text report. Do not include any other explanations.
        SOURCE MATERIALS FOLLOW:
    `},...gT(e)];r.push({text:`
Reminder: Write the report now based on the objective and all the sources provided above. The response must be only the text report.`});try{return(await Bt.models.generateContent({model:Ur,contents:{parts:r}})).text}catch(a){Br(a,"custom text report generation")}},yv=async(e,t,n)=>{if(!Bt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a project management assistant AI. Your task is to convert a project structure into data for a Gantt chart.
      CONTEXT:
      - Project Goal: "${t}"
      - Project Start Date: "${new Date().toISOString().split("T")[0]}"
      - Project Target End Date: "${n}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Ei(e),null,2)}

      INSTRUCTIONS:
      1.  Create a flat list of items for the Gantt chart. Include every ProjectTask, every SubStep, and every ActionItem from all tasks.
      2.  For each item, generate a JSON object with this exact structure:
          { "id": "string", "name": "string", "start": "YYYY-MM-DD", "end": "YYYY-MM-DD", "progress": number, "dependencies": ["string"], "type": "'task' | 'substep' | 'actionitem'", "parentId": "string | null" }
      3.  **Date Estimation**:
          - The project must fit between the start and target dates.
          - Use an item's \`dueDate\` as its 'end' date if available for tasks and sub-steps.
          - Estimate 'start' and 'end' dates logically. An item must start after its dependencies end.
          - For 'actionitem', estimate a short duration (e.g., 1-2 days) within the parent sub-step's timeframe.
      4.  **Progress Calculation**:
          - For a 'task': 'Completed' is 100, 'Not Started' is 0. For 'In Progress' or 'Blocked', average the progress of its sub-steps. If no sub-steps, 'In Progress' is 50.
          - For a 'substep': Calculate progress from its \`actionItems\` (% of completed items). If no action items, use its \`status\`: 'Completed' is 100, 'In Progress' is 50, 'Not Started' is 0.
          - For an 'actionitem': 'completed: true' is 100, 'completed: false' is 0.
      5.  **Dependencies & Parent ID**:
          - **Rule**: The 'dependencies' array models the sequential workflow. A dependency can ONLY exist between items of the SAME \`type\` AND with the SAME \`parentId\`.
          - **Tasks**: A task's 'parentId' is ALWAYS null. Use \`nextTaskIds\` to establish dependencies between tasks.
          - **Sub-steps**: A sub-step's 'parentId' MUST BE the ID of its parent ProjectTask. Use \`nextSubStepIds\` to establish dependencies ONLY between sub-steps within the same task.
          - **Action Items**: An action item's 'parentId' MUST BE the ID of its parent SubStep. Create sequential dependencies ONLY between action items within the same sub-step (item 2 depends on item 1, etc.).
          - **CRITICAL**: Do NOT create dependencies across different parents (e.g., from a sub-step in Task A to one in Task B) or across different types (e.g., from a task to a sub-step).
      6.  Your response MUST be a single, valid JSON array of GanttItem objects. Do not use markdown.
    `;try{const a=await Bt.models.generateContent({model:Ur,contents:r,config:{responseMimeType:"application/json"}}),o=Zr(a.text);if(!o||!Array.isArray(o))throw new Error("AI returned an invalid format for the Gantt chart data.");return o}catch(a){Br(a,"Gantt chart data generation")}},Lr=({size:e="md",color:t="border-blue-500",text:n})=>{const r={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return v.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[v.jsx("div",{className:`animate-spin rounded-full border-4 ${t} border-t-transparent ${r[e]}`}),n&&v.jsx("p",{className:"text-slate-600 text-sm",children:n})]})},vT=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18.75h.008v.008H9.75v-.008ZM7.5 18.75h.008v.008H7.5v-.008ZM14.25 15h.008v.008H14.25v-.008ZM16.5 15h.008v.008H16.5v-.008ZM14.25 18.75h.008v.008H14.25v-.008ZM16.5 18.75h.008v.008H16.5v-.008Z"})}),yT=e=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m12 12 4.243 4.243"})]}),DM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),xr=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),TT=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),_T=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),Zu=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),Iu=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Ia=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),gh=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Al=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),ET=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a15.055 15.055 0 0 1-3 0M12.75 4.5v-.75a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75m0 0A2.25 2.25 0 0 0 9.75 6.75h4.5A2.25 2.25 0 0 0 12.75 4.5M12 18.75h.008v.008H12v-.008Z"})}),Jd=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),IM=({title:e,...t})=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[e&&v.jsx("title",{children:e}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75V12m0 0H9.75M12 12h2.25m-2.25 0V9.75M12 12v2.25m0 0H9.75M12 14.25h2.25M12 6.75a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Zm0 0V3m0 3.75h.008v.008H12V6.75Zm-5.25 0H3.75m0 0V3m0 3.75h.008v.008H3.75V6.75Zm10.5 0h2.25m0 0V3m0 3.75h.008v.008H16.5V6.75Z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),xh=e=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75h16.5v16.5H3.75V3.75Z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3 6-6"})]}),vh=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25-2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"})}),FM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),yh=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),LM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),OM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),PM=e=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113A.375.375 0 0 1 9.75 15.113V8.887c0-.286.307-.466.557-.332l5.603 3.118Z"})]}),UM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Th=e=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008H16.5V3.75zm-3.75 0h.008v.008H12.75V3.75zm-3.75 0h.008v.008H9V3.75zm-3.75 0h.008v.008H5.25V3.75z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.5h18M9.75 16.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-4.5z"})]}),BM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),VM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),GM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15 6-6m0 0-6-6m6 6H3a6 6 0 0 0 0 12h3"})}),ho=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81"})}),_h=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m0 0H3.375c-.621 0-1.125-.504-1.125-1.125v-12.75c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v12.75c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m17.25 0v-12.75a1.125 1.125 0 0 0-1.125-1.125H3.375A1.125 1.125 0 0 0 2.25 4.5v12.75c0 .621.504 1.125 1.125 1.125M12 4.5v15m0 0H9m3 0h3"})}),HM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...e,children:v.jsx("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z",clipRule:"evenodd"})}),zM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...e,children:v.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2.5a2.5 2.5 0 00-2.5 2.5V9h5V7a2.5 2.5 0 00-2.5-2.5z"})}),es=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.5 17.25l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 13.5l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 17.25l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),Xd=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5H18v2.25H6.75V7.5zM3 12h3v6.75a2.25 2.25 0 002.25 2.25h9.75a2.25 2.25 0 002.25-2.25V12h3m-3.498 6.75H15"})}),jM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 11.25v-4.5m0 4.5h-4.5m4.5 0L15 15"})}),qM=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9V4.5M15 9h4.5M15 9l5.25-5.25M15 15v4.5M15 15h4.5M15 15l5.25 5.25"})}),ST=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),Ul=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),Bl=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...e,children:v.jsx("path",{d:"M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),ts=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...e,children:v.jsx("path",{d:"M7.247 11.14l-4.796-5.481c-.566-.647-.106-1.659.753-1.659h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}),CT=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25z"})}),YM=({onSubmit:e,isLoading:t,onImportProject:n,onLoadTemplate:r,initialGoal:a="",initialDate:o=""})=>{const[c,u]=ge.useState(a),[p,h]=ge.useState(o),g=ge.useRef(null);so.useEffect(()=>{u(a)},[a]),so.useEffect(()=>{h(o)},[o]);const y=new Date().toISOString().split("T")[0],_=M=>{if(M.preventDefault(),!c.trim()||!p){alert("");return}e(c,p)},E=()=>{var M;(M=g.current)==null||M.click()},S=M=>{var b;const k=(b=M.target.files)==null?void 0:b[0];k&&(n(k),M.target.value="")},C=M=>{if(!c.trim()||!p){alert("");return}r(M,c,p)},w=({template:M,title:k,description:b,disabled:U})=>v.jsxs("button",{type:"button",onClick:()=>C(M),disabled:U,className:"text-left p-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105",children:[v.jsx("div",{className:"font-semibold text-md",children:k}),v.jsx("div",{className:"text-xs text-purple-200 mt-1",children:b})]});return v.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[v.jsxs("div",{className:"w-full max-w-2xl bg-white shadow-2xl rounded-xl p-8 md:p-12",children:[v.jsxs("div",{className:"text-center mb-10",children:[v.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"AI"}),v.jsx("p",{className:"text-slate-600 text-lg",children:"AI"})]}),v.jsxs("form",{onSubmit:_,className:"space-y-6",children:[v.jsxs("div",{children:[v.jsxs("label",{htmlFor:"projectGoal",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[v.jsx(yT,{className:"w-5 h-5 mr-2 text-blue-600"})," ()"]}),v.jsx("textarea",{id:"projectGoal",value:c,onChange:M=>u(M.target.value),placeholder:": E1000",rows:3,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100 placeholder-slate-400"})]}),v.jsxs("div",{children:[v.jsxs("label",{htmlFor:"targetDate",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[v.jsx(vT,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),v.jsx("input",{type:"date",id:"targetDate",value:p,onChange:M=>h(M.target.value),min:y,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100",style:{colorScheme:"dark"}})]}),v.jsx("p",{className:"text-sm text-slate-500 text-center",children:""}),v.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[v.jsx("button",{type:"submit",disabled:t,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:t?v.jsx(Lr,{size:"sm",color:"border-white"}):"AI"}),v.jsxs("button",{type:"button",onClick:E,disabled:t,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:[v.jsx(_T,{className:"w-5 h-5 mr-2"})," (.json)"]}),v.jsx("input",{type:"file",ref:g,onChange:S,accept:".json",className:"hidden","aria-hidden":"true"})]}),v.jsxs("div",{className:"sm:col-span-2 pt-4",children:[v.jsx("p",{className:"text-center text-sm font-semibold text-slate-600 mb-3",children:":"}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[v.jsx(w,{template:"process-design",disabled:t,title:" (APQP)",description:"APQP"}),v.jsx(w,{template:"process-change",disabled:t,title:" (ISO/IATF)",description:""}),v.jsx(w,{template:"new-product-eval",disabled:t,title:"",description:""}),v.jsx(w,{template:"improvement-project",disabled:t,title:"",description:"DMAIC"}),v.jsx(w,{template:"equipment-modification",disabled:t,title:"",description:""})]})]})]})]}),v.jsx("footer",{className:"mt-12 text-center",children:v.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},du=e=>{switch(e){case Ct.IN_PROGRESS:return{icon:v.jsx(PM,{className:"w-3.5 h-3.5"}),color:"text-blue-700",text:"",bgColor:"bg-blue-100"};case Ct.COMPLETED:return{icon:v.jsx(gh,{className:"w-3.5 h-3.5"}),color:"text-green-700",text:"",bgColor:"bg-green-100"};case Ct.BLOCKED:return{icon:v.jsx(UM,{className:"w-3.5 h-3.5"}),color:"text-red-700",text:"",bgColor:"bg-red-100"};case Ct.NOT_STARTED:default:return{icon:v.jsx(OM,{className:"w-3.5 h-3.5"}),color:"text-slate-600",text:"",bgColor:"bg-slate-100"}}},$M=({task:e,onSelectTask:t,onRemoveTask:n,onUpdateStatus:r,onDragCardStart:a,index:o,cardRef:c,onStartConnection:u,onEndConnection:p})=>{var X,F,Y,L;const[h,g]=ge.useState(!1),y=ge.useRef(null);ge.useEffect(()=>{const Q=te=>{y.current&&!y.current.contains(te.target)&&g(!1)};return document.addEventListener("mousedown",Q),()=>{document.removeEventListener("mousedown",Q)}},[y]);const _=Q=>{r(e.id,Q),g(!1)},E=(X=e.extendedDetails)==null?void 0:X.numericalTarget;let S="text-slate-500";E&&(E.status===Nd.ACHIEVED?S="text-green-600":E.status===Nd.MISSED?S="text-red-600":S="text-yellow-600");const C=du(e.status),w=(F=e.extendedDetails)==null?void 0:F.dueDate,M=w?new Date(w+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"short",day:"numeric"}):null,k=e.status===Ct.IN_PROGRESS,b="task-card-in-flow bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 w-80 md:w-96 m-1 cursor-grab active:cursor-grabbing",U=k?"border-4 border-blue-500 ring-2 ring-blue-500 ring-offset-1":"border border-transparent",B=Q=>{Q.stopPropagation(),u(e.id,Q)};return v.jsxs("div",{ref:c,id:`taskcard-${e.id}`,draggable:"true",onDragStart:Q=>a(Q,e.id),onMouseUp:()=>p(e.id),className:`${b} ${U}`,style:{position:"absolute",left:((Y=e.position)==null?void 0:Y.x)||0,top:((L=e.position)==null?void 0:L.y)||0,touchAction:"none"},children:[v.jsxs("div",{className:"p-5 relative",children:[v.jsx("div",{onMouseDown:B,className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-500 border-2 border-white rounded-full cursor-crosshair hover:scale-125 transition-transform z-10",title:""}),v.jsxs("div",{className:"flex items-start justify-between mb-2",children:[v.jsxs("div",{className:"flex items-center flex-grow min-w-0 mr-2",children:[v.jsx("span",{className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-xs mr-3 flex-shrink-0",children:o+1}),v.jsx("div",{className:"flex-grow min-w-0",children:v.jsx("div",{className:"text-lg font-bold text-slate-900 break-words","aria-label":`task title for ${e.title}`,children:e.title})})]}),v.jsxs("div",{className:"flex space-x-1 flex-shrink-0 items-center",children:[E&&v.jsx(IM,{className:`w-5 h-5 ${S}`,title:`: ${E.description} (${E.status})`}),v.jsx("button",{onClick:Q=>{Q.stopPropagation(),t(e)},className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded-full hover:bg-blue-100",title:"","aria-label":`: ${e.title}`,children:v.jsx(DM,{className:"w-5 h-5"})}),v.jsx("button",{onClick:Q=>{Q.stopPropagation(),n(e.id)},className:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-100",title:"","aria-label":`: ${e.title}`,children:v.jsx(Ia,{className:"w-5 h-5"})})]})]}),v.jsx("div",{className:"h-20 mb-3",children:v.jsx("p",{className:"text-slate-800 text-sm leading-relaxed line-clamp-4 overflow-hidden h-full",children:e.description})}),v.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2",children:[v.jsxs("div",{className:"relative",ref:y,children:[v.jsxs("button",{onClick:()=>g(Q=>!Q),className:`inline-flex items-center px-2 py-0.5 rounded-full cursor-pointer ${C.bgColor} ${C.color} hover:ring-2 hover:ring-offset-1 hover:ring-blue-400 transition-all`,title:"",children:[so.cloneElement(C.icon,{className:`w-3 h-3 mr-1 ${C.color}`}),C.text]}),h&&v.jsx("div",{className:"absolute bottom-full mb-1 w-36 bg-white border border-slate-200 rounded-md shadow-lg z-20 py-1",children:Object.values(Ct).map(Q=>v.jsxs("button",{onClick:()=>_(Q),className:"w-full text-left px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 flex items-center",children:[so.cloneElement(du(Q).icon,{className:`w-3.5 h-3.5 mr-2 ${du(Q).color}`}),du(Q).text]},Q))})]}),M&&v.jsxs("div",{className:"flex items-center text-orange-600",children:[v.jsx(LM,{className:"w-3.5 h-3.5 mr-1"}),": ",M]})]})]}),v.jsx("button",{onClick:Q=>{Q.stopPropagation(),t(e)},className:"block w-full text-left bg-slate-100 hover:bg-slate-200 text-blue-700 font-medium py-3 px-5 transition-colors text-xs border-t border-slate-200",children:" "})]})},JM=ge.memo($M),Wd=({from:e,to:t,id:n,onDelete:r})=>{const c=e.x,u=t.x,p=(c+u)/2,h=(e.y+t.y)/2,g=`M${c},${e.y} C${c+50},${e.y} ${u-50},${t.y} ${u},${t.y}`;return v.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},"aria-hidden":"true",children:[v.jsx("defs",{children:v.jsx("marker",{id:`arrowhead-${n}`,markerWidth:8,markerHeight:8*.7,refX:8,refY:8*.35,orient:"auto",markerUnits:"strokeWidth",children:v.jsx("path",{d:`M0,0 L8,${8*.35} L0,${8*.7} Z`,fill:"#64748b"})})}),v.jsxs("g",{style:{pointerEvents:r?"auto":"none"},children:[v.jsx("path",{d:g,stroke:"#64748b",strokeWidth:2,markerEnd:`url(#arrowhead-${n})`,fill:"none"}),v.jsx("path",{d:g,stroke:"transparent",strokeWidth:"16",fill:"none",className:r?"cursor-pointer group":"",onClick:r}),r&&v.jsxs("g",{transform:`translate(${p}, ${h})`,className:"opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:r,children:[v.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"white",stroke:"#ef4444",strokeWidth:"1"}),v.jsx("path",{d:"M -3.5 -3.5 L 3.5 3.5 M -3.5 3.5 L 3.5 -3.5",stroke:"#ef4444",strokeWidth:"1.5",strokeLinecap:"round"})]})]})]})},XM=({tasks:e,onClose:t})=>{const[n,r]=ge.useState("all"),[a,o]=ge.useState(""),[c,u]=ge.useState(null),p=ge.useMemo(()=>{const S=[];return e.forEach(C=>{var w,M;(M=(w=C.extendedDetails)==null?void 0:w.subSteps)==null||M.forEach(k=>{var b;(b=k.actionItems)==null||b.forEach(U=>{S.push({actionItem:U,subStep:k,task:C})})})}),S},[e]),h=ge.useMemo(()=>p.filter(S=>n==="completed"?S.actionItem.completed:n==="pending"?!S.actionItem.completed:!0).filter(S=>{const C=a.toLowerCase();return S.actionItem.text.toLowerCase().includes(C)||S.subStep.text.toLowerCase().includes(C)||(S.subStep.responsible||"").toLowerCase().includes(C)||S.task.title.toLowerCase().includes(C)}),[p,n,a]),g=ge.useMemo(()=>{let S=[...h];return c!==null&&S.sort((C,w)=>{let M="",k="";switch(c.key){case"status":M=C.actionItem.completed,k=w.actionItem.completed;break;case"actionItem":M=C.actionItem.text.toLowerCase(),k=w.actionItem.text.toLowerCase();break;case"responsible":M=(C.subStep.responsible||"").toLowerCase(),k=(w.subStep.responsible||"").toLowerCase();break;case"subStep":M=C.subStep.text.toLowerCase(),k=w.subStep.text.toLowerCase();break;case"task":M=C.task.title.toLowerCase(),k=w.task.title.toLowerCase();break;case"dueDate":M=C.actionItem.dueDate||C.subStep.dueDate||"9999-12-31",k=w.actionItem.dueDate||w.subStep.dueDate||"9999-12-31";break}return M<k?c.direction==="ascending"?-1:1:M>k?c.direction==="ascending"?1:-1:0}),S},[h,c]),y=S=>{let C="ascending";c&&c.key===S&&c.direction==="ascending"&&(C="descending"),u({key:S,direction:C})},_=S=>!c||c.key!==S?v.jsx(Bl,{className:"w-3 h-3 ml-1 opacity-20"}):c.direction==="ascending"?v.jsx(Bl,{className:"w-3 h-3 ml-1 text-blue-600"}):v.jsx(ts,{className:"w-3 h-3 ml-1 text-blue-600"}),E=({sortKey:S,label:C,className:w})=>v.jsx("th",{scope:"col",className:`px-6 py-3 ${w||""}`,children:v.jsxs("button",{onClick:()=>y(S),className:"flex items-center gap-1 hover:text-blue-600 transition-colors",children:[C,_(S)]})});return v.jsxs("div",{className:"fixed inset-0 bg-slate-100 z-[60] flex flex-col",children:[v.jsx("header",{className:"flex-shrink-0 bg-white shadow-md",children:v.jsxs("div",{className:"flex items-center justify-between p-4 border-b w-full max-w-7xl mx-auto",children:[v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),v.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[v.jsx(TT,{className:"w-5 h-5"}),""]})]})}),v.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden p-4 w-full max-w-7xl mx-auto",children:[v.jsx("div",{className:"p-4 flex-shrink-0 bg-white rounded-t-lg border-x border-t",children:v.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[v.jsx("input",{type:"text",placeholder:"...",value:a,onChange:S=>o(S.target.value),className:"px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm w-full sm:w-auto flex-grow"}),v.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 p-1",children:[v.jsx("button",{onClick:()=>r("all"),className:`px-3 py-1 text-sm rounded-md ${n==="all"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),v.jsx("button",{onClick:()=>r("pending"),className:`px-3 py-1 text-sm rounded-md ${n==="pending"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),v.jsx("button",{onClick:()=>r("completed"),className:`px-3 py-1 text-sm rounded-md ${n==="completed"?"bg-white shadow":"hover:bg-slate-200"}`,children:""})]})]})}),v.jsx("div",{className:"flex-grow overflow-y-auto bg-white rounded-b-lg border",children:v.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[v.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-100 sticky top-0 z-10",children:v.jsxs("tr",{children:[v.jsx(E,{sortKey:"status",label:"",className:"w-24"}),v.jsx(E,{sortKey:"actionItem",label:""}),v.jsx(E,{sortKey:"responsible",label:""}),v.jsx(E,{sortKey:"subStep",label:""}),v.jsx(E,{sortKey:"task",label:""}),v.jsx(E,{sortKey:"dueDate",label:""})]})}),v.jsxs("tbody",{className:"divide-y divide-slate-200",children:[g.map(({actionItem:S,subStep:C,task:w},M)=>v.jsxs("tr",{className:"hover:bg-slate-50",children:[v.jsx("td",{className:"px-6 py-3",children:S.completed?v.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[v.jsx(xh,{className:"w-4 h-4 mr-1"}),""]}):v.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[v.jsx(vh,{className:"w-4 h-4 mr-1"}),""]})}),v.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:S.text}),v.jsx("td",{className:"px-6 py-3",children:C.responsible||""}),v.jsx("td",{className:"px-6 py-3",children:C.text}),v.jsx("td",{className:"px-6 py-3",children:w.title}),v.jsx("td",{className:"px-6 py-3",children:S.dueDate||C.dueDate?new Date((S.dueDate||C.dueDate)+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):""})]},S.id+M)),g.length===0&&v.jsx("tr",{children:v.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:""})})]})]})})]})]})},Tv={"On Track":{bgColor:"bg-green-100",textColor:"text-green-800",icon:v.jsx(gh,{className:"w-12 h-12 text-green-500"})},"At Risk":{bgColor:"bg-yellow-100",textColor:"text-yellow-800",icon:v.jsx(Al,{className:"w-12 h-12 text-yellow-500"})},"Off Track":{bgColor:"bg-red-100",textColor:"text-red-800",icon:v.jsx(Al,{className:"w-12 h-12 text-red-500"})},Unknown:{bgColor:"bg-slate-100",textColor:"text-slate-800",icon:v.jsx(Al,{className:"w-12 h-12 text-slate-500"})}},WM=({report:e,onClose:t})=>{if(!e)return null;const n=Tv[e.overallStatus]||Tv.Unknown;return v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:v.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl h-[90vh] flex flex-col",children:[v.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),v.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-slate-100",children:v.jsx(xr,{className:"w-6 h-6 text-slate-500"})})]}),v.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[v.jsxs("section",{className:`p-6 rounded-lg flex items-center gap-6 ${n.bgColor}`,children:[v.jsx("div",{className:"flex-shrink-0",children:n.icon}),v.jsxs("div",{children:[v.jsx("h4",{className:`text-2xl font-bold ${n.textColor}`,children:e.overallStatus}),v.jsx("p",{className:`mt-1 text-base ${n.textColor}`,children:e.summary})]})]}),v.jsxs("section",{children:[v.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[v.jsx(gh,{className:"w-5 h-5 mr-2 text-green-500"}),""]}),v.jsx("ul",{className:"list-disc list-inside space-y-2 text-slate-600 pl-2",children:e.positivePoints.map((r,a)=>v.jsx("li",{children:r},a))})]}),v.jsxs("section",{children:[v.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[v.jsx(Al,{className:"w-5 h-5 mr-2 text-yellow-500"}),""]}),v.jsx("div",{className:"space-y-3",children:e.areasOfConcern.map((r,a)=>v.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[v.jsx("p",{className:"font-semibold text-yellow-800",children:r.description}),r.relatedTaskIds.length>0&&v.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["ID: ",r.relatedTaskIds.join(", ")]})]},a))})]}),v.jsxs("section",{children:[v.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[v.jsx(ET,{className:"w-5 h-5 mr-2 text-blue-500"}),"AI"]}),v.jsx("div",{className:"space-y-3",children:e.suggestions.map((r,a)=>v.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:v.jsx("p",{className:"text-blue-800",children:r})},a))})]})]}),v.jsx("footer",{className:"p-4 bg-slate-50 border-t flex justify-end",children:v.jsx("button",{onClick:t,className:"px-5 py-2 text-sm font-medium text-white bg-slate-600 rounded-md hover:bg-slate-700",children:""})})]})})},_v=e=>{const t=Math.cos(2*Math.PI*e),n=Math.sin(2*Math.PI*e);return[t,n]},KM=({data:e,title:t})=>{const n=e.reduce((c,u)=>c+u.value,0);if(n===0)return v.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data to display"});let r=0;const a=["#4a90e2","#50e3c2","#f5a623","#f8e71c","#7ed321","#9013fe"],o=e.map((c,u)=>{const p=c.value/n,[h,g]=_v(r);r+=p;const[y,_]=_v(r),E=p>.5?1:0;return{path:[`M ${h} ${g}`,`A 1 1 0 ${E} 1 ${y} ${_}`,"L 0 0"].join(" "),color:a[u%a.length],label:c.label}});return v.jsxs("div",{className:"w-full h-full flex flex-col bg-white p-2",children:[v.jsx("text",{x:"50%",y:"10",textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",className:"block text-center",children:t}),v.jsxs("div",{className:"flex-grow flex items-center",children:[v.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-2/3 h-full",children:o.map((c,u)=>v.jsx("path",{d:c.path,fill:c.color},u))}),v.jsx("div",{className:"w-1/3 text-[8px] space-y-1",children:o.map((c,u)=>v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:c.color}}),v.jsx("span",{className:"truncate",children:c.label})]},u))})]})]})},ZM=({data:e,title:t})=>{const n=Math.max(...e.map(h=>h.value),0),r=300,a=150,o={top:20,right:10,bottom:30,left:30},c=r-o.left-o.right,u=a-o.top-o.bottom,p=e.map((h,g)=>{const y=g/(e.length-1)*c,_=u-h.value/n*u;return`${y},${_}`}).join(" ");return v.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[v.jsx("text",{x:r/2,y:o.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:t}),v.jsxs("g",{transform:`translate(${o.left}, ${o.top})`,children:[v.jsx("line",{x1:"0",y1:"0",x2:"0",y2:u,stroke:"#ddd",strokeWidth:"0.5"}),v.jsx("line",{x1:"0",y1:u,x2:c,y2:u,stroke:"#ddd",strokeWidth:"0.5"}),v.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1.5",points:p}),e.map((h,g)=>{const y=g/(e.length-1)*c,_=u-h.value/n*u;return v.jsx("circle",{cx:y,cy:_,r:"2",fill:"#4a90e2"},g)})]})]})},QM=({data:e,title:t})=>{const n=Math.max(...e.map(h=>h.value),0),r=300,a=150,o={top:20,right:10,bottom:30,left:30},c=r-o.left-o.right,u=a-o.top-o.bottom,p=e.length>0?c/e.length*.8:0;return v.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[v.jsx("text",{x:r/2,y:o.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:t}),v.jsxs("g",{transform:`translate(${o.left}, ${o.top})`,children:[v.jsx("line",{x1:"0",y1:"0",x2:"0",y2:u,stroke:"#999",strokeWidth:"0.5"}),[0,n/2,n].map(h=>v.jsxs("g",{transform:`translate(0, ${u-h/n*u})`,children:[v.jsx("line",{x1:"-3",y1:"0",x2:"0",y2:"0",stroke:"#999",strokeWidth:"0.5"}),v.jsx("text",{x:"-5",y:"3",textAnchor:"end",fontSize:"6",fill:"#666",children:h.toFixed(0)})]},h)),e.map((h,g)=>v.jsxs("g",{transform:`translate(${g*c/e.length+c/e.length*.1}, 0)`,children:[v.jsx("rect",{x:"0",y:u-h.value/n*u,width:p,height:h.value/n*u,fill:"#4a90e2"}),v.jsx("text",{x:p/2,y:u+8,textAnchor:"middle",fontSize:"6",fill:"#666",transform:`rotate(-45, ${p/2}, ${u+8})`,children:h.label})]},h.label))]})]})},eR=({subStep:e,statusColor:t})=>{var n,r;return v.jsx("div",{style:{position:"absolute",left:((n=e.position)==null?void 0:n.x)||0,top:((r=e.position)==null?void 0:r.y)||0,width:192,minHeight:76,padding:"8px",borderRadius:"8px",backgroundColor:"white",borderLeft:`4px solid ${t}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px",fontFamily:"sans-serif",color:"#333",display:"flex",flexDirection:"column",justifyContent:"center"},children:v.jsx("p",{className:`font-bold break-words ${e.status===ar.COMPLETED?"line-through text-slate-500":""}`,children:e.text})})},tR=({subSteps:e})=>{if(!e||e.length===0)return v.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 text-slate-500 text-sm",children:"No sub-steps to display."});const t=c=>{switch(c){case ar.COMPLETED:return"#22c55e";case ar.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},n=192,r=76,a=ge.useMemo(()=>{const c=[];return(e||[]).forEach(u=>{var p;if((p=u==null?void 0:u.nextSubStepIds)!=null&&p.length&&u.position){const h={x:u.position.x+n,y:u.position.y+r/2};u.nextSubStepIds.forEach(g=>{const y=e.find(_=>_.id===g);if(y&&y.position){const _={x:y.position.x,y:y.position.y+r/2};c.push({id:`fc-render-${u.id}-${g}`,from:h,to:_,sourceId:u.id,targetId:g})}})}}),c},[e,n,r]),o=ge.useMemo(()=>{if(!e||e.length===0)return{minX:0,minY:0,width:400,height:300};let c=0,u=0;return e.forEach(p=>{p.position&&(c=Math.max(c,p.position.x+n),u=Math.max(u,p.position.y+r))}),{minX:0,minY:0,width:c+20,height:u+20}},[e,n,r]);return v.jsx("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{fontFamily:"Inter, sans-serif"},children:v.jsxs("svg",{width:"100%",height:"100%",viewBox:`${o.minX} ${o.minY} ${o.width} ${o.height}`,children:[v.jsx("style",{children:`
                    .flowchart-card-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        font-family: Inter, sans-serif;
                    }
                    `}),v.jsx("foreignObject",{x:"0",y:"0",width:o.width,height:o.height,children:v.jsx("div",{className:"flowchart-card-container",children:(e||[]).map(c=>v.jsx(eR,{subStep:c,statusColor:t(c.status)},c.id))})}),a.map(c=>v.jsx(Wd,{from:c.from,to:c.to,id:c.id},c.id))]})})},nR=({el:e,onUpdate:t,children:n,isSelected:r,onClick:a})=>v.jsx("div",{onClick:o=>{o.stopPropagation(),a()},style:{position:"absolute",left:`${e.position.x}%`,top:`${e.position.y}%`,width:`${e.position.width}%`,height:`${e.position.height}%`,outline:r?"2px solid #3b82f6":"1px dashed transparent",cursor:"move"},className:"transition-all duration-150 hover:outline-dashed hover:outline-slate-400",children:n}),Eh=({tasks:e,initialDeck:t,onSave:n,onClose:r,generateUniqueId:a,projectGoal:o,targetDate:c,reportScope:u})=>{const[p,h]=ge.useState(t),[g,y]=ge.useState(0),[_,E]=ge.useState(null),[S,C]=ge.useState(!1),[w,M]=ge.useState(null),[k,b]=ge.useState(!1),U=ge.useRef(null),B=(ne,j)=>{h(N=>({...N,slides:N.slides.map(W=>W.id===ne?{...W,...typeof j=="function"?j(W):W}:W)}))},X=ne=>{const j=p.slides[ne];B(j.id,{isLocked:!j.isLocked})},F=(ne,j,N)=>{B(ne,W=>({elements:W.elements.map(D=>D.id===j?{...D,...N}:D)}))},Y=async()=>{C(!0),M(null);try{const ne={...p,slides:p.slides.map(W=>W.isLocked?W:{...W,isLocked:void 0})},j=await AM(ne),N={...j,slides:j.slides.map((W,D)=>({...W,isLocked:p.slides[D].isLocked}))};h(N)}catch(ne){M(ne instanceof Error?ne.message:"")}finally{C(!1)}},L=async()=>{C(!0),M(null);try{let ne;u==="project"?ne=await NM(p,e,o,c):ne=await wM(p,e[0],o),h(ne)}catch(ne){M(ne instanceof Error?ne.message:"")}finally{C(!1)}},Q=(ne,j)=>{var N,W,D;for(const J of e){const q=(W=(N=J.extendedDetails)==null?void 0:N.subSteps)==null?void 0:W.find(G=>G.id===ne);if(q){const G=(D=q==null?void 0:q.actionItems)==null?void 0:D.find(ie=>ie.id===j);if(G)return G}}},te=ne=>{var j,N,W,D,J;switch(ne.type){case"textbox":const q=ne;return v.jsx("textarea",{value:q.content,onChange:G=>F(p.slides[g].id,ne.id,{content:G.target.value}),className:"w-full h-full bg-transparent resize-none border-none outline-none p-2",style:{fontSize:q.fontSize,fontWeight:q.fontWeight,textAlign:q.textAlign,color:"#333"}});case"image":{const G=ne,ie=Q(G.subStepId,G.actionItemId),ye=(N=(j=ie==null?void 0:ie.report)==null?void 0:j.attachments)==null?void 0:N.find(Ae=>Ae.id===G.attachmentId);return ye?v.jsx("img",{src:ye.dataUrl,className:"w-full h-full object-contain",alt:ye.name}):v.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"table":{const G=ne,ie=Q(G.subStepId,G.actionItemId),ye=(W=ie==null?void 0:ie.report)==null?void 0:W.matrixData;return ye?v.jsx("div",{className:"p-2 overflow-auto h-full",children:v.jsxs("table",{className:"w-full text-[8px] border-collapse bg-white",children:[v.jsx("thead",{children:v.jsx("tr",{className:"bg-slate-200",children:ye.headers.map((Ae,Me)=>v.jsx("th",{className:"border border-slate-300 p-1 font-semibold",children:Ae},Me))})}),v.jsx("tbody",{children:ye.rows.map((Ae,Me)=>v.jsx("tr",{children:Ae.map((Ee,Ze)=>v.jsx("td",{className:"border border-slate-300 p-1",children:Ee},`${Me}-${Ze}`))},Me))})]})}):v.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"chart":{const G=ne,ie=Q(G.subStepId,G.actionItemId),ye=(((J=(D=ie==null?void 0:ie.report)==null?void 0:D.matrixData)==null?void 0:J.rows)||[]).map(Ae=>({label:Ae[0],value:parseFloat(Ae[1])||0})).filter(Ae=>Ae.label&&!isNaN(Ae.value));if(ye.length===0)return v.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""});switch(G.chartType){case"line":return v.jsx(ZM,{data:ye,title:G.title});case"pie":return v.jsx(KM,{data:ye,title:G.title});case"bar":default:return v.jsx(QM,{data:ye,title:G.title})}}case"flowchart":{const G=ne;return G.data&&G.data.subSteps?v.jsx(tR,{subSteps:G.data.subSteps}):v.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}default:return null}},ee=()=>window.print(),_e=(ne,j)=>{const N=JSON.stringify(ne,null,2),W=new Blob([N],{type:"application/json"}),D=URL.createObjectURL(W),J=document.createElement("a");J.href=D,J.download=j,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(D)},De=ne=>{ne==="pdf"?ee():_e(p,"report-deck.json"),b(!1)},Te=()=>{n(p),r()},re=p.slides[g],ce=u==="project"?`: ${o}`:`: ${e[0].title}`;return v.jsxs(v.Fragment,{children:[v.jsx("style",{children:"@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } .no-print { display: none !important; } .slide-print-page { page-break-after: always; width: 100vw; height: 56.25vw; /* 16:9 aspect ratio */ box-shadow: none !important; border: none; } }"}),v.jsxs("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-80 z-[100] flex flex-col p-4 no-print",onClick:()=>E(null),children:[v.jsxs("header",{className:"flex items-center justify-between pb-4 flex-shrink-0",children:[v.jsx("h2",{className:"text-xl font-bold text-white truncate pr-4",children:ce}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsxs("button",{onClick:L,disabled:S,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[v.jsx(yh,{className:"w-4 h-4"})," ",S?"...":""]}),v.jsxs("button",{onClick:Y,disabled:S,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[v.jsx(ET,{className:"w-4 h-4"})," ",S?"...":"AI"]}),v.jsxs("div",{className:"relative",ref:U,children:[v.jsx("button",{onClick:()=>b(ne=>!ne),className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:v.jsx(Zu,{className:"w-5 h-5"})}),k&&v.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-10",children:[v.jsx("button",{onClick:()=>De("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"PDF"}),v.jsx("button",{onClick:()=>De("json"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"JSON"})]})]}),v.jsxs("button",{onClick:r,className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:[" ",v.jsx(xr,{className:"w-5 h-5"})]}),v.jsx("button",{onClick:Te,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold text-sm",children:""})]})]}),w&&v.jsx("div",{className:"text-red-400 text-sm mb-2 bg-red-100 border border-red-400 p-2 rounded-md",children:w}),v.jsxs("div",{className:"flex-grow flex gap-4 min-h-0",children:[v.jsx("aside",{className:"w-40 bg-slate-800 rounded-lg p-2 flex flex-col gap-2 overflow-y-auto",children:p.slides.map((ne,j)=>v.jsxs("div",{onClick:()=>y(j),className:`relative group aspect-video bg-white rounded cursor-pointer transition-all p-1 ${g===j?"ring-4 ring-blue-500":"hover:ring-2 ring-blue-400"}`,children:[v.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-50 group-hover:opacity-100 transition-opacity",children:v.jsx("button",{onClick:N=>{N.stopPropagation(),X(j)},title:ne.isLocked?"":"",className:`p-1 rounded-full ${ne.isLocked?"bg-blue-600 text-white":"bg-slate-500 text-white"}`,children:ne.isLocked?v.jsx(HM,{className:"w-3 h-3"}):v.jsx(zM,{className:"w-3 h-3"})})}),v.jsx("div",{className:"w-full h-full transform scale-[0.1] origin-top-left overflow-hidden relative",children:ne.elements.map(N=>v.jsx("div",{style:{position:"absolute",left:`${N.position.x}%`,top:`${N.position.y}%`,width:`${N.position.width}%`,height:`${N.position.height}%`,backgroundColor:"#ccc"}},N.id))}),v.jsx("span",{className:"text-white text-xs block text-center -mt-2",children:j+1})]},ne.id))}),v.jsx("main",{className:"flex-grow flex items-center justify-center",children:re&&v.jsx("div",{className:"aspect-video w-full max-w-[100vh] bg-white shadow-2xl rounded-lg relative overflow-hidden",children:re.elements.map(ne=>v.jsx(nR,{el:ne,onUpdate:()=>{},isSelected:_===ne.id,onClick:()=>E(ne.id),children:te(ne)},ne.id))})}),v.jsxs("aside",{className:"w-64 bg-slate-800 rounded-lg p-3 text-white overflow-y-auto",children:[v.jsx("h3",{className:"font-bold border-b border-slate-600 pb-2 mb-3",children:""}),v.jsx("p",{className:"text-xs text-slate-400",children:""})]})]})]}),v.jsx("div",{className:"hidden print:block",children:p.slides.map((ne,j)=>v.jsx("div",{className:"slide-print-page bg-white relative",children:v.jsx("div",{className:"w-full h-full relative",children:ne.elements.map(N=>v.jsx("div",{style:{position:"absolute",left:`${N.position.x}%`,top:`${N.position.y}%`,width:`${N.position.width}%`,height:`${N.position.height}%`},children:te(N)},N.id))})},ne.id))})]})},rR=({onClose:e,onDownloadAndStartNew:t,onStartNewWithoutSaving:n})=>v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:v.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[v.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[v.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center",children:[v.jsx(Al,{className:"w-6 h-6 mr-2 text-yellow-500"}),""]}),v.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:v.jsx(xr,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"p-6",children:[v.jsx("p",{className:"text-slate-700",children:""}),v.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"JSON"})]}),v.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 rounded-b-xl",children:[v.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),v.jsx("button",{type:"button",onClick:n,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md shadow-sm hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:""}),v.jsxs("button",{type:"submit",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[v.jsx(Zu,{className:"w-4 h-4"}),""]})]})]})});function aR(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),t&&(r.href=t),a.href=e,a.href}const iR=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function gi(e){const t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}let Js=null;function wT(e={}){return Js||(e.includeStyleProperties?(Js=e.includeStyleProperties,Js):(Js=gi(window.getComputedStyle(document.documentElement)),Js))}function Fu(e,t){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return r?parseFloat(r.replace("px","")):0}function sR(e){const t=Fu(e,"border-left-width"),n=Fu(e,"border-right-width");return e.clientWidth+t+n}function oR(e){const t=Fu(e,"border-top-width"),n=Fu(e,"border-bottom-width");return e.clientHeight+t+n}function AT(e,t={}){const n=t.width||sR(e),r=t.height||oR(e);return{width:n,height:r}}function lR(){let e,t;try{t=process}catch{}const n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const mr=16384;function cR(e){(e.width>mr||e.height>mr)&&(e.width>mr&&e.height>mr?e.width>e.height?(e.height*=mr/e.width,e.width=mr):(e.width*=mr/e.height,e.height=mr):e.width>mr?(e.height*=mr/e.width,e.width=mr):(e.width*=mr/e.height,e.height=mr))}function Lu(e){return new Promise((t,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>t(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function uR(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function fR(e,t,n){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),o=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${t}`),a.setAttribute("height",`${n}`),a.setAttribute("viewBox",`0 0 ${t} ${n}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),a.appendChild(o),o.appendChild(e),uR(a)}const sr=(e,t)=>{if(e instanceof t)return!0;const n=Object.getPrototypeOf(e);return n===null?!1:n.constructor.name===t.name||sr(n,t)};function dR(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function hR(e,t){return wT(t).map(n=>{const r=e.getPropertyValue(n),a=e.getPropertyPriority(n);return`${n}: ${r}${a?" !important":""};`}).join(" ")}function mR(e,t,n,r){const a=`.${e}:${t}`,o=n.cssText?dR(n):hR(n,r);return document.createTextNode(`${a}{${o}}`)}function Ev(e,t,n,r){const a=window.getComputedStyle(e,n),o=a.getPropertyValue("content");if(o===""||o==="none")return;const c=iR();try{t.className=`${t.className} ${c}`}catch{return}const u=document.createElement("style");u.appendChild(mR(c,n,a,r)),t.appendChild(u)}function pR(e,t,n){Ev(e,t,":before",n),Ev(e,t,":after",n)}const Sv="application/font-woff",Cv="image/jpeg",gR={woff:Sv,woff2:Sv,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Cv,jpeg:Cv,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function xR(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Sh(e){const t=xR(e).toLowerCase();return gR[t]||""}function vR(e){return e.split(/,/)[1]}function Kd(e){return e.search(/^(data:)/)!==-1}function yR(e,t){return`data:${t};base64,${e}`}async function bT(e,t,n){const r=await fetch(e,t);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((o,c)=>{const u=new FileReader;u.onerror=c,u.onloadend=()=>{try{o(n({res:r,result:u.result}))}catch(p){c(p)}},u.readAsDataURL(a)})}const xd={};function TR(e,t,n){let r=e.replace(/\?.*/,"");return n&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),t?`[${t}]${r}`:r}async function Ch(e,t,n){const r=TR(e,t,n.includeQueryParams);if(xd[r]!=null)return xd[r];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let a;try{const o=await bT(e,n.fetchRequestInit,({res:c,result:u})=>(t||(t=c.headers.get("Content-Type")||""),vR(u)));a=yR(o,t)}catch(o){a=n.imagePlaceholder||"";let c=`Failed to fetch resource: ${e}`;o&&(c=typeof o=="string"?o:o.message),c&&console.warn(c)}return xd[r]=a,a}async function _R(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):Lu(t)}async function ER(e,t){if(e.currentSrc){const o=document.createElement("canvas"),c=o.getContext("2d");o.width=e.clientWidth,o.height=e.clientHeight,c==null||c.drawImage(e,0,0,o.width,o.height);const u=o.toDataURL();return Lu(u)}const n=e.poster,r=Sh(n),a=await Ch(n,r,t);return Lu(a)}async function SR(e,t){var n;try{if(!((n=e==null?void 0:e.contentDocument)===null||n===void 0)&&n.body)return await Qu(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function CR(e,t){return sr(e,HTMLCanvasElement)?_R(e):sr(e,HTMLVideoElement)?ER(e,t):sr(e,HTMLIFrameElement)?SR(e,t):e.cloneNode(kT(e))}const wR=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",kT=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function AR(e,t,n){var r,a;if(kT(t))return t;let o=[];return wR(e)&&e.assignedNodes?o=gi(e.assignedNodes()):sr(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?o=gi(e.contentDocument.body.childNodes):o=gi(((a=e.shadowRoot)!==null&&a!==void 0?a:e).childNodes),o.length===0||sr(e,HTMLVideoElement)||await o.reduce((c,u)=>c.then(()=>Qu(u,n)).then(p=>{p&&t.appendChild(p)}),Promise.resolve()),t}function bR(e,t,n){const r=t.style;if(!r)return;const a=window.getComputedStyle(e);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):wT(n).forEach(o=>{let c=a.getPropertyValue(o);o==="font-size"&&c.endsWith("px")&&(c=`${Math.floor(parseFloat(c.substring(0,c.length-2)))-.1}px`),sr(e,HTMLIFrameElement)&&o==="display"&&c==="inline"&&(c="block"),o==="d"&&t.getAttribute("d")&&(c=`path(${t.getAttribute("d")})`),r.setProperty(o,c,a.getPropertyPriority(o))})}function kR(e,t){sr(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),sr(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function NR(e,t){if(sr(e,HTMLSelectElement)){const n=t,r=Array.from(n.children).find(a=>e.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function MR(e,t,n){return sr(t,Element)&&(bR(e,t,n),pR(e,t,n),kR(e,t),NR(e,t)),t}async function RR(e,t){const n=e.querySelectorAll?e.querySelectorAll("use"):[];if(n.length===0)return e;const r={};for(let o=0;o<n.length;o++){const u=n[o].getAttribute("xlink:href");if(u){const p=e.querySelector(u),h=document.querySelector(u);!p&&h&&!r[u]&&(r[u]=await Qu(h,t,!0))}}const a=Object.values(r);if(a.length){const o="http://www.w3.org/1999/xhtml",c=document.createElementNS(o,"svg");c.setAttribute("xmlns",o),c.style.position="absolute",c.style.width="0",c.style.height="0",c.style.overflow="hidden",c.style.display="none";const u=document.createElementNS(o,"defs");c.appendChild(u);for(let p=0;p<a.length;p++)u.appendChild(a[p]);e.appendChild(c)}return e}async function Qu(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(r=>CR(r,t)).then(r=>AR(e,r,t)).then(r=>MR(e,r,t)).then(r=>RR(r,t))}const NT=/url\((['"]?)([^'"]+?)\1\)/g,DR=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,IR=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function FR(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function LR(e){const t=[];return e.replace(NT,(n,r,a)=>(t.push(a),n)),t.filter(n=>!Kd(n))}async function OR(e,t,n,r,a){try{const o=n?aR(t,n):t,c=Sh(t);let u;return a||(u=await Ch(o,c,r)),e.replace(FR(t),`$1${u}$3`)}catch{}return e}function PR(e,{preferredFontFormat:t}){return t?e.replace(IR,n=>{for(;;){const[r,,a]=DR.exec(n)||[];if(!a)return"";if(a===t)return`src: ${r};`}}):e}function MT(e){return e.search(NT)!==-1}async function RT(e,t,n){if(!MT(e))return e;const r=PR(e,n);return LR(r).reduce((o,c)=>o.then(u=>OR(u,c,t,n)),Promise.resolve(r))}async function Xs(e,t,n){var r;const a=(r=t.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(a){const o=await RT(a,null,n);return t.style.setProperty(e,o,t.style.getPropertyPriority(e)),!0}return!1}async function UR(e,t){await Xs("background",e,t)||await Xs("background-image",e,t),await Xs("mask",e,t)||await Xs("-webkit-mask",e,t)||await Xs("mask-image",e,t)||await Xs("-webkit-mask-image",e,t)}async function BR(e,t){const n=sr(e,HTMLImageElement);if(!(n&&!Kd(e.src))&&!(sr(e,SVGImageElement)&&!Kd(e.href.baseVal)))return;const r=n?e.src:e.href.baseVal,a=await Ch(r,Sh(r),t);await new Promise((o,c)=>{e.onload=o,e.onerror=t.onImageErrorHandler?(...p)=>{try{o(t.onImageErrorHandler(...p))}catch(h){c(h)}}:c;const u=e;u.decode&&(u.decode=o),u.loading==="lazy"&&(u.loading="eager"),n?(e.srcset="",e.src=a):e.href.baseVal=a})}async function VR(e,t){const r=gi(e.childNodes).map(a=>DT(a,t));await Promise.all(r).then(()=>e)}async function DT(e,t){sr(e,Element)&&(await UR(e,t),await BR(e,t),await VR(e,t))}function GR(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const r=t.style;return r!=null&&Object.keys(r).forEach(a=>{n[a]=r[a]}),e}const wv={};async function Av(e){let t=wv[e];if(t!=null)return t;const r=await(await fetch(e)).text();return t={url:e,cssText:r},wv[e]=t,t}async function bv(e,t){let n=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,o=(n.match(/url\([^)]+\)/g)||[]).map(async c=>{let u=c.replace(r,"$1");return u.startsWith("https://")||(u=new URL(u,e.url).href),bT(u,t.fetchRequestInit,({result:p})=>(n=n.replace(c,`url(${p})`),[c,p]))});return Promise.all(o).then(()=>n)}function kv(e){if(e==null)return[];const t=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(n,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const p=a.exec(r);if(p===null)break;t.push(p[0])}r=r.replace(a,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,c="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(c,"gi");for(;;){let p=o.exec(r);if(p===null){if(p=u.exec(r),p===null)break;o.lastIndex=u.lastIndex}else u.lastIndex=o.lastIndex;t.push(p[0])}return t}async function HR(e,t){const n=[],r=[];return e.forEach(a=>{if("cssRules"in a)try{gi(a.cssRules||[]).forEach((o,c)=>{if(o.type===CSSRule.IMPORT_RULE){let u=c+1;const p=o.href,h=Av(p).then(g=>bv(g,t)).then(g=>kv(g).forEach(y=>{try{a.insertRule(y,y.startsWith("@import")?u+=1:a.cssRules.length)}catch(_){console.error("Error inserting rule from remote css",{rule:y,error:_})}})).catch(g=>{console.error("Error loading remote css",g.toString())});r.push(h)}})}catch(o){const c=e.find(u=>u.href==null)||document.styleSheets[0];a.href!=null&&r.push(Av(a.href).then(u=>bv(u,t)).then(u=>kv(u).forEach(p=>{c.insertRule(p,c.cssRules.length)})).catch(u=>{console.error("Error loading remote stylesheet",u)})),console.error("Error inlining remote css file",o)}}),Promise.all(r).then(()=>(e.forEach(a=>{if("cssRules"in a)try{gi(a.cssRules||[]).forEach(o=>{n.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${a.href}`,o)}}),n))}function zR(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>MT(t.style.getPropertyValue("src")))}async function jR(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=gi(e.ownerDocument.styleSheets),r=await HR(n,t);return zR(r)}function IT(e){return e.trim().replace(/["']/g,"")}function qR(e){const t=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(o=>{t.add(IT(o))}),Array.from(r.children).forEach(o=>{o instanceof HTMLElement&&n(o)})}return n(e),t}async function YR(e,t){const n=await jR(e,t),r=qR(e);return(await Promise.all(n.filter(o=>r.has(IT(o.style.fontFamily))).map(o=>{const c=o.parentStyleSheet?o.parentStyleSheet.href:null;return RT(o.cssText,c,t)}))).join(`
`)}async function $R(e,t){const n=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await YR(e,t);if(n){const r=document.createElement("style"),a=document.createTextNode(n);r.appendChild(a),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function JR(e,t={}){const{width:n,height:r}=AT(e,t),a=await Qu(e,t,!0);return await $R(a,t),await DT(a,t),GR(a,t),await fR(a,n,r)}async function XR(e,t={}){const{width:n,height:r}=AT(e,t),a=await JR(e,t),o=await Lu(a),c=document.createElement("canvas"),u=c.getContext("2d"),p=t.pixelRatio||lR(),h=t.canvasWidth||n,g=t.canvasHeight||r;return c.width=h*p,c.height=g*p,t.skipAutoScale||cR(c),c.style.width=`${h}`,c.style.height=`${g}`,t.backgroundColor&&(u.fillStyle=t.backgroundColor,u.fillRect(0,0,c.width,c.height)),u.drawImage(o,0,0,c.width,c.height),c}async function WR(e,t={}){return(await XR(e,t)).toDataURL()}const Tl=40,Nv=64,Mv=320,Rv=["#3B82F6","#F59E0B","#10B981","#EF4444","#6B7280","#6366F1","#EC4899","#8B5CF6"],KR=({data:e,onClose:t,onItemClick:n,onRegenerate:r,isRegenerating:a})=>{const[o,c]=ge.useState(!0),[u,p]=ge.useState(new Set),[h,g]=ge.useState("all"),y=ge.useRef(null),[_,E]=ge.useState(!1),[S,C]=ge.useState("day"),[w,M]=ge.useState({start:"",end:""}),b={day:40,week:15,month:5}[S],U=ge.useMemo(()=>{const ne=new Map;return e.filter(j=>j.type==="task").forEach((j,N)=>{ne.set(j.id,Rv[N%Rv.length])}),ne},[e]),B=ge.useCallback((ne,j)=>{if(ne.type==="task")return ne.id;let N=ne;for(;N.parentId;){const W=j.get(N.parentId);if(!W)return null;if(W.type==="task")return W.id;N=W}return null},[]),X=ge.useMemo(()=>new Map(e.map(ne=>[ne.id,ne])),[e]),F=ge.useCallback(ne=>{const j=B(ne,X);return j&&U.get(j)||"#9CA3AF"},[X,U,B]);ge.useEffect(()=>{const ne=new Set(e.filter(j=>j.type==="task").map(j=>j.id));p(ne)},[e]);const Y=ne=>{p(j=>{const N=new Set(j);return N.has(ne)?N.delete(ne):N.add(ne),N})},L=ge.useMemo(()=>{const ne=[];return e.filter(N=>N.type==="task").forEach(N=>{ne.push(N),u.has(N.id)&&e.filter(D=>D.type==="substep"&&D.parentId===N.id).forEach(D=>{if(ne.push(D),u.has(D.id)){const J=e.filter(q=>{if(q.type!=="actionitem"||q.parentId!==D.id)return!1;if(h==="all")return!0;const G=q.progress===100;return h==="completed"?G:h==="pending"?!G:!0});ne.push(...J)}})}),ne},[e,u,h]),{timelineStart:Q,totalDays:te}=ge.useMemo(()=>{if(e.length===0)return{timelineStart:new Date,totalDays:30};const ne=e.map(G=>new Date(G.start)).filter(G=>!isNaN(G.getTime())),j=e.map(G=>new Date(G.end)).filter(G=>!isNaN(G.getTime()));let N,W;ne.length===0||j.length===0?(N=new Date,W=new Date,W.setMonth(W.getMonth()+1)):(N=new Date(Math.min(...ne.map(G=>G.getTime()))),W=new Date(Math.max(...j.map(G=>G.getTime()))));let D=w.start?new Date(w.start):N,J=w.end?new Date(w.end):W;isNaN(D.getTime())&&(D=N),isNaN(J.getTime())&&(J=W),J<D&&(J=D),D.setDate(D.getDate()-2),J.setDate(J.getDate()+5);const q=(J.getTime()-D.getTime())/(1e3*3600*24);return{timelineStart:D,totalDays:Math.ceil(q)}},[e,w]),ee=ge.useMemo(()=>{const ne=W=>{W=new Date(Date.UTC(W.getFullYear(),W.getMonth(),W.getDate())),W.setUTCDate(W.getUTCDate()+4-(W.getUTCDay()||7));const D=new Date(Date.UTC(W.getUTCFullYear(),0,1));return Math.ceil(((W.getTime()-D.getTime())/864e5+1)/7)},j=[];let N=new Date(Q);if(S==="day")for(let W=0;W<te;W++)j.push({secondaryLabel:N.toLocaleDateString("ja-JP",{weekday:"short"}),label:String(N.getDate()),width:b}),N.setDate(N.getDate()+1);else if(S==="week")for(let W=0;W<te;W++)(N.getDay()===1||j.length===0)&&j.push({label:`W${ne(N)}`,secondaryLabel:N.toLocaleDateString("ja-JP",{month:"short"}),width:0}),j[j.length-1].width+=b,N.setDate(N.getDate()+1);else if(S==="month"){let W=-1;for(let D=0;D<te;D++){const J=N.getMonth();J!==W&&(W=J,j.push({label:N.toLocaleDateString("ja-JP",{month:"long",year:"numeric"}),width:0})),j[j.length-1].width+=b,N.setDate(N.getDate()+1)}}return j},[Q,te,S,b]),_e=ne=>{const j=new Date(ne);return isNaN(j.getTime())?-1:(j.getTime()-Q.getTime())/(1e3*3600*24)},De=ne=>{switch(ne){case"substep":return"pl-5";case"actionitem":return"pl-9";default:return"pl-1"}},Te=ne=>e.some(j=>j.parentId===ne),re=ge.useCallback(()=>{if(y.current===null){alert("");return}E(!0),WR(y.current,{cacheBust:!0,backgroundColor:"#ffffff",width:y.current.scrollWidth,height:y.current.scrollHeight}).then(ne=>{const j=document.createElement("a");j.download="gantt-chart.png",j.href=ne,j.click()}).catch(ne=>{console.error("",ne),alert("")}).finally(()=>{E(!1)})},[]),ce=ge.useMemo(()=>ee.reduce((ne,j)=>ne+j.width,0),[ee]);return v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 z-[80]",children:v.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full h-full flex flex-col",children:[v.jsxs("header",{className:"flex-shrink-0 flex flex-wrap items-center justify-between p-4 border-b gap-4",children:[v.jsx("h2",{className:"text-xl font-bold text-slate-800",children:""}),v.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-2",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),v.jsx("div",{className:"flex items-center rounded-md bg-slate-100 p-1",children:["day","week","month"].map(ne=>v.jsx("button",{onClick:()=>C(ne),className:`px-3 py-1 text-xs capitalize rounded-md ${S===ne?"bg-white shadow-sm font-semibold text-blue-600":""}`,children:ne},ne))})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),v.jsx("input",{type:"date",value:w.start,onChange:ne=>M(j=>({...j,start:ne.target.value})),className:"p-1 border rounded-md text-sm"}),v.jsx("span",{children:"-"}),v.jsx("input",{type:"date",value:w.end,onChange:ne=>M(j=>({...j,end:ne.target.value})),className:"p-1 border rounded-md text-sm"}),v.jsx("button",{onClick:()=>M({start:"",end:""}),className:"text-xs px-2 py-1 bg-slate-200 rounded-md hover:bg-slate-300",children:""})]}),v.jsxs("button",{onClick:re,disabled:_,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[_?v.jsx(Lr,{size:"sm",color:"border-white"}):v.jsx(Zu,{className:"w-4 h-4"}),"PNG"]}),v.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:[v.jsx(xr,{className:"w-5 h-5"}),""]})]})]}),v.jsxs("div",{className:"flex-shrink-0 p-4 border-b flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-100 p-1",children:[v.jsx("button",{onClick:()=>g("all"),className:`px-3 py-1 text-xs rounded-full ${h==="all"?"bg-white shadow-sm":""}`,children:""}),v.jsx("button",{onClick:()=>g("pending"),className:`px-3 py-1 text-xs rounded-full ${h==="pending"?"bg-white shadow-sm":""}`,children:""}),v.jsx("button",{onClick:()=>g("completed"),className:`px-3 py-1 text-xs rounded-full ${h==="completed"?"bg-white shadow-sm":""}`,children:""})]}),v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsxs("button",{onClick:r,disabled:a,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[a?v.jsx(Lr,{size:"sm",color:"border-white"}):v.jsx(yh,{className:"w-4 h-4"}),"AI"]}),v.jsxs("label",{className:"flex items-center text-sm text-slate-600 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:o,onChange:()=>c(ne=>!ne),className:"w-4 h-4 mr-2 accent-blue-600"}),""]})]})]}),v.jsx("div",{className:"flex-grow overflow-auto relative",children:v.jsxs("div",{ref:y,className:"grid",style:{gridTemplateColumns:`${Mv}px 1fr`,width:`${Mv+ce}px`},children:[v.jsx("div",{className:"sticky top-0 left-0 z-30 flex items-center p-2 font-semibold text-sm border-b border-r bg-slate-100 text-slate-800",style:{gridColumn:1,gridRow:1,height:Nv},children:" / "}),v.jsx("div",{className:"sticky top-0 z-20 border-b bg-slate-50",style:{gridColumn:2,gridRow:1,height:Nv},children:v.jsx("div",{className:"flex h-full",children:ee.map((ne,j)=>v.jsxs("div",{className:"border-r text-center text-[10px] flex flex-col items-center justify-center",style:{width:ne.width},children:[ne.secondaryLabel&&v.jsx("span",{className:"font-semibold text-slate-600",children:ne.secondaryLabel}),v.jsx("div",{className:`font-bold text-slate-800 ${S==="day"?"text-lg":"text-sm"}`,children:ne.label})]},j))})}),v.jsx("div",{className:"pointer-events-none flex",style:{gridColumn:2,gridRow:`2 / span ${L.length}`},children:ee.map((ne,j)=>v.jsx("div",{className:"h-full border-r border-slate-200",style:{width:ne.width}},j))}),L.map((ne,j)=>{const N=F(ne),W=(()=>{const ye=L[j+1];return ye?B(ne,X)!==B(ye,X):!0})(),D=_e(ne.start),J=Math.max(.2,_e(ne.end)-D+1),q=D*b,G=J*b,ie={task:{height:"24px"},substep:{height:"20px"},actionitem:{height:"8px"}};return v.jsxs(so.Fragment,{children:[v.jsxs("div",{className:"sticky left-0 z-10 flex items-center border-r bg-slate-50",style:{gridColumn:1,gridRow:j+2,height:Tl,borderBottom:W?`2px solid ${N}`:"1px solid #e5e7eb"},children:[v.jsx("div",{className:"w-1 h-full flex-shrink-0",style:{backgroundColor:N}}),v.jsxs("div",{className:`flex items-center w-full ${De(ne.type)}`,children:[(ne.type==="task"||ne.type==="substep")&&(Te(ne.id)?v.jsx(BM,{onClick:()=>Y(ne.id),className:`w-4 h-4 mr-1 text-slate-500 cursor-pointer transition-transform ${u.has(ne.id)?"rotate-0":"-rotate-90"}`}):v.jsx("div",{className:"w-4 h-4 mr-1"})),ne.type==="actionitem"&&(ne.progress===100?v.jsx(xh,{className:"w-3.5 h-3.5 text-green-600 mr-2 flex-shrink-0"}):v.jsx(vh,{className:"w-3.5 h-3.5 text-slate-400 mr-2 flex-shrink-0"})),v.jsx("span",{onClick:()=>n==null?void 0:n(ne),className:`truncate text-xs ${ne.type==="task"?"font-semibold text-slate-800":"text-slate-600"} ${n?"cursor-pointer hover:text-blue-600":""}`,title:ne.name,children:ne.name})]})]}),v.jsx("div",{className:"relative",style:{gridColumn:2,gridRow:j+2,borderBottom:W?`2px solid ${N}`:"1px solid #e5e7eb"},children:D>=0&&v.jsx("div",{title:`${ne.name} (${ne.progress}%)`,onClick:()=>n==null?void 0:n(ne),className:"absolute h-full flex items-center group",style:{left:q,width:G,cursor:n?"pointer":"default"},children:v.jsx("div",{className:"w-full rounded",style:{...ie[ne.type],backgroundColor:N},children:v.jsx("div",{className:"bg-black bg-opacity-30 h-full rounded",style:{width:`${ne.progress}%`}})})})})]},ne.id)}),v.jsx("div",{style:{gridColumn:2,gridRow:`2 / span ${L.length}`,position:"relative",pointerEvents:"none"},children:o&&v.jsx(ZR,{items:L,getDaysFromStart:_e,dayWidth:b})})]})})]})})},ZR=({items:e,getDaysFromStart:t,dayWidth:n})=>{const r=ge.useMemo(()=>{const a=[],o=new Map(e.map((c,u)=>[c.id,u]));return e.forEach((c,u)=>{(c.dependencies||[]).forEach(p=>{const h=o.get(p),g=h!==void 0?e[h]:void 0;if(g&&h!==void 0){const y=t(g.end),_=t(c.start);if(y<0||_<0)return;const E=(y+1)*n,S=h*Tl+Tl/2,C=_*n,w=u*Tl+Tl/2,M=E+20,k=C-20,b=`M ${E} ${S} C ${M} ${S}, ${k} ${w}, ${C} ${w}`;a.push({key:`${p}-${c.id}`,d:b})}})}),a},[e,t,n]);return v.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",overflow:"visible",children:[v.jsx("defs",{children:v.jsx("marker",{id:"gantt_arrowhead",markerWidth:"5",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:v.jsx("polygon",{points:"0 0, 5 2, 0 4",fill:"#4b5563"})})}),r.map(a=>v.jsx("path",{d:a.d,stroke:"#4b5563",strokeWidth:"1",fill:"none",markerEnd:"url(#gantt_arrowhead)"},a.key))]})},ef=({message:e})=>e?v.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative",role:"alert",children:[v.jsx("strong",{className:"font-bold",children:"Error: "}),v.jsx("span",{className:"block sm:inline",children:e})]}):null,QR=({tasks:e,projectGoal:t,targetDate:n,ganttData:r,projectReportDeck:a,onClose:o,onReportGenerated:c,generateUniqueId:u})=>{const[p,h]=ge.useState("list"),[g,y]=ge.useState(new Set),[_,E]=ge.useState(""),[S,C]=ge.useState(!1),[w,M]=ge.useState(null),[k,b]=ge.useState({key:"taskName",direction:"ascending"}),[U,B]=ge.useState("slides"),[X,F]=ge.useState(null),Y=ge.useMemo(()=>{const N=[];return r&&N.push({id:"gantt-chart-main",name:" ",type:"Gantt Chart",taskName:"",subStepName:"",actionItemName:"",source:{name:" ",type:"json",content:r}}),a&&N.push({id:"project-report-main",name:"",type:"Project Report",taskName:"",subStepName:"",actionItemName:"",source:{name:"",type:"json",content:a}}),e.forEach(W=>{var D,J,q,G,ie;(D=W.extendedDetails)!=null&&D.reportDeck&&N.push({id:`task-report-${W.id}`,name:`: ${W.title}`,type:"Task Report",taskName:W.title,subStepName:"",actionItemName:"",source:{name:`: ${W.title}`,type:"json",content:W.extendedDetails.reportDeck}}),(q=(J=W.extendedDetails)==null?void 0:J.attachments)==null||q.forEach(ye=>{N.push({id:ye.id,name:ye.name,type:"Attachment",taskName:W.title,subStepName:"",actionItemName:"",source:{name:ye.name,type:ye.type.startsWith("image/")?"image":"text",content:ye.dataUrl,dataUrl:ye.dataUrl}})}),(ie=(G=W.extendedDetails)==null?void 0:G.subSteps)==null||ie.forEach(ye=>{var Ae,Me;(Ae=ye.attachments)==null||Ae.forEach(Ee=>{N.push({id:Ee.id,name:Ee.name,type:"Attachment",taskName:W.title,subStepName:ye.text,actionItemName:"",source:{name:Ee.name,type:Ee.type.startsWith("image/")?"image":"text",content:Ee.dataUrl,dataUrl:Ee.dataUrl}})}),(Me=ye.actionItems)==null||Me.forEach(Ee=>{var Ze,K,ut;(K=(Ze=Ee.report)==null?void 0:Ze.attachments)==null||K.forEach(We=>{N.push({id:We.id,name:We.name,type:"Attachment",taskName:W.title,subStepName:ye.text,actionItemName:Ee.text,source:{name:We.name,type:We.type.startsWith("image/")?"image":"text",content:We.dataUrl,dataUrl:We.dataUrl}})}),(ut=Ee.report)!=null&&ut.matrixData&&N.push({id:`matrix-${Ee.id}`,name:`: ${Ee.text}`,type:"Data Matrix",taskName:W.title,subStepName:ye.text,actionItemName:Ee.text,source:{name:`: ${Ee.text}`,type:"json",content:Ee.report.matrixData}})})})}),N},[e,r,a]),L=ge.useMemo(()=>{let N=[...Y];return k!==null&&N.sort((W,D)=>{const J=(W[k.key]||"").toLowerCase(),q=(D[k.key]||"").toLowerCase();return J<q?k.direction==="ascending"?-1:1:J>q?k.direction==="ascending"?1:-1:0}),N},[Y,k]),Q=N=>{let W="ascending";k&&k.key===N&&k.direction==="ascending"&&(W="descending"),b({key:N,direction:W})},te=N=>!k||k.key!==N?v.jsx(ts,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):k.direction==="ascending"?v.jsx(Bl,{className:"w-3 h-3 ml-1 text-blue-600"}):v.jsx(ts,{className:"w-3 h-3 ml-1 text-blue-600"}),ee=N=>{y(W=>{const D=new Set(W);return D.has(N)?D.delete(N):D.add(N),D})},_e=()=>{g.size===Y.length?y(new Set):y(new Set(Y.map(N=>N.id)))},De=async()=>{if(g.size===0){M("1");return}if(!_.trim()){M("");return}C(!0),M(null),F(null);const N=Y.filter(W=>g.has(W.id)).map(W=>W.source);try{if(U==="slides"){const W=await xT(N,_);c(W)}else{const W=await RM(N,_);F(W)}}catch(W){M(W instanceof Error?W.message:"")}finally{C(!1)}},Te=N=>{switch(N){case"Gantt Chart":return v.jsx(ST,{className:"w-5 h-5 text-amber-600"});case"Project Report":case"Task Report":return v.jsx(Th,{className:"w-5 h-5 text-teal-600"});case"Attachment":return v.jsx(ho,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return v.jsx(_h,{className:"w-5 h-5 text-purple-600"});default:return v.jsx(Ul,{className:"w-5 h-5 text-slate-500"})}},re=N=>{if(N.dataUrl)return N.dataUrl;if(N.type==="json")try{const W=JSON.stringify(N.content,null,2),D=new Blob([W],{type:"application/json"});return URL.createObjectURL(D)}catch{return}},ce=ge.useMemo(()=>Y.filter(N=>g.has(N.id)),[g,Y]),ne=()=>v.jsxs(v.Fragment,{children:[v.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:v.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[v.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:v.jsxs("tr",{children:[v.jsx("th",{className:"p-2 border border-slate-300 w-10 text-center",children:v.jsx("input",{type:"checkbox",checked:g.size===Y.length&&Y.length>0,onChange:_e,className:"w-4 h-4 accent-blue-600"})}),v.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:v.jsxs("button",{onClick:()=>Q("name"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[v.jsx("span",{children:""}),te("name")]})}),v.jsx("th",{className:"p-0 border border-slate-300 w-40",children:v.jsxs("button",{onClick:()=>Q("type"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[v.jsx("span",{children:""}),te("type")]})}),v.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:v.jsxs("button",{onClick:()=>Q("taskName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[v.jsx("span",{children:""}),te("taskName")]})}),v.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:v.jsxs("button",{onClick:()=>Q("subStepName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[v.jsx("span",{children:""}),te("subStepName")]})}),v.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:v.jsxs("button",{onClick:()=>Q("actionItemName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[v.jsx("span",{children:""}),te("actionItemName")]})})]})}),v.jsx("tbody",{children:L.map(N=>{const W=re(N.source);return v.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[v.jsx("td",{className:"border border-slate-300 align-middle text-center p-2",children:v.jsx("input",{type:"checkbox",checked:g.has(N.id),onChange:()=>ee(N.id),className:"w-4 h-4 accent-blue-600"})}),v.jsx("td",{className:"border border-slate-300 p-2 font-medium text-slate-800",children:W?v.jsx("a",{href:W,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:N.name}):v.jsx("span",{children:N.name})}),v.jsx("td",{className:"border border-slate-300 p-2 text-slate-600",children:v.jsxs("div",{className:"flex items-center gap-2",children:[Te(N.type),v.jsx("span",{children:N.type})]})}),v.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.taskName}),v.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.subStepName}),v.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.actionItemName})]},N.id)})})]})}),v.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[v.jsxs("span",{className:"text-sm text-slate-600",children:[g.size," / ",Y.length," "]}),v.jsx("button",{onClick:()=>h("generate"),disabled:g.size===0,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:""})]})]}),j=()=>v.jsxs(v.Fragment,{children:[v.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[v.jsxs("div",{children:[v.jsxs("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:[" (",ce.length,")"]}),v.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-96 overflow-y-auto space-y-2",children:ce.map(N=>v.jsxs("div",{className:"text-sm text-slate-700 flex items-center gap-2",children:[Te(N.type),v.jsx("span",{className:"truncate",title:N.name,children:N.name})]},N.id))}),v.jsx("h4",{className:"font-semibold text-lg text-slate-800 mt-6 mb-2",children:""}),v.jsxs("div",{className:"flex gap-4",children:[v.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[v.jsx("input",{type:"radio",name:"reportFormat",value:"slides",checked:U==="slides",onChange:()=>B("slides"),className:"w-4 h-4 accent-blue-600"}),""]}),v.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[v.jsx("input",{type:"radio",name:"reportFormat",value:"text",checked:U==="text",onChange:()=>B("text"),className:"w-4 h-4 accent-blue-600"}),""]})]})]}),v.jsxs("div",{children:[v.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:""}),v.jsx("textarea",{value:_,onChange:N=>E(N.target.value),placeholder:"",rows:6,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),w&&v.jsx("div",{className:"mt-2",children:v.jsx(ef,{message:w})}),X&&v.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-slate-50",children:[v.jsx("h5",{className:"font-semibold text-md text-slate-800 mb-2",children:""}),v.jsx("pre",{className:"text-sm text-slate-700 bg-white p-3 rounded whitespace-pre-wrap max-h-60 overflow-y-auto",children:X}),v.jsx("button",{onClick:()=>navigator.clipboard.writeText(X),className:"text-xs mt-2 px-2 py-1 bg-slate-200 rounded",children:""})]})]})]}),v.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[v.jsxs("button",{onClick:()=>{h("list"),F(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:[v.jsx(TT,{className:"w-4 h-4"}),""]}),v.jsxs("button",{onClick:De,disabled:S,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[S?v.jsx(Lr,{size:"sm",color:"border-white"}):v.jsx(es,{className:"w-5 h-5"}),v.jsx("span",{children:S?"...":""})]})]})]});return v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[70]",children:v.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[v.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[v.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-3",children:[v.jsx(Ul,{className:"w-7 h-7 text-blue-600"}),v.jsx("span",{children:""})]}),v.jsx("button",{onClick:o,className:"p-1.5 rounded-full hover:bg-slate-100",children:v.jsx(xr,{className:"w-6 h-6 text-slate-500"})})]}),p==="list"?ne():j()]})})},eD=({tasks:e,projectGoal:t,targetDate:n,onSelectTask:r,onUpdateTaskExtendedDetails:a,onUpdateTaskPosition:o,onUpdateTaskStatus:c,onStartNewProject:u,onExportProject:p,onAddTask:h,onRemoveTask:g,onImportSingleTask:y,onAutoLayout:_,onUndo:E,canUndo:S,onRedo:C,canRedo:w,generateUniqueId:M,onUpdateTaskConnections:k,ganttData:b,setGanttData:U,onCustomReportGenerated:B,onClearApiKey:X})=>{ge.useRef(null);const F=ge.useRef(null),[Y,L]=ge.useState(new Map),[Q,te]=ge.useState([]),ee=ge.useRef(null),_e=ge.useRef({x:0,y:0}),[De,Te]=ge.useState(!1),[re,ce]=ge.useState(!1),[ne,j]=ge.useState(null),[N,W]=ge.useState(!1),[D,J]=ge.useState(null),[q,G]=ge.useState(!1),[ie,ye]=ge.useState(null),[Ae,Me]=ge.useState(!1),[Ee,Ze]=ge.useState(null),[K,ut]=ge.useState(!1),[We,ht]=ge.useState(!1),[Ne,xe]=ge.useState(null),[He,je]=ge.useState(!1),[Mt,_t]=ge.useState(!1),[Xt,an]=ge.useState(null),[Qt,An]=ge.useState({x:0,y:0});ge.useEffect(()=>{const Pe=new Map;e.forEach(lt=>{Pe.set(lt.id,Y.get(lt.id)||ge.createRef())}),L(Pe)},[e]);const Vt=ge.useCallback(()=>{if(!F.current||Y.size===0){te([]);return}const Pe=[];e.forEach(lt=>{var vt,cn;if(lt.nextTaskIds&&lt.nextTaskIds.length>0){const Ln=Y.get(lt.id),kn=Ln==null?void 0:Ln.current;if(!kn)return;const ea=((vt=lt.position)==null?void 0:vt.x)||0,bi=((cn=lt.position)==null?void 0:cn.y)||0,Yn=kn.getBoundingClientRect(),Wt={x:ea+Yn.width,y:bi+Yn.height/2};lt.nextTaskIds.forEach(Kt=>{var V,z;const yr=e.find(fe=>fe.id===Kt);if(!yr)return;const ga=Y.get(Kt),hs=ga==null?void 0:ga.current;if(!hs)return;const R=((V=yr.position)==null?void 0:V.x)||0,H=((z=yr.position)==null?void 0:z.y)||0,O=hs.getBoundingClientRect(),P={x:R,y:H+O.height/2};Pe.push({id:`conn-${lt.id}-${Kt}`,from:Wt,to:P,sourceId:lt.id,targetId:Kt})})}}),te(Pe)},[e,Y]);ge.useEffect(()=>{const Pe=setTimeout(Vt,50);return()=>clearTimeout(Pe)},[Vt,e]),ge.useEffect(()=>{window.addEventListener("resize",Vt);const Pe=new MutationObserver(Vt);return F.current&&Pe.observe(F.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("resize",Vt),Pe.disconnect()}},[Vt]);const Gt=(Pe,lt)=>{var cn,Ln;ee.current=lt;const vt=e.find(kn=>kn.id===lt);if(F.current){const kn=F.current.getBoundingClientRect();_e.current.x=Pe.clientX-kn.left-(((cn=vt==null?void 0:vt.position)==null?void 0:cn.x)||0),_e.current.y=Pe.clientY-kn.top-(((Ln=vt==null?void 0:vt.position)==null?void 0:Ln.y)||0)}Pe.dataTransfer.effectAllowed="move"},be=Pe=>{Pe.preventDefault(),Pe.dataTransfer.dropEffect="move"},Ge=Pe=>{var Wt;if(Pe.preventDefault(),!ee.current||!F.current)return;const lt=F.current.getBoundingClientRect(),vt=(Wt=Y.get(ee.current))==null?void 0:Wt.current,cn=(vt==null?void 0:vt.offsetWidth)||380,Ln=(vt==null?void 0:vt.offsetHeight)||280;let kn=Pe.clientX-lt.left-_e.current.x,ea=Pe.clientY-lt.top-_e.current.y;const bi=F.current.scrollWidth,Yn=F.current.scrollHeight;kn=Math.max(0,Math.min(kn,bi-cn)),ea=Math.max(0,Math.min(ea,Yn-Ln)),o(ee.current,{x:kn,y:ea}),ee.current=null,setTimeout(Vt,0)},Ce=async()=>{W(!0),J(null);try{const Pe=await bM(e,t,n);j(Pe),ce(!0)}catch(Pe){J(Pe instanceof Error?Pe.message:"")}finally{W(!1)}},Be=async()=>{if(ie){G(!0);return}Me(!0),Ze(null);try{const Pe=await kM(e,t,n);ye(Pe),G(!0)}catch(Pe){Ze(Pe instanceof Error?Pe.message:"")}finally{Me(!1)}},et=async()=>{if(b){ut(!0);return}ht(!0),xe(null);try{const Pe=await yv(e,t,n);U(Pe),ut(!0)}catch(Pe){xe(Pe instanceof Error?Pe.message:"")}finally{ht(!1)}},Oe=async()=>{ht(!0),xe(null);try{const Pe=await yv(e,t,n);U(Pe)}catch(Pe){xe(Pe instanceof Error?Pe.message:"")}finally{ht(!1)}},mt=(Pe,lt)=>{if(!F.current)return;const vt=F.current.getBoundingClientRect(),cn={x:lt.clientX-vt.left+F.current.scrollLeft,y:lt.clientY-vt.top+F.current.scrollTop};an({fromId:Pe,fromPos:cn})},bn=Pe=>{if(!Xt||Xt.fromId===Pe){an(null);return}const lt=e.find(vt=>vt.id===Xt.fromId);if(lt){const vt=Array.from(new Set([...lt.nextTaskIds||[],Pe]));k(lt.id,vt)}an(null)},Qr=(Pe,lt)=>{const vt=e.find(cn=>cn.id===Pe);if(vt){const cn=(vt.nextTaskIds||[]).filter(Ln=>Ln!==lt);k(vt.id,cn)}},pa=Pe=>{if(!Xt||!F.current)return;const lt=F.current.getBoundingClientRect();An({x:Pe.clientX-lt.left+F.current.scrollLeft,y:Pe.clientY-lt.top+F.current.scrollTop})},ds=()=>{Xt&&an(null)},Ci=Pe=>{const lt=Pe.type==="task"?Pe.id:Pe.parentId;if(!lt)return;const vt=e.find(cn=>cn.id===lt);vt&&(ut(!1),r(vt))},wi=Pe=>{B(Pe),_t(!1)},Ai=n?new Date(n+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"";return q&&ie?v.jsx(Eh,{tasks:e,initialDeck:ie,onSave:Pe=>ye(Pe),onClose:()=>G(!1),projectGoal:t,targetDate:n,reportScope:"project",generateUniqueId:M}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 md:p-6 flex flex-col overflow-hidden",children:[v.jsxs("div",{className:"max-w-full mx-auto w-full",children:[v.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[v.jsxs("button",{onClick:()=>je(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-transform hover:scale-105",children:[v.jsx(Jd,{className:"w-5 h-5 mr-2"}),""]}),v.jsxs("div",{className:"flex flex-wrap gap-2",children:[v.jsx("button",{onClick:E,disabled:!S,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:v.jsx(VM,{className:"w-5 h-5"})}),v.jsx("button",{onClick:C,disabled:!w,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:v.jsx(GM,{className:"w-5 h-5"})}),v.jsx("button",{onClick:X,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"API",children:v.jsx(CT,{className:"w-5 h-5 text-yellow-600"})}),v.jsxs("button",{onClick:h,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",children:[v.jsx(Iu,{className:"w-5 h-5 mr-2"}),""]}),v.jsxs("button",{onClick:p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[v.jsx(Zu,{className:"w-5 h-5 mr-2"}),""]}),v.jsxs("button",{onClick:_,className:"inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",title:"",children:[v.jsx(yh,{className:"w-5 h-5 mr-2"}),""]})]})]}),v.jsxs("header",{className:"mb-6 p-6 bg-white rounded-xl shadow-lg",children:[v.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[v.jsxs("div",{children:[v.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:""}),v.jsxs("div",{className:"space-y-2 text-slate-700",children:[v.jsxs("p",{className:"flex items-start",children:[v.jsx(yT,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0 mt-1"}),v.jsx("strong",{children:":"}),"",v.jsx("span",{className:"break-all",children:t})]}),v.jsxs("p",{className:"flex items-center",children:[v.jsx(vT,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0"}),v.jsx("strong",{children:":"}),"",Ai]})]})]}),v.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[v.jsxs("button",{onClick:()=>Te(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[v.jsx(Xd,{className:"w-5 h-5 mr-2"}),""]}),v.jsxs("button",{onClick:()=>_t(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[v.jsx(Ul,{className:"w-5 h-5 mr-2"}),""]}),v.jsxs("button",{onClick:et,disabled:We,className:"inline-flex items-center justify-center px-4 py-2 border border-amber-300 text-sm font-medium rounded-md shadow-sm text-amber-800 bg-amber-100 hover:bg-amber-200 disabled:bg-slate-400",children:[We?v.jsx(Lr,{size:"sm"}):v.jsx(ST,{className:"w-5 h-5 mr-2"}),""]}),v.jsxs("button",{onClick:Ce,disabled:N,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400",children:[N?v.jsx(Lr,{size:"sm"}):v.jsx(es,{className:"w-5 h-5 mr-2"}),"AI"]}),v.jsxs("button",{onClick:Be,disabled:Ae,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-teal-600 hover:bg-teal-700 disabled:bg-slate-400",children:[Ae?v.jsx(Lr,{size:"sm"}):v.jsx(Th,{className:"w-5 h-5 mr-2"}),""]})]})]}),D&&v.jsx("div",{className:"mt-4",children:v.jsx("p",{className:"text-red-600 text-sm",children:D})}),Ee&&v.jsx("div",{className:"mt-4",children:v.jsx("p",{className:"text-red-600 text-sm",children:Ee})}),Ne&&v.jsx("div",{className:"mt-4",children:v.jsx("p",{className:"text-red-600 text-sm",children:Ne})})]})]}),v.jsxs("div",{ref:F,className:"flex-grow overflow-auto pb-8 relative min-h-[600px] border border-slate-300 rounded-lg bg-slate-50 p-4 shadow-inner",onDragOver:be,onDrop:Ge,onMouseMove:pa,onMouseUp:ds,children:[v.jsxs("div",{className:"relative w-full h-full min-w-[1200px] min-h-[800px]",children:[e.map((Pe,lt)=>v.jsx(JM,{cardRef:Y.get(Pe.id),task:Pe,onSelectTask:r,onRemoveTask:g,onUpdateStatus:c,onDragCardStart:Gt,onStartConnection:mt,onEndConnection:bn,index:lt},Pe.id)),Q.map(Pe=>v.jsx(Wd,{from:Pe.from,to:Pe.to,id:Pe.id,onDelete:()=>Qr(Pe.sourceId,Pe.targetId)},Pe.id)),Xt&&v.jsx(Wd,{from:Xt.fromPos,to:Qt,id:"preview-connector"})]}),e.length===0&&v.jsx("div",{className:"text-center py-10 flex-grow flex items-center justify-center",children:v.jsx("p",{className:"text-slate-500 text-lg",children:""})})]})]}),K&&b&&v.jsx(KR,{data:b,onClose:()=>ut(!1),onItemClick:Ci,onRegenerate:Oe,isRegenerating:We}),Mt&&v.jsx(QR,{tasks:e,projectGoal:t,targetDate:n,ganttData:b,projectReportDeck:ie,onClose:()=>_t(!1),onReportGenerated:wi,generateUniqueId:M}),De&&v.jsx(XM,{tasks:e,onClose:()=>Te(!1)}),re&&v.jsx(WM,{report:ne,onClose:()=>ce(!1)}),He&&v.jsx(rR,{onClose:()=>je(!1),onDownloadAndStartNew:()=>{p(),u()},onStartNewWithoutSaving:u})]})},tD=({proposals:e,existingSubSteps:t,onConfirm:n,onClose:r})=>{const[a,o]=ge.useState(()=>{const p={};return e.forEach((h,g)=>{p[g]={decision:"NEW",targetSubStepId:void 0}}),p}),c=(p,h,g)=>{o(y=>({...y,[p]:{...y[p],[h]:g}}))},u=()=>{const p=[],h=[];Object.entries(a).forEach(([g,y])=>{const _=parseInt(g,10),E=e[_];y.decision==="NEW"?p.push(E):y.decision==="ADD"&&y.targetSubStepId&&h.push({targetSubStepId:y.targetSubStepId,title:E.title})}),n({newSubSteps:p,newActionItems:h})};return v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:v.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[v.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),v.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:v.jsx(xr,{className:"w-6 h-6 text-slate-500"})})]}),v.jsxs("div",{className:"flex-grow p-5 overflow-y-auto space-y-4",children:[v.jsx("p",{className:"text-sm text-slate-600",children:"AI"}),v.jsx("div",{className:"space-y-3",children:e.map((p,h)=>v.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[v.jsx("p",{className:"font-semibold text-slate-800",children:p.title}),v.jsx("p",{className:"text-sm text-slate-600 mb-3",children:p.description}),v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsxs("select",{value:a[h].decision,onChange:g=>c(h,"decision",g.target.value),className:"p-2 border border-slate-300 rounded-md text-sm",children:[v.jsx("option",{value:"NEW",children:""}),t.length>0&&v.jsx("option",{value:"ADD",children:""}),v.jsx("option",{value:"IGNORE",children:""})]}),a[h].decision==="ADD"&&v.jsxs("select",{value:a[h].targetSubStepId||"",onChange:g=>c(h,"targetSubStepId",g.target.value),className:"flex-grow p-2 border border-slate-300 rounded-md text-sm",children:[v.jsx("option",{value:"",disabled:!0,children:"..."}),t.map(g=>v.jsx("option",{value:g.id,children:g.text},g.id))]})]})]},h))})]}),v.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[v.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),v.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var FT=1252,nD=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ah=function(e){nD.indexOf(e)!=-1&&(FT=wh[0]=e)};function rD(){Ah(1252)}var Xr=function(e){Ah(e)};function LT(){Xr(1200),rD()}function Dv(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function aD(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}function OT(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var _l=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return t==255&&n==254?aD(e.slice(2)):t==254&&n==255?OT(e.slice(2)):t==65279?e.slice(1):e},hu=function(t){return String.fromCharCode(t)},Iv=function(t){return String.fromCharCode(t)},Vl,hi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Fv(e){for(var t="",n=0,r=0,a=0,o=0,c=0,u=0,p=0,h=0;h<e.length;)n=e.charCodeAt(h++),o=n>>2,r=e.charCodeAt(h++),c=(n&3)<<4|r>>4,a=e.charCodeAt(h++),u=(r&15)<<2|a>>6,p=a&63,isNaN(r)?u=p=64:isNaN(a)&&(p=64),t+=hi.charAt(o)+hi.charAt(c)+hi.charAt(u)+hi.charAt(p);return t}function vr(e){var t="",n=0,r=0,a=0,o=0,c=0,u=0,p=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=hi.indexOf(e.charAt(h++)),c=hi.indexOf(e.charAt(h++)),n=o<<2|c>>4,t+=String.fromCharCode(n),u=hi.indexOf(e.charAt(h++)),r=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(r)),p=hi.indexOf(e.charAt(h++)),a=(u&3)<<6|p,p!==64&&(t+=String.fromCharCode(a));return t}var yt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ss=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ti(e){return yt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Lv(e){return yt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Jr=function(t){return yt?ss(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function os(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function bh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return bh(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var di=yt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ss(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function iD(e){for(var t=[],n=0,r=e.length+250,a=Ti(e.length+255),o=0;o<e.length;++o){var c=e.charCodeAt(o);if(c<128)a[n++]=c;else if(c<2048)a[n++]=192|c>>6&31,a[n++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++o)&1023;a[n++]=240|c>>8&7,a[n++]=128|c>>2&63,a[n++]=128|u>>6&15|(c&3)<<4,a[n++]=128|u&63}else a[n++]=224|c>>12&15,a[n++]=128|c>>6&63,a[n++]=128|c&63;n>r&&(t.push(a.slice(0,n)),n=0,a=Ti(65535),r=65530)}return t.push(a.slice(0,n)),di(t)}var Kn=/\u0000/g,El=/[\u0001-\u0006]/g;function ro(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Wr(e,t){var n=""+e;return n.length>=t?n:nn("0",t-n.length)+n}function kh(e,t){var n=""+e;return n.length>=t?n:nn(" ",t-n.length)+n}function Ou(e,t){var n=""+e;return n.length>=t?n:n+nn(" ",t-n.length)}function sD(e,t){var n=""+Math.round(e);return n.length>=t?n:nn("0",t-n.length)+n}function oD(e,t){var n=""+e;return n.length>=t?n:nn("0",t-n.length)+n}var Ov=Math.pow(2,32);function Ws(e,t){if(e>Ov||e<-Ov)return sD(e,t);var n=Math.round(e);return oD(n,t)}function Pu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Pv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function lD(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Uv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},cD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Uu(e,t,n){for(var r=e<0?-1:1,a=e*r,o=0,c=1,u=0,p=1,h=0,g=0,y=Math.floor(a);h<t&&(y=Math.floor(a),u=y*c+o,g=y*h+p,!(a-y<5e-8));)a=1/(a-y),o=c,c=u,p=h,h=g;if(g>t&&(h>t?(g=p,u=o):(g=h,u=c)),!n)return[0,r*u,g];var _=Math.floor(r*u/g);return[_,r*u-_*g,g]}function $i(e,t,n){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,c=[],u={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(r+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++r,++u.D)),r===60)c=n?[1317,10,29]:[1900,2,29],o=3;else if(r===0)c=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var p=new Date(1900,0,1);p.setDate(p.getDate()+r-1),c=[p.getFullYear(),p.getMonth()+1,p.getDate()],o=p.getDay(),r<60&&(o=(o+6)%7),n&&(o=pD(p,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var PT=new Date(1899,11,31,0,0,0),uD=PT.getTime(),fD=new Date(1900,2,1,0,0,0);function UT(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=fD&&(n+=24*60*60*1e3),(n-(uD+(e.getTimezoneOffset()-PT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Nh(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function dD(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hD(e){var t=e<0?12:11,n=Nh(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function mD(e){var t=Nh(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Gl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=hD(e):t===10?n=e.toFixed(10).substr(0,12):n=mD(e),Nh(dD(n.toUpperCase()))}function ns(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Gl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Or(14,UT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function pD(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function gD(e,t,n,r){var a="",o=0,c=0,u=n.y,p,h=0;switch(e){case 98:u=n.y+543;case 121:switch(t.length){case 1:case 2:p=u%100,h=2;break;default:p=u%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:p=n.m,h=t.length;break;case 3:return vd[n.m-1][1];case 5:return vd[n.m-1][0];default:return vd[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:p=n.d,h=t.length;break;case 3:return Pv[n.q][0];default:return Pv[n.q][1]}break;case 104:switch(t.length){case 1:case 2:p=1+(n.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:p=n.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:p=n.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Wr(n.S,t.length):(r>=2?c=r===3?1e3:100:c=r===1?10:1,o=Math.round(c*(n.S+n.u)),o>=60*c&&(o=0),t==="s"?o===0?"0":""+o/c:(a=Wr(o,2+r),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":p=n.D*24+n.H;break;case"[m]":case"[mm]":p=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":p=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:p=u,h=1;break}var g=h>0?Wr(p,h):"";return g}function mi(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var BT=/%/g;function xD(e,t,n){var r=t.replace(BT,""),a=t.length-r.length;return Fa(e,r,n*Math.pow(10,2*a))+nn("%",a)}function vD(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Fa(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function VT(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+VT(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),n=(t/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),n.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(c-n.length+o):n+="E+"+(c-o);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,p,h,g){return p+h+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var GT=/# (\?+)( ?)\/( ?)(\d+)/;function yD(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),o=Math.floor(a/r),c=a-o*r,u=r;return n+(o===0?"":""+o)+" "+(c===0?nn(" ",e[1].length+1+e[4].length):kh(c,e[1].length)+e[2]+"/"+e[3]+Wr(u,e[4].length))}function TD(e,t,n){return n+(t===0?"":""+t)+nn(" ",e[1].length+2+e[4].length)}var HT=/^#*0*\.([0#]+)/,zT=/\).*[0#]/,jT=/\(###\) ###\\?-####/;function Jn(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function Bv(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Vv(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function _D(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ED(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Dr(e,t,n){if(e.charCodeAt(0)===40&&!t.match(zT)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Dr("n",r,n):"("+Dr("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return vD(e,t,n);if(t.indexOf("%")!==-1)return xD(e,t,n);if(t.indexOf("E")!==-1)return VT(t,n);if(t.charCodeAt(0)===36)return"$"+Dr(e,t.substr(t.charAt(1)==" "?2:1),n);var a,o,c,u,p=Math.abs(n),h=n<0?"-":"";if(t.match(/^00+$/))return h+Ws(p,t.length);if(t.match(/^[#?]+$/))return a=Ws(n,0),a==="0"&&(a=""),a.length>t.length?a:Jn(t.substr(0,t.length-a.length))+a;if(o=t.match(GT))return yD(o,p,h);if(t.match(/^#+0+$/))return h+Ws(p,t.length-t.indexOf("0"));if(o=t.match(HT))return a=Bv(n,o[1].length).replace(/^([^\.]+)$/,"$1."+Jn(o[1])).replace(/\.$/,"."+Jn(o[1])).replace(/\.(\d*)$/,function(S,C){return"."+C+nn("0",Jn(o[1]).length-C.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+Bv(p,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+mi(Ws(p,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Dr(e,t,-n):mi(""+(Math.floor(n)+_D(n,o[1].length)))+"."+Wr(Vv(n,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return Dr(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ro(Dr(e,t.replace(/[\\-]/g,""),n)),c=0,ro(ro(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<a.length?a.charAt(c++):S==="0"?"0":""}));if(t.match(jT))return a=Dr(e,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=Uu(p,Math.pow(10,c)-1,!1),a=""+h,g=Fa("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=Ou(u[2],c),g.length<o[4].length&&(g=Jn(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=Uu(p,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?kh(u[1],c)+o[2]+"/"+o[3]+Ou(u[2],c):nn(" ",2*c+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=Ws(n,0),t.length<=a.length?a:Jn(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=t.indexOf(".")-c,_=t.length-a.length-y;return Jn(t.substr(0,y)+a+t.substr(t.length-_))}if(o=t.match(/^00,000\.([#0]*0)$/))return c=Vv(n,o[1].length),n<0?"-"+Dr(e,t,-n):mi(ED(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Wr(0,3-S.length):"")+S})+"."+Wr(c,o[1].length);switch(t){case"###,##0.00":return Dr(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var E=mi(Ws(p,0));return E!=="0"?h+E:"";case"###,###.00":return Dr(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Dr(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function SD(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Fa(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function CD(e,t,n){var r=t.replace(BT,""),a=t.length-r.length;return Fa(e,r,n*Math.pow(10,2*a))+nn("%",a)}function qT(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qT(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),n=(t/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!n.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(c-n.length+o):n+="E+"+(c-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,p,h,g){return p+h+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function oa(e,t,n){if(e.charCodeAt(0)===40&&!t.match(zT)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?oa("n",r,n):"("+oa("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return SD(e,t,n);if(t.indexOf("%")!==-1)return CD(e,t,n);if(t.indexOf("E")!==-1)return qT(t,n);if(t.charCodeAt(0)===36)return"$"+oa(e,t.substr(t.charAt(1)==" "?2:1),n);var a,o,c,u,p=Math.abs(n),h=n<0?"-":"";if(t.match(/^00+$/))return h+Wr(p,t.length);if(t.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>t.length?a:Jn(t.substr(0,t.length-a.length))+a;if(o=t.match(GT))return TD(o,p,h);if(t.match(/^#+0+$/))return h+Wr(p,t.length-t.indexOf("0"));if(o=t.match(HT))return a=(""+n).replace(/^([^\.]+)$/,"$1."+Jn(o[1])).replace(/\.$/,"."+Jn(o[1])),a=a.replace(/\.(\d*)$/,function(S,C){return"."+C+nn("0",Jn(o[1]).length-C.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+(""+p).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+mi(""+p);if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+oa(e,t,-n):mi(""+n)+"."+nn("0",o[1].length);if(o=t.match(/^#,#*,#0/))return oa(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ro(oa(e,t.replace(/[\\-]/g,""),n)),c=0,ro(ro(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<a.length?a.charAt(c++):S==="0"?"0":""}));if(t.match(jT))return a=oa(e,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=Uu(p,Math.pow(10,c)-1,!1),a=""+h,g=Fa("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=Ou(u[2],c),g.length<o[4].length&&(g=Jn(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=Uu(p,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?kh(u[1],c)+o[2]+"/"+o[3]+Ou(u[2],c):nn(" ",2*c+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:Jn(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=t.indexOf(".")-c,_=t.length-a.length-y;return Jn(t.substr(0,y)+a+t.substr(t.length-_))}if(o=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+oa(e,t,-n):mi(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Wr(0,3-S.length):"")+S})+"."+Wr(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var E=mi(""+p);return E!=="0"?h+E:"";default:if(t.match(/\.[0#?]*$/))return oa(e,t.slice(0,t.lastIndexOf(".")),n)+Jn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Fa(e,t,n){return(n|0)===n?oa(e,t,n):Dr(e,t,n)}function wD(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var YT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function To(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Pu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(YT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function AD(e,t,n,r){for(var a=[],o="",c=0,u="",p="t",h,g,y,_="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Pu(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(y=e.charCodeAt(++c))!==34&&c<e.length;)o+=String.fromCharCode(y);a[a.length]={t:"t",v:o},++c;break;case"\\":var E=e.charAt(++c),S=E==="("||E===")"?E:"t";a[a.length]={t:S,v:E},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(h==null&&(h=$i(t,n,e.charAt(c+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(c,2)},p=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=$i(t,n),h==null))return"";for(o=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)o+=u;u==="m"&&p.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:o},p=u;break;case"A":case"a":case"":var C={t:u,v:u};if(h==null&&(h=$i(t,n)),e.substr(c,3).toUpperCase()==="A/P"?(h!=null&&(C.v=h.H>=12?"P":"A"),C.t="T",_="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(h!=null&&(C.v=h.H>=12?"PM":"AM"),C.t="T",c+=5,_="h"):e.substr(c,5).toUpperCase()==="/"?(h!=null&&(C.v=h.H>=12?"":""),C.t="T",c+=5,_="h"):(C.t="t",++c),h==null&&C.t==="T")return"";a[a.length]=C,p=u;break;case"[":for(o=u;e.charAt(c++)!=="]"&&c<e.length;)o+=e.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(YT)){if(h==null&&(h=$i(t,n),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},p=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",To(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=u;++c<e.length&&(u=e.charAt(c))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;e.charAt(++c)===u;)o+=u;a[a.length]={t:u,v:o},p=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:r===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)o+=e.charAt(c);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c;break}var w=0,M=0,k;for(c=a.length-1,p="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=_,p="h",w<1&&(w=1);break;case"s":(k=a[c].v.match(/\.0+$/))&&(M=Math.max(M,k[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":p=a[c].t;break;case"m":p==="s"&&(a[c].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[c].v.match(/[Hh]/)&&(w=1),w<2&&a[c].v.match(/[Mm]/)&&(w=2),w<3&&a[c].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var b="",U;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=gD(a[c].t.charCodeAt(0),a[c].v,h,M),a[c].t="t";break;case"n":case"?":for(U=c+1;a[U]!=null&&((u=a[U].t)==="?"||u==="D"||(u===" "||u==="t")&&a[U+1]!=null&&(a[U+1].t==="?"||a[U+1].t==="t"&&a[U+1].v==="/")||a[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[U].v==="/"||a[U].v===" "&&a[U+1]!=null&&a[U+1].t=="?"));)a[c].v+=a[U].v,a[U]={v:"",t:";"},++U;b+=a[c].v,c=U-1;break;case"G":a[c].t="t",a[c].v=ns(t,n);break}var B="",X,F;if(b.length>0){b.charCodeAt(0)==40?(X=t<0&&b.charCodeAt(0)===45?-t:t,F=Fa("n",b,X)):(X=t<0&&r>1?-t:t,F=Fa("n",b,X),X<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),U=F.length-1;var Y=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){Y=c;break}var L=a.length;if(Y===a.length&&F.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(U>=a[c].v.length-1?(U-=a[c].v.length,a[c].v=F.substr(U+1,a[c].v.length)):U<0?a[c].v="":(a[c].v=F.substr(0,U+1),U=-1),a[c].t="t",L=c);U>=0&&L<a.length&&(a[L].v=F.substr(0,U+1)+a[L].v)}else if(Y!==a.length&&F.indexOf("E")===-1){for(U=F.indexOf(".")-1,c=Y;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(g=a[c].v.indexOf(".")>-1&&c===Y?a[c].v.indexOf(".")-1:a[c].v.length-1,B=a[c].v.substr(g+1);g>=0;--g)U>=0&&(a[c].v.charAt(g)==="0"||a[c].v.charAt(g)==="#")&&(B=F.charAt(U--)+B);a[c].v=B,a[c].t="t",L=c}for(U>=0&&L<a.length&&(a[L].v=F.substr(0,U+1)+a[L].v),U=F.indexOf(".")+1,c=Y;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==Y)){for(g=a[c].v.indexOf(".")>-1&&c===Y?a[c].v.indexOf(".")+1:0,B=a[c].v.substr(0,g);g<a[c].v.length;++g)U<F.length&&(B+=F.charAt(U++));a[c].v=B,a[c].t="t",L=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(X=r>1&&t<0&&c>0&&a[c-1].v==="-"?-t:t,a[c].v=Fa(a[c].t,a[c].v,X),a[c].t="t");var Q="";for(c=0;c!==a.length;++c)a[c]!=null&&(Q+=a[c].v);return Q}var Gv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hv(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function bD(e,t){var n=wD(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var o=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,o];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var c=n[0].match(Gv),u=n[1].match(Gv);return Hv(t,c)?[r,n[0]]:Hv(t,u)?[r,n[1]]:[r,n[c!=null&&u!=null?2:1]]}return[r,o]}function Or(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:ot)[e],r==null&&(r=n.table&&n.table[Uv[e]]||ot[Uv[e]]),r==null&&(r=cD[e]||"General");break}if(Pu(r,0))return ns(t,n);t instanceof Date&&(t=UT(t,n.date1904));var a=bD(r,t);if(Pu(a[1]))return ns(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return AD(a[1],t,n,a[0])}function Ji(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(ot[n]==null){t<0&&(t=n);continue}if(ot[n]==e){t=n;break}}t<0&&(t=391)}return ot[t]=e,t}function $T(){ot=lD()}var kD={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},JT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ND(e){var t=typeof e=="number"?ot[e]:e;return t=t.replace(JT,"(\\d+)"),new RegExp("^"+t+"$")}function MD(e,t,n){var r=-1,a=-1,o=-1,c=-1,u=-1,p=-1;(t.match(JT)||[]).forEach(function(y,_){var E=parseInt(n[_+1],10);switch(y.toLowerCase().charAt(0)){case"y":r=E;break;case"d":o=E;break;case"h":c=E;break;case"s":p=E;break;case"m":c>=0?u=E:a=E;break}}),p>=0&&u==-1&&a>=0&&(u=a,a=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var g=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2);return c==-1&&u==-1&&p==-1?h:r==-1&&a==-1&&o==-1?g:h+"T"+g}var RD=function(){var e={};e.version="1.2.0";function t(){for(var F=0,Y=new Array(256),L=0;L!=256;++L)F=L,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,Y[L]=F;return typeof Int32Array<"u"?new Int32Array(Y):Y}var n=t();function r(F){var Y=0,L=0,Q=0,te=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Q=0;Q!=256;++Q)te[Q]=F[Q];for(Q=0;Q!=256;++Q)for(L=F[Q],Y=256+Q;Y<4096;Y+=256)L=te[Y]=L>>>8^F[L&255];var ee=[];for(Q=1;Q!=16;++Q)ee[Q-1]=typeof Int32Array<"u"?te.subarray(Q*256,Q*256+256):te.slice(Q*256,Q*256+256);return ee}var a=r(n),o=a[0],c=a[1],u=a[2],p=a[3],h=a[4],g=a[5],y=a[6],_=a[7],E=a[8],S=a[9],C=a[10],w=a[11],M=a[12],k=a[13],b=a[14];function U(F,Y){for(var L=Y^-1,Q=0,te=F.length;Q<te;)L=L>>>8^n[(L^F.charCodeAt(Q++))&255];return~L}function B(F,Y){for(var L=Y^-1,Q=F.length-15,te=0;te<Q;)L=b[F[te++]^L&255]^k[F[te++]^L>>8&255]^M[F[te++]^L>>16&255]^w[F[te++]^L>>>24]^C[F[te++]]^S[F[te++]]^E[F[te++]]^_[F[te++]]^y[F[te++]]^g[F[te++]]^h[F[te++]]^p[F[te++]]^u[F[te++]]^c[F[te++]]^o[F[te++]]^n[F[te++]];for(Q+=15;te<Q;)L=L>>>8^n[(L^F[te++])&255];return~L}function X(F,Y){for(var L=Y^-1,Q=0,te=F.length,ee=0,_e=0;Q<te;)ee=F.charCodeAt(Q++),ee<128?L=L>>>8^n[(L^ee)&255]:ee<2048?(L=L>>>8^n[(L^(192|ee>>6&31))&255],L=L>>>8^n[(L^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,_e=F.charCodeAt(Q++)&1023,L=L>>>8^n[(L^(240|ee>>8&7))&255],L=L>>>8^n[(L^(128|ee>>2&63))&255],L=L>>>8^n[(L^(128|_e>>6&15|(ee&3)<<4))&255],L=L>>>8^n[(L^(128|_e&63))&255]):(L=L>>>8^n[(L^(224|ee>>12&15))&255],L=L>>>8^n[(L^(128|ee>>6&63))&255],L=L>>>8^n[(L^(128|ee&63))&255]);return~L}return e.table=n,e.bstr=U,e.buf=B,e.str=X,e}(),St=function(){var t={};t.version="1.2.1";function n(R,H){for(var O=R.split("/"),P=H.split("/"),V=0,z=0,fe=Math.min(O.length,P.length);V<fe;++V){if(z=O[V].length-P[V].length)return z;if(O[V]!=P[V])return O[V]<P[V]?-1:1}return O.length-P.length}function r(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:r(R.slice(0,-1));var H=R.lastIndexOf("/");return H===-1?R:R.slice(0,H+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var H=R.lastIndexOf("/");return H===-1?R:R.slice(H+1)}function o(R,H){typeof H=="string"&&(H=new Date(H));var O=H.getHours();O=O<<6|H.getMinutes(),O=O<<5|H.getSeconds()>>>1,R.write_shift(2,O);var P=H.getFullYear()-1980;P=P<<4|H.getMonth()+1,P=P<<5|H.getDate(),R.write_shift(2,P)}function c(R){var H=R.read_shift(2)&65535,O=R.read_shift(2)&65535,P=new Date,V=O&31;O>>>=5;var z=O&15;O>>>=4,P.setMilliseconds(0),P.setFullYear(O+1980),P.setMonth(z-1),P.setDate(V);var fe=H&31;H>>>=5;var ve=H&63;return H>>>=6,P.setHours(H),P.setMinutes(ve),P.setSeconds(fe<<1),P}function u(R){Dn(R,0);for(var H={},O=0;R.l<=R.length-4;){var P=R.read_shift(2),V=R.read_shift(2),z=R.l+V,fe={};switch(P){case 21589:O=R.read_shift(1),O&1&&(fe.mtime=R.read_shift(4)),V>5&&(O&2&&(fe.atime=R.read_shift(4)),O&4&&(fe.ctime=R.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}R.l=z,H[P]=fe}return H}var p;function h(){return p||(p={})}function g(R,H){if(R[0]==80&&R[1]==75)return wi(R,H);if((R[0]|32)==109&&(R[1]|32)==105)return bi(R,H);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var O=3,P=512,V=0,z=0,fe=0,ve=0,oe=0,de=[],me=R.slice(0,512);Dn(me,0);var Re=y(me);switch(O=Re[0],O){case 3:P=512;break;case 4:P=4096;break;case 0:if(Re[1]==0)return wi(R,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}P!==512&&(me=R.slice(0,P),Dn(me,28));var Le=R.slice(0,P);_(me,O);var ze=me.read_shift(4,"i");if(O===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);me.l+=4,fe=me.read_shift(4,"i"),me.l+=4,me.chk("00100000","Mini Stream Cutoff Size: "),ve=me.read_shift(4,"i"),V=me.read_shift(4,"i"),oe=me.read_shift(4,"i"),z=me.read_shift(4,"i");for(var Ie=-1,Ue=0;Ue<109&&(Ie=me.read_shift(4,"i"),!(Ie<0));++Ue)de[Ue]=Ie;var at=E(R,P);w(oe,z,at,P,de);var Ft=k(at,fe,de,P);Ft[fe].name="!Directory",V>0&&ve!==_e&&(Ft[ve].name="!MiniFAT"),Ft[de[0]].name="!FAT",Ft.fat_addrs=de,Ft.ssz=P;var Lt={},zt=[],xa=[],Ga=[];b(fe,Ft,at,zt,V,Lt,xa,ve),S(xa,Ga,zt),zt.shift();var Tr={FileIndex:xa,FullPaths:Ga};return H&&H.raw&&(Tr.raw={header:Le,sectors:at}),Tr}function y(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(De,"Header Signature: "),R.l+=16;var H=R.read_shift(2,"u");return[R.read_shift(2,"u"),H]}function _(R,H){var O=9;switch(R.l+=2,O=R.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function E(R,H){for(var O=Math.ceil(R.length/H)-1,P=[],V=1;V<O;++V)P[V-1]=R.slice(V*H,(V+1)*H);return P[O-1]=R.slice(O*H),P}function S(R,H,O){for(var P=0,V=0,z=0,fe=0,ve=0,oe=O.length,de=[],me=[];P<oe;++P)de[P]=me[P]=P,H[P]=O[P];for(;ve<me.length;++ve)P=me[ve],V=R[P].L,z=R[P].R,fe=R[P].C,de[P]===P&&(V!==-1&&de[V]!==V&&(de[P]=de[V]),z!==-1&&de[z]!==z&&(de[P]=de[z])),fe!==-1&&(de[fe]=P),V!==-1&&P!=de[P]&&(de[V]=de[P],me.lastIndexOf(V)<ve&&me.push(V)),z!==-1&&P!=de[P]&&(de[z]=de[P],me.lastIndexOf(z)<ve&&me.push(z));for(P=1;P<oe;++P)de[P]===P&&(z!==-1&&de[z]!==z?de[P]=de[z]:V!==-1&&de[V]!==V&&(de[P]=de[V]));for(P=1;P<oe;++P)if(R[P].type!==0){if(ve=P,ve!=de[ve])do ve=de[ve],H[P]=H[ve]+"/"+H[P];while(ve!==0&&de[ve]!==-1&&ve!=de[ve]);de[P]=-1}for(H[0]+="/",P=1;P<oe;++P)R[P].type!==2&&(H[P]+="/")}function C(R,H,O){for(var P=R.start,V=R.size,z=[],fe=P;O&&V>0&&fe>=0;)z.push(H.slice(fe*ee,fe*ee+ee)),V-=ee,fe=Yi(O,fe*4);return z.length===0?vn(0):di(z).slice(0,R.size)}function w(R,H,O,P,V){var z=_e;if(R===_e){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var fe=O[R],ve=(P>>>2)-1;if(!fe)return;for(var oe=0;oe<ve&&(z=Yi(fe,oe*4))!==_e;++oe)V.push(z);w(Yi(fe,P-4),H-1,O,P,V)}}function M(R,H,O,P,V){var z=[],fe=[];V||(V=[]);var ve=P-1,oe=0,de=0;for(oe=H;oe>=0;){V[oe]=!0,z[z.length]=oe,fe.push(R[oe]);var me=O[Math.floor(oe*4/P)];if(de=oe*4&ve,P<4+de)throw new Error("FAT boundary crossed: "+oe+" 4 "+P);if(!R[me])break;oe=Yi(R[me],de)}return{nodes:z,data:Zv([fe])}}function k(R,H,O,P){var V=R.length,z=[],fe=[],ve=[],oe=[],de=P-1,me=0,Re=0,Le=0,ze=0;for(me=0;me<V;++me)if(ve=[],Le=me+H,Le>=V&&(Le-=V),!fe[Le]){oe=[];var Ie=[];for(Re=Le;Re>=0;){Ie[Re]=!0,fe[Re]=!0,ve[ve.length]=Re,oe.push(R[Re]);var Ue=O[Math.floor(Re*4/P)];if(ze=Re*4&de,P<4+ze)throw new Error("FAT boundary crossed: "+Re+" 4 "+P);if(!R[Ue]||(Re=Yi(R[Ue],ze),Ie[Re]))break}z[Le]={nodes:ve,data:Zv([oe])}}return z}function b(R,H,O,P,V,z,fe,ve){for(var oe=0,de=P.length?2:0,me=H[R].data,Re=0,Le=0,ze;Re<me.length;Re+=128){var Ie=me.slice(Re,Re+128);Dn(Ie,64),Le=Ie.read_shift(2),ze=Fh(Ie,0,Le-de),P.push(ze);var Ue={name:ze,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},at=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);at!==0&&(Ue.ct=U(Ie,Ie.l-8));var Ft=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Ft!==0&&(Ue.mt=U(Ie,Ie.l-8)),Ue.start=Ie.read_shift(4,"i"),Ue.size=Ie.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=_e,Ue.name=""),Ue.type===5?(oe=Ue.start,V>0&&oe!==_e&&(H[oe].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",H[Ue.start]===void 0&&(H[Ue.start]=M(O,Ue.start,H.fat_addrs,H.ssz)),H[Ue.start].name=Ue.name,Ue.content=H[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:oe!==_e&&Ue.start!==_e&&H[oe]&&(Ue.content=C(Ue,H[oe].data,(H[ve]||{}).data))),Ue.content&&Dn(Ue.content,0),z[ze]=Ue,fe.push(Ue)}}function U(R,H){return new Date((pr(R,H+4)/1e7*Math.pow(2,32)+pr(R,H)/1e7-11644473600)*1e3)}function B(R,H){return h(),g(p.readFileSync(R),H)}function X(R,H){var O=H&&H.type;switch(O||yt&&Buffer.isBuffer(R)&&(O="buffer"),O||"base64"){case"file":return B(R,H);case"base64":return g(Jr(vr(R)),H);case"binary":return g(Jr(R),H)}return g(R,H)}function F(R,H){var O=H||{},P=O.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=P+"/",R.FileIndex[0]={name:P,type:5}),O.CLSID&&(R.FileIndex[0].clsid=O.CLSID),Y(R)}function Y(R){var H="Sh33tJ5";if(!St.find(R,"/"+H)){var O=vn(4);O[0]=55,O[1]=O[3]=50,O[2]=54,R.FileIndex.push({name:H,type:2,content:O,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+H),L(R)}}function L(R,H){F(R);for(var O=!1,P=!1,V=R.FullPaths.length-1;V>=0;--V){var z=R.FileIndex[V];switch(z.type){case 0:P?O=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(z.R*z.L*z.C)&&(O=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!H)){var fe=new Date(1987,1,19),ve=0,oe=Object.create?Object.create(null):{},de=[];for(V=0;V<R.FullPaths.length;++V)oe[R.FullPaths[V]]=!0,R.FileIndex[V].type!==0&&de.push([R.FullPaths[V],R.FileIndex[V]]);for(V=0;V<de.length;++V){var me=r(de[V][0]);P=oe[me],P||(de.push([me,{name:a(me).replace("/",""),type:1,clsid:re,ct:fe,mt:fe,content:null}]),oe[me]=!0)}for(de.sort(function(ze,Ie){return n(ze[0],Ie[0])}),R.FullPaths=[],R.FileIndex=[],V=0;V<de.length;++V)R.FullPaths[V]=de[V][0],R.FileIndex[V]=de[V][1];for(V=0;V<de.length;++V){var Re=R.FileIndex[V],Le=R.FullPaths[V];if(Re.name=a(Le).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||re,V===0)Re.C=de.length>1?1:-1,Re.size=0,Re.type=5;else if(Le.slice(-1)=="/"){for(ve=V+1;ve<de.length&&r(R.FullPaths[ve])!=Le;++ve);for(Re.C=ve>=de.length?-1:ve,ve=V+1;ve<de.length&&r(R.FullPaths[ve])!=r(Le);++ve);Re.R=ve>=de.length?-1:ve,Re.type=1}else r(R.FullPaths[V+1]||"")==r(Le)&&(Re.R=V+1),Re.type=2}}}function Q(R,H){var O=H||{};if(O.fileType=="mad")return Yn(R,O);switch(L(R),O.fileType){case"zip":return Pe(R,O)}var P=function(ze){for(var Ie=0,Ue=0,at=0;at<ze.FileIndex.length;++at){var Ft=ze.FileIndex[at];if(Ft.content){var Lt=Ft.content.length;Lt>0&&(Lt<4096?Ie+=Lt+63>>6:Ue+=Lt+511>>9)}}for(var zt=ze.FullPaths.length+3>>2,xa=Ie+7>>3,Ga=Ie+127>>7,Tr=xa+Ue+zt+Ga,Gr=Tr+127>>7,ki=Gr<=109?0:Math.ceil((Gr-109)/127);Tr+Gr+ki+127>>7>Gr;)ki=++Gr<=109?0:Math.ceil((Gr-109)/127);var Hr=[1,ki,Gr,Ga,zt,Ue,Ie,0];return ze.FileIndex[0].size=Ie<<6,Hr[7]=(ze.FileIndex[0].start=Hr[0]+Hr[1]+Hr[2]+Hr[3]+Hr[4]+Hr[5])+(Hr[6]+7>>3),Hr}(R),V=vn(P[7]<<9),z=0,fe=0;{for(z=0;z<8;++z)V.write_shift(1,Te[z]);for(z=0;z<8;++z)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),z=0;z<3;++z)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,P[2]),V.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:_e),V.write_shift(4,P[3]),V.write_shift(-4,P[1]?P[0]-1:_e),V.write_shift(4,P[1]),z=0;z<109;++z)V.write_shift(-4,z<P[2]?P[1]+z:-1)}if(P[1])for(fe=0;fe<P[1];++fe){for(;z<236+fe*127;++z)V.write_shift(-4,z<P[2]?P[1]+z:-1);V.write_shift(-4,fe===P[1]-1?_e:fe+1)}var ve=function(ze){for(fe+=ze;z<fe-1;++z)V.write_shift(-4,z+1);ze&&(++z,V.write_shift(-4,_e))};for(fe=z=0,fe+=P[1];z<fe;++z)V.write_shift(-4,ce.DIFSECT);for(fe+=P[2];z<fe;++z)V.write_shift(-4,ce.FATSECT);ve(P[3]),ve(P[4]);for(var oe=0,de=0,me=R.FileIndex[0];oe<R.FileIndex.length;++oe)me=R.FileIndex[oe],me.content&&(de=me.content.length,!(de<4096)&&(me.start=fe,ve(de+511>>9)));for(ve(P[6]+7>>3);V.l&511;)V.write_shift(-4,ce.ENDOFCHAIN);for(fe=z=0,oe=0;oe<R.FileIndex.length;++oe)me=R.FileIndex[oe],me.content&&(de=me.content.length,!(!de||de>=4096)&&(me.start=fe,ve(de+63>>6)));for(;V.l&511;)V.write_shift(-4,ce.ENDOFCHAIN);for(z=0;z<P[4]<<2;++z){var Re=R.FullPaths[z];if(!Re||Re.length===0){for(oe=0;oe<17;++oe)V.write_shift(4,0);for(oe=0;oe<3;++oe)V.write_shift(4,-1);for(oe=0;oe<12;++oe)V.write_shift(4,0);continue}me=R.FileIndex[z],z===0&&(me.start=me.size?me.start-1:_e);var Le=z===0&&O.root||me.name;if(de=2*(Le.length+1),V.write_shift(64,Le,"utf16le"),V.write_shift(2,de),V.write_shift(1,me.type),V.write_shift(1,me.color),V.write_shift(-4,me.L),V.write_shift(-4,me.R),V.write_shift(-4,me.C),me.clsid)V.write_shift(16,me.clsid,"hex");else for(oe=0;oe<4;++oe)V.write_shift(4,0);V.write_shift(4,me.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,me.start),V.write_shift(4,me.size),V.write_shift(4,0)}for(z=1;z<R.FileIndex.length;++z)if(me=R.FileIndex[z],me.size>=4096)if(V.l=me.start+1<<9,yt&&Buffer.isBuffer(me.content))me.content.copy(V,V.l,0,me.size),V.l+=me.size+511&-512;else{for(oe=0;oe<me.size;++oe)V.write_shift(1,me.content[oe]);for(;oe&511;++oe)V.write_shift(1,0)}for(z=1;z<R.FileIndex.length;++z)if(me=R.FileIndex[z],me.size>0&&me.size<4096)if(yt&&Buffer.isBuffer(me.content))me.content.copy(V,V.l,0,me.size),V.l+=me.size+63&-64;else{for(oe=0;oe<me.size;++oe)V.write_shift(1,me.content[oe]);for(;oe&63;++oe)V.write_shift(1,0)}if(yt)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function te(R,H){var O=R.FullPaths.map(function(oe){return oe.toUpperCase()}),P=O.map(function(oe){var de=oe.split("/");return de[de.length-(oe.slice(-1)=="/"?2:1)]}),V=!1;H.charCodeAt(0)===47?(V=!0,H=O[0].slice(0,-1)+H):V=H.indexOf("/")!==-1;var z=H.toUpperCase(),fe=V===!0?O.indexOf(z):P.indexOf(z);if(fe!==-1)return R.FileIndex[fe];var ve=!z.match(El);for(z=z.replace(Kn,""),ve&&(z=z.replace(El,"!")),fe=0;fe<O.length;++fe)if((ve?O[fe].replace(El,"!"):O[fe]).replace(Kn,"")==z||(ve?P[fe].replace(El,"!"):P[fe]).replace(Kn,"")==z)return R.FileIndex[fe];return null}var ee=64,_e=-2,De="d0cf11e0a1b11ae1",Te=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_e,FREESECT:-1,HEADER_SIGNATURE:De,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ne(R,H,O){h();var P=Q(R,O);p.writeFileSync(H,P)}function j(R){for(var H=new Array(R.length),O=0;O<R.length;++O)H[O]=String.fromCharCode(R[O]);return H.join("")}function N(R,H){var O=Q(R,H);switch(H&&H.type||"buffer"){case"file":return h(),p.writeFileSync(H.filename,O),O;case"binary":return typeof O=="string"?O:j(O);case"base64":return Fv(typeof O=="string"?O:j(O));case"buffer":if(yt)return Buffer.isBuffer(O)?O:ss(O);case"array":return typeof O=="string"?Jr(O):O}return O}var W;function D(R){try{var H=R.InflateRaw,O=new H;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)W=R;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function J(R,H){if(!W)return ds(R,H);var O=W.InflateRaw,P=new O,V=P._processChunk(R.slice(R.l),P._finishFlushFlag);return R.l+=P.bytesRead,V}function q(R){return W?W.deflateRawSync(R):Ce(R)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(R){var H=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(H>>16|H>>8|H)&255}for(var Me=typeof Uint8Array<"u",Ee=Me?new Uint8Array(256):[],Ze=0;Ze<256;++Ze)Ee[Ze]=Ae(Ze);function K(R,H){var O=Ee[R&255];return H<=8?O>>>8-H:(O=O<<8|Ee[R>>8&255],H<=16?O>>>16-H:(O=O<<8|Ee[R>>16&255],O>>>24-H))}function ut(R,H){var O=H&7,P=H>>>3;return(R[P]|(O<=6?0:R[P+1]<<8))>>>O&3}function We(R,H){var O=H&7,P=H>>>3;return(R[P]|(O<=5?0:R[P+1]<<8))>>>O&7}function ht(R,H){var O=H&7,P=H>>>3;return(R[P]|(O<=4?0:R[P+1]<<8))>>>O&15}function Ne(R,H){var O=H&7,P=H>>>3;return(R[P]|(O<=3?0:R[P+1]<<8))>>>O&31}function xe(R,H){var O=H&7,P=H>>>3;return(R[P]|(O<=1?0:R[P+1]<<8))>>>O&127}function He(R,H,O){var P=H&7,V=H>>>3,z=(1<<O)-1,fe=R[V]>>>P;return O<8-P||(fe|=R[V+1]<<8-P,O<16-P)||(fe|=R[V+2]<<16-P,O<24-P)||(fe|=R[V+3]<<24-P),fe&z}function je(R,H,O){var P=H&7,V=H>>>3;return P<=5?R[V]|=(O&7)<<P:(R[V]|=O<<P&255,R[V+1]=(O&7)>>8-P),H+3}function Mt(R,H,O){var P=H&7,V=H>>>3;return O=(O&1)<<P,R[V]|=O,H+1}function _t(R,H,O){var P=H&7,V=H>>>3;return O<<=P,R[V]|=O&255,O>>>=8,R[V+1]=O,H+8}function Xt(R,H,O){var P=H&7,V=H>>>3;return O<<=P,R[V]|=O&255,O>>>=8,R[V+1]=O&255,R[V+2]=O>>>8,H+16}function an(R,H){var O=R.length,P=2*O>H?2*O:H+5,V=0;if(O>=H)return R;if(yt){var z=Lv(P);if(R.copy)R.copy(z);else for(;V<R.length;++V)z[V]=R[V];return z}else if(Me){var fe=new Uint8Array(P);if(fe.set)fe.set(R);else for(;V<O;++V)fe[V]=R[V];return fe}return R.length=P,R}function Qt(R){for(var H=new Array(R),O=0;O<R;++O)H[O]=0;return H}function An(R,H,O){var P=1,V=0,z=0,fe=0,ve=0,oe=R.length,de=Me?new Uint16Array(32):Qt(32);for(z=0;z<32;++z)de[z]=0;for(z=oe;z<O;++z)R[z]=0;oe=R.length;var me=Me?new Uint16Array(oe):Qt(oe);for(z=0;z<oe;++z)de[V=R[z]]++,P<V&&(P=V),me[z]=0;for(de[0]=0,z=1;z<=P;++z)de[z+16]=ve=ve+de[z-1]<<1;for(z=0;z<oe;++z)ve=R[z],ve!=0&&(me[z]=de[ve+16]++);var Re=0;for(z=0;z<oe;++z)if(Re=R[z],Re!=0)for(ve=K(me[z],P)>>P-Re,fe=(1<<P+4-Re)-1;fe>=0;--fe)H[ve|fe<<Re]=Re&15|z<<4;return P}var Vt=Me?new Uint16Array(512):Qt(512),Gt=Me?new Uint16Array(32):Qt(32);if(!Me){for(var be=0;be<512;++be)Vt[be]=0;for(be=0;be<32;++be)Gt[be]=0}(function(){for(var R=[],H=0;H<32;H++)R.push(5);An(R,Gt,32);var O=[];for(H=0;H<=143;H++)O.push(8);for(;H<=255;H++)O.push(9);for(;H<=279;H++)O.push(7);for(;H<=287;H++)O.push(8);An(O,Vt,288)})();var Ge=function(){for(var H=Me?new Uint8Array(32768):[],O=0,P=0;O<ye.length-1;++O)for(;P<ye[O+1];++P)H[P]=O;for(;P<32768;++P)H[P]=29;var V=Me?new Uint8Array(259):[];for(O=0,P=0;O<ie.length-1;++O)for(;P<ie[O+1];++P)V[P]=O;function z(ve,oe){for(var de=0;de<ve.length;){var me=Math.min(65535,ve.length-de),Re=de+me==ve.length;for(oe.write_shift(1,+Re),oe.write_shift(2,me),oe.write_shift(2,~me&65535);me-- >0;)oe[oe.l++]=ve[de++]}return oe.l}function fe(ve,oe){for(var de=0,me=0,Re=Me?new Uint16Array(32768):[];me<ve.length;){var Le=Math.min(65535,ve.length-me);if(Le<10){for(de=je(oe,de,+(me+Le==ve.length)),de&7&&(de+=8-(de&7)),oe.l=de/8|0,oe.write_shift(2,Le),oe.write_shift(2,~Le&65535);Le-- >0;)oe[oe.l++]=ve[me++];de=oe.l*8;continue}de=je(oe,de,+(me+Le==ve.length)+2);for(var ze=0;Le-- >0;){var Ie=ve[me];ze=(ze<<5^Ie)&32767;var Ue=-1,at=0;if((Ue=Re[ze])&&(Ue|=me&-32768,Ue>me&&(Ue-=32768),Ue<me))for(;ve[Ue+at]==ve[me+at]&&at<250;)++at;if(at>2){Ie=V[at],Ie<=22?de=_t(oe,de,Ee[Ie+1]>>1)-1:(_t(oe,de,3),de+=5,_t(oe,de,Ee[Ie-23]>>5),de+=3);var Ft=Ie<8?0:Ie-4>>2;Ft>0&&(Xt(oe,de,at-ie[Ie]),de+=Ft),Ie=H[me-Ue],de=_t(oe,de,Ee[Ie]>>3),de-=3;var Lt=Ie<4?0:Ie-2>>1;Lt>0&&(Xt(oe,de,me-Ue-ye[Ie]),de+=Lt);for(var zt=0;zt<at;++zt)Re[ze]=me&32767,ze=(ze<<5^ve[me])&32767,++me;Le-=at-1}else Ie<=143?Ie=Ie+48:de=Mt(oe,de,1),de=_t(oe,de,Ee[Ie]),Re[ze]=me&32767,++me}de=_t(oe,de,0)-1}return oe.l=(de+7)/8|0,oe.l}return function(oe,de){return oe.length<8?z(oe,de):fe(oe,de)}}();function Ce(R){var H=vn(50+Math.floor(R.length*1.1)),O=Ge(R,H);return H.slice(0,O)}var Be=Me?new Uint16Array(32768):Qt(32768),et=Me?new Uint16Array(32768):Qt(32768),Oe=Me?new Uint16Array(128):Qt(128),mt=1,bn=1;function Qr(R,H){var O=Ne(R,H)+257;H+=5;var P=Ne(R,H)+1;H+=5;var V=ht(R,H)+4;H+=4;for(var z=0,fe=Me?new Uint8Array(19):Qt(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,de=Me?new Uint8Array(8):Qt(8),me=Me?new Uint8Array(8):Qt(8),Re=fe.length,Le=0;Le<V;++Le)fe[G[Le]]=z=We(R,H),oe<z&&(oe=z),de[z]++,H+=3;var ze=0;for(de[0]=0,Le=1;Le<=oe;++Le)me[Le]=ze=ze+de[Le-1]<<1;for(Le=0;Le<Re;++Le)(ze=fe[Le])!=0&&(ve[Le]=me[ze]++);var Ie=0;for(Le=0;Le<Re;++Le)if(Ie=fe[Le],Ie!=0){ze=Ee[ve[Le]]>>8-Ie;for(var Ue=(1<<7-Ie)-1;Ue>=0;--Ue)Oe[ze|Ue<<Ie]=Ie&7|Le<<3}var at=[];for(oe=1;at.length<O+P;)switch(ze=Oe[xe(R,H)],H+=ze&7,ze>>>=3){case 16:for(z=3+ut(R,H),H+=2,ze=at[at.length-1];z-- >0;)at.push(ze);break;case 17:for(z=3+We(R,H),H+=3;z-- >0;)at.push(0);break;case 18:for(z=11+xe(R,H),H+=7;z-- >0;)at.push(0);break;default:at.push(ze),oe<ze&&(oe=ze);break}var Ft=at.slice(0,O),Lt=at.slice(O);for(Le=O;Le<286;++Le)Ft[Le]=0;for(Le=P;Le<30;++Le)Lt[Le]=0;return mt=An(Ft,Be,286),bn=An(Lt,et,30),H}function pa(R,H){if(R[0]==3&&!(R[1]&3))return[Ti(H),2];for(var O=0,P=0,V=Lv(H||1<<18),z=0,fe=V.length>>>0,ve=0,oe=0;(P&1)==0;){if(P=We(R,O),O+=3,P>>>1)P>>1==1?(ve=9,oe=5):(O=Qr(R,O),ve=mt,oe=bn);else{O&7&&(O+=8-(O&7));var de=R[O>>>3]|R[(O>>>3)+1]<<8;if(O+=32,de>0)for(!H&&fe<z+de&&(V=an(V,z+de),fe=V.length);de-- >0;)V[z++]=R[O>>>3],O+=8;continue}for(;;){!H&&fe<z+32767&&(V=an(V,z+32767),fe=V.length);var me=He(R,O,ve),Re=P>>>1==1?Vt[me]:Be[me];if(O+=Re&15,Re>>>=4,(Re>>>8&255)===0)V[z++]=Re;else{if(Re==256)break;Re-=257;var Le=Re<8?0:Re-4>>2;Le>5&&(Le=0);var ze=z+ie[Re];Le>0&&(ze+=He(R,O,Le),O+=Le),me=He(R,O,oe),Re=P>>>1==1?Gt[me]:et[me],O+=Re&15,Re>>>=4;var Ie=Re<4?0:Re-2>>1,Ue=ye[Re];for(Ie>0&&(Ue+=He(R,O,Ie),O+=Ie),!H&&fe<ze&&(V=an(V,ze+100),fe=V.length);z<ze;)V[z]=V[z-Ue],++z}}}return H?[V,O+7>>>3]:[V.slice(0,z),O+7>>>3]}function ds(R,H){var O=R.slice(R.l||0),P=pa(O,H);return R.l+=P[1],P[0]}function Ci(R,H){if(R)typeof console<"u"&&console.error(H);else throw new Error(H)}function wi(R,H){var O=R;Dn(O,0);var P=[],V=[],z={FileIndex:P,FullPaths:V};F(z,{root:H.root});for(var fe=O.length-4;(O[fe]!=80||O[fe+1]!=75||O[fe+2]!=5||O[fe+3]!=6)&&fe>=0;)--fe;O.l=fe+4,O.l+=4;var ve=O.read_shift(2);O.l+=6;var oe=O.read_shift(4);for(O.l=oe,fe=0;fe<ve;++fe){O.l+=20;var de=O.read_shift(4),me=O.read_shift(4),Re=O.read_shift(2),Le=O.read_shift(2),ze=O.read_shift(2);O.l+=8;var Ie=O.read_shift(4),Ue=u(O.slice(O.l+Re,O.l+Re+Le));O.l+=Re+Le+ze;var at=O.l;O.l=Ie+4,Ai(O,de,me,z,Ue),O.l=at}return z}function Ai(R,H,O,P,V){R.l+=2;var z=R.read_shift(2),fe=R.read_shift(2),ve=c(R);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var oe=R.read_shift(4),de=R.read_shift(4),me=R.read_shift(4),Re=R.read_shift(2),Le=R.read_shift(2),ze="",Ie=0;Ie<Re;++Ie)ze+=String.fromCharCode(R[R.l++]);if(Le){var Ue=u(R.slice(R.l,R.l+Le));(Ue[21589]||{}).mt&&(ve=Ue[21589].mt),((V||{})[21589]||{}).mt&&(ve=V[21589].mt)}R.l+=Le;var at=R.slice(R.l,R.l+de);switch(fe){case 8:at=J(R,me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var Ft=!1;z&8&&(oe=R.read_shift(4),oe==134695760&&(oe=R.read_shift(4),Ft=!0),de=R.read_shift(4),me=R.read_shift(4)),de!=H&&Ci(Ft,"Bad compressed size: "+H+" != "+de),me!=O&&Ci(Ft,"Bad uncompressed size: "+O+" != "+me),Kt(P,ze,at,{unsafe:!0,mt:ve})}function Pe(R,H){var O=H||{},P=[],V=[],z=vn(1),fe=O.compression?8:0,ve=0,oe=0,de=0,me=0,Re=0,Le=R.FullPaths[0],ze=Le,Ie=R.FileIndex[0],Ue=[],at=0;for(oe=1;oe<R.FullPaths.length;++oe)if(ze=R.FullPaths[oe].slice(Le.length),Ie=R.FileIndex[oe],!(!Ie.size||!Ie.content||ze=="Sh33tJ5")){var Ft=me,Lt=vn(ze.length);for(de=0;de<ze.length;++de)Lt.write_shift(1,ze.charCodeAt(de)&127);Lt=Lt.slice(0,Lt.l),Ue[Re]=RD.buf(Ie.content,0);var zt=Ie.content;fe==8&&(zt=q(zt)),z=vn(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,ve),z.write_shift(2,fe),Ie.mt?o(z,Ie.mt):z.write_shift(4,0),z.write_shift(-4,Ue[Re]),z.write_shift(4,zt.length),z.write_shift(4,Ie.content.length),z.write_shift(2,Lt.length),z.write_shift(2,0),me+=z.length,P.push(z),me+=Lt.length,P.push(Lt),me+=zt.length,P.push(zt),z=vn(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,ve),z.write_shift(2,fe),z.write_shift(4,0),z.write_shift(-4,Ue[Re]),z.write_shift(4,zt.length),z.write_shift(4,Ie.content.length),z.write_shift(2,Lt.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Ft),at+=z.l,V.push(z),at+=Lt.length,V.push(Lt),++Re}return z=vn(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,Re),z.write_shift(2,Re),z.write_shift(4,at),z.write_shift(4,me),z.write_shift(2,0),di([di(P),di(V),z])}var lt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vt(R,H){if(R.ctype)return R.ctype;var O=R.name||"",P=O.match(/\.([^\.]+)$/);return P&&lt[P[1]]||H&&(P=(O=H).match(/[\.\\]([^\.\\])+$/),P&&lt[P[1]])?lt[P[1]]:"application/octet-stream"}function cn(R){for(var H=Fv(R),O=[],P=0;P<H.length;P+=76)O.push(H.slice(P,P+76));return O.join(`\r
`)+`\r
`}function Ln(R){var H=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var me=de.charCodeAt(0).toString(16).toUpperCase();return"="+(me.length==1?"0"+me:me)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],P=H.split(`\r
`),V=0;V<P.length;++V){var z=P[V];if(z.length==0){O.push("");continue}for(var fe=0;fe<z.length;){var ve=76,oe=z.slice(fe,fe+ve);oe.charAt(ve-1)=="="?ve--:oe.charAt(ve-2)=="="?ve-=2:oe.charAt(ve-3)=="="&&(ve-=3),oe=z.slice(fe,fe+ve),fe+=ve,fe<z.length&&(oe+="="),O.push(oe)}}return O.join(`\r
`)}function kn(R){for(var H=[],O=0;O<R.length;++O){for(var P=R[O];O<=R.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+R[++O];H.push(P)}for(var V=0;V<H.length;++V)H[V]=H[V].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Jr(H.join(`\r
`))}function ea(R,H,O){for(var P="",V="",z="",fe,ve=0;ve<10;++ve){var oe=H[ve];if(!oe||oe.match(/^\s*$/))break;var de=oe.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":P=de[2].trim();break;case"content-type":z=de[2].trim();break;case"content-transfer-encoding":V=de[2].trim();break}}switch(++ve,V.toLowerCase()){case"base64":fe=Jr(vr(H.slice(ve).join("")));break;case"quoted-printable":fe=kn(H.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var me=Kt(R,P.slice(O.length),fe,{unsafe:!0});z&&(me.ctype=z)}function bi(R,H){if(j(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=H&&H.root||"",P=(yt&&Buffer.isBuffer(R)?R.toString("binary"):j(R)).split(`\r
`),V=0,z="";for(V=0;V<P.length;++V)if(z=P[V],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),O||(O=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),z.slice(0,O.length)!=O););var fe=(P[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var ve="--"+(fe[1]||""),oe=[],de=[],me={FileIndex:oe,FullPaths:de};F(me);var Re,Le=0;for(V=0;V<P.length;++V){var ze=P[V];ze!==ve&&ze!==ve+"--"||(Le++&&ea(me,P.slice(Re,V),O),Re=V)}return me}function Yn(R,H){var O=H||{},P=O.boundary||"SheetJS";P="------="+P;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],z=R.FullPaths[0],fe=z,ve=R.FileIndex[0],oe=1;oe<R.FullPaths.length;++oe)if(fe=R.FullPaths[oe].slice(z.length),ve=R.FileIndex[oe],!(!ve.size||!ve.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var de=ve.content,me=yt&&Buffer.isBuffer(de)?de.toString("binary"):j(de),Re=0,Le=Math.min(1024,me.length),ze=0,Ie=0;Ie<=Le;++Ie)(ze=me.charCodeAt(Ie))>=32&&ze<128&&++Re;var Ue=Re>=Le*4/5;V.push(P),V.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+fe),V.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),V.push("Content-Type: "+vt(ve,fe)),V.push(""),V.push(Ue?Ln(me):cn(me))}return V.push(P+`--\r
`),V.join(`\r
`)}function Wt(R){var H={};return F(H,R),H}function Kt(R,H,O,P){var V=P&&P.unsafe;V||F(R);var z=!V&&St.find(R,H);if(!z){var fe=R.FullPaths[0];H.slice(0,fe.length)==fe?fe=H:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+H).replace("//","/")),z={name:a(H),type:2},R.FileIndex.push(z),R.FullPaths.push(fe),V||St.utils.cfb_gc(R)}return z.content=O,z.size=O?O.length:0,P&&(P.CLSID&&(z.clsid=P.CLSID),P.mt&&(z.mt=P.mt),P.ct&&(z.ct=P.ct)),z}function yr(R,H){F(R);var O=St.find(R,H);if(O){for(var P=0;P<R.FileIndex.length;++P)if(R.FileIndex[P]==O)return R.FileIndex.splice(P,1),R.FullPaths.splice(P,1),!0}return!1}function ga(R,H,O){F(R);var P=St.find(R,H);if(P){for(var V=0;V<R.FileIndex.length;++V)if(R.FileIndex[V]==P)return R.FileIndex[V].name=a(O),R.FullPaths[V]=O,!0}return!1}function hs(R){L(R,!0)}return t.find=te,t.read=X,t.parse=g,t.write=N,t.writeFile=ne,t.utils={cfb_new:Wt,cfb_add:Kt,cfb_del:yr,cfb_mov:ga,cfb_gc:hs,ReadShift:bl,CheckField:g2,prep_blob:Dn,bconcat:di,use_zlib:D,_deflateRaw:Ce,_inflateRaw:ds,consts:ce},t}();function DD(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function da(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Mh(e){for(var t=[],n=da(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}var Bu=new Date(1899,11,30,0,0,0);function Qn(e,t){var n=e.getTime(),r=Bu.getTime()+(e.getTimezoneOffset()-Bu.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var XT=new Date,ID=Bu.getTime()+(XT.getTimezoneOffset()-Bu.getTimezoneOffset())*6e4,zv=XT.getTimezoneOffset();function tf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+ID),t.getTimezoneOffset()!==zv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-zv)*6e4),t}function FD(e){var t=0,n=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(n=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=n*parseInt(a[o],10)}return t}var jv=new Date("2017-02-19T19:06:09.000Z"),WT=isNaN(jv.getFullYear())?new Date("2/19/17"):jv,LD=WT.getFullYear()==2017;function wn(e,t){var n=new Date(e);if(LD)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(WT.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function rs(e,t){if(yt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Cl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Cl(OT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Cl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Cl(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return n[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function In(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=In(e[n]));return t}function nn(e,t){for(var n="";n.length<t;)n+=e;return n}function Kr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return n=-n,o}),!isNaN(t=Number(r)))?t/n:t}var OD=["january","february","march","april","may","june","july","august","september","october","november","december"];function mo(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),o=t.getDate();if(isNaN(o))return n;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&OD.indexOf(c)==-1)return n}else if(c.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||o>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}var PD=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(e||typeof r=="string")return n.split(r);for(var o=n.split(r),c=[o[0]],u=1;u<o.length;++u)c.push(a),c.push(o[u]);return c}}();function KT(e){return e?e.content&&e.type?rs(e.content,!0):e.data?_l(e.data):e.asNodeBuffer&&yt?_l(e.asNodeBuffer().toString("binary")):e.asBinary?_l(e.asBinary()):e._data&&e._data.getContent?_l(rs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ZT(e){if(!e)return null;if(e.data)return Dv(e.data);if(e.asNodeBuffer&&yt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Dv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function UD(e){return e&&e.name.slice(-4)===".bin"?ZT(e):KT(e)}function Ir(e,t){for(var n=e.FullPaths||da(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<n.length;++o){var c=n[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==c||a==c)return e.files?e.files[n[o]]:e.FileIndex[o]}return null}function Rh(e,t){var n=Ir(e,t);if(n==null)throw new Error("Cannot find file "+t+" in zip");return n}function hn(e,t,n){if(!n)return UD(Rh(e,t));if(!t)return null;try{return hn(e,t)}catch{return null}}function gr(e,t,n){if(!n)return KT(Rh(e,t));if(!t)return null;try{return gr(e,t)}catch{return null}}function BD(e,t,n){return ZT(Rh(e,t))}function qv(e){for(var t=e.FullPaths||da(e.files),n=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function VD(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return yt?r=ss(n):r=iD(n),St.utils.cfb_add(e,t,r)}St.utils.cfb_add(e,t,n)}else e.file(t,n)}function QT(e,t){switch(t.type){case"base64":return St.read(e,{type:"base64"});case"binary":return St.read(e,{type:"binary"});case"buffer":case"array":return St.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Sl(e,t){if(e.charAt(0)=="/")return e.slice(1);var n=t.split("/");t.slice(-1)!="/"&&n.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var e2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,GD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Yv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,HD=/<[^>]*>/g,qn=e2.match(Yv)?Yv:HD,zD=/<\w*:/,jD=/<(\/?)\w+:/;function nt(e,t,n){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var c=e.match(GD),u=0,p="",h=0,g="",y="",_=1;if(c)for(h=0;h!=c.length;++h){for(y=c[h],o=0;o!=y.length&&y.charCodeAt(o)!==61;++o);for(g=y.slice(0,o).trim();y.charCodeAt(o+1)==32;)++o;for(_=(a=y.charCodeAt(o+1))==34||a==39?1:0,p=y.slice(o+1+_,y.length-_),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),r[g]=p,r[g.toLowerCase()]=p;else{var E=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(r[E]&&g.slice(u-3,u)=="ext")continue;r[E]=p,r[E.toLowerCase()]=p}}return r}function ha(e){return e.replace(jD,"<$1")}var t2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},qD=Mh(t2),At=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(u,p){return t2[u]||String.fromCharCode(parseInt(p,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,p){return String.fromCharCode(parseInt(p,16))});var c=a.indexOf("]]>");return n(a.slice(0,o))+a.slice(o+9,c)+n(a.slice(c+3))}}(),YD=/[&<>'"]/g,$D=/[\u0000-\u001f]/g;function Dh(e){var t=e+"";return t.replace(YD,function(n){return qD[n]}).replace(/\n/g,"<br/>").replace($D,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var $v=function(){var e=/&#(\d+);/g;function t(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}}();function Jt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yd(e){for(var t="",n=0,r=0,a=0,o=0,c=0,u=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(a=e.charCodeAt(n++),r>191&&r<224){c=(r&31)<<6,c|=a&63,t+=String.fromCharCode(c);continue}if(o=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}c=e.charCodeAt(n++),u=((r&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Jv(e){var t=Ti(2*e.length),n,r,a=1,o=0,c=0,u;for(r=0;r<e.length;r+=a)a=1,(u=e.charCodeAt(r))<128?n=u:u<224?(n=(u&31)*64+(e.charCodeAt(r+1)&63),a=2):u<240?(n=(u&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,n=(u&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,c=55296+(n>>>10&1023),n=56320+(n&1023)),c!==0&&(t[o++]=c&255,t[o++]=c>>>8,c=0),t[o++]=n%256,t[o++]=n>>>8;return t.slice(0,o).toString("ucs2")}function Xv(e){return ss(e,"binary").toString("utf8")}var mu="foo bar baz",qt=yt&&(Xv(mu)==yd(mu)&&Xv||Jv(mu)==yd(mu)&&Jv)||yd,Cl=yt?function(e){return ss(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},Hl=function(){var e={};return function(n,r){var a=n+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),n2=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}}(),JD=function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),XD=/<\/?(?:vt:)?variant>/g,WD=/<(?:vt:)([^>]*)>([\s\S]*)</;function Wv(e,t){var n=nt(e),r=e.match(JD(n.baseType))||[],a=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(o){var c=o.replace(XD,"").match(WD);c&&a.push({v:qt(c[2]),t:c[1]})}),a}var KD=/(^\s|\s$|\n)/;function ZD(e){return da(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function QD(e,t,n){return"<"+e+(n!=null?ZD(n):"")+(t!=null?(t.match(KD)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ih(e){if(yt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return qt(os(bh(e)));throw new Error("Bad input format: expected Buffer or string")}var zl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,e6={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},t6=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function n6(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,o=5;o>=0;--o)a=a*256+e[t+o];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function r6(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,o=0,c=r?-t:t;isFinite(c)?c==0?a=o=0:(a=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(t)?26985:0);for(var u=0;u<=5;++u,o/=256)e[n+u]=o&255;e[n+6]=(a&15)<<4|o&15,e[n+7]=a>>4|r}var Kv=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=n)t.push.apply(t,e[0][r].slice(a,a+n));return t},Zv=yt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ss(t)})):Kv(e)}:Kv,Qv=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(Da(e,a)));return r.join("").replace(Kn,"")},Fh=yt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Kn,""):Qv(e,t,n)}:Qv,ey=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},r2=yt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):ey(e,t,n)}:ey,ty=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(Zs(e,a)));return r.join("")},Wl=yt?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):ty(t,n,r)}:ty,a2=function(e,t){var n=pr(e,t);return n>0?Wl(e,t+4,t+4+n-1):""},i2=a2,s2=function(e,t){var n=pr(e,t);return n>0?Wl(e,t+4,t+4+n-1):""},o2=s2,l2=function(e,t){var n=2*pr(e,t);return n>0?Wl(e,t+4,t+4+n-1):""},c2=l2,u2=function(t,n){var r=pr(t,n);return r>0?Fh(t,n+4,n+4+r):""},f2=u2,d2=function(e,t){var n=pr(e,t);return n>0?Wl(e,t+4,t+4+n):""},h2=d2,m2=function(e,t){return n6(e,t)},Vu=m2,p2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};yt&&(i2=function(t,n){if(!Buffer.isBuffer(t))return a2(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},o2=function(t,n){if(!Buffer.isBuffer(t))return s2(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},c2=function(t,n){if(!Buffer.isBuffer(t))return l2(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},f2=function(t,n){if(!Buffer.isBuffer(t))return u2(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},h2=function(t,n){if(!Buffer.isBuffer(t))return d2(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},Vu=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):m2(t,n)},p2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Zs=function(e,t){return e[t]},Da=function(e,t){return e[t+1]*256+e[t]},a6=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},pr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Yi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},i6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function bl(e,t){var n="",r,a,o=[],c,u,p,h;switch(t){case"dbcs":if(h=this.l,yt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(p=0;p<e;++p)n+=String.fromCharCode(Da(this,h)),h+=2;e*=2;break;case"utf8":n=Wl(this,this.l,this.l+e);break;case"utf16le":e*=2,n=Fh(this,this.l,this.l+e);break;case"wstr":return bl.call(this,e,"dbcs");case"lpstr-ansi":n=i2(this,this.l),e=4+pr(this,this.l);break;case"lpstr-cp":n=o2(this,this.l),e=4+pr(this,this.l);break;case"lpwstr":n=c2(this,this.l),e=4+2*pr(this,this.l);break;case"lpp4":e=4+pr(this,this.l),n=f2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+pr(this,this.l),n=h2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(c=Zs(this,this.l+e++))!==0;)o.push(hu(c));n=o.join("");break;case"_wstr":for(e=0,n="";(c=Da(this,this.l+e))!==0;)o.push(hu(c)),e+=2;e+=2,n=o.join("");break;case"dbcs-cont":for(n="",h=this.l,p=0;p<e;++p){if(this.lens&&this.lens.indexOf(h)!==-1)return c=Zs(this,h),this.l=h+1,u=bl.call(this,e-p,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(hu(Da(this,h))),h+=2}n=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",h=this.l,p=0;p!=e;++p){if(this.lens&&this.lens.indexOf(h)!==-1)return c=Zs(this,h),this.l=h+1,u=bl.call(this,e-p,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(hu(Zs(this,h))),h+=1}n=o.join("");break;default:switch(e){case 1:return r=Zs(this,this.l),this.l++,r;case 2:return r=(t==="i"?a6:Da)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(e>0?Yi:i6)(this,this.l),this.l+=4,r):(a=pr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Vu(this,this.l):a=Vu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:n=r2(this,this.l,e);break}}return this.l+=e,n}var s6=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},o6=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},l6=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function c6(e,t,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=t.length;++a)l6(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;r=t.length}else if(n==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var c=t.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,s6(this,t,this.l);break;case 8:if(r=8,n==="f"){r6(this,t,this.l);break}case 16:break;case-4:r=4,o6(this,t,this.l);break}return this.l+=r,this}function g2(e,t){var n=r2(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Dn(e,t){e.l=t,e.read_shift=bl,e.chk=g2,e.write_shift=c6}function jn(e,t){e.l+=t}function vn(e){var t=Ti(e);return Dn(t,0),t}function Va(e,t,n){if(e){var r,a,o;Dn(e,e.l||0);for(var c=e.length,u=0,p=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var h=Yu[u]||Yu[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;p=e.l+o;var g=h.f&&h.f(e,o,n);if(e.l=p,t(g,h,u))return}}}function Zd(){var e=[],t=yt?256:2048,n=function(h){var g=vn(h);return Dn(g,0),g},r=n(t),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(h){return r&&h<r.length-r.l?r:(a(),r=n(Math.max(h+1,t)))},c=function(){return a(),di(e)},u=function(h){a(),r=h,r.l==null&&(r.l=r.length),o(t)};return{next:o,push:u,end:c,_bufs:e}}function kl(e,t,n){var r=In(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function ny(e,t,n){var r=In(e);return r.s=kl(r.s,t.s,n),r.e=kl(r.e,t.s,n),r}function Nl(e,t){if(e.cRel&&e.c<0)for(e=In(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=In(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=st(e);return!e.cRel&&e.cRel!=null&&(n=d6(n)),!e.rRel&&e.rRel!=null&&(n=u6(n)),n}function Td(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+yn(e.s.c)+":"+(e.e.cRel?"":"$")+yn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Fn(e.s.r)+":"+(e.e.rRel?"":"$")+Fn(e.e.r):Nl(e.s,t.biff)+":"+Nl(e.e,t.biff)}function Lh(e){return parseInt(f6(e),10)-1}function Fn(e){return""+(e+1)}function u6(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function f6(e){return e.replace(/\$(\d+)$/,"$1")}function Oh(e){for(var t=h6(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function yn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function d6(e){return e.replace(/^([A-Z])/,"$$$1")}function h6(e){return e.replace(/^\$([A-Z])/,"$1")}function m6(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wn(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function st(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function _o(e){var t=e.indexOf(":");return t==-1?{s:Wn(e),e:Wn(e)}:{s:Wn(e.slice(0,t)),e:Wn(e.slice(t+1))}}function wt(e,t){return typeof t>"u"||typeof t=="number"?wt(e.s,e.e):(typeof e!="string"&&(e=st(e)),typeof t!="string"&&(t=st(t)),e==t?e:e+":"+t)}function rn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,o=e.length;for(n=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===o||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function ry(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Or(e.z,n?Qn(t):t)}catch{}try{return e.w=Or((e.XF||{}).numFmtId||(n?14:0),n?Qn(t):t)}catch{return""+t}}function Pa(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?us[e.v]||e.v:t==null?ry(e,e.v):ry(e,t))}function Si(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function x2(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),c=0,u=0;if(o&&r.origin!=null){if(typeof r.origin=="number")c=r.origin;else{var p=typeof r.origin=="string"?Wn(r.origin):r.origin;c=p.r,u=p.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=rn(o["!ref"]);h.s.c=g.s.c,h.s.r=g.s.r,h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),c==-1&&(h.e.r=c=g.e.r+1)}for(var y=0;y!=t.length;++y)if(t[y]){if(!Array.isArray(t[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=t[y].length;++_)if(!(typeof t[y][_]>"u")){var E={v:t[y][_]},S=c+y,C=u+_;if(h.s.r>S&&(h.s.r=S),h.s.c>C&&(h.s.c=C),h.e.r<S&&(h.e.r=S),h.e.c<C&&(h.e.c=C),t[y][_]&&typeof t[y][_]=="object"&&!Array.isArray(t[y][_])&&!(t[y][_]instanceof Date))E=t[y][_];else if(Array.isArray(E.v)&&(E.f=t[y][_][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(r.nullError)E.t="e",E.v=0;else if(r.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=r.dateNF||ot[14],r.cellDates?(E.t="d",E.w=Or(E.z,Qn(E.v))):(E.t="n",E.v=Qn(E.v),E.w=Or(E.z,E.v))):E.t="s";if(a)o[S]||(o[S]=[]),o[S][C]&&o[S][C].z&&(E.z=o[S][C].z),o[S][C]=E;else{var w=st({c:C,r:S});o[w]&&o[w].z&&(E.z=o[w].z),o[w]=E}}}return h.s.c<1e7&&(o["!ref"]=wt(h)),o}function Eo(e,t){return x2(null,e,t)}function p6(e){return e.read_shift(4,"i")}function zn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function g6(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ph(e,t){var n=e.l,r=e.read_shift(1),a=zn(e),o=[],c={t:a,h:a};if((r&1)!==0){for(var u=e.read_shift(4),p=0;p!=u;++p)o.push(g6(e));c.r=o}else c.r=[{ich:0,ifnt:0}];return e.l=n+t,c}var x6=Ph;function Vr(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function ls(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var v6=zn;function Uh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var y6=zn,Qd=Uh;function Bh(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var a=r===0?Vu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Yi(t,0)>>2;return n?a/100:a}function v2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var cs=v2;function Vn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function T6(e){var t={},n=e.read_shift(1),r=n>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),p=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=a;var h=Xi[a];h&&(t.rgb=ql(h));break;case 2:t.rgb=ql([c,u,p]);break;case 3:t.theme=a;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function _6(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function y2(e,t){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function E6(e){return y2(e,1)}function S6(e){return y2(e,2)}var Vh=2,ir=3,pu=11,ay=12,Gu=19,gu=64,C6=65,w6=71,A6=4108,b6=4126,Cn=80,T2=81,k6=[Cn,T2],N6={1:{n:"CodePage",t:Vh},2:{n:"Category",t:Cn},3:{n:"PresentationFormat",t:Cn},4:{n:"ByteCount",t:ir},5:{n:"LineCount",t:ir},6:{n:"ParagraphCount",t:ir},7:{n:"SlideCount",t:ir},8:{n:"NoteCount",t:ir},9:{n:"HiddenCount",t:ir},10:{n:"MultimediaClipCount",t:ir},11:{n:"ScaleCrop",t:pu},12:{n:"HeadingPairs",t:A6},13:{n:"TitlesOfParts",t:b6},14:{n:"Manager",t:Cn},15:{n:"Company",t:Cn},16:{n:"LinksUpToDate",t:pu},17:{n:"CharacterCount",t:ir},19:{n:"SharedDoc",t:pu},22:{n:"HyperlinksChanged",t:pu},23:{n:"AppVersion",t:ir,p:"version"},24:{n:"DigSig",t:C6},26:{n:"ContentType",t:Cn},27:{n:"ContentStatus",t:Cn},28:{n:"Language",t:Cn},29:{n:"Version",t:Cn},255:{},2147483648:{n:"Locale",t:Gu},2147483651:{n:"Behavior",t:Gu},1919054434:{}},M6={1:{n:"CodePage",t:Vh},2:{n:"Title",t:Cn},3:{n:"Subject",t:Cn},4:{n:"Author",t:Cn},5:{n:"Keywords",t:Cn},6:{n:"Comments",t:Cn},7:{n:"Template",t:Cn},8:{n:"LastAuthor",t:Cn},9:{n:"RevNumber",t:Cn},10:{n:"EditTime",t:gu},11:{n:"LastPrinted",t:gu},12:{n:"CreatedDate",t:gu},13:{n:"ModifiedDate",t:gu},14:{n:"PageCount",t:ir},15:{n:"WordCount",t:ir},16:{n:"CharCount",t:ir},17:{n:"Thumbnail",t:w6},18:{n:"Application",t:Cn},19:{n:"DocSecurity",t:ir},255:{},2147483648:{n:"Locale",t:Gu},2147483651:{n:"Behavior",t:Gu},1919054434:{}},iy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},R6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function D6(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var I6=D6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Xi=In(I6),us={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},_2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},sy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function F6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function L6(e){var t=F6();if(!e||!e.match)return t;var n={};if((e.match(qn)||[]).forEach(function(r){var a=nt(r);switch(a[0].replace(zD,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":t[sy[a.ContentType]]!==void 0&&t[sy[a.ContentType]].push(a.PartName);break}}),t.xmlns!==e6.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}var eo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function eh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ml(e,t){var n={"!id":{}};if(!e)return n;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match(qn)||[]).forEach(function(a){var o=nt(a);if(o[0]==="<Relationship"){var c={};c.Type=o.Type,c.Target=o.Target,c.Id=o.Id,o.TargetMode&&(c.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Sl(o.Target,t);n[u]=c,r[o.Id]=c}}),n["!id"]=r,n}var O6="application/vnd.oasis.opendocument.spreadsheet";function P6(e,t){for(var n=Ih(e),r,a;r=zl.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=nt(r[0],!1),a.path=="/"&&a.type!==O6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}var Rl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],U6=function(){for(var e=new Array(Rl.length),t=0;t<Rl.length;++t){var n=Rl[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function E2(e){var t={};e=qt(e);for(var n=0;n<Rl.length;++n){var r=Rl[n],a=e.match(U6[n]);a!=null&&a.length>0&&(t[r[1]]=At(a[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=wn(t[r[1]]))}return t}var B6=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function S2(e,t,n,r){var a=[];if(typeof e=="string")a=Wv(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(g){return{v:g}}));var c=typeof t=="string"?Wv(t,r).map(function(g){return g.v}):t,u=0,p=0;if(c.length>0)for(var h=0;h!==a.length;h+=2){switch(p=+a[h+1].v,a[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=p,n.SheetNames=c.slice(u,u+p);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=p,n.DefinedNames=c.slice(u,u+p);break;case"Charts":case"Diagramme":n.Chartsheets=p,n.ChartNames=c.slice(u,u+p);break}u+=p}}function V6(e,t,n){var r={};return t||(t={}),e=qt(e),B6.forEach(function(a){var o=(e.match(Hl(a[0]))||[])[1];switch(a[2]){case"string":o&&(t[a[1]]=At(o));break;case"bool":t[a[1]]=o==="true";break;case"raw":var c=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));c&&c.length>0&&(r[a[1]]=c[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&S2(r.HeadingPairs,r.TitlesOfParts,t,n),t}var G6=/<[^>]+>[^<]*/g;function H6(e,t){var n={},r="",a=e.match(G6);if(a)for(var o=0;o!=a.length;++o){var c=a[o],u=nt(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":r=At(u.name);break;case"</property>":r=null;break;default:if(c.indexOf("<vt:")===0){var p=c.split(">"),h=p[0].slice(4),g=p[1];switch(h){case"lpstr":case"bstr":case"lpwstr":n[r]=At(g);break;case"bool":n[r]=Jt(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(g,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(g);break;case"filetime":case"date":n[r]=wn(g);break;case"cy":case"error":n[r]=At(g);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,h,p)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return n}var z6={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},_d;function j6(e,t,n){_d||(_d=Mh(z6)),t=_d[t]||t,e[t]=n}function Gh(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function C2(e,t,n){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return a}function w2(e,t,n){var r=e.read_shift(0,"lpwstr");return r}function A2(e,t,n){return t===31?w2(e):C2(e,t,n)}function th(e,t,n){return A2(e,t,n===!1?0:4)}function q6(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return A2(e,t,0)}function Y6(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var a=e.l;n[r]=e.read_shift(0,"lpwstr").replace(Kn,""),e.l-a&2&&(e.l+=2)}return n}function $6(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(Kn,"");return n}function J6(e){var t=e.l,n=Hu(e,T2);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=Hu(e,ir);return[n,r]}function X6(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(J6(e));return n}function oy(e,t){for(var n=e.read_shift(4),r={},a=0;a!=n;++a){var o=e.read_shift(4),c=e.read_shift(4);r[o]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(Kn,"").replace(El,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function b2(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),n}function W6(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Hu(e,t,n){var r=e.read_shift(2),a,o=n||{};if(e.l+=2,t!==ay&&r!==t&&k6.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===ay?r:t){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return C2(e,r,4).replace(Kn,"");case 31:return w2(e);case 64:return Gh(e);case 65:return b2(e);case 71:return W6(e);case 80:return th(e,r,!o.raw).replace(Kn,"");case 81:return q6(e,r).replace(Kn,"");case 4108:return X6(e);case 4126:case 4127:return r==4127?Y6(e):$6(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function ly(e,t){var n=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],c=0,u=0,p=-1,h={};for(c=0;c!=a;++c){var g=e.read_shift(4),y=e.read_shift(4);o[c]=[g,y+n]}o.sort(function(k,b){return k[1]-b[1]});var _={};for(c=0;c!=a;++c){if(e.l!==o[c][1]){var E=!0;if(c>0&&t)switch(t[o[c-1][0]].t){case 2:e.l+2===o[c][1]&&(e.l+=2,E=!1);break;case 80:e.l<=o[c][1]&&(e.l=o[c][1],E=!1);break;case 4108:e.l<=o[c][1]&&(e.l=o[c][1],E=!1);break}if((!t||c==0)&&e.l<=o[c][1]&&(E=!1,e.l=o[c][1]),E)throw new Error("Read Error: Expected address "+o[c][1]+" at "+e.l+" :"+c)}if(t){var S=t[o[c][0]];if(_[S.n]=Hu(e,S.t,{raw:!0}),S.p==="version"&&(_[S.n]=String(_[S.n]>>16)+"."+("0000"+String(_[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(_[S.n]){case 0:_[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xr(u=_[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[S.n])}}else if(o[c][0]===1){if(u=_.CodePage=Hu(e,Vh),Xr(u),p!==-1){var C=e.l;e.l=o[p][1],h=oy(e,u),e.l=C}}else if(o[c][0]===0){if(u===0){p=c,e.l=o[c+1][1];continue}h=oy(e,u)}else{var w=h[o[c][0]],M;switch(e[e.l]){case 65:e.l+=4,M=b2(e);break;case 30:e.l+=4,M=th(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,M=th(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,M=e.read_shift(4,"i");break;case 19:e.l+=4,M=e.read_shift(4);break;case 5:e.l+=4,M=e.read_shift(8,"f");break;case 11:e.l+=4,M=ln(e,4);break;case 64:e.l+=4,M=wn(Gh(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[w]=M}}return e.l=n+r,_}function cy(e,t,n){var r=e.content;if(!r)return{};Dn(r,0);var a,o,c,u,p=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),g=r.read_shift(16);if(g!==St.utils.consts.HEADER_CLSID&&g!==n)throw new Error("Bad PropertySet CLSID "+g);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),u=r.read_shift(4),a===1&&u!==r.l)throw new Error("Length mismatch: "+u+" !== "+r.l);a===2&&(c=r.read_shift(16),p=r.read_shift(4));var y=ly(r,t),_={SystemIdentifier:h};for(var E in y)_[E]=y[E];if(_.FMTID=o,a===1)return _;if(p-r.l==2&&(r.l+=2),r.l!==p)throw new Error("Length mismatch 2: "+r.l+" !== "+p);var S;try{S=ly(r,null)}catch{}for(E in S)_[E]=S[E];return _.FMTID=[o,c],_}function ui(e,t){return e.read_shift(t),null}function K6(e,t,n){for(var r=[],a=e.l+t;e.l<a;)r.push(n(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function ln(e,t){return e.read_shift(t)===1}function mn(e){return e.read_shift(2,"u")}function k2(e,t){return K6(e,t,mn)}function Z6(e){var t=e.read_shift(1),n=e.read_shift(1);return n===1?t:t===1}function Kl(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var c=r?e.read_shift(r,a):"";return c}function Q6(e){var t=e.read_shift(2),n=e.read_shift(1),r=n&4,a=n&8,o=1+(n&1),c=0,u,p={};a&&(c=e.read_shift(2)),r&&(u=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",g=t===0?"":e.read_shift(t,h);return a&&(e.l+=4*c),r&&(e.l+=u),p.t=g,a||(p.raw="<t>"+p.t+"</t>",p.r=p.t),p}function as(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function Zl(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):as(e,r,n)}function fs(e,t,n){if(n.biff>5)return Zl(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function eI(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}function tI(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=n);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(Kn,"");return r&&(e.l+=24),a}function nI(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(o>>1,"utf16le").replace(Kn,"");return n+c}function rI(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return tI(e);case"0303000000000000c000000000000046":return nI(e);default:throw new Error("Unsupported Moniker "+n)}}function xu(e){var t=e.read_shift(4),n=t>0?e.read_shift(t,"utf16le").replace(Kn,""):"";return n}function aI(e,t){var n=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,c,u,p,h="",g,y;a&16&&(o=xu(e,n-e.l)),a&128&&(c=xu(e,n-e.l)),(a&257)===257&&(u=xu(e,n-e.l)),(a&257)===1&&(p=rI(e,n-e.l)),a&8&&(h=xu(e,n-e.l)),a&32&&(g=e.read_shift(16)),a&64&&(y=Gh(e)),e.l=n;var _=c||u||p||"";_&&h&&(_+="#"+h),_||(_="#"+h),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var E={Target:_};return g&&(E.guid=g),y&&(E.time=y),o&&(E.Tooltip=o),E}function N2(e){var t=e.read_shift(1),n=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[t,n,r,a]}function M2(e,t){var n=N2(e);return n[3]=0,n}function ma(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return{r:t,c:n,ixfe:r}}function iI(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}function sI(e,t,n){return t===0?"":fs(e,t,n)}function oI(e,t,n){var r=n.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),c=e.read_shift(r,"i");return[a,o,c]}function R2(e){var t=e.read_shift(2),n=Bh(e);return[t,n]}function lI(e,t,n){e.l+=4,t-=4;var r=e.l+t,a=Kl(e,t,n),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function nf(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:t},e:{c:a,r:n}}}function D2(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:t},e:{c:a,r:n}}}var cI=D2;function I2(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function uI(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function fI(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Un(e){e.l+=2,e.l+=e.read_shift(2)}var dI={0:Un,4:Un,5:Un,6:Un,7:fI,8:Un,9:Un,10:Un,11:Un,12:Un,13:uI,14:Un,15:Un,16:Un,17:Un,18:Un,19:Un,20:Un,21:I2};function hI(e,t){for(var n=e.l+t,r=[];e.l<n;){var a=e.read_shift(2);e.l-=2;try{r.push(dI[a](e,n-e.l))}catch{return e.l=n,r}}return e.l!=n&&(e.l=n),r}function vu(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),t-=2,t>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function mI(e,t){return t===0||e.read_shift(2),1200}function pI(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,a=fs(e,0,n);return e.read_shift(t+r-e.l),a}function gI(e,t,n){var r=n&&n.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function xI(e,t,n){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var c=Kl(e,0,n);return c.length===0&&(c="Sheet1"),{pos:r,hs:a,dt:o,name:c}}function vI(e,t){for(var n=e.l+t,r=e.read_shift(4),a=e.read_shift(4),o=[],c=0;c!=a&&e.l<n;++c)o.push(Q6(e));return o.Count=r,o.Unique=a,o}function yI(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}function TI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=n/20),t}function _I(e){var t=iI(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var n=e.read_shift(4);return n!==0}function EI(e){return e.read_shift(2),e.read_shift(4)}function uy(e,t,n){var r=0;n&&n.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function SI(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),p=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,n],Dim:[r,a],Flags:o,CurTab:c,FirstTab:u,Selected:p,TabRatio:h}}function CI(e,t,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function wI(){}function AI(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Kl(e,0,n),r}function bI(e){var t=ma(e);return t.isst=e.read_shift(4),t}function kI(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=e.l+t,a=ma(e);n.biff==2&&e.l++;var o=Zl(e,r-e.l,n);return a.val=o,a}function NI(e,t,n){var r=e.read_shift(2),a=fs(e,0,n);return[r,a]}var MI=fs;function fy(e,t,n){var r=e.l+t,a=n.biff==8||!n.biff?4:2,o=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(2),p=e.read_shift(2);return e.l=r,{s:{r:o,c:u},e:{r:c,c:p}}}function RI(e){var t=e.read_shift(2),n=e.read_shift(2),r=R2(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}function DI(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<n;)o.push(R2(e));if(e.l!==n)throw new Error("MulRK read error");var c=e.read_shift(2);if(o.length!=c-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:c,rkrec:o}}function II(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<n;)o.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var c=e.read_shift(2);if(o.length!=c-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:c,ixfe:o}}function FI(e,t,n,r){var a={},o=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),p=e.read_shift(2);return a.patternType=R6[u>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=c&15,a.dgRight=c>>4&15,a.dgTop=c>>8&15,a.dgBottom=c>>12&15,a.icvLeft=c>>16&127,a.icvRight=c>>23&127,a.grbitDiag=c>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=p&127,a.icvBack=p>>7&127,a.fsxButton=p>>14&1),a}function LI(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=FI(e,t,r.fStyle,n),r}function OI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function dy(e,t,n){var r=ma(e);(n.biff==2||t==9)&&++e.l;var a=Z6(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function PI(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=ma(e),a=Vn(e);return r.val=a,r}var hy=sI;function UI(e,t,n){var r=e.l+t,a=e.read_shift(2),o=e.read_shift(2);if(n.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var c=as(e,o),u=[];r>e.l;)u.push(Zl(e));return[o,a,c,u]}function my(e,t,n){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=lI(e,t-2,n)),o.body=a||e.read_shift(t-2),typeof a=="string"&&(o.Name=a),o}var BI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function py(e,t,n){var r=e.l+t,a=e.read_shift(2),o=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(n&&n.biff==2?1:2),p=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),p=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var h=as(e,c,n);a&32&&(h=BI[h.charCodeAt(0)]);var g=r-e.l;n&&n.biff==2&&--g;var y=r==e.l||u===0||!(g>0)?[]:TO(e,g,n,u);return{chKey:o,Name:h,itab:p,rgce:y}}function F2(e,t,n){if(n.biff<8)return VI(e,t,n);for(var r=[],a=e.l+t,o=e.read_shift(n.biff>8?4:2);o--!==0;)r.push(oI(e,n.biff>8?12:6,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function VI(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=Kl(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function GI(e,t,n){if(n.biff<8){e.l+=t;return}var r=e.read_shift(2),a=e.read_shift(2),o=as(e,r,n),c=as(e,a,n);return[o,c]}function HI(e,t,n){var r=D2(e);e.l++;var a=e.read_shift(1);return t-=8,[_O(e,t,n),a,r]}function gy(e,t,n){var r=cI(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,vO(e,t,n)]}function zI(e){var t=e.read_shift(4)!==0,n=e.read_shift(4)!==0,r=e.read_shift(4);return[t,n,r]}function jI(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=fs(e,0,n);return n.biff<8&&e.read_shift(1),[{r,c:a},u,c,o]}}function qI(e,t,n){return jI(e,t,n)}function YI(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(nf(e));return n}function $I(e,t,n){if(n&&n.biff<8)return XI(e,t,n);var r=I2(e),a=hI(e,t-22,r[1]);return{cmo:r,ft:a}}var JI={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=n,{fmt:r}}};function XI(e,t,n){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((JI[r]||jn)(e,t,n)),{cmo:[a,r,o],ft:c}}function WI(e,t,n){var r=e.l,a="";try{e.l+=4;var o=(n.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:c=eI(e,6,n);var u=e.read_shift(2);e.read_shift(2),mn(e,2);var p=e.read_shift(2);e.l+=p;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var g=e[e.l],y=as(e,e.lens[h+1]-e.lens[h]-1);if(a+=y,a.length>=(g?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return e.l=r+t,{t:a}}catch{return e.l=r+t,{t:a}}}function KI(e,t){var n=nf(e);e.l+=16;var r=aI(e,t-24);return[n,r]}function ZI(e,t){e.read_shift(2);var n=nf(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(Kn,""),[n,r]}function QI(e){var t=[0,0],n;return n=e.read_shift(2),t[0]=iy[n]||n,n=e.read_shift(2),t[1]=iy[n]||n,t}function eF(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(M2(e));return n}function tF(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(M2(e));return n}function nF(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function L2(e,t,n){if(!n.cellStyles)return jn(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),c=e.read_shift(r),u=e.read_shift(r),p=e.read_shift(2);r==2&&(e.l+=2);var h={s:a,e:o,w:c,ixfe:u,flags:p};return(n.biff>=5||!n.biff)&&(h.level=p>>8&7),h}function rF(e,t){var n={};return t<32||(e.l+=16,n.header=Vn(e),n.footer=Vn(e),e.l+=2),n}function aF(e,t,n){var r={area:!1};if(n.biff!=5)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var iF=ma,sF=k2,oF=Zl;function lF(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function cF(e,t,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=ma(e);++e.l;var a=fs(e,t-7,n);return r.t="str",r.val=a,r}function uF(e){var t=ma(e);++e.l;var n=Vn(e);return t.t="n",t.val=n,t}function fF(e){var t=ma(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}function dF(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function hF(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function mF(e,t,n){var r=e.l+t,a=ma(e),o=e.read_shift(2),c=as(e,o,n);return e.l=r,a.t="str",a.val=c,a}var pF=[2,3,48,49,131,139,140,245],xy=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Mh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(u,p){var h=[],g=Ti(1);switch(p.type){case"base64":g=Jr(vr(u));break;case"binary":g=Jr(u);break;case"buffer":case"array":g=u;break}Dn(g,0);var y=g.read_shift(1),_=!!(y&136),E=!1,S=!1;switch(y){case 2:break;case 3:break;case 48:E=!0,_=!0;break;case 49:E=!0,_=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var C=0,w=521;y==2&&(C=g.read_shift(2)),g.l+=3,y!=2&&(C=g.read_shift(4)),C>1048576&&(C=1e6),y!=2&&(w=g.read_shift(2));var M=g.read_shift(2),k=p.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(k=e[g[g.l]]),g.l+=1,g.l+=2),S&&(g.l+=36);for(var b=[],U={},B=Math.min(g.length,y==2?521:w-10-(E?264:0)),X=S?32:11;g.l<B&&g[g.l]!=13;)switch(U={},U.name=Vl.utils.decode(k,g.slice(g.l,g.l+X)).replace(/[\u0000\r\n].*$/g,""),g.l+=X,U.type=String.fromCharCode(g.read_shift(1)),y!=2&&!S&&(U.offset=g.read_shift(4)),U.len=g.read_shift(1),y==2&&(U.offset=g.read_shift(2)),U.dec=g.read_shift(1),U.name.length&&b.push(U),y!=2&&(g.l+=S?13:14),U.type){case"B":(!E||U.len!=8)&&p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(g[g.l]!==13&&(g.l=w-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=w;var F=0,Y=0;for(h[0]=[],Y=0;Y!=b.length;++Y)h[0][Y]=b[Y].name;for(;C-- >0;){if(g[g.l]===42){g.l+=M;continue}for(++g.l,h[++F]=[],Y=0,Y=0;Y!=b.length;++Y){var L=g.slice(g.l,g.l+b[Y].len);g.l+=b[Y].len,Dn(L,0);var Q=Vl.utils.decode(k,L);switch(b[Y].type){case"C":Q.trim().length&&(h[F][Y]=Q.replace(/\s+$/,""));break;case"D":Q.length===8?h[F][Y]=new Date(+Q.slice(0,4),+Q.slice(4,6)-1,+Q.slice(6,8)):h[F][Y]=Q;break;case"F":h[F][Y]=parseFloat(Q.trim());break;case"+":case"I":h[F][Y]=S?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(Q.trim().toUpperCase()){case"Y":case"T":h[F][Y]=!0;break;case"N":case"F":h[F][Y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Q+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));h[F][Y]="##MEMO##"+(S?parseInt(Q.trim(),10):L.read_shift(4));break;case"N":Q=Q.replace(/\u0000/g,"").trim(),Q&&Q!="."&&(h[F][Y]=+Q||0);break;case"@":h[F][Y]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":h[F][Y]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":h[F][Y]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[F][Y]=-L.read_shift(-8,"f");break;case"B":if(E&&b[Y].len==8){h[F][Y]=L.read_shift(8,"f");break}case"G":case"P":L.l+=b[Y].len;break;case"0":if(b[Y].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[Y].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return p&&p.sheetRows&&(h=h.slice(0,p.sheetRows)),p.DBF=b,h}function r(u,p){var h=p||{};h.dateNF||(h.dateNF="yyyymmdd");var g=Eo(n(u,h),h);return g["!cols"]=h.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete h.DBF,g}function a(u,p){try{return Si(r(u,p),p)}catch(h){if(p&&p.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,p){var h=p||{};if(+h.codepage>=0&&Xr(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var g=Zd(),y=lh(u,{header:1,raw:!0,cellDates:!0}),_=y[0],E=y.slice(1),S=u["!cols"]||[],C=0,w=0,M=0,k=1;for(C=0;C<_.length;++C){if(((S[C]||{}).DBF||{}).name){_[C]=S[C].DBF.name,++M;continue}if(_[C]!=null){if(++M,typeof _[C]=="number"&&(_[C]=_[C].toString(10)),typeof _[C]!="string")throw new Error("DBF Invalid column name "+_[C]+" |"+typeof _[C]+"|");if(_.indexOf(_[C])!==C){for(w=0;w<1024;++w)if(_.indexOf(_[C]+"_"+w)==-1){_[C]+="_"+w;break}}}}var b=rn(u["!ref"]),U=[],B=[],X=[];for(C=0;C<=b.e.c-b.s.c;++C){var F="",Y="",L=0,Q=[];for(w=0;w<E.length;++w)E[w][C]!=null&&Q.push(E[w][C]);if(Q.length==0||_[C]==null){U[C]="?";continue}for(w=0;w<Q.length;++w){switch(typeof Q[w]){case"number":Y="B";break;case"string":Y="C";break;case"boolean":Y="L";break;case"object":Y=Q[w]instanceof Date?"D":"C";break;default:Y="C"}L=Math.max(L,String(Q[w]).length),F=F&&F!=Y?"C":Y}L>250&&(L=250),Y=((S[C]||{}).DBF||{}).type,Y=="C"&&S[C].DBF.len>L&&(L=S[C].DBF.len),F=="B"&&Y=="N"&&(F="N",X[C]=S[C].DBF.dec,L=S[C].DBF.len),B[C]=F=="C"||Y=="N"?L:o[F]||0,k+=B[C],U[C]=F}var te=g.next(32);for(te.write_shift(4,318902576),te.write_shift(4,E.length),te.write_shift(2,296+32*M),te.write_shift(2,k),C=0;C<4;++C)te.write_shift(4,0);for(te.write_shift(4,0|(+t[FT]||3)<<8),C=0,w=0;C<_.length;++C)if(_[C]!=null){var ee=g.next(32),_e=(_[C].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,_e,"sbcs"),ee.write_shift(1,U[C]=="?"?"C":U[C],"sbcs"),ee.write_shift(4,w),ee.write_shift(1,B[C]||o[U[C]]||0),ee.write_shift(1,X[C]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),w+=B[C]||o[U[C]]||0}var De=g.next(264);for(De.write_shift(4,13),C=0;C<65;++C)De.write_shift(4,0);for(C=0;C<E.length;++C){var Te=g.next(k);for(Te.write_shift(1,0),w=0;w<_.length;++w)if(_[w]!=null)switch(U[w]){case"L":Te.write_shift(1,E[C][w]==null?63:E[C][w]?84:70);break;case"B":Te.write_shift(8,E[C][w]||0,"f");break;case"N":var re="0";for(typeof E[C][w]=="number"&&(re=E[C][w].toFixed(X[w]||0)),M=0;M<B[w]-re.length;++M)Te.write_shift(1,32);Te.write_shift(1,re,"sbcs");break;case"D":E[C][w]?(Te.write_shift(4,("0000"+E[C][w].getFullYear()).slice(-4),"sbcs"),Te.write_shift(2,("00"+(E[C][w].getMonth()+1)).slice(-2),"sbcs"),Te.write_shift(2,("00"+E[C][w].getDate()).slice(-2),"sbcs")):Te.write_shift(8,"00000000","sbcs");break;case"C":var ce=String(E[C][w]!=null?E[C][w]:"").slice(0,B[w]);for(Te.write_shift(1,ce,"sbcs"),M=0;M<B[w]-ce.length;++M)Te.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:r,from_sheet:c}}(),gF=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+da(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(_,E){var S=e[E];return typeof S=="number"?Iv(S):S},r=function(_,E,S){var C=E.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return C==59?_:Iv(C)};e["|"]=254;function a(_,E){switch(E.type){case"base64":return o(vr(_),E);case"binary":return o(_,E);case"buffer":return o(yt&&Buffer.isBuffer(_)?_.toString("binary"):os(_),E);case"array":return o(rs(_),E)}throw new Error("Unrecognized type "+E.type)}function o(_,E){var S=_.split(/[\n\r]+/),C=-1,w=-1,M=0,k=0,b=[],U=[],B=null,X={},F=[],Y=[],L=[],Q=0,te;for(+E.codepage>=0&&Xr(+E.codepage);M!==S.length;++M){Q=0;var ee=S[M].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),_e=ee.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),De=_e[0],Te;if(ee.length>0)switch(De){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":_e[1].charAt(0)=="P"&&U.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,ce=!1,ne=!1,j=!1,N=-1,W=-1;for(k=1;k<_e.length;++k)switch(_e[k].charAt(0)){case"A":break;case"X":w=parseInt(_e[k].slice(1))-1,ce=!0;break;case"Y":for(C=parseInt(_e[k].slice(1))-1,ce||(w=0),te=b.length;te<=C;++te)b[te]=[];break;case"K":Te=_e[k].slice(1),Te.charAt(0)==='"'?Te=Te.slice(1,Te.length-1):Te==="TRUE"?Te=!0:Te==="FALSE"?Te=!1:isNaN(Kr(Te))?isNaN(mo(Te).getDate())||(Te=wn(Te)):(Te=Kr(Te),B!==null&&To(B)&&(Te=tf(Te))),re=!0;break;case"E":j=!0;var D=ao(_e[k].slice(1),{r:C,c:w});b[C][w]=[b[C][w],D];break;case"S":ne=!0,b[C][w]=[b[C][w],"S5S"];break;case"G":break;case"R":N=parseInt(_e[k].slice(1))-1;break;case"C":W=parseInt(_e[k].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ee)}if(re&&(b[C][w]&&b[C][w].length==2?b[C][w][0]=Te:b[C][w]=Te,B=null),ne){if(j)throw new Error("SYLK shared formula cannot have own formula");var J=N>-1&&b[N][W];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");b[C][w][1]=q2(J[1],{r:C-N,c:w-W})}break;case"F":var q=0;for(k=1;k<_e.length;++k)switch(_e[k].charAt(0)){case"X":w=parseInt(_e[k].slice(1))-1,++q;break;case"Y":for(C=parseInt(_e[k].slice(1))-1,te=b.length;te<=C;++te)b[te]=[];break;case"M":Q=parseInt(_e[k].slice(1))/20;break;case"F":break;case"G":break;case"P":B=U[parseInt(_e[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=_e[k].slice(1).split(" "),te=parseInt(L[0],10);te<=parseInt(L[1],10);++te)Q=parseInt(L[2],10),Y[te-1]=Q===0?{hidden:!0}:{wch:Q},po(Y[te-1]);break;case"C":w=parseInt(_e[k].slice(1))-1,Y[w]||(Y[w]={});break;case"R":C=parseInt(_e[k].slice(1))-1,F[C]||(F[C]={}),Q>0?(F[C].hpt=Q,F[C].hpx=Yl(Q)):Q===0&&(F[C].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ee)}q<1&&(B=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ee)}}return F.length>0&&(X["!rows"]=F),Y.length>0&&(X["!cols"]=Y),E&&E.sheetRows&&(b=b.slice(0,E.sheetRows)),[b,X]}function c(_,E){var S=a(_,E),C=S[0],w=S[1],M=Eo(C,E);return da(w).forEach(function(k){M[k]=w[k]}),M}function u(_,E){return Si(c(_,E),E)}function p(_,E,S,C){var w="C;Y"+(S+1)+";X"+(C+1)+";K";switch(_.t){case"n":w+=_.v||0,_.f&&!_.F&&(w+=";E"+nL(_.f,{r:S,c:C}));break;case"b":w+=_.v?"TRUE":"FALSE";break;case"e":w+=_.w||_.v;break;case"d":w+='"'+(_.w||_.v)+'"';break;case"s":w+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function h(_,E){E.forEach(function(S,C){var w="F;W"+(C+1)+" "+(C+1)+" ";S.hidden?w+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=ju(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=qu(S.wpx)),typeof S.wch=="number"&&(w+=Math.round(S.wch))),w.charAt(w.length-1)!=" "&&_.push(w)})}function g(_,E){E.forEach(function(S,C){var w="F;";S.hidden?w+="M0;":S.hpt?w+="M"+20*S.hpt+";":S.hpx&&(w+="M"+20*H2(S.hpx)+";"),w.length>2&&_.push(w+"R"+(C+1))})}function y(_,E){var S=["ID;PWXL;N;E"],C=[],w=rn(_["!ref"]),M,k=Array.isArray(_),b=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),_["!cols"]&&h(S,_["!cols"]),_["!rows"]&&g(S,_["!rows"]),S.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var U=w.s.r;U<=w.e.r;++U)for(var B=w.s.c;B<=w.e.c;++B){var X=st({r:U,c:B});M=k?(_[U]||[])[B]:_[X],!(!M||M.v==null&&(!M.f||M.F))&&C.push(p(M,_,U,B))}return S.join(b)+b+C.join(b)+b+"E"+b}return{to_workbook:u,to_sheet:c,from_sheet:y}}(),xF=function(){function e(o,c){switch(c.type){case"base64":return t(vr(o),c);case"binary":return t(o,c);case"buffer":return t(yt&&Buffer.isBuffer(o)?o.toString("binary"):os(o),c);case"array":return t(rs(o),c)}throw new Error("Unrecognized type "+c.type)}function t(o,c){for(var u=o.split(`
`),p=-1,h=-1,g=0,y=[];g!==u.length;++g){if(u[g].trim()==="BOT"){y[++p]=[],h=0;continue}if(!(p<0)){var _=u[g].trim().split(","),E=_[0],S=_[1];++g;for(var C=u[g]||"";(C.match(/["]/g)||[]).length&1&&g<u.length-1;)C+=`
`+u[++g];switch(C=C.trim(),+E){case-1:if(C==="BOT"){y[++p]=[],h=0;continue}else if(C!=="EOD")throw new Error("Unrecognized DIF special command "+C);break;case 0:C==="TRUE"?y[p][h]=!0:C==="FALSE"?y[p][h]=!1:isNaN(Kr(S))?isNaN(mo(S).getDate())?y[p][h]=S:y[p][h]=wn(S):y[p][h]=Kr(S),++h;break;case 1:C=C.slice(1,C.length-1),C=C.replace(/""/g,'"'),C&&C.match(/^=".*"$/)&&(C=C.slice(2,-1)),y[p][h++]=C!==""?C:null;break}if(C==="EOD")break}}return c&&c.sheetRows&&(y=y.slice(0,c.sheetRows)),y}function n(o,c){return Eo(e(o,c),c)}function r(o,c){return Si(n(o,c),c)}var a=function(){var o=function(p,h,g,y,_){p.push(h),p.push(g+","+y),p.push('"'+_.replace(/"/g,'""')+'"')},c=function(p,h,g,y){p.push(h+","+g),p.push(h==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(p){var h=[],g=rn(p["!ref"]),y,_=Array.isArray(p);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,g.e.r-g.s.r+1,""),o(h,"TUPLES",0,g.e.c-g.s.c+1,""),o(h,"DATA",0,0,"");for(var E=g.s.r;E<=g.e.r;++E){c(h,-1,0,"BOT");for(var S=g.s.c;S<=g.e.c;++S){var C=st({r:E,c:S});if(y=_?(p[E]||[])[S]:p[C],!y){c(h,1,0,"");continue}switch(y.t){case"n":var w=y.w;!w&&y.v!=null&&(w=y.v),w==null?y.f&&!y.F?c(h,1,0,"="+y.f):c(h,1,0,""):c(h,0,w,"V");break;case"b":c(h,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":c(h,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=Or(y.z||ot[14],Qn(wn(y.v)))),c(h,0,y.w,"V");break;default:c(h,1,0,"")}}}c(h,-1,0,"EOD");var M=`\r
`,k=h.join(M);return k}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),vF=function(){function e(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(y,_){for(var E=y.split(`
`),S=-1,C=-1,w=0,M=[];w!==E.length;++w){var k=E[w].trim().split(":");if(k[0]==="cell"){var b=Wn(k[1]);if(M.length<=b.r)for(S=M.length;S<=b.r;++S)M[S]||(M[S]=[]);switch(S=b.r,C=b.c,k[2]){case"t":M[S][C]=e(k[3]);break;case"v":M[S][C]=+k[3];break;case"vtf":var U=k[k.length-1];case"vtc":switch(k[3]){case"nl":M[S][C]=!!+k[4];break;default:M[S][C]=+k[4];break}k[2]=="vtf"&&(M[S][C]=[M[S][C],U])}}}return _&&_.sheetRows&&(M=M.slice(0,_.sheetRows)),M}function r(y,_){return Eo(n(y,_),_)}function a(y,_){return Si(r(y,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),p="--SocialCalcSpreadsheetControlSave--";function h(y){if(!y||!y["!ref"])return"";for(var _=[],E=[],S,C="",w=_o(y["!ref"]),M=Array.isArray(y),k=w.s.r;k<=w.e.r;++k)for(var b=w.s.c;b<=w.e.c;++b)if(C=st({r:k,c:b}),S=M?(y[k]||[])[b]:y[C],!(!S||S.v==null||S.t==="z")){switch(E=["cell",C,"t"],S.t){case"s":case"str":E.push(t(S.v));break;case"n":S.f?(E[2]="vtf",E[3]="n",E[4]=S.v,E[5]=t(S.f)):(E[2]="v",E[3]=S.v);break;case"b":E[2]="vt"+(S.f?"f":"c"),E[3]="nl",E[4]=S.v?"1":"0",E[5]=t(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var U=Qn(wn(S.v));E[2]="vtc",E[3]="nd",E[4]=""+U,E[5]=S.w||Or(S.z||ot[14],U);break;case"e":continue}_.push(E.join(":"))}return _.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(y){return[o,c,u,c,h(y),p].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:g}}(),jl=function(){function e(g,y,_,E,S){S.raw?y[_][E]=g:g===""||(g==="TRUE"?y[_][E]=!0:g==="FALSE"?y[_][E]=!1:isNaN(Kr(g))?isNaN(mo(g).getDate())?y[_][E]=g:y[_][E]=wn(g):y[_][E]=Kr(g))}function t(g,y){var _=y||{},E=[];if(!g||g.length===0)return E;for(var S=g.split(/[\r\n]/),C=S.length-1;C>=0&&S[C].length===0;)--C;for(var w=10,M=0,k=0;k<=C;++k)M=S[k].indexOf(" "),M==-1?M=S[k].length:M++,w=Math.max(w,M);for(k=0;k<=C;++k){E[k]=[];var b=0;for(e(S[k].slice(0,w).trim(),E,k,b,_),b=1;b<=(S[k].length-w)/10+1;++b)e(S[k].slice(w+(b-1)*10,w+b*10).trim(),E,k,b,_)}return _.sheetRows&&(E=E.slice(0,_.sheetRows)),E}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(g){for(var y={},_=!1,E=0,S=0;E<g.length;++E)(S=g.charCodeAt(E))==34?_=!_:!_&&S in n&&(y[S]=(y[S]||0)+1);S=[];for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&S.push([y[E],E]);if(!S.length){y=r;for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&S.push([y[E],E])}return S.sort(function(C,w){return C[0]-w[0]||r[C[1]]-r[w[1]]}),n[S.pop()[1]]||44}function o(g,y){var _=y||{},E="",S=_.dense?[]:{},C={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(E=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(E=g.charAt(4),g=g.slice(6)):E=a(g.slice(0,1024)):_&&_.FS?E=_.FS:E=a(g.slice(0,1024));var w=0,M=0,k=0,b=0,U=0,B=E.charCodeAt(0),X=!1,F=0,Y=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var L=_.dateNF!=null?ND(_.dateNF):null;function Q(){var te=g.slice(b,U),ee={};if(te.charAt(0)=='"'&&te.charAt(te.length-1)=='"'&&(te=te.slice(1,-1).replace(/""/g,'"')),te.length===0)ee.t="z";else if(_.raw)ee.t="s",ee.v=te;else if(te.trim().length===0)ee.t="s",ee.v=te;else if(te.charCodeAt(0)==61)te.charCodeAt(1)==34&&te.charCodeAt(te.length-1)==34?(ee.t="s",ee.v=te.slice(2,-1).replace(/""/g,'"')):aL(te)?(ee.t="n",ee.f=te.slice(1)):(ee.t="s",ee.v=te);else if(te=="TRUE")ee.t="b",ee.v=!0;else if(te=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(k=Kr(te)))ee.t="n",_.cellText!==!1&&(ee.w=te),ee.v=k;else if(!isNaN(mo(te).getDate())||L&&te.match(L)){ee.z=_.dateNF||ot[14];var _e=0;L&&te.match(L)&&(te=MD(te,_.dateNF,te.match(L)||[]),_e=1),_.cellDates?(ee.t="d",ee.v=wn(te,_e)):(ee.t="n",ee.v=Qn(wn(te,_e))),_.cellText!==!1&&(ee.w=Or(ee.z,ee.v instanceof Date?Qn(ee.v):ee.v)),_.cellNF||delete ee.z}else ee.t="s",ee.v=te;if(ee.t=="z"||(_.dense?(S[w]||(S[w]=[]),S[w][M]=ee):S[st({c:M,r:w})]=ee),b=U+1,Y=g.charCodeAt(b),C.e.c<M&&(C.e.c=M),C.e.r<w&&(C.e.r=w),F==B)++M;else if(M=0,++w,_.sheetRows&&_.sheetRows<=w)return!0}e:for(;U<g.length;++U)switch(F=g.charCodeAt(U)){case 34:Y===34&&(X=!X);break;case B:case 10:case 13:if(!X&&Q())break e;break}return U-b>0&&Q(),S["!ref"]=wt(C),S}function c(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,y):Eo(t(g,y),y)}function u(g,y){var _="",E=y.type=="string"?[0,0,0,0]:Xh(g,y);switch(y.type){case"base64":_=vr(g);break;case"binary":_=g;break;case"buffer":y.codepage==65001?_=g.toString("utf8"):y.codepage&&typeof Vl<"u"||(_=yt&&Buffer.isBuffer(g)?g.toString("binary"):os(g));break;case"array":_=rs(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+y.type)}return E[0]==239&&E[1]==187&&E[2]==191?_=qt(_.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?_=qt(_):y.type=="binary"&&typeof Vl<"u",_.slice(0,19)=="socialcalc:version:"?vF.to_sheet(y.type=="string"?_:qt(_),y):c(_,y)}function p(g,y){return Si(u(g,y),y)}function h(g){for(var y=[],_=rn(g["!ref"]),E,S=Array.isArray(g),C=_.s.r;C<=_.e.r;++C){for(var w=[],M=_.s.c;M<=_.e.c;++M){var k=st({r:C,c:M});if(E=S?(g[C]||[])[M]:g[k],!E||E.v==null){w.push("          ");continue}for(var b=(E.w||(Pa(E),E.w)||"").slice(0,10);b.length<10;)b+=" ";w.push(b+(M===0?" ":""))}y.push(w.join(""))}return y.join(`
`)}return{to_workbook:p,to_sheet:u,from_sheet:h}}();function yF(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var a=gF.to_workbook(e,n);return n.WTF=r,a}catch(o){if(n.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return jl.to_workbook(e,t)}}var Dl=function(){function e(D,J,q){if(D){Dn(D,D.l||0);for(var G=q.Enum||N;D.l<D.length;){var ie=D.read_shift(2),ye=G[ie]||G[65535],Ae=D.read_shift(2),Me=D.l+Ae,Ee=ye.f&&ye.f(D,Ae,q);if(D.l=Me,J(Ee,ye,ie))return}}}function t(D,J){switch(J.type){case"base64":return n(Jr(vr(D)),J);case"binary":return n(Jr(D),J);case"buffer":case"array":return n(D,J)}throw"Unsupported type "+J.type}function n(D,J){if(!D)return D;var q=J||{},G=q.dense?[]:{},ie="Sheet1",ye="",Ae=0,Me={},Ee=[],Ze=[],K={s:{r:0,c:0},e:{r:0,c:0}},ut=q.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)q.Enum=N,e(D,function(xe,He,je){switch(je){case 0:q.vers=xe,xe>=4096&&(q.qpro=!0);break;case 6:K=xe;break;case 204:xe&&(ye=xe);break;case 222:ye=xe;break;case 15:case 51:q.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:je==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=q.dateNF||ot[14],q.cellDates&&(xe[1].t="d",xe[1].v=tf(xe[1].v))),q.qpro&&xe[3]>Ae&&(G["!ref"]=wt(K),Me[ie]=G,Ee.push(ie),G=q.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ae=xe[3],ie=ye||"Sheet"+(Ae+1),ye="");var Mt=q.dense?(G[xe[0].r]||[])[xe[0].c]:G[st(xe[0])];if(Mt){Mt.t=xe[1].t,Mt.v=xe[1].v,xe[1].z!=null&&(Mt.z=xe[1].z),xe[1].f!=null&&(Mt.f=xe[1].f);break}q.dense?(G[xe[0].r]||(G[xe[0].r]=[]),G[xe[0].r][xe[0].c]=xe[1]):G[st(xe[0])]=xe[1];break}},q);else if(D[2]==26||D[2]==14)q.Enum=W,D[2]==14&&(q.qpro=!0,D.l=0),e(D,function(xe,He,je){switch(je){case 204:ie=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>Ae&&(G["!ref"]=wt(K),Me[ie]=G,Ee.push(ie),G=q.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ae=xe[3],ie="Sheet"+(Ae+1)),ut>0&&xe[0].r>=ut)break;q.dense?(G[xe[0].r]||(G[xe[0].r]=[]),G[xe[0].r][xe[0].c]=xe[1]):G[st(xe[0])]=xe[1],K.e.c<xe[0].c&&(K.e.c=xe[0].c),K.e.r<xe[0].r&&(K.e.r=xe[0].r);break;case 27:xe[14e3]&&(Ze[xe[14e3][0]]=xe[14e3][1]);break;case 1537:Ze[xe[0]]=xe[1],xe[0]==Ae&&(ie=xe[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(G["!ref"]=wt(K),Me[ye||ie]=G,Ee.push(ye||ie),!Ze.length)return{SheetNames:Ee,Sheets:Me};for(var We={},ht=[],Ne=0;Ne<Ze.length;++Ne)Me[Ee[Ne]]?(ht.push(Ze[Ne]||Ee[Ne]),We[Ze[Ne]]=Me[Ze[Ne]]||Me[Ee[Ne]]):(ht.push(Ze[Ne]),We[Ze[Ne]]={"!ref":"A1"});return{SheetNames:ht,Sheets:We}}function r(D,J){var q=J||{};if(+q.codepage>=0&&Xr(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Zd(),ie=rn(D["!ref"]),ye=Array.isArray(D),Ae=[];$r(G,0,o(1030)),$r(G,6,p(ie));for(var Me=Math.min(ie.e.r,8191),Ee=ie.s.r;Ee<=Me;++Ee)for(var Ze=Fn(Ee),K=ie.s.c;K<=ie.e.c;++K){Ee===ie.s.r&&(Ae[K]=yn(K));var ut=Ae[K]+Ze,We=ye?(D[Ee]||[])[K]:D[ut];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?$r(G,13,E(Ee,K,We.v)):$r(G,14,C(Ee,K,We.v));else{var ht=Pa(We);$r(G,15,y(Ee,K,ht.slice(0,239)))}}return $r(G,1),G.end()}function a(D,J){var q=J||{};if(+q.codepage>=0&&Xr(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Zd();$r(G,0,c(D));for(var ie=0,ye=0;ie<D.SheetNames.length;++ie)(D.Sheets[D.SheetNames[ie]]||{})["!ref"]&&$r(G,27,j(D.SheetNames[ie],ye++));var Ae=0;for(ie=0;ie<D.SheetNames.length;++ie){var Me=D.Sheets[D.SheetNames[ie]];if(!(!Me||!Me["!ref"])){for(var Ee=rn(Me["!ref"]),Ze=Array.isArray(Me),K=[],ut=Math.min(Ee.e.r,8191),We=Ee.s.r;We<=ut;++We)for(var ht=Fn(We),Ne=Ee.s.c;Ne<=Ee.e.c;++Ne){We===Ee.s.r&&(K[Ne]=yn(Ne));var xe=K[Ne]+ht,He=Ze?(Me[We]||[])[Ne]:Me[xe];if(!(!He||He.t=="z"))if(He.t=="n")$r(G,23,Q(We,Ne,Ae,He.v));else{var je=Pa(He);$r(G,22,F(We,Ne,Ae,je.slice(0,239)))}}++Ae}}return $r(G,1),G.end()}function o(D){var J=vn(2);return J.write_shift(2,D),J}function c(D){var J=vn(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var q=0,G=0,ie=0,ye=0;ye<D.SheetNames.length;++ye){var Ae=D.SheetNames[ye],Me=D.Sheets[Ae];if(!(!Me||!Me["!ref"])){++ie;var Ee=_o(Me["!ref"]);q<Ee.e.r&&(q=Ee.e.r),G<Ee.e.c&&(G=Ee.e.c)}}return q>8191&&(q=8191),J.write_shift(2,q),J.write_shift(1,ie),J.write_shift(1,G),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function u(D,J,q){var G={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&q.qpro?(G.s.c=D.read_shift(1),D.l++,G.s.r=D.read_shift(2),G.e.c=D.read_shift(1),D.l++,G.e.r=D.read_shift(2),G):(G.s.c=D.read_shift(2),G.s.r=D.read_shift(2),J==12&&q.qpro&&(D.l+=2),G.e.c=D.read_shift(2),G.e.r=D.read_shift(2),J==12&&q.qpro&&(D.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function p(D){var J=vn(8);return J.write_shift(2,D.s.c),J.write_shift(2,D.s.r),J.write_shift(2,D.e.c),J.write_shift(2,D.e.r),J}function h(D,J,q){var G=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(G[0].c=D.read_shift(1),G[3]=D.read_shift(1),G[0].r=D.read_shift(2),D.l+=2):(G[2]=D.read_shift(1),G[0].c=D.read_shift(2),G[0].r=D.read_shift(2)),G}function g(D,J,q){var G=D.l+J,ie=h(D,J,q);if(ie[1].t="s",q.vers==20768){D.l++;var ye=D.read_shift(1);return ie[1].v=D.read_shift(ye,"utf8"),ie}return q.qpro&&D.l++,ie[1].v=D.read_shift(G-D.l,"cstr"),ie}function y(D,J,q){var G=vn(7+q.length);G.write_shift(1,255),G.write_shift(2,J),G.write_shift(2,D),G.write_shift(1,39);for(var ie=0;ie<G.length;++ie){var ye=q.charCodeAt(ie);G.write_shift(1,ye>=128?95:ye)}return G.write_shift(1,0),G}function _(D,J,q){var G=h(D,J,q);return G[1].v=D.read_shift(2,"i"),G}function E(D,J,q){var G=vn(7);return G.write_shift(1,255),G.write_shift(2,J),G.write_shift(2,D),G.write_shift(2,q,"i"),G}function S(D,J,q){var G=h(D,J,q);return G[1].v=D.read_shift(8,"f"),G}function C(D,J,q){var G=vn(13);return G.write_shift(1,255),G.write_shift(2,J),G.write_shift(2,D),G.write_shift(8,q,"f"),G}function w(D,J,q){var G=D.l+J,ie=h(D,J,q);if(ie[1].v=D.read_shift(8,"f"),q.qpro)D.l=G;else{var ye=D.read_shift(2);U(D.slice(D.l,D.l+ye),ie),D.l+=ye}return ie}function M(D,J,q){var G=J&32768;return J&=-32769,J=(G?D:0)+(J>=8192?J-16384:J),(G?"":"$")+(q?yn(J):Fn(J))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(D,J){Dn(D,0);for(var q=[],G=0,ie="",ye="",Ae="",Me="";D.l<D.length;){var Ee=D[D.l++];switch(Ee){case 0:q.push(D.read_shift(8,"f"));break;case 1:ye=M(J[0].c,D.read_shift(2),!0),ie=M(J[0].r,D.read_shift(2),!1),q.push(ye+ie);break;case 2:{var Ze=M(J[0].c,D.read_shift(2),!0),K=M(J[0].r,D.read_shift(2),!1);ye=M(J[0].c,D.read_shift(2),!0),ie=M(J[0].r,D.read_shift(2),!1),q.push(Ze+K+":"+ye+ie)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(D.read_shift(2));break;case 6:{for(var ut="";Ee=D[D.l++];)ut+=String.fromCharCode(Ee);q.push('"'+ut.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Me=q.pop(),Ae=q.pop(),q.push(["AND","OR"][Ee-20]+"("+Ae+","+Me+")");break;default:if(Ee<32&&b[Ee])Me=q.pop(),Ae=q.pop(),q.push(Ae+b[Ee]+Me);else if(k[Ee]){if(G=k[Ee][1],G==69&&(G=D[D.l++]),G>q.length){console.error("WK1 bad formula parse 0x"+Ee.toString(16)+":|"+q.join("|")+"|");return}var We=q.slice(-G);q.length-=G,q.push(k[Ee][0]+"("+We.join(",")+")")}else return Ee<=7?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=24?console.error("WK1 unsupported op "+Ee.toString(16)):Ee<=30?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=115?console.error("WK1 unsupported function opcode "+Ee.toString(16)):console.error("WK1 unrecognized opcode "+Ee.toString(16))}}q.length==1?J[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function B(D){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=D.read_shift(2),J[3]=D[D.l++],J[0].c=D[D.l++],J}function X(D,J){var q=B(D);return q[1].t="s",q[1].v=D.read_shift(J-4,"cstr"),q}function F(D,J,q,G){var ie=vn(6+G.length);ie.write_shift(2,D),ie.write_shift(1,q),ie.write_shift(1,J),ie.write_shift(1,39);for(var ye=0;ye<G.length;++ye){var Ae=G.charCodeAt(ye);ie.write_shift(1,Ae>=128?95:Ae)}return ie.write_shift(1,0),ie}function Y(D,J){var q=B(D);q[1].v=D.read_shift(2);var G=q[1].v>>1;if(q[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return q[1].v=G,q}function L(D,J){var q=B(D),G=D.read_shift(4),ie=D.read_shift(4),ye=D.read_shift(2);if(ye==65535)return G===0&&ie===3221225472?(q[1].t="e",q[1].v=15):G===0&&ie===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Ae=ye&32768;return ye=(ye&32767)-16446,q[1].v=(1-Ae*2)*(ie*Math.pow(2,ye+32)+G*Math.pow(2,ye)),q}function Q(D,J,q,G){var ie=vn(14);if(ie.write_shift(2,D),ie.write_shift(1,q),ie.write_shift(1,J),G==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var ye=0,Ae=0,Me=0,Ee=0;return G<0&&(ye=1,G=-G),Ae=Math.log2(G)|0,G/=Math.pow(2,Ae-31),Ee=G>>>0,(Ee&2147483648)==0&&(G/=2,++Ae,Ee=G>>>0),G-=Ee,Ee|=2147483648,Ee>>>=0,G*=Math.pow(2,32),Me=G>>>0,ie.write_shift(4,Me),ie.write_shift(4,Ee),Ae+=16383+(ye?32768:0),ie.write_shift(2,Ae),ie}function te(D,J){var q=L(D);return D.l+=J-14,q}function ee(D,J){var q=B(D),G=D.read_shift(4);return q[1].v=G>>6,q}function _e(D,J){var q=B(D),G=D.read_shift(8,"f");return q[1].v=G,q}function De(D,J){var q=_e(D);return D.l+=J-10,q}function Te(D,J){return D[D.l+J-1]==0?D.read_shift(J,"cstr"):""}function re(D,J){var q=D[D.l++];q>J-1&&(q=J-1);for(var G="";G.length<q;)G+=String.fromCharCode(D[D.l++]);return G}function ce(D,J,q){if(!(!q.qpro||J<21)){var G=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var ie=D.read_shift(J-21,"cstr");return[G,ie]}}function ne(D,J){for(var q={},G=D.l+J;D.l<G;){var ie=D.read_shift(2);if(ie==14e3){for(q[ie]=[0,""],q[ie][0]=D.read_shift(2);D[D.l];)q[ie][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return q}function j(D,J){var q=vn(5+D.length);q.write_shift(2,14e3),q.write_shift(2,J);for(var G=0;G<D.length;++G){var ie=D.charCodeAt(G);q[q.l++]=ie>127?95:ie}return q[q.l++]=0,q}var N={0:{n:"BOF",f:mn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Te},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:X},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:Y},25:{n:"FORMULA19",f:te},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:_e},40:{n:"FORMULA28",f:De},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:t}}();function TF(e){var t={},n=e.match(qn),r=0,a=!1;if(n)for(;r!=n.length;++r){var o=nt(n[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;t.cp=wh[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return t}var _F=function(){var e=Hl("t"),t=Hl("rPr");function n(o){var c=o.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:At(c[1])},p=o.match(t);return p&&(u.s=TF(p[1])),u}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(c){return c.replace(r,"").split(a).map(n).filter(function(u){return u.v})}}(),EF=function(){var t=/(\r\n|\n)/g;function n(a,o,c){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),c.push("</b>")),a.i&&(o.push("<i>"),c.push("</i>")),a.strike&&(o.push("<s>"),c.push("</s>"));var p=a.valign||"";return p=="superscript"||p=="super"?p="sup":p=="subscript"&&(p="sub"),p!=""&&(o.push("<"+p+">"),c.push("</"+p+">")),c.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&n(a.s,o[0],o[2]),o[0].join("")+o[1].replace(t,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}}(),SF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,CF=/<(?:\w+:)?r>/,wF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Hh(e,t){var n=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=At(qt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=qt(e),n&&(r.h=Dh(r.t))):e.match(CF)&&(r.r=qt(e),r.t=At(qt((e.replace(wF,"").match(SF)||[]).join("").replace(qn,""))),n&&(r.h=EF(_F(r.r)))),r):{t:""}}var AF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,bF=/<(?:\w+:)?(?:si|sstItem)>/g,kF=/<\/(?:\w+:)?(?:si|sstItem)>/;function NF(e,t){var n=[],r="";if(!e)return n;var a=e.match(AF);if(a){r=a[2].replace(bF,"").split(kF);for(var o=0;o!=r.length;++o){var c=Hh(r[o].trim(),t);c!=null&&(n[n.length]=c)}a=nt(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}function MF(e){return[e.read_shift(4),e.read_shift(4)]}function RF(e,t){var n=[],r=!1;return Va(e,function(o,c,u){switch(u){case 159:n.Count=o[0],n.Unique=o[1];break;case 19:n.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(c.T,!r||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function O2(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function La(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function DF(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=La(e,4),t.U=La(e,4),t.W=La(e,4),t}function IF(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function FF(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(IF(e));return t}function LF(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function OF(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=La(e,4),t.U=La(e,4),t.W=La(e,4),t}function PF(e){var t=OF(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function P2(e,t){var n=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function U2(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function UF(e){var t=La(e);switch(t.Minor){case 2:return[t.Minor,BF(e)];case 3:return[t.Minor,VF()];case 4:return[t.Minor,GF(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function BF(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),r=P2(e,n),a=U2(e,e.length-e.l);return{t:"Std",h:r,v:a}}function VF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function GF(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(qn,function(o){var c=nt(o);switch(ha(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){r[u]=c[u]});break;case"<dataIntegrity":r.encryptedHmacKey=c.encryptedHmacKey,r.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(c);break;default:throw c[0]}}),r}function HF(e,t){var n={},r=n.EncryptionVersionInfo=La(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,n.EncryptionHeader=P2(e,a),t-=a,n.EncryptionVerifier=U2(e,t),n}function zF(e){var t={},n=t.EncryptionVersionInfo=La(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function jF(e){var t=0,n,r=O2(e),a=r.length+1,o,c,u,p,h;for(n=Ti(a),n[0]=r.length,o=1;o!=a;++o)n[o]=r[o-1];for(o=a-1;o>=0;--o)c=n[o],u=(t&16384)===0?0:1,p=t<<1&32767,h=u|p,t=h^c;return t^52811}var B2=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(c){return(c/2|c*128)&255},a=function(c,u){return r(c^u)},o=function(c){for(var u=t[c.length-1],p=104,h=c.length-1;h>=0;--h)for(var g=c[h],y=0;y!=7;++y)g&64&&(u^=n[p]),g*=2,--p;return u};return function(c){for(var u=O2(c),p=o(u),h=u.length,g=Ti(16),y=0;y!=16;++y)g[y]=0;var _,E,S;for((h&1)===1&&(_=p>>8,g[h]=a(e[0],_),--h,_=p&255,E=u[u.length-1],g[h]=a(E,_));h>0;)--h,_=p>>8,g[h]=a(u[h],_),--h,_=p&255,g[h]=a(u[h],_);for(h=15,S=15-u.length;S>0;)_=p>>8,g[h]=a(e[S],_),--h,--S,_=p&255,g[h]=a(u[h],_),--h,--S;return g}}(),qF=function(e,t,n,r,a){a||(a=t),r||(r=B2(e));var o,c;for(o=0;o!=t.length;++o)c=t[o],c^=r[n],c=(c>>5|c<<3)&255,a[o]=c,++n;return[a,n,r]},YF=function(e){var t=0,n=B2(e);return function(r){var a=qF("",r,t,n);return t=a[1],a[0]}};function $F(e,t,n,r){var a={key:mn(e),verificationBytes:mn(e)};return n.password&&(a.verifier=jF(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=YF(n.password)),a}function JF(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=zF(e):r.Data=HF(e,t),r}function XF(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?JF(e,t-2,r):$F(e,n.biff>=8?t:t-2,n,r),r}var WF=function(){function e(a,o){switch(o.type){case"base64":return t(vr(a),o);case"binary":return t(a,o);case"buffer":return t(yt&&Buffer.isBuffer(a)?a.toString("binary"):os(a),o);case"array":return t(rs(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){var c=o||{},u=c.dense?[]:{},p=a.match(/\\trowd.*?\\row\b/g);if(!p.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:p.length-1}};return p.forEach(function(g,y){Array.isArray(u)&&(u[y]=[]);for(var _=/\\\w+\b/g,E=0,S,C=-1;S=_.exec(g);){switch(S[0]){case"\\cell":var w=g.slice(E,_.lastIndex-S[0].length);if(w[0]==" "&&(w=w.slice(1)),++C,w.length){var M={v:w,t:"s"};Array.isArray(u)?u[y][C]=M:u[st({r:y,c:C})]=M}break}E=_.lastIndex}C>h.e.c&&(h.e.c=C)}),u["!ref"]=wt(h),u}function n(a,o){return Si(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],c=rn(a["!ref"]),u,p=Array.isArray(a),h=c.s.r;h<=c.e.r;++h){o.push("\\trowd\\trautofit1");for(var g=c.s.c;g<=c.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=c.s.c;g<=c.e.c;++g){var y=st({r:h,c:g});u=p?(a[h]||[])[g]:a[y],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(Pa(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function KF(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ql(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function ZF(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),o=Math.min(t,n,r),c=a-o;if(c===0)return[0,0,t];var u=0,p=0,h=a+o;switch(p=c/(h>1?2-h:h),a){case t:u=((n-r)/c+6)%6;break;case n:u=(r-t)/c+2;break;case r:u=(t-n)/c+4;break}return[u/6,p,h/2]}function QF(e){var t=e[0],n=e[1],r=e[2],a=n*2*(r<.5?r:1-r),o=r-a/2,c=[o,o,o],u=6*t,p;if(n!==0)switch(u|0){case 0:case 6:p=a*u,c[0]+=a,c[1]+=p;break;case 1:p=a*(2-u),c[0]+=p,c[1]+=a;break;case 2:p=a*(u-2),c[1]+=a,c[2]+=p;break;case 3:p=a*(4-u),c[1]+=p,c[2]+=a;break;case 4:p=a*(u-4),c[2]+=a,c[0]+=p;break;case 5:p=a*(6-u),c[2]+=p,c[0]+=a;break}for(var h=0;h!=3;++h)c[h]=Math.round(c[h]*255);return c}function zu(e,t){if(t===0)return e;var n=ZF(KF(e));return t<0?n[2]=n[2]*(1+t):n[2]=1-(1-n[2])*(1-t),ql(QF(n))}var V2=6,e8=15,t8=1,Xn=V2;function ju(e){return Math.floor((e+Math.round(128/Xn)/256)*Xn)}function qu(e){return Math.floor((e-5)/Xn*100+.5)/100}function nh(e){return Math.round((e*Xn+5)/Xn*256)/256}function Ed(e){return nh(qu(ju(e)))}function zh(e){var t=Math.abs(e-Ed(e)),n=Xn;if(t>.005)for(Xn=t8;Xn<e8;++Xn)Math.abs(e-Ed(e))<=t&&(t=Math.abs(e-Ed(e)),n=Xn);Xn=n}function po(e){e.width?(e.wpx=ju(e.width),e.wch=qu(e.wpx),e.MDW=Xn):e.wpx?(e.wch=qu(e.wpx),e.width=nh(e.wch),e.MDW=Xn):typeof e.wch=="number"&&(e.width=nh(e.wch),e.wpx=ju(e.width),e.MDW=Xn),e.customWidth&&delete e.customWidth}var n8=96,G2=n8;function H2(e){return e*96/G2}function Yl(e){return e*G2/96}var r8={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function a8(e,t,n,r){t.Borders=[];var a={},o=!1;(e[0].match(qn)||[]).forEach(function(c){var u=nt(c);switch(ha(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=Jt(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=Jt(u.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function i8(e,t,n,r){t.Fills=[];var a={},o=!1;(e[0].match(qn)||[]).forEach(function(c){var u=nt(c);switch(ha(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function s8(e,t,n,r){t.Fonts=[];var a={},o=!1;(e[0].match(qn)||[]).forEach(function(c){var u=nt(c);switch(ha(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=qt(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?Jt(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?Jt(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?Jt(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?Jt(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?Jt(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?Jt(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?Jt(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=wh[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=Jt(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var p=Xi[a.color.index];a.color.index==81&&(p=Xi[1]),p||(p=Xi[1]),a.color.rgb=p[0].toString(16)+p[1].toString(16)+p[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=zu(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function o8(e,t,n){t.NumberFmt=[];for(var r=da(ot),a=0;a<r.length;++a)t.NumberFmt[r[a]]=ot[r[a]];var o=e[0].match(qn);if(o)for(a=0;a<o.length;++a){var c=nt(o[a]);switch(ha(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=At(qt(c.formatCode)),p=parseInt(c.numFmtId,10);if(t.NumberFmt[p]=u,p>0){if(p>392){for(p=392;p>60&&t.NumberFmt[p]!=null;--p);t.NumberFmt[p]=u}Ji(u,p)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var yu=["numFmtId","fillId","fontId","borderId","xfId"],Tu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function l8(e,t,n){t.CellXf=[];var r,a=!1;(e[0].match(qn)||[]).forEach(function(o){var c=nt(o),u=0;switch(ha(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=c,delete r[0],u=0;u<yu.length;++u)r[yu[u]]&&(r[yu[u]]=parseInt(r[yu[u]],10));for(u=0;u<Tu.length;++u)r[Tu[u]]&&(r[Tu[u]]=Jt(r[Tu[u]]));if(t.NumberFmt&&r.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[u]){r.numFmtId=u;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var p={};c.vertical&&(p.vertical=c.vertical),c.horizontal&&(p.horizontal=c.horizontal),c.textRotation!=null&&(p.textRotation=c.textRotation),c.indent&&(p.indent=c.indent),c.wrapText&&(p.wrapText=Jt(c.wrapText)),r.alignment=p;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var c8=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,p,h){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=u.match(t))&&o8(y,g,h),(y=u.match(a))&&s8(y,g,p,h),(y=u.match(r))&&i8(y,g,p,h),(y=u.match(o))&&a8(y,g,p,h),(y=u.match(n))&&l8(y,g,h),g}}();function u8(e,t){var n=e.read_shift(2),r=zn(e);return[n,r]}function f8(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=_6(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(r.underline=c);var u=e.read_shift(1);u>0&&(r.family=u);var p=e.read_shift(1);switch(p>0&&(r.charset=p),e.l++,r.color=T6(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=zn(e),r}var d8=jn;function h8(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}var m8=jn;function p8(e,t,n){var r={};r.NumberFmt=[];for(var a in ot)r.NumberFmt[a]=ot[a];r.CellXf=[],r.Fonts=[];var o=[],c=!1;return Va(e,function(p,h,g){switch(g){case 44:r.NumberFmt[p[0]]=p[1],Ji(p[1],p[0]);break;case 43:r.Fonts.push(p),p.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(p.color.rgb=zu(t.themeElements.clrScheme[p.color.theme].rgb,p.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(p);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:o.push(g),c=!0;break;case 38:o.pop(),c=!1;break;default:if(h.T>0)o.push(g);else if(h.T<0)o.pop();else if(!c||n.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),r}var g8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function x8(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(qn)||[]).forEach(function(a){var o=nt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(t.themeElements.clrScheme[g8.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function v8(){}function y8(){}var T8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,E8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function S8(e,t,n){t.themeElements={};var r;[["clrScheme",T8,x8],["fontScheme",_8,v8],["fmtScheme",E8,y8]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,n)})}var C8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function z2(e,t){(!e||e.length===0)&&(e=w8());var n,r={};if(!(n=e.match(C8)))throw new Error("themeElements not found in theme");return S8(n[0],r,t),r.raw=e,r}function w8(e,t){var n=[e2];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function A8(e,t,n){var r=e.l+t,a=e.read_shift(4);if(a!==124226){if(!n.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var c;try{c=QT(o,{type:"array"})}catch{return}var u=gr(c,"theme/theme/theme1.xml",!0);if(u)return z2(u,n)}}function b8(e){return e.read_shift(4)}function k8(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=N8(e,4);break;case 2:t.xclrValue=N2(e);break;case 3:t.xclrValue=b8(e);break;case 4:e.l+=4;break}return e.l+=8,t}function N8(e,t){return jn(e,t)}function M8(e,t){return jn(e,t)}function R8(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=k8(e);break;case 6:r[1]=M8(e,n);break;case 14:case 15:r[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function D8(e,t){var n=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(R8(e,n-e.l));return{ixfe:r,ext:o}}function I8(e,t){t.forEach(function(n){n[0]})}function F8(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:zn(e)}}function L8(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function O8(e){return e.l+=4,e.read_shift(4)!=0}function P8(e,t,n){var r={Types:[],Cell:[],Value:[]},a=n||{},o=[],c=!1,u=2;return Va(e,function(p,h,g){switch(g){case 335:r.Types.push({name:p.name});break;case 51:p.forEach(function(y){u==1?r.Cell.push({type:r.Types[y[0]-1].name,index:y[1]}):u==0&&r.Value.push({type:r.Types[y[0]-1].name,index:y[1]})});break;case 337:u=p?1:0;break;case 338:u=2;break;case 35:o.push(g),c=!0;break;case 36:o.pop(),c=!1;break;default:if(!h.T){if(!c||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),r}function U8(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,c;return e.replace(qn,function(u){var p=nt(u);switch(ha(p[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:p.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==p.name&&(c=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[p.t-1].name,index:+p.v}):o==0&&r.Value.push({type:r.Types[p.t-1].name,index:+p.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+p.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+p[0]+" in metadata")}return u}),r}function B8(e){var t=[];if(!e)return t;var n=1;return(e.match(qn)||[]).forEach(function(r){var a=nt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,t.push(a);break}}),t}function V8(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=st(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function G8(e,t,n){var r=[];return Va(e,function(o,c,u){switch(u){case 63:r.push(o);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function H8(e,t,n,r){if(!e)return e;var a=r||{},o=!1;Va(e,function(u,p,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!p.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function z8(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}function vy(e,t,n,r){var a=Array.isArray(e),o;t.forEach(function(c){var u=Wn(c.ref);if(a?(e[u.r]||(e[u.r]=[]),o=e[u.r][u.c]):o=e[c.ref],!o){o={t:"z"},a?e[u.r][u.c]=o:e[c.ref]=o;var p=rn(e["!ref"]||"BDWGO1000001:A1");p.s.r>u.r&&(p.s.r=u.r),p.e.r<u.r&&(p.e.r=u.r),p.s.c>u.c&&(p.s.c=u.c),p.e.c<u.c&&(p.e.c=u.c);var h=wt(p);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var g={a:c.author,t:c.t,r:c.r,T:n};c.h&&(g.h=c.h);for(var y=o.c.length-1;y>=0;--y){if(!n&&o.c[y].T)return;n&&!o.c[y].T&&o.c.splice(y,1)}if(n&&r){for(y=0;y<r.length;++y)if(g.a==r[y].id){g.a=r[y].name||g.a;break}}o.c.push(g)})}function j8(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&n.push(u[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var p=nt(u[0]),h={author:p.authorId&&n[p.authorId]||"sheetjsghost",ref:p.ref,guid:p.guid},g=Wn(p.ref);if(!(t.sheetRows&&t.sheetRows<=g.r)){var y=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!y&&!!y[1]&&Hh(y[1])||{r:"",t:"",h:""};h.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),h.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=_.h),r.push(h)}}}}),r}function q8(e,t){var n=[],r=!1,a={},o=0;return e.replace(qn,function(u,p){var h=nt(u);switch(ha(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":o=p+u.length;break;case"</text>":a.t=e.slice(o,p).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),n}function Y8(e,t){var n=[],r=!1;return e.replace(qn,function(o){var c=nt(o);switch(ha(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),n}function $8(e){var t={};t.iauthor=e.read_shift(4);var n=cs(e);return t.rfx=n.s,t.ref=st(n.s),e.l+=16,t}var J8=zn;function X8(e,t){var n=[],r=[],a={},o=!1;return Va(e,function(u,p,h){switch(h){case 632:r.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!p.T){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}var W8="application/vnd.ms-office.vbaProject";function K8(e){var t=St.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");St.utils.cfb_add(t,a,e.FileIndex[r].content)}}),St.write(t)}function Z8(){return{"!type":"dialog"}}function Q8(){return{"!type":"dialog"}}function eL(){return{"!type":"macro"}}function tL(){return{"!type":"macro"}}var ao=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,a,o,c){var u=!1,p=!1;o.length==0?p=!0:o.charAt(0)=="["&&(p=!0,o=o.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,g=c.length>0?parseInt(c,10)|0:0;return u?g+=t.c:--g,p?h+=t.r:--h,a+(u?"":"$")+yn(g)+(p?"":"$")+Fn(h)}return function(a,o){return t=o,a.replace(e,n)}}(),j2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nL=function(){return function(t,n){return t.replace(j2,function(r,a,o,c,u,p){var h=Oh(c)-(o?0:n.c),g=Lh(p)-(u?0:n.r),y=g==0?"":u?g+1:"["+g+"]",_=h==0?"":o?h+1:"["+h+"]";return a+"R"+y+"C"+_})}}();function q2(e,t){return e.replace(j2,function(n,r,a,o,c,u){return r+(a=="$"?a+o:yn(Oh(o)+t.c))+(c=="$"?c+u:Fn(Lh(u)+t.r))})}function rL(e,t,n){var r=_o(t),a=r.s,o=Wn(n),c={r:o.r-a.r,c:o.c-a.c};return q2(e,c)}function aL(e){return e.length!=1}function yy(e){return e.replace(/_xlfn\./g,"")}function dn(e){e.l+=1}function _i(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function Y2(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return $2(e);n.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),c=_i(e),u=_i(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function $2(e){var t=_i(e),n=_i(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function iL(e,t,n){if(n.biff<8)return $2(e);var r=e.read_shift(n.biff==12?4:2),a=e.read_shift(n.biff==12?4:2),o=_i(e),c=_i(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function J2(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return sL(e);var r=e.read_shift(n&&n.biff==12?4:2),a=_i(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function sL(e){var t=_i(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function oL(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function lL(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return cL(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),c=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:c,rRel:u}}function cL(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),a==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:a,rRel:r}}function uL(e,t,n){var r=(e[e.l++]&96)>>5,a=Y2(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function fL(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var c=Y2(e,o,n);return[r,a,c]}function dL(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function hL(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function mL(e,t,n){var r=(e[e.l++]&96)>>5,a=iL(e,t-1,n);return[r,a]}function pL(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Ty(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function gL(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(n&&n.biff==2?1:2));return a}function xL(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function vL(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function yL(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function TL(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function X2(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function _L(e){return e.read_shift(2),X2(e)}function EL(e){return e.read_shift(2),X2(e)}function SL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=J2(e,0,n);return[r,a]}function CL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=lL(e,0,n);return[r,a]}function wL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var o=J2(e,0,n);return[r,a,o]}function AL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[bO[a],Z2[a],r]}function bL(e,t,n){var r=e[e.l++],a=e.read_shift(1),o=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:kL(e);return[a,(o[0]===0?Z2:AO)[o[1]]]}function kL(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function NL(e,t,n){e.l+=n&&n.biff==2?3:4}function ML(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function RL(e){return e.l++,us[e.read_shift(1)]}function DL(e){return e.l++,e.read_shift(2)}function IL(e){return e.l++,e.read_shift(1)!==0}function FL(e){return e.l++,Vn(e)}function LL(e,t,n){return e.l++,Kl(e,t-1,n)}function OL(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=ln(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=us[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Vn(e);break;case 2:n[1]=fs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function PL(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((n.biff==12?cs:nf)(e));return a}function UL(e,t,n){var r=0,a=0;n.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var o=0,c=[];o!=r&&(c[o]=[]);++o)for(var u=0;u!=a;++u)c[o][u]=OL(e,n.biff);return c}function BL(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,o=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function VL(e,t,n){if(n.biff==5)return GL(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function GL(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function HL(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function zL(e,t,n){var r=e.read_shift(1)>>>5&3,a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function jL(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function qL(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var YL=jn,$L=jn,JL=jn;function Ql(e,t,n){return e.l+=2,[oL(e)]}function jh(e){return e.l+=6,[]}var XL=Ql,WL=jh,KL=jh,ZL=Ql;function W2(e){return e.l+=2,[mn(e),e.read_shift(2)&1]}var QL=Ql,eO=W2,tO=jh,nO=Ql,rO=Ql,aO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function iO(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),c=aO[n>>2&31];return{ixti:t,coltype:n&3,rt:c,idx:r,c:a,C:o}}function sO(e){return e.l+=2,[e.read_shift(4)]}function oO(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function lO(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function cO(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function uO(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function fO(e){return e.l+=4,[0,0]}var _y={1:{n:"PtgExp",f:ML},2:{n:"PtgTbl",f:JL},3:{n:"PtgAdd",f:dn},4:{n:"PtgSub",f:dn},5:{n:"PtgMul",f:dn},6:{n:"PtgDiv",f:dn},7:{n:"PtgPower",f:dn},8:{n:"PtgConcat",f:dn},9:{n:"PtgLt",f:dn},10:{n:"PtgLe",f:dn},11:{n:"PtgEq",f:dn},12:{n:"PtgGe",f:dn},13:{n:"PtgGt",f:dn},14:{n:"PtgNe",f:dn},15:{n:"PtgIsect",f:dn},16:{n:"PtgUnion",f:dn},17:{n:"PtgRange",f:dn},18:{n:"PtgUplus",f:dn},19:{n:"PtgUminus",f:dn},20:{n:"PtgPercent",f:dn},21:{n:"PtgParen",f:dn},22:{n:"PtgMissArg",f:dn},23:{n:"PtgStr",f:LL},26:{n:"PtgSheet",f:oO},27:{n:"PtgEndSheet",f:lO},28:{n:"PtgErr",f:RL},29:{n:"PtgBool",f:IL},30:{n:"PtgInt",f:DL},31:{n:"PtgNum",f:FL},32:{n:"PtgArray",f:pL},33:{n:"PtgFunc",f:AL},34:{n:"PtgFuncVar",f:bL},35:{n:"PtgName",f:BL},36:{n:"PtgRef",f:SL},37:{n:"PtgArea",f:uL},38:{n:"PtgMemArea",f:HL},39:{n:"PtgMemErr",f:YL},40:{n:"PtgMemNoMem",f:$L},41:{n:"PtgMemFunc",f:zL},42:{n:"PtgRefErr",f:jL},43:{n:"PtgAreaErr",f:dL},44:{n:"PtgRefN",f:CL},45:{n:"PtgAreaN",f:mL},46:{n:"PtgMemAreaN",f:cO},47:{n:"PtgMemNoMemN",f:uO},57:{n:"PtgNameX",f:VL},58:{n:"PtgRef3d",f:wL},59:{n:"PtgArea3d",f:fL},60:{n:"PtgRefErr3d",f:qL},61:{n:"PtgAreaErr3d",f:hL},255:{}},dO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hO={1:{n:"PtgElfLel",f:W2},2:{n:"PtgElfRw",f:nO},3:{n:"PtgElfCol",f:XL},6:{n:"PtgElfRwV",f:rO},7:{n:"PtgElfColV",f:ZL},10:{n:"PtgElfRadical",f:QL},11:{n:"PtgElfRadicalS",f:tO},13:{n:"PtgElfColS",f:WL},15:{n:"PtgElfColSV",f:KL},16:{n:"PtgElfRadicalLel",f:eO},25:{n:"PtgList",f:iO},29:{n:"PtgSxName",f:sO},255:{}},mO={0:{n:"PtgAttrNoop",f:fO},1:{n:"PtgAttrSemi",f:TL},2:{n:"PtgAttrIf",f:vL},4:{n:"PtgAttrChoose",f:gL},8:{n:"PtgAttrGoto",f:xL},16:{n:"PtgAttrSum",f:NL},32:{n:"PtgAttrBaxcel",f:Ty},33:{n:"PtgAttrBaxcel",f:Ty},64:{n:"PtgAttrSpace",f:_L},65:{n:"PtgAttrSpaceSemi",f:EL},128:{n:"PtgAttrIfError",f:yL},255:{}};function ec(e,t,n,r){if(r.biff<8)return jn(e,t);for(var a=e.l+t,o=[],c=0;c!==n.length;++c)switch(n[c][0]){case"PtgArray":n[c][1]=UL(e,0,r),o.push(n[c][1]);break;case"PtgMemArea":n[c][2]=PL(e,n[c][1],r),o.push(n[c][2]);break;case"PtgExp":r&&r.biff==12&&(n[c][1][1]=e.read_shift(4),o.push(n[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[c][0]}return t=a-e.l,t!==0&&o.push(jn(e,t)),o}function tc(e,t,n){for(var r=e.l+t,a,o,c=[];r!=e.l;)t=r-e.l,o=e[e.l],a=_y[o]||_y[dO[o]],(o===24||o===25)&&(a=(o===24?hO:mO)[e[e.l+1]]),!a||!a.f?jn(e,t):c.push([a.n,a.f(e,t,n)]);return c}function pO(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],o=0;o<r.length;++o){var c=r[o];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var gO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function K2(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Ey(e,t,n){var r=K2(e,t,n);return r=="#REF"?r:xO(r,n)}function Bn(e,t,n,r,a){var o=a&&a.biff||8,c={s:{c:0,r:0}},u=[],p,h,g,y=0,_=0,E,S="";if(!e[0]||!e[0][0])return"";for(var C=-1,w="",M=0,k=e[0].length;M<k;++M){var b=e[0][M];switch(b[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(p=u.pop(),h=u.pop(),C>=0){switch(e[0][C][1][0]){case 0:w=nn(" ",e[0][C][1][1]);break;case 1:w=nn("\r",e[0][C][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}h=h+w,C=-1}u.push(h+gO[b[0]]+p);break;case"PtgIsect":p=u.pop(),h=u.pop(),u.push(h+" "+p);break;case"PtgUnion":p=u.pop(),h=u.pop(),u.push(h+","+p);break;case"PtgRange":p=u.pop(),h=u.pop(),u.push(h+":"+p);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=kl(b[1][1],c,a),u.push(Nl(g,o));break;case"PtgRefN":g=n?kl(b[1][1],n,a):b[1][1],u.push(Nl(g,o));break;case"PtgRef3d":y=b[1][1],g=kl(b[1][2],c,a),S=Ey(r,y,a),u.push(S+"!"+Nl(g,o));break;case"PtgFunc":case"PtgFuncVar":var U=b[1][0],B=b[1][1];U||(U=0),U&=127;var X=U==0?[]:u.slice(-U);u.length-=U,B==="User"&&(B=X.shift()),u.push(B+"("+X.join(",")+")");break;case"PtgBool":u.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(b[1]);break;case"PtgNum":u.push(String(b[1]));break;case"PtgStr":u.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(b[1]);break;case"PtgAreaN":E=ny(b[1][1],n?{s:n}:c,a),u.push(Td(E,a));break;case"PtgArea":E=ny(b[1][1],c,a),u.push(Td(E,a));break;case"PtgArea3d":y=b[1][1],E=b[1][2],S=Ey(r,y,a),u.push(S+"!"+Td(E,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=b[1][2];var F=(r.names||[])[_-1]||(r[0]||[])[_],Y=F?F.Name:"SH33TJSNAME"+String(_);Y&&Y.slice(0,6)=="_xlfn."&&!a.xlfn&&(Y=Y.slice(6)),u.push(Y);break;case"PtgNameX":var L=b[1][1];_=b[1][2];var Q;if(a.biff<=5)L<0&&(L=-L),r[L]&&(Q=r[L][_]);else{var te="";if(((r[L]||[])[0]||[])[0]==14849||(((r[L]||[])[0]||[])[0]==1025?r[L][_]&&r[L][_].itab>0&&(te=r.SheetNames[r[L][_].itab-1]+"!"):te=r.SheetNames[_-1]+"!"),r[L]&&r[L][_])te+=r[L][_].Name;else if(r[0]&&r[0][_])te+=r[0][_].Name;else{var ee=(K2(r,L,a)||"").split(";;");ee[_-1]?te=ee[_-1]:te+="SH33TJSERRX"}u.push(te);break}Q||(Q={Name:"SH33TJSERRY"}),u.push(Q.Name);break;case"PtgParen":var _e="(",De=")";if(C>=0){switch(w="",e[0][C][1][0]){case 2:_e=nn(" ",e[0][C][1][1])+_e;break;case 3:_e=nn("\r",e[0][C][1][1])+_e;break;case 4:De=nn(" ",e[0][C][1][1])+De;break;case 5:De=nn("\r",e[0][C][1][1])+De;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}C=-1}u.push(_e+u.pop()+De);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:b[1][1],r:b[1][0]};var Te={c:n.c,r:n.r};if(r.sharedf[st(g)]){var re=r.sharedf[st(g)];u.push(Bn(re,c,Te,r,a))}else{var ce=!1;for(p=0;p!=r.arrayf.length;++p)if(h=r.arrayf[p],!(g.c<h[0].s.c||g.c>h[0].e.c)&&!(g.r<h[0].s.r||g.r>h[0].e.r)){u.push(Bn(h[1],c,Te,r,a)),ce=!0;break}ce||u.push(b[1])}break;case"PtgArray":u.push("{"+pO(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":C=M;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&C>=0&&ne.indexOf(e[0][M][0])==-1){b=e[0][C];var j=!0;switch(b[1][0]){case 4:j=!1;case 0:w=nn(" ",b[1][1]);break;case 5:j=!1;case 1:w=nn("\r",b[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}u.push((j?w:"")+u.pop()+(j?"":w)),C=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function vO(e,t,n){var r=e.l+t,a=n.biff==2?1:2,o,c=e.read_shift(a);if(c==65535)return[[],jn(e,t-2)];var u=tc(e,c,n);return t!==c+a&&(o=ec(e,t-c-a,u,n)),e.l=r,[u,o]}function yO(e,t,n){var r=e.l+t,a=n.biff==2?1:2,o,c=e.read_shift(a);if(c==65535)return[[],jn(e,t-2)];var u=tc(e,c,n);return t!==c+a&&(o=ec(e,t-c-a,u,n)),e.l=r,[u,o]}function TO(e,t,n,r){var a=e.l+t,o=tc(e,r,n),c;return a!==e.l&&(c=ec(e,a-e.l,o,n)),[o,c]}function _O(e,t,n){var r=e.l+t,a,o=e.read_shift(2),c=tc(e,o,n);return o==65535?[[],jn(e,t-2)]:(t!==o+2&&(a=ec(e,r-o-2,c,n)),[c,a])}function EO(e){var t;if(Da(e,e.l+6)!==65535)return[Vn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Sd(e,t,n){var r=e.l+t,a=ma(e);n.biff==2&&++e.l;var o=EO(e),c=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var u=yO(e,r-e.l,n);return{cell:a,val:o[0],formula:u,shared:c>>3&1,tt:o[1]}}function rf(e,t,n){var r=e.read_shift(4),a=tc(e,r,n),o=e.read_shift(4),c=o>0?ec(e,o,a,n):null;return[a,c]}var SO=rf,af=rf,CO=rf,wO=rf,AO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Z2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Sy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Cd(e){var t=e.split(":"),n=t[0].split(".")[0];return[n,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Il={},io={};function Fl(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function Q2(e,t,n,r,a,o){try{r.cellNF&&(e.z=ot[t])}catch(u){if(r.WTF)throw u}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=wn(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(ot[t]==null&&Ji(kD[t]||"General",t),e.t==="e")e.w=e.w||us[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gl(e.v);else if(e.t==="d"){var c=Qn(e.v);(c|0)===c?e.w=c.toString(10):e.w=Gl(c)}else{if(e.v===void 0)return"";e.w=ns(e.v,io)}else e.t==="d"?e.w=Or(t,Qn(e.v),io):e.w=Or(t,e.v,io)}catch(u){if(r.WTF)throw u}if(r.cellStyles&&n!=null)try{e.s=o.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=zu(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=zu(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(r.WTF&&o.Fills)throw u}}}function kO(e,t){var n=rn(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=wt(n))}var NO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,MO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,RO=/<(?:\w:)?hyperlink [^>]*>/mg,DO=/"(\w*:\w*)"/,IO=/<(?:\w:)?col\b[^>]*[\/]?>/g,FO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,LO=/<(?:\w:)?pageMargins[^>]*\/>/g,e_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,OO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,PO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function UO(e,t,n,r,a,o,c){if(!e)return e;r||(r={"!id":{}});var u=t.dense?[]:{},p={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",g="",y=e.match(MO);y?(h=e.slice(0,y.index),g=e.slice(y.index+y[0].length)):h=g=e;var _=h.match(e_);_?qh(_[0],u,a,n):(_=h.match(OO))&&BO(_[0],_[1]||"",u,a,n);var E=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var S=h.slice(E,E+50).match(DO);S&&kO(u,S[1])}var C=h.match(PO);C&&C[1]&&qO(C[1],a);var w=[];if(t.cellStyles){var M=h.match(IO);M&&HO(w,M)}y&&YO(y[1],u,t,p,o,c);var k=g.match(FO);k&&(u["!autofilter"]=zO(k[0]));var b=[],U=g.match(NO);if(U)for(E=0;E!=U.length;++E)b[E]=rn(U[E].slice(U[E].indexOf('"')+1));var B=g.match(RO);B&&VO(u,B,r);var X=g.match(LO);if(X&&(u["!margins"]=GO(nt(X[0]))),!u["!ref"]&&p.e.c>=p.s.c&&p.e.r>=p.s.r&&(u["!ref"]=wt(p)),t.sheetRows>0&&u["!ref"]){var F=rn(u["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>p.e.r&&(F.e.r=p.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>p.e.c&&(F.e.c=p.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),u["!fullref"]=u["!ref"],u["!ref"]=wt(F))}return w.length>0&&(u["!cols"]=w),b.length>0&&(u["!merges"]=b),u}function qh(e,t,n,r){var a=nt(e);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=At(qt(a.codeName)))}function BO(e,t,n,r,a){qh(e.slice(0,e.indexOf(">")),n,r,a)}function VO(e,t,n){for(var r=Array.isArray(e),a=0;a!=t.length;++a){var o=nt(qt(t[a]),!0);if(!o.ref)return;var c=((n||{})["!id"]||[])[o.id];c?(o.Target=c.Target,o.location&&(o.Target+="#"+At(o.location))):(o.Target="#"+At(o.location),c={Target:o.Target,TargetMode:"Internal"}),o.Rel=c,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=rn(o.ref),p=u.s.r;p<=u.e.r;++p)for(var h=u.s.c;h<=u.e.c;++h){var g=st({c:h,r:p});r?(e[p]||(e[p]=[]),e[p][h]||(e[p][h]={t:"z",v:void 0}),e[p][h].l=o):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=o)}}}function GO(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}function HO(e,t){for(var n=!1,r=0;r!=t.length;++r){var a=nt(t[r],!0);a.hidden&&(a.hidden=Jt(a.hidden));var o=parseInt(a.min,10)-1,c=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,zh(a.width)),po(a);o<=c;)e[o++]=In(a)}}function zO(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var jO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function qO(e,t){t.Views||(t.Views=[{}]),(e.match(jO)||[]).forEach(function(n,r){var a=nt(n);t.Views[r]||(t.Views[r]={}),+a.zoomScale&&(t.Views[r].zoom=+a.zoomScale),Jt(a.rightToLeft)&&(t.Views[r].RTL=!0)})}var YO=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Hl("v"),c=Hl("f");return function(p,h,g,y,_,E){for(var S=0,C="",w=[],M=[],k=0,b=0,U=0,B="",X,F,Y=0,L=0,Q,te,ee=0,_e=0,De=Array.isArray(E.CellXf),Te,re=[],ce=[],ne=Array.isArray(h),j=[],N={},W=!1,D=!!g.sheetStubs,J=p.split(t),q=0,G=J.length;q!=G;++q){C=J[q].trim();var ie=C.length;if(ie!==0){var ye=0;e:for(S=0;S<ie;++S)switch(C[S]){case">":if(C[S-1]!="/"){++S;break e}if(g&&g.cellStyles){if(F=nt(C.slice(ye,S),!0),Y=F.r!=null?parseInt(F.r,10):Y+1,L=-1,g.sheetRows&&g.sheetRows<Y)continue;N={},W=!1,F.ht&&(W=!0,N.hpt=parseFloat(F.ht),N.hpx=Yl(N.hpt)),F.hidden=="1"&&(W=!0,N.hidden=!0),F.outlineLevel!=null&&(W=!0,N.level=+F.outlineLevel),W&&(j[Y-1]=N)}break;case"<":ye=S;break}if(ye>=S)break;if(F=nt(C.slice(ye,S),!0),Y=F.r!=null?parseInt(F.r,10):Y+1,L=-1,!(g.sheetRows&&g.sheetRows<Y)){y.s.r>Y-1&&(y.s.r=Y-1),y.e.r<Y-1&&(y.e.r=Y-1),g&&g.cellStyles&&(N={},W=!1,F.ht&&(W=!0,N.hpt=parseFloat(F.ht),N.hpx=Yl(N.hpt)),F.hidden=="1"&&(W=!0,N.hidden=!0),F.outlineLevel!=null&&(W=!0,N.level=+F.outlineLevel),W&&(j[Y-1]=N)),w=C.slice(S).split(e);for(var Ae=0;Ae!=w.length&&w[Ae].trim().charAt(0)=="<";++Ae);for(w=w.slice(Ae),S=0;S!=w.length;++S)if(C=w[S].trim(),C.length!==0){if(M=C.match(n),k=S,b=0,U=0,C="<c "+(C.slice(0,1)=="<"?">":"")+C,M!=null&&M.length===2){for(k=0,B=M[1],b=0;b!=B.length&&!((U=B.charCodeAt(b)-64)<1||U>26);++b)k=26*k+U;--k,L=k}else++L;for(b=0;b!=C.length&&C.charCodeAt(b)!==62;++b);if(++b,F=nt(C.slice(0,b),!0),F.r||(F.r=st({r:Y-1,c:L})),B=C.slice(b),X={t:""},(M=B.match(o))!=null&&M[1]!==""&&(X.v=At(M[1])),g.cellFormula){if((M=B.match(c))!=null&&M[1]!==""){if(X.f=At(qt(M[1])).replace(/\r\n/g,`
`),g.xlfn||(X.f=yy(X.f)),M[0].indexOf('t="array"')>-1)X.F=(B.match(a)||[])[1],X.F.indexOf(":")>-1&&re.push([rn(X.F),X.F]);else if(M[0].indexOf('t="shared"')>-1){te=nt(M[0]);var Me=At(qt(M[1]));g.xlfn||(Me=yy(Me)),ce[parseInt(te.si,10)]=[te,Me,F.r]}}else(M=B.match(/<f[^>]*\/>/))&&(te=nt(M[0]),ce[te.si]&&(X.f=rL(ce[te.si][1],ce[te.si][2],F.r)));var Ee=Wn(F.r);for(b=0;b<re.length;++b)Ee.r>=re[b][0].s.r&&Ee.r<=re[b][0].e.r&&Ee.c>=re[b][0].s.c&&Ee.c<=re[b][0].e.c&&(X.F=re[b][1])}if(F.t==null&&X.v===void 0)if(X.f||X.F)X.v=0,X.t="n";else if(D)X.t="z";else continue;else X.t=F.t||"n";switch(y.s.c>L&&(y.s.c=L),y.e.c<L&&(y.e.c=L),X.t){case"n":if(X.v==""||X.v==null){if(!D)continue;X.t="z"}else X.v=parseFloat(X.v);break;case"s":if(typeof X.v>"u"){if(!D)continue;X.t="z"}else Q=Il[parseInt(X.v,10)],X.v=Q.t,X.r=Q.r,g.cellHTML&&(X.h=Q.h);break;case"str":X.t="s",X.v=X.v!=null?qt(X.v):"",g.cellHTML&&(X.h=Dh(X.v));break;case"inlineStr":M=B.match(r),X.t="s",M!=null&&(Q=Hh(M[1]))?(X.v=Q.t,g.cellHTML&&(X.h=Q.h)):X.v="";break;case"b":X.v=Jt(X.v);break;case"d":g.cellDates?X.v=wn(X.v,1):(X.v=Qn(wn(X.v,1)),X.t="n");break;case"e":(!g||g.cellText!==!1)&&(X.w=X.v),X.v=_2[X.v];break}if(ee=_e=0,Te=null,De&&F.s!==void 0&&(Te=E.CellXf[F.s],Te!=null&&(Te.numFmtId!=null&&(ee=Te.numFmtId),g.cellStyles&&Te.fillId!=null&&(_e=Te.fillId))),Q2(X,ee,_e,g,_,E),g.cellDates&&De&&X.t=="n"&&To(ot[ee])&&(X.t="d",X.v=tf(X.v)),F.cm&&g.xlmeta){var Ze=(g.xlmeta.Cell||[])[+F.cm-1];Ze&&Ze.type=="XLDAPR"&&(X.D=!0)}if(ne){var K=Wn(F.r);h[K.r]||(h[K.r]=[]),h[K.r][K.c]=X}else h[F.r]=X}}}}j.length>0&&(h["!rows"]=j)}}();function $O(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(n.level=o&7),o&16&&(n.hidden=!0),o&32&&(n.hpt=a/20),n}var JO=cs;function XO(){}function WO(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=v6(e),n}function KO(e){var t=Vr(e);return[t]}function ZO(e){var t=ls(e);return[t]}function QO(e){var t=Vr(e),n=e.read_shift(1);return[t,n,"b"]}function e7(e){var t=ls(e),n=e.read_shift(1);return[t,n,"b"]}function t7(e){var t=Vr(e),n=e.read_shift(1);return[t,n,"e"]}function n7(e){var t=ls(e),n=e.read_shift(1);return[t,n,"e"]}function r7(e){var t=Vr(e),n=e.read_shift(4);return[t,n,"s"]}function a7(e){var t=ls(e),n=e.read_shift(4);return[t,n,"s"]}function i7(e){var t=Vr(e),n=Vn(e);return[t,n,"n"]}function t_(e){var t=ls(e),n=Vn(e);return[t,n,"n"]}function s7(e){var t=Vr(e),n=Bh(e);return[t,n,"n"]}function o7(e){var t=ls(e),n=Bh(e);return[t,n,"n"]}function l7(e){var t=Vr(e),n=Ph(e);return[t,n,"is"]}function c7(e){var t=Vr(e),n=zn(e);return[t,n,"str"]}function u7(e){var t=ls(e),n=zn(e);return[t,n,"str"]}function f7(e,t,n){var r=e.l+t,a=Vr(e);a.r=n["!row"];var o=e.read_shift(1),c=[a,o,"b"];if(n.cellFormula){e.l+=2;var u=af(e,r-e.l,n);c[3]=Bn(u,null,a,n.supbooks,n)}else e.l=r;return c}function d7(e,t,n){var r=e.l+t,a=Vr(e);a.r=n["!row"];var o=e.read_shift(1),c=[a,o,"e"];if(n.cellFormula){e.l+=2;var u=af(e,r-e.l,n);c[3]=Bn(u,null,a,n.supbooks,n)}else e.l=r;return c}function h7(e,t,n){var r=e.l+t,a=Vr(e);a.r=n["!row"];var o=Vn(e),c=[a,o,"n"];if(n.cellFormula){e.l+=2;var u=af(e,r-e.l,n);c[3]=Bn(u,null,a,n.supbooks,n)}else e.l=r;return c}function m7(e,t,n){var r=e.l+t,a=Vr(e);a.r=n["!row"];var o=zn(e),c=[a,o,"str"];if(n.cellFormula){e.l+=2;var u=af(e,r-e.l,n);c[3]=Bn(u,null,a,n.supbooks,n)}else e.l=r;return c}var p7=cs;function g7(e,t){var n=e.l+t,r=cs(e),a=Uh(e),o=zn(e),c=zn(e),u=zn(e);e.l=n;var p={rfx:r,relId:a,loc:o,display:u};return c&&(p.Tooltip=c),p}function x7(){}function v7(e,t,n){var r=e.l+t,a=v2(e),o=e.read_shift(1),c=[a];if(c[2]=o,n.cellFormula){var u=SO(e,r-e.l,n);c[1]=u}else e.l=r;return c}function y7(e,t,n){var r=e.l+t,a=cs(e),o=[a];if(n.cellFormula){var c=wO(e,r-e.l,n);o[1]=c,e.l=r}else e.l=r;return o}var T7=["left","right","top","bottom","header","footer"];function _7(e){var t={};return T7.forEach(function(n){t[n]=Vn(e)}),t}function E7(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function S7(){}function C7(){}function w7(e,t,n,r,a,o,c){if(!e)return e;var u=t||{};r||(r={"!id":{}});var p=u.dense?[]:{},h,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,_=!1,E,S,C,w,M,k,b,U,B,X=[];u.biff=12,u["!row"]=0;var F=0,Y=!1,L=[],Q={},te=u.supbooks||a.supbooks||[[]];if(te.sharedf=Q,te.arrayf=L,te.SheetNames=a.SheetNames||a.Sheets.map(function(ne){return ne.name}),!u.supbooks&&(u.supbooks=te,a.Names))for(var ee=0;ee<a.Names.length;++ee)te[0][ee+1]=a.Names[ee];var _e=[],De=[],Te=!1;Yu[16]={n:"BrtShortReal",f:t_};var re;if(Va(e,function(j,N,W){if(!_)switch(W){case 148:h=j;break;case 0:E=j,u.sheetRows&&u.sheetRows<=E.r&&(_=!0),U=Fn(w=E.r),u["!row"]=E.r,(j.hidden||j.hpt||j.level!=null)&&(j.hpt&&(j.hpx=Yl(j.hpt)),De[j.r]=j);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:j[2]},j[2]){case"n":S.v=j[1];break;case"s":b=Il[j[1]],S.v=b.t,S.r=b.r;break;case"b":S.v=!!j[1];break;case"e":S.v=j[1],u.cellText!==!1&&(S.w=us[S.v]);break;case"str":S.t="s",S.v=j[1];break;case"is":S.t="s",S.v=j[1].t;break}if((C=c.CellXf[j[0].iStyleRef])&&Q2(S,C.numFmtId,null,u,o,c),M=j[0].c==-1?M+1:j[0].c,u.dense?(p[w]||(p[w]=[]),p[w][M]=S):p[yn(M)+U]=S,u.cellFormula){for(Y=!1,F=0;F<L.length;++F){var D=L[F];E.r>=D[0].s.r&&E.r<=D[0].e.r&&M>=D[0].s.c&&M<=D[0].e.c&&(S.F=wt(D[0]),Y=!0)}!Y&&j.length>3&&(S.f=j[3])}if(g.s.r>E.r&&(g.s.r=E.r),g.s.c>M&&(g.s.c=M),g.e.r<E.r&&(g.e.r=E.r),g.e.c<M&&(g.e.c=M),u.cellDates&&C&&S.t=="n"&&To(ot[C.numFmtId])){var J=$i(S.v);J&&(S.t="d",S.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}re&&(re.type=="XLDAPR"&&(S.D=!0),re=void 0);break;case 1:case 12:if(!u.sheetStubs||y)break;S={t:"z",v:void 0},M=j[0].c==-1?M+1:j[0].c,u.dense?(p[w]||(p[w]=[]),p[w][M]=S):p[yn(M)+U]=S,g.s.r>E.r&&(g.s.r=E.r),g.s.c>M&&(g.s.c=M),g.e.r<E.r&&(g.e.r=E.r),g.e.c<M&&(g.e.c=M),re&&(re.type=="XLDAPR"&&(S.D=!0),re=void 0);break;case 176:X.push(j);break;case 49:re=((u.xlmeta||{}).Cell||[])[j-1];break;case 494:var q=r["!id"][j.relId];for(q?(j.Target=q.Target,j.loc&&(j.Target+="#"+j.loc),j.Rel=q):j.relId==""&&(j.Target="#"+j.loc),w=j.rfx.s.r;w<=j.rfx.e.r;++w)for(M=j.rfx.s.c;M<=j.rfx.e.c;++M)u.dense?(p[w]||(p[w]=[]),p[w][M]||(p[w][M]={t:"z",v:void 0}),p[w][M].l=j):(k=st({c:M,r:w}),p[k]||(p[k]={t:"z",v:void 0}),p[k].l=j);break;case 426:if(!u.cellFormula)break;L.push(j),B=u.dense?p[w][M]:p[yn(M)+U],B.f=Bn(j[1],g,{r:E.r,c:M},te,u),B.F=wt(j[0]);break;case 427:if(!u.cellFormula)break;Q[st(j[0].s)]=j[1],B=u.dense?p[w][M]:p[yn(M)+U],B.f=Bn(j[1],g,{r:E.r,c:M},te,u);break;case 60:if(!u.cellStyles)break;for(;j.e>=j.s;)_e[j.e--]={width:j.w/256,hidden:!!(j.flags&1),level:j.level},Te||(Te=!0,zh(j.w/256)),po(_e[j.e+1]);break;case 161:p["!autofilter"]={ref:wt(j)};break;case 476:p["!margins"]=j;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),j.name&&(a.Sheets[n].CodeName=j.name),(j.above||j.left)&&(p["!outline"]={above:j.above,left:j.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),j.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!N.T){if(!y||u.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},u),delete u.supbooks,delete u["!row"],!p["!ref"]&&(g.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(p["!ref"]=wt(h||g)),u.sheetRows&&p["!ref"]){var ce=rn(p["!ref"]);u.sheetRows<=+ce.e.r&&(ce.e.r=u.sheetRows-1,ce.e.r>g.e.r&&(ce.e.r=g.e.r),ce.e.r<ce.s.r&&(ce.s.r=ce.e.r),ce.e.c>g.e.c&&(ce.e.c=g.e.c),ce.e.c<ce.s.c&&(ce.s.c=ce.e.c),p["!fullref"]=p["!ref"],p["!ref"]=wt(ce))}return X.length>0&&(p["!merges"]=X),_e.length>0&&(p["!cols"]=_e),De.length>0&&(p["!rows"]=De),p}function A7(e){var t=[],n=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var c=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=n?+c[2]:c[2])});var a=At((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[t,a,r]}function b7(e,t,n,r,a,o){var c=o||{"!type":"chart"};if(!e)return o;var u=0,p=0,h="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var _=A7(y);g.s.r=g.s.c=0,g.e.c=u,h=yn(u),_[0].forEach(function(E,S){c[h+Fn(S)]={t:"n",v:E,z:_[1]},p=S}),g.e.r<p&&(g.e.r=p),++u}),u>0&&(c["!ref"]=wt(g)),c}function k7(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(e_);return u&&qh(u[0],o,a,n),(c=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=c[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function N7(e,t){e.l+=10;var n=zn(e);return{name:n}}function M7(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Va(e,function(p,h,g){switch(g){case 550:o["!rel"]=p;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),p.name&&(a.Sheets[n].CodeName=p.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},t),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var n_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],R7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],D7=[],I7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Cy(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],a=0;a!=t.length;++a){var o=t[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=Jt(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function wy(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=Jt(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function r_(e){wy(e.WBProps,n_),wy(e.CalcPr,I7),Cy(e.WBView,R7),Cy(e.Sheets,D7),io.date1904=Jt(e.WBProps.date1904)}var F7="][*?/\\".split("");function L7(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return F7.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}var O7=/<\w+:workbook/;function P7(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},c=0;if(e.replace(qn,function(p,h){var g=nt(p);switch(ha(g[0])){case"<?xml":break;case"<workbook":p.match(O7)&&(a="xmlns"+p.match(/<(\w+):/)[1]),n.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],n.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":n_.forEach(function(y){if(g[y[0]]!=null)switch(y[2]){case"bool":n.WBProps[y[0]]=Jt(g[y[0]]);break;case"int":n.WBProps[y[0]]=parseInt(g[y[0]],10);break;default:n.WBProps[y[0]]=g[y[0]]}}),g.codeName&&(n.WBProps.CodeName=qt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],n.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=At(qt(g.name)),delete g[0],n.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=qt(g.name),g.comment&&(o.Comment=g.comment),g.localSheetId&&(o.Sheet=+g.localSheetId),Jt(g.hidden||"0")&&(o.Hidden=!0),c=h+p.length;break;case"</definedName>":o.Ref=At(qt(e.slice(c,h))),n.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete g[0],n.CalcPr=g;break;case"<calcPr/>":delete g[0],n.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return p}),t6.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return r_(n),n}function U7(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=Qd(e),n.name=zn(e),n}function B7(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?zn(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function V7(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function G7(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),o=y6(e),c=CO(e,0,n),u=Uh(e);e.l=r;var p={Name:o,Ptg:c};return a<268435455&&(p.Sheet=a),u&&(p.Comment=u),p}function H7(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var o=[],c=[[]];return c.SheetNames=[],c.XTI=[],Yu[16]={n:"BrtFRTArchID$",f:V7},Va(e,function(p,h,g){switch(g){case 156:c.SheetNames.push(p.name),n.Sheets.push(p);break;case 153:n.WBProps=p;break;case 39:p.Sheet!=null&&(t.SID=p.Sheet),p.Ref=Bn(p.Ptg,null,null,c,t),delete t.SID,delete p.Ptg,o.push(p);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([g,p]):c[0]=[g,p],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(p),c.XTI=c.XTI.concat(p);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(g),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(g),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},t),r_(n),n.Names=o,n.supbooks=c,n}function z7(e,t,n){return t.slice(-4)===".bin"?H7(e,n):P7(e,n)}function j7(e,t,n,r,a,o,c,u){return t.slice(-4)===".bin"?w7(e,r,n,a,o,c,u):UO(e,r,n,a,o,c,u)}function q7(e,t,n,r,a,o,c,u){return t.slice(-4)===".bin"?M7(e,r,n,a,o):k7(e,r,n,a,o)}function Y7(e,t,n,r,a,o,c,u){return t.slice(-4)===".bin"?eL():tL()}function $7(e,t,n,r,a,o,c,u){return t.slice(-4)===".bin"?Z8():Q8()}function J7(e,t,n,r){return t.slice(-4)===".bin"?p8(e,n,r):c8(e,n,r)}function X7(e,t,n){return z2(e,n)}function W7(e,t,n){return t.slice(-4)===".bin"?RF(e,n):NF(e,n)}function K7(e,t,n){return t.slice(-4)===".bin"?X8(e,n):j8(e,n)}function Z7(e,t,n){return t.slice(-4)===".bin"?G8(e):B8(e)}function Q7(e,t,n,r){return n.slice(-4)===".bin"?H8(e,t,n,r):void 0}function eP(e,t,n){return t.slice(-4)===".bin"?P8(e,t,n):U8(e,t,n)}var a_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,i_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Yr(e,t){var n=e.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=e.match(a_),o,c,u,p;if(a)for(p=0;p!=a.length;++p)o=a[p].match(i_),(c=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(c+1),r[u]=o[2].slice(1,o[2].length-1));return r}function tP(e){var t=e.split(/\s+/),n={};if(t.length===1)return n;var r=e.match(a_),a,o,c,u;if(r)for(u=0;u!=r.length;++u)a=r[u].match(i_),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(o+1),n[c]=a[2].slice(1,a[2].length-1));return n}var Ll;function nP(e,t){var n=Ll[e]||At(e);return n==="General"?ns(t):Or(n,t)}function rP(e,t,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Jt(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=wn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[At(t)]=a}function aP(e,t,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||us[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gl(e.v):e.w=ns(e.v):e.w=nP(t||"General",e.v)}catch(o){if(n.WTF)throw o}try{var r=Ll[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&e.t=="n"&&To(r)){var a=$i(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(n.WTF)throw o}}}function iP(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=r8[r.Pattern]||r.Pattern)}e[t.ID]=t}function sP(e,t,n,r,a,o,c,u,p,h){var g="General",y=r.StyleID,_={};h=h||{};var E=[],S=0;for(y===void 0&&u&&(y=u.StyleID),y===void 0&&c&&(y=c.StyleID);o[y]!==void 0&&(o[y].nf&&(g=o[y].nf),o[y].Interior&&E.push(o[y].Interior),!!o[y].Parent);)y=o[y].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Jt(e);break;case"String":r.t="s",r.r=$v(At(e)),r.v=e.indexOf("<")>-1?At(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(wn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=At(e):r.v<60&&(r.v=r.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=_2[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=$v(t||e));break}if(aP(r,g,h),h.cellFormula!==!1)if(r.Formula){var C=At(r.Formula);C.charCodeAt(0)==61&&(C=C.slice(1)),r.f=ao(C,a),delete r.Formula,r.ArrayRange=="RC"?r.F=ao("RC:RC",a):r.ArrayRange&&(r.F=ao(r.ArrayRange,a),p.push([rn(r.F),r.F]))}else for(S=0;S<p.length;++S)a.r>=p[S][0].s.r&&a.r<=p[S][0].e.r&&a.c>=p[S][0].s.c&&a.c<=p[S][0].e.c&&(r.F=p[S][1]);h.cellStyles&&(E.forEach(function(w){!_.patternType&&w.patternType&&(_.patternType=w.patternType)}),r.s=_),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function oP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function wd(e,t){var n=t||{};$T();var r=_l(Ih(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=qt(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var c=In(n);return c.type="string",jl.to_workbook(r,c)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(He){a.indexOf("<"+He)>=0&&(o=!0)}),o)return gP(r,n);Ll={"General Number":"General","General Date":ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ot[15],"Short Date":ot[14],"Long Time":ot[19],"Medium Time":ot[18],"Short Time":ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ot[2],Standard:ot[4],Percent:ot[10],Scientific:ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,p=[],h,g={},y=[],_=n.dense?[]:{},E="",S={},C={},w=Yr('<Data ss:Type="String">'),M=0,k=0,b=0,U={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},X={},F="",Y=0,L=[],Q={},te={},ee=0,_e=[],De=[],Te={},re=[],ce,ne=!1,j=[],N=[],W={},D=0,J=0,q={Sheets:[],WBProps:{date1904:!1}},G={};zl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";u=zl.exec(r);)switch(u[3]=(ie=u[3]).toLowerCase()){case"data":if(ie=="data"){if(u[1]==="/"){if((h=p.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&p.push([u[3],!0]);break}if(p[p.length-1][1])break;u[1]==="/"?sP(r.slice(M,u.index),F,w,p[p.length-1][0]=="comment"?Te:S,{c:k,r:b},B,re[k],C,j,n):(F="",w=Yr(u[0]),M=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(De.length>0&&(S.c=De),(!n.sheetRows||n.sheetRows>b)&&S.v!==void 0&&(n.dense?(_[b]||(_[b]=[]),_[b][k]=S):_[yn(k)+Fn(b)]=S),S.HRef&&(S.l={Target:At(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(D=k+(parseInt(S.MergeAcross,10)|0),J=b+(parseInt(S.MergeDown,10)|0),L.push({s:{c:k,r:b},e:{c:D,r:J}})),!n.sheetStubs)S.MergeAcross?k=D+1:++k;else if(S.MergeAcross||S.MergeDown){for(var ye=k;ye<=D;++ye)for(var Ae=b;Ae<=J;++Ae)(ye>k||Ae>b)&&(n.dense?(_[Ae]||(_[Ae]=[]),_[Ae][ye]={t:"z"}):_[yn(ye)+Fn(Ae)]={t:"z"});k=D+1}else++k;else S=tP(u[0]),S.Index&&(k=+S.Index-1),k<U.s.c&&(U.s.c=k),k>U.e.c&&(U.e.c=k),u[0].slice(-2)==="/>"&&++k,De=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(b<U.s.r&&(U.s.r=b),b>U.e.r&&(U.e.r=b),u[0].slice(-2)==="/>"&&(C=Yr(u[0]),C.Index&&(b=+C.Index-1)),k=0,++b):(C=Yr(u[0]),C.Index&&(b=+C.Index-1),W={},(C.AutoFitHeight=="0"||C.Height)&&(W.hpx=parseInt(C.Height,10),W.hpt=H2(W.hpx),N[b]=W),C.Hidden=="1"&&(W.hidden=!0,N[b]=W));break;case"worksheet":if(u[1]==="/"){if((h=p.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));y.push(E),U.s.r<=U.e.r&&U.s.c<=U.e.c&&(_["!ref"]=wt(U),n.sheetRows&&n.sheetRows<=U.e.r&&(_["!fullref"]=_["!ref"],U.e.r=n.sheetRows-1,_["!ref"]=wt(U))),L.length&&(_["!merges"]=L),re.length>0&&(_["!cols"]=re),N.length>0&&(_["!rows"]=N),g[E]=_}else U={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=k=0,p.push([u[3],!1]),h=Yr(u[0]),E=At(h.Name),_=n.dense?[]:{},L=[],j=[],N=[],G={name:E,Hidden:0},q.Sheets.push(G);break;case"table":if(u[1]==="/"){if((h=p.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;p.push([u[3],!1]),re=[],ne=!1}break;case"style":u[1]==="/"?iP(B,X,n):X=Yr(u[0]);break;case"numberformat":X.nf=At(Yr(u[0]).Format||"General"),Ll[X.nf]&&(X.nf=Ll[X.nf]);for(var Me=0;Me!=392&&ot[Me]!=X.nf;++Me);if(Me==392){for(Me=57;Me!=392;++Me)if(ot[Me]==null){Ji(X.nf,Me);break}}break;case"column":if(p[p.length-1][0]!=="table")break;if(ce=Yr(u[0]),ce.Hidden&&(ce.hidden=!0,delete ce.Hidden),ce.Width&&(ce.wpx=parseInt(ce.Width,10)),!ne&&ce.wpx>10){ne=!0,Xn=V2;for(var Ee=0;Ee<re.length;++Ee)re[Ee]&&po(re[Ee])}ne&&po(ce),re[ce.Index-1||re.length]=ce;for(var Ze=0;Ze<+ce.Span;++Ze)re[re.length]=In(ce);break;case"namedrange":if(u[1]==="/")break;q.Names||(q.Names=[]);var K=nt(u[0]),ut={Name:K.Name,Ref:ao(K.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(ut.Sheet=q.Sheets.length-1),q.Names.push(ut);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?F+=r.slice(Y,u.index):Y=u.index+u[0].length;break;case"interior":if(!n.cellStyles)break;X.Interior=Yr(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?j6(Q,ie,r.slice(ee,u.index)):ee=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=p.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else p.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=p.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));oP(Te),De.push(Te)}else p.push([u[3],!1]),h=Yr(u[0]),Te={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=p.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var We=Yr(u[0]);_["!autofilter"]={ref:ao(We.Range).replace(/\$/g,"")},p.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=p.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&p.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=p.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&p.push([u[3],!0]);break;case"null":break;default:if(p.length==0&&u[3]=="document"||p.length==0&&u[3]=="uof")return Ry(r,n);var ht=!0;switch(p[p.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ht=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ht=!1}break;case"excelworkbook":switch(u[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ht=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:ht=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(r.slice(ee,u.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else ee=u.index+u[0].length;break;case"header":_["!margins"]||Fl(_["!margins"]={},"xlml"),isNaN(+nt(u[0]).Margin)||(_["!margins"].header=+nt(u[0]).Margin);break;case"footer":_["!margins"]||Fl(_["!margins"]={},"xlml"),isNaN(+nt(u[0]).Margin)||(_["!margins"].footer=+nt(u[0]).Margin);break;case"pagemargins":var Ne=nt(u[0]);_["!margins"]||Fl(_["!margins"]={},"xlml"),isNaN(+Ne.Top)||(_["!margins"].top=+Ne.Top),isNaN(+Ne.Left)||(_["!margins"].left=+Ne.Left),isNaN(+Ne.Right)||(_["!margins"].right=+Ne.Right),isNaN(+Ne.Bottom)||(_["!margins"].bottom=+Ne.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ht=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ht=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ht=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ht=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ht=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ht=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ht=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ht=!1}break;case"smarttags":break;default:ht=!1;break}if(ht||u[3].match(/!\[CDATA/))break;if(!p[p.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+p.join("|");if(p[p.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?rP(te,ie,_e,r.slice(ee,u.index)):(_e=u,ee=u.index+u[0].length);break}if(n.WTF)throw"Unrecognized tag: "+u[3]+"|"+p.join("|")}var xe={};return!n.bookSheets&&!n.bookProps&&(xe.Sheets=g),xe.SheetNames=y,xe.Workbook=q,xe.SSF=In(ot),xe.Props=Q,xe.Custprops=te,xe}function rh(e,t){switch(Jh(t=t||{}),t.type||"base64"){case"base64":return wd(vr(e),t);case"binary":case"buffer":case"file":return wd(e,t);case"array":return wd(os(e),t)}}function lP(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=E6(n),n.length-n.l<=4)return t;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=S6(n),r=n.read_shift(4),r==0||r>40))return t;n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr")}var cP=[60,1084,2066,2165,2175];function uP(e,t,n,r,a){var o=r,c=[],u=n.slice(n.l,n.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}c.push(u),n.l+=o;for(var p=Da(n,n.l),h=ah[p],g=0;h!=null&&cP.indexOf(p)>-1;)o=Da(n,n.l+2),g=n.l+4,p==2066?g+=4:(p==2165||p==2175)&&(g+=12),u=n.slice(g,n.l+4+o),c.push(u),n.l+=4+o,h=ah[p=Da(n,n.l)];var y=di(c);Dn(y,0);var _=0;y.lens=[];for(var E=0;E<c.length;++E)y.lens.push(_),_+=c[E].length;if(y.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+y.length+" < "+r;return t.f(y,y.length,a)}function sa(e,t,n){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ot[r])}catch(o){if(t.WTF)throw o}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||us[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gl(e.v):e.w=ns(e.v):e.w=Or(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&r&&e.t=="n"&&To(ot[r]||String(r))){var a=$i(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function _u(e,t,n){return{v:e,ixfe:t,t:n}}function fP(e,t){var n={opts:{}},r={},a=t.dense?[]:{},o={},c={},u=null,p=[],h="",g={},y,_="",E,S,C,w,M={},k=[],b,U,B=[],X=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Y={},L=function(Ce){return Ce<8?Xi[Ce]:Ce<64&&X[Ce-8]||Xi[Ce]},Q=function(Ce,Be,et){var Oe=Be.XF.data;if(!(!Oe||!Oe.patternType||!et||!et.cellStyles)){Be.s={},Be.s.patternType=Oe.patternType;var mt;(mt=ql(L(Oe.icvFore)))&&(Be.s.fgColor={rgb:mt}),(mt=ql(L(Oe.icvBack)))&&(Be.s.bgColor={rgb:mt})}},te=function(Ce,Be,et){if(!(W>1)&&!(et.sheetRows&&Ce.r>=et.sheetRows)){if(et.cellStyles&&Be.XF&&Be.XF.data&&Q(Ce,Be,et),delete Be.ixfe,delete Be.XF,y=Ce,_=st(Ce),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),Ce.r<c.s.r&&(c.s.r=Ce.r),Ce.c<c.s.c&&(c.s.c=Ce.c),Ce.r+1>c.e.r&&(c.e.r=Ce.r+1),Ce.c+1>c.e.c&&(c.e.c=Ce.c+1),et.cellFormula&&Be.f){for(var Oe=0;Oe<k.length;++Oe)if(!(k[Oe][0].s.c>Ce.c||k[Oe][0].s.r>Ce.r)&&!(k[Oe][0].e.c<Ce.c||k[Oe][0].e.r<Ce.r)){Be.F=wt(k[Oe][0]),(k[Oe][0].s.c!=Ce.c||k[Oe][0].s.r!=Ce.r)&&delete Be.f,Be.f&&(Be.f=""+Bn(k[Oe][1],c,Ce,j,ee));break}}et.dense?(a[Ce.r]||(a[Ce.r]=[]),a[Ce.r][Ce.c]=Be):a[_]=Be}},ee={enc:!1,sbcch:0,snames:[],sharedf:M,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(ee.password=t.password);var _e,De=[],Te=[],re=[],ce=[],ne=!1,j=[];j.SheetNames=ee.snames,j.sharedf=ee.sharedf,j.arrayf=ee.arrayf,j.names=[],j.XTI=[];var N=0,W=0,D=0,J=[],q=[],G;ee.codepage=1200,Xr(1200);for(var ie=!1;e.l<e.length-1;){var ye=e.l,Ae=e.read_shift(2);if(Ae===0&&N===10)break;var Me=e.l===e.length?0:e.read_shift(2),Ee=ah[Ae];if(Ee&&Ee.f){if(t.bookSheets&&N===133&&Ae!==133)break;if(N=Ae,Ee.r===2||Ee.r==12){var Ze=e.read_shift(2);if(Me-=2,!ee.enc&&Ze!==Ae&&((Ze&255)<<8|Ze>>8)!==Ae)throw new Error("rt mismatch: "+Ze+"!="+Ae);Ee.r==12&&(e.l+=10,Me-=10)}var K={};if(Ae===10?K=Ee.f(e,Me,ee):K=uP(Ae,Ee,e,Me,ee),W==0&&[9,521,1033,2057].indexOf(N)===-1)continue;switch(Ae){case 34:n.opts.Date1904=F.WBProps.date1904=K;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(ee.enc||(e.l=0),ee.enc=K,!t.password)throw new Error("File is password-protected");if(K.valid==null)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=K;break;case 66:var ut=Number(K);switch(ut){case 21010:ut=1200;break;case 32768:ut=1e4;break;case 32769:ut=1252;break}Xr(ee.codepage=ut),ie=!0;break;case 317:ee.rrtabid=K;break;case 25:ee.winlocked=K;break;case 439:n.opts.RefreshAll=K;break;case 12:n.opts.CalcCount=K;break;case 16:n.opts.CalcDelta=K;break;case 17:n.opts.CalcIter=K;break;case 13:n.opts.CalcMode=K;break;case 14:n.opts.CalcPrecision=K;break;case 95:n.opts.CalcSaveRecalc=K;break;case 15:ee.CalcRefMode=K;break;case 2211:n.opts.FullCalc=K;break;case 129:K.fDialog&&(a["!type"]="dialog"),K.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),K.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:B.push(K);break;case 430:j.push([K]),j[j.length-1].XTI=[];break;case 35:case 547:j[j.length-1].push(K);break;case 24:case 536:G={Name:K.Name,Ref:Bn(K.rgce,c,null,j,ee)},K.itab>0&&(G.Sheet=K.itab-1),j.names.push(G),j[0]||(j[0]=[],j[0].XTI=[]),j[j.length-1].push(K),K.Name=="_xlnm._FilterDatabase"&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&K.rgce[0][0][0]=="PtgArea3d"&&(q[K.itab-1]={ref:wt(K.rgce[0][0][1][2])});break;case 22:ee.ExternCount=K;break;case 23:j.length==0&&(j[0]=[],j[0].XTI=[]),j[j.length-1].XTI=j[j.length-1].XTI.concat(K),j.XTI=j.XTI.concat(K);break;case 2196:if(ee.biff<8)break;G!=null&&(G.Comment=K[1]);break;case 18:a["!protect"]=K;break;case 19:K!==0&&ee.WTF&&console.error("Password verifier: "+K);break;case 133:o[K.pos]=K,ee.snames.push(K.name);break;case 10:{if(--W)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,a["!ref"]=wt(c),t.sheetRows&&t.sheetRows<=c.e.r){var We=c.e.r;c.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=wt(c),c.e.r=We}c.e.r++,c.e.c++}De.length>0&&(a["!merges"]=De),Te.length>0&&(a["!objects"]=Te),re.length>0&&(a["!cols"]=re),ce.length>0&&(a["!rows"]=ce),F.Sheets.push(Y)}h===""?g=a:r[h]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[Ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),ee.biffguess=K.BIFFVer==0,K.BIFFVer==0&&K.dt==4096&&(ee.biff=5,ie=!0,Xr(ee.codepage=28591)),ee.biff==8&&K.BIFFVer==0&&K.dt==16&&(ee.biff=2),W++)break;if(a=t.dense?[]:{},ee.biff<8&&!ie&&(ie=!0,Xr(ee.codepage=t.codepage||1252)),ee.biff<5||K.BIFFVer==0&&K.dt==4096){h===""&&(h="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var ht={pos:e.l-Me,name:h};o[ht.pos]=ht,ee.snames.push(h)}else h=(o[ye]||{name:""}).name;K.dt==32&&(a["!type"]="chart"),K.dt==64&&(a["!type"]="macro"),De=[],Te=[],ee.arrayf=k=[],re=[],ce=[],ne=!1,Y={Hidden:(o[ye]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[K.r]||[])[K.c]:a[st({c:K.c,r:K.r})])&&++K.c,b={ixfe:K.ixfe,XF:B[K.ixfe]||{},v:K.val,t:"n"},D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te({c:K.c,r:K.r},b,t);break;case 5:case 517:b={ixfe:K.ixfe,XF:B[K.ixfe],v:K.val,t:K.t},D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te({c:K.c,r:K.r},b,t);break;case 638:b={ixfe:K.ixfe,XF:B[K.ixfe],v:K.rknum,t:"n"},D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te({c:K.c,r:K.r},b,t);break;case 189:for(var Ne=K.c;Ne<=K.C;++Ne){var xe=K.rkrec[Ne-K.c][0];b={ixfe:xe,XF:B[xe],v:K.rkrec[Ne-K.c][1],t:"n"},D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te({c:Ne,r:K.r},b,t)}break;case 6:case 518:case 1030:{if(K.val=="String"){u=K;break}if(b=_u(K.val,K.cell.ixfe,K.tt),b.XF=B[b.ixfe],t.cellFormula){var He=K.formula;if(He&&He[0]&&He[0][0]&&He[0][0][0]=="PtgExp"){var je=He[0][0][1][0],Mt=He[0][0][1][1],_t=st({r:je,c:Mt});M[_t]?b.f=""+Bn(K.formula,c,K.cell,j,ee):b.F=((t.dense?(a[je]||[])[Mt]:a[_t])||{}).F}else b.f=""+Bn(K.formula,c,K.cell,j,ee)}D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te(K.cell,b,t),u=K}break;case 7:case 519:if(u)u.val=K,b=_u(K,u.cell.ixfe,"s"),b.XF=B[b.ixfe],t.cellFormula&&(b.f=""+Bn(u.formula,c,u.cell,j,ee)),D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te(u.cell,b,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(K);var Xt=st(K[0].s);if(E=t.dense?(a[K[0].s.r]||[])[K[0].s.c]:a[Xt],t.cellFormula&&E){if(!u||!Xt||!E)break;E.f=""+Bn(K[1],c,K[0],j,ee),E.F=wt(K[0])}}break;case 1212:{if(!t.cellFormula)break;if(_){if(!u)break;M[st(u.cell)]=K[0],E=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[st(u.cell)],(E||{}).f=""+Bn(K[0],c,y,j,ee)}}break;case 253:b=_u(p[K.isst].t,K.ixfe,"s"),p[K.isst].h&&(b.h=p[K.isst].h),b.XF=B[b.ixfe],D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te({c:K.c,r:K.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:K.ixfe,XF:B[K.ixfe],t:"z"},D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te({c:K.c,r:K.r},b,t));break;case 190:if(t.sheetStubs)for(var an=K.c;an<=K.C;++an){var Qt=K.ixfe[an-K.c];b={ixfe:Qt,XF:B[Qt],t:"z"},D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te({c:an,r:K.r},b,t)}break;case 214:case 516:case 4:b=_u(K.val,K.ixfe,"s"),b.XF=B[b.ixfe],D>0&&(b.z=J[b.ixfe>>8&63]),sa(b,t,n.opts.Date1904),te({c:K.c,r:K.r},b,t);break;case 0:case 512:W===1&&(c=K);break;case 252:p=K;break;case 1054:if(ee.biff==4){J[D++]=K[1];for(var An=0;An<D+163&&ot[An]!=K[1];++An);An>=163&&Ji(K[1],D+163)}else Ji(K[1],K[0]);break;case 30:{J[D++]=K;for(var Vt=0;Vt<D+163&&ot[Vt]!=K;++Vt);Vt>=163&&Ji(K,D+163)}break;case 229:De=De.concat(K);break;case 93:Te[K.cmo[0]]=ee.lastobj=K;break;case 438:ee.lastobj.TxO=K;break;case 127:ee.lastobj.ImData=K;break;case 440:for(w=K[0].s.r;w<=K[0].e.r;++w)for(C=K[0].s.c;C<=K[0].e.c;++C)E=t.dense?(a[w]||[])[C]:a[st({c:C,r:w})],E&&(E.l=K[1]);break;case 2048:for(w=K[0].s.r;w<=K[0].e.r;++w)for(C=K[0].s.c;C<=K[0].e.c;++C)E=t.dense?(a[w]||[])[C]:a[st({c:C,r:w})],E&&E.l&&(E.l.Tooltip=K[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;E=t.dense?(a[K[0].r]||[])[K[0].c]:a[st(K[0])];var Gt=Te[K[2]];E||(t.dense?(a[K[0].r]||(a[K[0].r]=[]),E=a[K[0].r][K[0].c]={t:"z"}):E=a[st(K[0])]={t:"z"},c.e.r=Math.max(c.e.r,K[0].r),c.s.r=Math.min(c.s.r,K[0].r),c.e.c=Math.max(c.e.c,K[0].c),c.s.c=Math.min(c.s.c,K[0].c)),E.c||(E.c=[]),S={a:K[1],t:Gt.TxO.t},E.c.push(S)}break;case 2173:I8(B[K.ixfe],K.ext);break;case 125:{if(!ee.cellStyles)break;for(;K.e>=K.s;)re[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(K.flags&1)},ne||(ne=!0,zh(K.w/256)),po(re[K.e+1])}break;case 520:{var be={};K.level!=null&&(ce[K.r]=be,be.level=K.level),K.hidden&&(ce[K.r]=be,be.hidden=!0),K.hpt&&(ce[K.r]=be,be.hpt=K.hpt,be.hpx=Yl(K.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Fl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ae]]=K;break;case 161:a["!margins"]||Fl(a["!margins"]={}),a["!margins"].header=K.header,a["!margins"].footer=K.footer;break;case 574:K.RTL&&(F.Views[0].RTL=!0);break;case 146:X=K;break;case 2198:_e=K;break;case 140:U=K;break;case 442:h?Y.CodeName=K||Y.name:F.WBProps.CodeName=K||"ThisWorkbook";break}}else Ee||console.error("Missing Info for XLS Record 0x"+Ae.toString(16)),e.l+=Me}return n.SheetNames=da(o).sort(function(Ge,Ce){return Number(Ge)-Number(Ce)}).map(function(Ge){return o[Ge].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&g["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=g)):n.Preamble=g,n.Sheets&&q.forEach(function(Ge,Ce){n.Sheets[n.SheetNames[Ce]]["!autofilter"]=Ge}),n.Strings=p,n.SSF=In(ot),ee.enc&&(n.Encryption=ee.enc),_e&&(n.Themes=_e),n.Metadata={},U!==void 0&&(n.Metadata.Country=U),j.names.length>0&&(F.Names=j.names),n.Workbook=F,n}var Ay={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function dP(e,t,n){var r=St.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=cy(r,N6,Ay.DSI);for(var o in a)t[o]=a[o]}catch(h){if(n.WTF)throw h}var c=St.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=cy(c,M6,Ay.SI);for(var p in u)t[p]==null&&(t[p]=u[p])}catch(h){if(n.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(S2(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}function s_(e,t){t||(t={}),Jh(t),LT(),t.codepage&&Ah(t.codepage);var n,r;if(e.FullPaths){if(St.find(e,"/encryption"))throw new Error("File is password-protected");n=St.find(e,"!CompObj"),r=St.find(e,"/Workbook")||St.find(e,"/Book")}else{switch(t.type){case"base64":e=Jr(vr(e));break;case"binary":e=Jr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Dn(e,0),r={content:e}}var a,o;if(n&&lP(n),t.bookProps&&!t.bookSheets)a={};else{var c=yt?"buffer":"array";if(r&&r.content)a=fP(r.content,t);else if((o=St.find(e,"PerfectOffice_MAIN"))&&o.content)a=Dl.to_workbook(o.content,(t.type=c,t));else if((o=St.find(e,"NativeContent_MAIN"))&&o.content)a=Dl.to_workbook(o.content,(t.type=c,t));else throw(o=St.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&St.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=K8(e))}var u={};return e.FullPaths&&dP(e,u,t),a.Props=a.Custprops=u,t.bookFiles&&(a.cfb=e),a}var Yu={0:{f:$O},1:{f:KO},2:{f:s7},3:{f:t7},4:{f:QO},5:{f:i7},6:{f:c7},7:{f:r7},8:{f:m7},9:{f:h7},10:{f:f7},11:{f:d7},12:{f:ZO},13:{f:o7},14:{f:n7},15:{f:e7},16:{f:t_},17:{f:u7},18:{f:a7},19:{f:Ph},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:G7},40:{},42:{},43:{f:f8},44:{f:u8},45:{f:d8},46:{f:m8},47:{f:h8},48:{},49:{f:p6},50:{},51:{f:L8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:L2},62:{f:l7},63:{f:V8},64:{f:S7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:E7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:WO},148:{f:JO,p:16},151:{f:x7},152:{},153:{f:B7},154:{},155:{},156:{f:U7},157:{},158:{},159:{T:1,f:MF},160:{T:-1},161:{T:1,f:cs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:p7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:F8},336:{T:-1},337:{f:O8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:F2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:v7},427:{f:y7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:XO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:g7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:J8},633:{T:1},634:{T:-1},635:{T:1,f:$8},636:{T:-1},637:{f:x6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:N7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:C7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ah={6:{f:Sd},10:{f:ui},12:{f:mn},13:{f:mn},14:{f:ln},15:{f:ln},16:{f:Vn},17:{f:ln},18:{f:ln},19:{f:mn},20:{f:hy},21:{f:hy},23:{f:F2},24:{f:py},25:{f:ln},26:{},27:{},28:{f:qI},29:{},34:{f:ln},35:{f:my},38:{f:Vn},39:{f:Vn},40:{f:Vn},41:{f:Vn},42:{f:ln},43:{f:ln},47:{f:XF},49:{f:AI},51:{f:mn},60:{},61:{f:SI},64:{f:ln},65:{f:wI},66:{f:mn},77:{},80:{},81:{},82:{},85:{f:mn},89:{},90:{},91:{},92:{f:pI},93:{f:$I},94:{},95:{f:ln},96:{},97:{},99:{f:ln},125:{f:L2},128:{f:OI},129:{f:gI},130:{f:mn},131:{f:ln},132:{f:ln},133:{f:xI},134:{},140:{f:QI},141:{f:mn},144:{},146:{f:tF},151:{},152:{},153:{},154:{},155:{},156:{f:mn},157:{},158:{},160:{f:sF},161:{f:rF},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:DI},190:{f:II},193:{f:ui},197:{},198:{},199:{},200:{},201:{},202:{f:ln},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:mn},220:{},221:{f:ln},222:{},224:{f:LI},225:{f:mI},226:{f:ui},227:{},229:{f:YI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:vI},253:{f:bI},255:{f:yI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:k2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ln},353:{f:ui},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:UI},431:{f:ln},432:{},433:{},434:{},437:{},438:{f:WI},439:{f:ln},440:{f:KI},441:{},442:{f:Zl},443:{},444:{f:mn},445:{},446:{},448:{f:ui},449:{f:EI,r:2},450:{f:ui},512:{f:fy},513:{f:iF},515:{f:PI},516:{f:kI},517:{f:dy},519:{f:oF},520:{f:TI},523:{},545:{f:gy},549:{f:uy},566:{},574:{f:CI},638:{f:RI},659:{},1048:{},1054:{f:NI},1084:{},1212:{f:HI},2048:{f:ZI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:vu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ui},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nF,r:12},2173:{f:D8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ln,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:GI,r:12},2197:{},2198:{f:A8,r:12},2199:{},2200:{},2201:{},2202:{f:zI,r:12},2203:{f:ui},2204:{},2205:{},2206:{},2207:{},2211:{f:_I},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:mn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:aF},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:eF},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fy},1:{},2:{f:fF},3:{f:uF},4:{f:cF},5:{f:dy},7:{f:dF},8:{},9:{f:vu},11:{},22:{f:mn},30:{f:MI},31:{},32:{},33:{f:gy},36:{},37:{f:uy},50:{f:hF},62:{},52:{},67:{},68:{f:mn},69:{},86:{},126:{},127:{f:lF},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:mF},223:{},234:{},354:{},421:{},518:{f:Sd},521:{f:vu},536:{f:py},547:{f:my},561:{},579:{},1030:{f:Sd},1033:{f:vu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function $r(e,t,n,r){var a=t;if(!isNaN(a)){var o=(n||[]).length||0,c=e.next(4);c.write_shift(2,a),c.write_shift(2,o),o>0&&p2(n)&&e.push(n)}}function by(e,t){var n=t||{},r=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),c=a.index,u=o&&o.index||e.length,p=PD(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,g=0,y=0,_=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(c=0;c<p.length;++c){var C=p[c].trim(),w=C.slice(0,3).toLowerCase();if(w=="<tr"){if(++h,n.sheetRows&&n.sheetRows<=h){--h;break}g=0;continue}if(!(w!="<td"&&w!="<th")){var M=C.split(/<\/t[dh]>/i);for(u=0;u<M.length;++u){var k=M[u].trim();if(k.match(/<t[dh]/i)){for(var b=k,U=0;b.charAt(0)=="<"&&(U=b.indexOf(">"))>-1;)b=b.slice(U+1);for(var B=0;B<S.length;++B){var X=S[B];X.s.c==g&&X.s.r<h&&h<=X.e.r&&(g=X.e.c+1,B=-1)}var F=nt(k.slice(0,k.indexOf(">")));_=F.colspan?+F.colspan:1,((y=+F.rowspan)>1||_>1)&&S.push({s:{r:h,c:g},e:{r:h+(y||1)-1,c:g+_-1}});var Y=F.t||F["data-t"]||"";if(!b.length){g+=_;continue}if(b=n2(b),E.s.r>h&&(E.s.r=h),E.e.r<h&&(E.e.r=h),E.s.c>g&&(E.s.c=g),E.e.c<g&&(E.e.c=g),!b.length){g+=_;continue}var L={t:"s",v:b};n.raw||!b.trim().length||Y=="s"||(b==="TRUE"?L={t:"b",v:!0}:b==="FALSE"?L={t:"b",v:!1}:isNaN(Kr(b))?isNaN(mo(b).getDate())||(L={t:"d",v:wn(b)},n.cellDates||(L={t:"n",v:Qn(L.v)}),L.z=n.dateNF||ot[14]):L={t:"n",v:Kr(b)}),n.dense?(r[h]||(r[h]=[]),r[h][g]=L):r[st({r:h,c:g})]=L,g+=_}}}}return r["!ref"]=wt(E),S.length&&(r["!merges"]=S),r}function hP(e,t,n,r){for(var a=e["!merges"]||[],o=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,p=0,h=0;h<a.length;++h)if(!(a[h].s.r>n||a[h].s.c>c)&&!(a[h].e.r<n||a[h].e.c<c)){if(a[h].s.r<n||a[h].s.c<c){u=-1;break}u=a[h].e.r-a[h].s.r+1,p=a[h].e.c-a[h].s.c+1;break}if(!(u<0)){var g=st({r:n,c}),y=r.dense?(e[n]||[])[c]:e[g],_=y&&y.v!=null&&(y.h||Dh(y.w||(Pa(y),y.w)||""))||"",E={};u>1&&(E.rowspan=u),p>1&&(E.colspan=p),r.editable?_='<span contenteditable="true">'+_+"</span>":y&&(E["data-t"]=y&&y.t||"z",y.v!=null&&(E["data-v"]=y.v),y.z!=null&&(E["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+y.l.Target+'">'+_+"</a>")),E.id=(r.id||"sjs")+"-"+g,o.push(QD("td",_,E))}}var S="<tr>";return S+o.join("")+"</tr>"}var mP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',pP="</body></html>";function gP(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return Si(by(n[0],t),t);var r=Wh();return n.forEach(function(a,o){Kh(r,by(a,t),"Sheet"+(o+1))}),r}function xP(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function vP(e,t){var n=t||{},r=n.header!=null?n.header:mP,a=n.footer!=null?n.footer:pP,o=[r],c=_o(e["!ref"]);n.dense=Array.isArray(e),o.push(xP(e,c,n));for(var u=c.s.r;u<=c.e.r;++u)o.push(hP(e,c,u,n));return o.push("</table>"+a),o.join("")}function o_(e,t,n){var r=n||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var c=typeof r.origin=="string"?Wn(r.origin):r.origin;a=c.r,o=c.c}var u=t.getElementsByTagName("tr"),p=Math.min(r.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var g=_o(e["!ref"]);h.s.r=Math.min(h.s.r,g.s.r),h.s.c=Math.min(h.s.c,g.s.c),h.e.r=Math.max(h.e.r,g.e.r),h.e.c=Math.max(h.e.c,g.e.c),a==-1&&(h.e.r=a=g.e.r+1)}var y=[],_=0,E=e["!rows"]||(e["!rows"]=[]),S=0,C=0,w=0,M=0,k=0,b=0;for(e["!cols"]||(e["!cols"]=[]);S<u.length&&C<p;++S){var U=u[S];if(ky(U)){if(r.display)continue;E[C]={hidden:!0}}var B=U.children;for(w=M=0;w<B.length;++w){var X=B[w];if(!(r.display&&ky(X))){var F=X.hasAttribute("data-v")?X.getAttribute("data-v"):X.hasAttribute("v")?X.getAttribute("v"):n2(X.innerHTML),Y=X.getAttribute("data-z")||X.getAttribute("z");for(_=0;_<y.length;++_){var L=y[_];L.s.c==M+o&&L.s.r<C+a&&C+a<=L.e.r&&(M=L.e.c+1-o,_=-1)}b=+X.getAttribute("colspan")||1,((k=+X.getAttribute("rowspan")||1)>1||b>1)&&y.push({s:{r:C+a,c:M+o},e:{r:C+a+(k||1)-1,c:M+o+(b||1)-1}});var Q={t:"s",v:F},te=X.getAttribute("data-t")||X.getAttribute("t")||"";F!=null&&(F.length==0?Q.t=te||"z":r.raw||F.trim().length==0||te=="s"||(F==="TRUE"?Q={t:"b",v:!0}:F==="FALSE"?Q={t:"b",v:!1}:isNaN(Kr(F))?isNaN(mo(F).getDate())||(Q={t:"d",v:wn(F)},r.cellDates||(Q={t:"n",v:Qn(Q.v)}),Q.z=r.dateNF||ot[14]):Q={t:"n",v:Kr(F)})),Q.z===void 0&&Y!=null&&(Q.z=Y);var ee="",_e=X.getElementsByTagName("A");if(_e&&_e.length)for(var De=0;De<_e.length&&!(_e[De].hasAttribute("href")&&(ee=_e[De].getAttribute("href"),ee.charAt(0)!="#"));++De);ee&&ee.charAt(0)!="#"&&(Q.l={Target:ee}),r.dense?(e[C+a]||(e[C+a]=[]),e[C+a][M+o]=Q):e[st({c:M+o,r:C+a})]=Q,h.e.c<M+o&&(h.e.c=M+o),M+=b}}++C}return y.length&&(e["!merges"]=(e["!merges"]||[]).concat(y)),h.e.r=Math.max(h.e.r,C-1+a),e["!ref"]=wt(h),C>=p&&(e["!fullref"]=wt((h.e.r=u.length-S+C-1+a,h))),e}function l_(e,t){var n=t||{},r=n.dense?[]:{};return o_(r,e,t)}function yP(e,t){return Si(l_(e,t),t)}function ky(e){var t="",n=TP(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function TP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _P(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=At(t.replace(/<[^>]*>/g,""));return[n]}var Ny={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function c_(e,t){var n=t||{},r=Ih(e),a=[],o,c,u={name:""},p="",h=0,g,y,_={},E=[],S=n.dense?[]:{},C,w,M={value:""},k="",b=0,U=[],B=-1,X=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},Y=0,L={},Q=[],te={},ee=0,_e=0,De=[],Te=1,re=1,ce=[],ne={Names:[]},j={},N=["",""],W=[],D={},J="",q=0,G=!1,ie=!1,ye=0;for(zl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");C=zl.exec(r);)switch(C[3]=C[3].replace(/_.*$/,"")){case"table":case"":C[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?S["!ref"]=wt(F):S["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=F.e.r&&(S["!fullref"]=S["!ref"],F.e.r=n.sheetRows-1,S["!ref"]=wt(F)),Q.length&&(S["!merges"]=Q),De.length&&(S["!rows"]=De),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),E.push(g.name),_[g.name]=S,ie=!1):C[0].charAt(C[0].length-2)!=="/"&&(g=nt(C[0],!1),B=X=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,S=n.dense?[]:{},Q=[],De=[],ie=!0);break;case"table-row-group":C[1]==="/"?--Y:++Y;break;case"table-row":case"":if(C[1]==="/"){B+=Te,Te=1;break}if(y=nt(C[0],!1),y.?B=y.-1:B==-1&&(B=0),Te=+y["number-rows-repeated"]||1,Te<10)for(ye=0;ye<Te;++ye)Y>0&&(De[B+ye]={level:Y});X=-1;break;case"covered-table-cell":C[1]!=="/"&&++X,n.sheetStubs&&(n.dense?(S[B]||(S[B]=[]),S[B][X]={t:"z"}):S[st({r:B,c:X})]={t:"z"}),k="",U=[];break;case"table-cell":case"":if(C[0].charAt(C[0].length-2)==="/")++X,M=nt(C[0],!1),re=parseInt(M["number-columns-repeated"]||"1",10),w={t:"z",v:null},M.formula&&n.cellFormula!=!1&&(w.f=Sy(At(M.formula))),(M.||M["value-type"])=="string"&&(w.t="s",w.v=At(M["string-value"]||""),n.dense?(S[B]||(S[B]=[]),S[B][X]=w):S[st({r:B,c:X})]=w),X+=re-1;else if(C[1]!=="/"){++X,k="",b=0,U=[],re=1;var Ae=Te?B+Te-1:B;if(X>F.e.c&&(F.e.c=X),X<F.s.c&&(F.s.c=X),B<F.s.r&&(F.s.r=B),Ae>F.e.r&&(F.e.r=Ae),M=nt(C[0],!1),W=[],D={},w={t:M.||M["value-type"],v:null},n.cellFormula)if(M.formula&&(M.formula=At(M.formula)),M["number-matrix-columns-spanned"]&&M["number-matrix-rows-spanned"]&&(ee=parseInt(M["number-matrix-rows-spanned"],10)||0,_e=parseInt(M["number-matrix-columns-spanned"],10)||0,te={s:{r:B,c:X},e:{r:B+ee-1,c:X+_e-1}},w.F=wt(te),ce.push([te,w.F])),M.formula)w.f=Sy(M.formula);else for(ye=0;ye<ce.length;++ye)B>=ce[ye][0].s.r&&B<=ce[ye][0].e.r&&X>=ce[ye][0].s.c&&X<=ce[ye][0].e.c&&(w.F=ce[ye][1]);switch((M["number-columns-spanned"]||M["number-rows-spanned"])&&(ee=parseInt(M["number-rows-spanned"],10)||0,_e=parseInt(M["number-columns-spanned"],10)||0,te={s:{r:B,c:X},e:{r:B+ee-1,c:X+_e-1}},Q.push(te)),M["number-columns-repeated"]&&(re=parseInt(M["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Jt(M["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(M.value);break;case"percentage":w.t="n",w.v=parseFloat(M.value);break;case"currency":w.t="n",w.v=parseFloat(M.value);break;case"date":w.t="d",w.v=wn(M["date-value"]),n.cellDates||(w.t="n",w.v=Qn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=FD(M["time-value"])/86400,n.cellDates&&(w.t="d",w.v=tf(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(M.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",M["string-value"]!=null&&(k=At(M["string-value"]),U=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(G=!1,w.t==="s"&&(w.v=k||"",U.length&&(w.R=U),G=b==0),j.Target&&(w.l=j),W.length>0&&(w.c=W,W=[]),k&&n.cellText!==!1&&(w.w=k),G&&(w.t="z",delete w.v),(!G||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=B))for(var Me=0;Me<Te;++Me){if(re=parseInt(M["number-columns-repeated"]||"1",10),n.dense)for(S[B+Me]||(S[B+Me]=[]),S[B+Me][X]=Me==0?w:In(w);--re>0;)S[B+Me][X+re]=In(w);else for(S[st({r:B+Me,c:X})]=w;--re>0;)S[st({r:B+Me,c:X+re})]=In(w);F.e.c<=X&&(F.e.c=X)}re=parseInt(M["number-columns-repeated"]||"1",10),X+=re-1,re=0,w={},k="",U=[]}j={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(C[1]==="/"){if((o=a.pop())[0]!==C[3])throw"Bad state: "+o}else C[0].charAt(C[0].length-2)!=="/"&&a.push([C[3],!0]);break;case"annotation":if(C[1]==="/"){if((o=a.pop())[0]!==C[3])throw"Bad state: "+o;D.t=k,U.length&&(D.R=U),D.a=J,W.push(D)}else C[0].charAt(C[0].length-2)!=="/"&&a.push([C[3],!1]);J="",q=0,k="",b=0,U=[];break;case"creator":C[1]==="/"?J=r.slice(q,C.index):q=C.index+C[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(C[1]==="/"){if((o=a.pop())[0]!==C[3])throw"Bad state: "+o}else C[0].charAt(C[0].length-2)!=="/"&&a.push([C[3],!1]);k="",b=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(C[1]==="/"){if(L[u.name]=p,(o=a.pop())[0]!==C[3])throw"Bad state: "+o}else C[0].charAt(C[0].length-2)!=="/"&&(p="",u=nt(C[0],!1),a.push([C[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":c=nt(C[0],!1),p+=Ny[C[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":c=nt(C[0],!1),p+=Ny[C[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(C[0].slice(-2)==="/>")break;if(C[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":p+=r.slice(h,C.index);break}else h=C.index+C[0].length;break;case"named-range":c=nt(C[0],!1),N=Cd(c["cell-range-address"]);var Ee={Name:c.name,Ref:N[0]+"!"+N[1]};ie&&(Ee.Sheet=E.length),ne.Names.push(Ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(C[1]==="/"&&(!M||!M["string-value"])){var Ze=_P(r.slice(b,C.index));k=(k.length>0?k+`
`:"")+Ze[0]}else nt(C[0],!1),b=C.index+C[0].length;break;case"s":break;case"database-range":if(C[1]==="/")break;try{N=Cd(nt(C[0])["target-range-address"]),_[N[0]]["!autofilter"]={ref:N[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(C[1]!=="/"){if(j=nt(C[0],!1),!j.href)break;j.Target=At(j.href),delete j.href,j.Target.charAt(0)=="#"&&j.Target.indexOf(".")>-1?(N=Cd(j.Target.slice(1)),j.Target="#"+N[0]+"!"+N[1]):j.Target.match(/^\.\.[\\\/]/)&&(j.Target=j.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(C[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(C)}}var K={Sheets:_,SheetNames:E,Workbook:ne};return n.bookSheets&&delete K.Sheets,K}function My(e,t){t=t||{},Ir(e,"META-INF/manifest.xml")&&P6(hn(e,"META-INF/manifest.xml"),t);var n=gr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=c_(qt(n),t);return Ir(e,"meta.xml")&&(r.Props=E2(hn(e,"meta.xml"))),r}function Ry(e,t){return c_(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Yh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ih(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):qt(os(e))}function sh(e){var t=e.reduce(function(a,o){return a+o.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(a){n.set(a,r),r+=a.length}),n}function Dy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function EP(e,t){for(var n=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,a=t+13;a>=t;--a)r=r*256+e[a];return(e[t+15]&128?-r:r)*Math.pow(10,n-6176)}function $l(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Tn(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function Hn(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],a=$l(e,n),o=a&7;a=Math.floor(a/8);var c=0,u;if(a==0)break;switch(o){case 0:{for(var p=n[0];e[n[0]++]>=128;);u=e.slice(p,n[0])}break;case 5:c=4,u=e.slice(n[0],n[0]+c),n[0]+=c;break;case 1:c=8,u=e.slice(n[0],n[0]+c),n[0]+=c;break;case 2:c=$l(e,n),u=e.slice(n[0],n[0]+c),n[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var h={data:u,type:o};t[a]==null?t[a]=[h]:t[a].push(h)}return t}function $h(e,t){return(e==null?void 0:e.map(function(n){return t(n.data)}))||[]}function SP(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=$l(e,r),o=Hn(e.slice(r[0],r[0]+a));r[0]+=a;var c={id:Tn(o[1][0].data),messages:[]};o[2].forEach(function(u){var p=Hn(u.data),h=Tn(p[3][0].data);c.messages.push({meta:p,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(t=o[3])!=null&&t[0]&&(c.merge=Tn(o[3][0].data)>>>0>0),n.push(c)}return n}function CP(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=$l(t,n),a=[];n[0]<t.length;){var o=t[n[0]]&3;if(o==0){var c=t[n[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[n[0]],u>1&&(c|=t[n[0]+1]<<8),u>2&&(c|=t[n[0]+2]<<16),u>3&&(c|=t[n[0]+3]<<24),c>>>=0,c++,n[0]+=u}a.push(t.slice(n[0],n[0]+c)),n[0]+=c;continue}else{var p=0,h=0;if(o==1?(h=(t[n[0]]>>2&7)+4,p=(t[n[0]++]&224)<<3,p|=t[n[0]++]):(h=(t[n[0]++]>>2)+1,o==2?(p=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(p=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[sh(a)],p==0)throw new Error("Invalid offset 0");if(p>a[0].length)throw new Error("Invalid offset beyond length");if(h>=p)for(a.push(a[0].slice(-p)),h-=p;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-p,-p+h))}}var g=sh(a);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function wP(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(CP(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return sh(t)}function AP(e,t,n,r){var a=Yh(e),o=a.getUint32(4,!0),c=(r>1?12:8)+Dy(o&(r>1?3470:398))*4,u=-1,p=-1,h=NaN,g=new Date(2001,0,1);o&512&&(u=a.getUint32(c,!0),c+=4),c+=Dy(o&(r>1?12288:4096))*4,o&16&&(p=a.getUint32(c,!0),c+=4),o&32&&(h=a.getFloat64(c,!0),c+=8),o&64&&(g.setTime(g.getTime()+a.getFloat64(c,!0)*1e3),c+=8);var y;switch(e[2]){case 0:break;case 2:y={t:"n",v:h};break;case 3:y={t:"s",v:t[p]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:h>0};break;case 7:y={t:"n",v:h/86400};break;case 8:y={t:"e",v:0};break;case 9:if(u>-1)y={t:"s",v:n[u]};else if(p>-1)y={t:"s",v:t[p]};else if(!isNaN(h))y={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return y}function bP(e,t,n){var r=Yh(e),a=r.getUint32(8,!0),o=12,c=-1,u=-1,p=NaN,h=NaN,g=new Date(2001,0,1);a&1&&(p=EP(e,o),o+=16),a&2&&(h=r.getFloat64(o,!0),o+=8),a&4&&(g.setTime(g.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=r.getUint32(o,!0),o+=4),a&16&&(c=r.getUint32(o,!0),o+=4);var y;switch(e[1]){case 0:break;case 2:y={t:"n",v:p};break;case 3:y={t:"s",v:t[u]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:h>0};break;case 7:y={t:"n",v:h/86400};break;case 8:y={t:"e",v:0};break;case 9:if(c>-1)y={t:"s",v:n[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:y={t:"n",v:p};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return y}function kP(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return AP(e,t,n,e[0]);case 5:return bP(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function xi(e){var t=Hn(e);return $l(t[1][0].data)}function Iy(e,t){var n=Hn(t.data),r=Tn(n[1][0].data),a=n[3],o=[];return(a||[]).forEach(function(c){var u=Hn(c.data),p=Tn(u[1][0].data)>>>0;switch(r){case 1:o[p]=ih(u[3][0].data);break;case 8:{var h=e[xi(u[9][0].data)][0],g=Hn(h.data),y=e[xi(g[1][0].data)][0],_=Tn(y.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var E=Hn(y.data);o[p]=E[3].map(function(S){return ih(S.data)}).join("")}break}}),o}function NP(e,t){var n,r,a,o,c,u,p,h,g,y,_,E,S,C,w=Hn(e),M=Tn(w[1][0].data)>>>0,k=Tn(w[2][0].data)>>>0,b=((r=(n=w[8])==null?void 0:n[0])==null?void 0:r.data)&&Tn(w[8][0].data)>0||!1,U,B;if((o=(a=w[7])==null?void 0:a[0])!=null&&o.data&&t!=0)U=(u=(c=w[7])==null?void 0:c[0])==null?void 0:u.data,B=(h=(p=w[6])==null?void 0:p[0])==null?void 0:h.data;else if((y=(g=w[4])==null?void 0:g[0])!=null&&y.data&&t!=1)U=(E=(_=w[4])==null?void 0:_[0])==null?void 0:E.data,B=(C=(S=w[3])==null?void 0:S[0])==null?void 0:C.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var X=b?4:1,F=Yh(U),Y=[],L=0;L<U.length/2;++L){var Q=F.getUint16(L*2,!0);Q<65535&&Y.push([L,Q])}if(Y.length!=k)throw"Expected ".concat(k," cells, found ").concat(Y.length);var te=[];for(L=0;L<Y.length-1;++L)te[Y[L][0]]=B.subarray(Y[L][1]*X,Y[L+1][1]*X);return Y.length>=1&&(te[Y[Y.length-1][0]]=B.subarray(Y[Y.length-1][1]*X)),{R:M,cells:te}}function MP(e,t){var n,r=Hn(t.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?Tn(r[7][0].data)>>>0>0?1:0:-1,o=$h(r[5],function(c){return NP(c,a)});return{nrows:Tn(r[4][0].data)>>>0,data:o.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(p,h){if(c[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));c[u.R][h]=p}),c},[])}}function RP(e,t,n){var r,a=Hn(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Tn(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Tn(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=wt(o);var c=Hn(a[4][0].data),u=Iy(e,e[xi(c[4][0].data)][0]),p=(r=c[17])!=null&&r[0]?Iy(e,e[xi(c[17][0].data)][0]):[],h=Hn(c[3][0].data),g=0;h[1].forEach(function(y){var _=Hn(y.data),E=e[xi(_[2][0].data)][0],S=Tn(E.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var C=MP(e,E);C.data.forEach(function(w,M){w.forEach(function(k,b){var U=st({r:g+M,c:b}),B=kP(k,u,p);B&&(n[U]=B)})}),g+=C.nrows})}function DP(e,t){var n=Hn(t.data),r={"!ref":"A1"},a=e[xi(n[2][0].data)],o=Tn(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return RP(e,a[0],r),r}function IP(e,t){var n,r=Hn(t.data),a={name:(n=r[1])!=null&&n[0]?ih(r[1][0].data):"",sheets:[]},o=$h(r[2],xi);return o.forEach(function(c){e[c].forEach(function(u){var p=Tn(u.meta[1][0].data);p==6e3&&a.sheets.push(DP(e,u))})}),a}function FP(e,t){var n=Wh(),r=Hn(t.data),a=$h(r[1],xi);if(a.forEach(function(o){e[o].forEach(function(c){var u=Tn(c.meta[1][0].data);if(u==2){var p=IP(e,c);p.sheets.forEach(function(h,g){Kh(n,h,g==0?p.name:p.name+"_"+g,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function Ad(e){var t,n,r,a,o={},c=[];if(e.FullPaths.forEach(function(p){if(p.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(p){if(p.name.match(/\.iwa$/)){var h;try{h=wP(p.content)}catch(y){return console.log("?? "+p.content.length+" "+(y.message||y))}var g;try{g=SP(h)}catch(y){return console.log("## "+(y.message||y))}g.forEach(function(y){o[y.id]=y.messages,c.push(y.id)})}}),!c.length)throw new Error("File has no messages");var u=((a=(r=(n=(t=o==null?void 0:o[1])==null?void 0:t[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Tn(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||c.forEach(function(p){o[p].forEach(function(h){var g=Tn(h.meta[1][0].data)>>>0;if(g==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return FP(o,u)}function LP(e){return function(n){for(var r=0;r!=e.length;++r){var a=e[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function Jh(e){LP([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function OP(e){return eo.WS.indexOf(e)>-1?"sheet":e==eo.CS?"chart":e==eo.DS?"dialog":e==eo.MS?"macro":e&&e.length?e:"sheet"}function PP(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,OP(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function UP(e,t,n,r,a,o,c,u,p,h,g,y){try{o[r]=Ml(gr(e,n,!0),t);var _=hn(e,t),E;switch(u){case"sheet":E=j7(_,t,a,p,o[r],h,g,y);break;case"chart":if(E=q7(_,t,a,p,o[r],h,g,y),!E||!E["!drawel"])break;var S=Sl(E["!drawel"].Target,t),C=eh(S),w=z8(gr(e,S,!0),Ml(gr(e,C,!0),S)),M=Sl(w,S),k=eh(M);E=b7(gr(e,M,!0),M,p,Ml(gr(e,k,!0),M),h,E);break;case"macro":E=Y7(_,t,a,p,o[r],h,g,y);break;case"dialog":E=$7(_,t,a,p,o[r],h,g,y);break;default:throw new Error("Unrecognized sheet type "+u)}c[r]=E;var b=[];o&&o[r]&&da(o[r]).forEach(function(U){var B="";if(o[r][U].Type==eo.CMNT){B=Sl(o[r][U].Target,t);var X=K7(hn(e,B,!0),B,p);if(!X||!X.length)return;vy(E,X,!1)}o[r][U].Type==eo.TCMNT&&(B=Sl(o[r][U].Target,t),b=b.concat(q8(hn(e,B,!0),p)))}),b&&b.length&&vy(E,b,!0,p.people||[])}catch(U){if(p.WTF)throw U}}function Mr(e){return e.charAt(0)=="/"?e.slice(1):e}function BP(e,t){if($T(),t=t||{},Jh(t),Ir(e,"META-INF/manifest.xml")||Ir(e,"objectdata.xml"))return My(e,t);if(Ir(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ad<"u"){if(e.FileIndex)return Ad(e);var n=St.utils.cfb_new();return qv(e).forEach(function(De){VD(n,De,BD(e,De))}),Ad(n)}throw new Error("Unsupported NUMBERS file")}if(!Ir(e,"[Content_Types].xml"))throw Ir(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ir(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=qv(e),a=L6(gr(e,"[Content_Types].xml")),o=!1,c,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",hn(e,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!hn(e,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var p={},h={};if(!t.bookSheets&&!t.bookProps){if(Il=[],a.sst)try{Il=W7(hn(e,Mr(a.sst)),a.sst,t)}catch(De){if(t.WTF)throw De}t.cellStyles&&a.themes.length&&(p=X7(gr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(h=J7(hn(e,Mr(a.style)),a.style,p,t))}a.links.map(function(De){try{var Te=Ml(gr(e,eh(Mr(De))),De);return Q7(hn(e,Mr(De)),Te,De,t)}catch{}});var g=z7(hn(e,Mr(a.workbooks[0])),a.workbooks[0],t),y={},_="";a.coreprops.length&&(_=hn(e,Mr(a.coreprops[0]),!0),_&&(y=E2(_)),a.extprops.length!==0&&(_=hn(e,Mr(a.extprops[0]),!0),_&&V6(_,y,t)));var E={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(_=gr(e,Mr(a.custprops[0]),!0),_&&(E=H6(_,t)));var S={};if((t.bookSheets||t.bookProps)&&(g.Sheets?c=g.Sheets.map(function(Te){return Te.name}):y.Worksheets&&y.SheetNames.length>0&&(c=y.SheetNames),t.bookProps&&(S.Props=y,S.Custprops=E),t.bookSheets&&typeof c<"u"&&(S.SheetNames=c),t.bookSheets?S.SheetNames:t.bookProps))return S;c={};var C={};t.bookDeps&&a.calcchain&&(C=Z7(hn(e,Mr(a.calcchain)),a.calcchain));var w=0,M={},k,b;{var U=g.Sheets;y.Worksheets=U.length,y.SheetNames=[];for(var B=0;B!=U.length;++B)y.SheetNames[B]=U[B].name}var X=o?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),Y=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Ir(e,Y)||(Y="xl/_rels/workbook."+X+".rels");var L=Ml(gr(e,Y,!0),Y.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=eP(hn(e,Mr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=Y8(hn(e,Mr(a.people[0])),t)),L&&(L=PP(L,g.Sheets));var Q=hn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=y.Worksheets;++w){var te="sheet";if(L&&L[w]?(k="xl/"+L[w][1].replace(/[\/]?xl\//,""),Ir(e,k)||(k=L[w][1]),Ir(e,k)||(k=Y.replace(/_rels\/.*$/,"")+L[w][1]),te=L[w][2]):(k="xl/worksheets/sheet"+(w+1-Q)+"."+X,k=k.replace(/sheet0\./,"sheet.")),b=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(y.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var ee=!1,_e=0;_e!=t.sheets.length;++_e)typeof t.sheets[_e]=="number"&&t.sheets[_e]==w&&(ee=1),typeof t.sheets[_e]=="string"&&t.sheets[_e].toLowerCase()==y.SheetNames[w].toLowerCase()&&(ee=1);if(!ee)continue e}}UP(e,k,b,y.SheetNames[w],w,M,c,te,t,g,p,h)}return S={Directory:a,Workbook:g,Props:y,Custprops:E,Deps:C,Sheets:c,SheetNames:y.SheetNames,Strings:Il,Styles:h,Themes:p,SSF:In(ot)},t&&t.bookFiles&&(e.files?(S.keys=r,S.files=e.files):(S.keys=[],S.files={},e.FullPaths.forEach(function(De,Te){De=De.replace(/^Root Entry[\/]/,""),S.keys.push(De),S.files[De]=e.FileIndex[Te]}))),t&&t.bookVBA&&(a.vba.length>0?S.vbaraw=hn(e,Mr(a.vba[0]),!0):a.defaults&&a.defaults.bin===W8&&(S.vbaraw=hn(e,"xl/vbaProject.bin",!0))),S}function VP(e,t){var n=t||{},r="Workbook",a=St.find(e,r);try{if(r="/!DataSpaces/Version",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(DF(a.content),r="/!DataSpaces/DataSpaceMap",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=FF(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=LF(a.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);PF(a.content)}catch{}if(r="/EncryptionInfo",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var u=UF(a.content);if(r="/EncryptedPackage",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,n.password||"",n);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function Xh(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=vr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function GP(e,t){return St.find(e,"EncryptedPackage")?VP(e,t):s_(e,t)}function HP(e,t){var n,r=e,a=t||{};return a.type||(a.type=yt&&Buffer.isBuffer(e)?"buffer":"base64"),n=QT(r,a),BP(n,a)}function u_(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return rh(e.slice(n),t);default:break e}return jl.to_workbook(e,t)}function zP(e,t){var n="",r=Xh(e,t);switch(t.type){case"base64":n=vr(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=rs(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=qt(n)),t.type="binary",u_(n,t)}function jP(e,t){var n=e;return t.type=="base64"&&(n=vr(n)),n=Vl.utils.decode(1200,n.slice(2),"str"),t.type="binary",u_(n,t)}function qP(e){return e.match(/[^\x00-\x7F]/)?Cl(e):e}function bd(e,t,n,r){return r?(n.type="string",jl.to_workbook(e,n)):jl.to_workbook(t,n)}function oh(e,t){LT();var n=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return oh(new Uint8Array(e),(n=In(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),io={},n.dateNF&&(io.dateNF=n.dateNF),n.type||(n.type=yt&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=yt?"buffer":"binary",r=DD(e),typeof Uint8Array<"u"&&!yt&&(n.type="array")),n.type=="string"&&(o=!0,n.type="binary",n.codepage=65001,r=qP(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return n=In(n),n.type="array",oh(bh(r),n)}switch((a=Xh(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return GP(St.read(r,n),n);break;case 9:if(a[1]<=8)return s_(r,n);break;case 60:return rh(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return yF(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return xF.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?HP(r,n):bd(e,r,n,o);case 239:return a[3]===60?rh(r,n):bd(e,r,n,o);case 255:if(a[1]===254)return jP(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return Dl.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Dl.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return xy.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return WF.to_workbook(r,n);break;case 10:case 13:case 32:return zP(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return pF.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?xy.to_workbook(r,n):bd(e,r,n,o)}function YP(e,t,n,r,a,o,c,u){var p=Fn(n),h=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),y=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:!1})}catch{_.__rowNum__=n}else _.__rowNum__=n;if(!c||e[n])for(var E=t.s.c;E<=t.e.c;++E){var S=c?e[n][E]:e[r[E]+p];if(S===void 0||S.t===void 0){if(h===void 0)continue;o[E]!=null&&(_[o[E]]=h);continue}var C=S.v;switch(S.t){case"z":if(C==null)break;continue;case"e":C=C==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(o[E]!=null){if(C==null)if(S.t=="e"&&C===null)_[o[E]]=null;else if(h!==void 0)_[o[E]]=h;else if(g&&C===null)_[o[E]]=null;else continue;else _[o[E]]=g&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?C:Pa(S,C,u);C!=null&&(y=!1)}}return{row:_,isempty:y}}function lh(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,o=[],c=0,u="",p={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},g=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof g){case"string":p=rn(g);break;case"number":p=rn(e["!ref"]),p.s.r=g;break;default:p=g}r>0&&(a=0);var y=Fn(p.s.r),_=[],E=[],S=0,C=0,w=Array.isArray(e),M=p.s.r,k=0,b={};w&&!e[M]&&(e[M]=[]);var U=h.skipHidden&&e["!cols"]||[],B=h.skipHidden&&e["!rows"]||[];for(k=p.s.c;k<=p.e.c;++k)if(!(U[k]||{}).hidden)switch(_[k]=yn(k),n=w?e[M][k]:e[_[k]+y],r){case 1:o[k]=k-p.s.c;break;case 2:o[k]=_[k];break;case 3:o[k]=h.header[k-p.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),u=c=Pa(n,null,h),C=b[c]||0,!C)b[c]=1;else{do u=c+"_"+C++;while(b[u]);b[c]=C,b[u]=1}o[k]=u}for(M=p.s.r+a;M<=p.e.r;++M)if(!(B[M]||{}).hidden){var X=YP(e,p,M,_,r,o,w,h);(X.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(E[S++]=X.row)}return E.length=S,E}var Fy=/"/g;function $P(e,t,n,r,a,o,c,u){for(var p=!0,h=[],g="",y=Fn(n),_=t.s.c;_<=t.e.c;++_)if(r[_]){var E=u.dense?(e[n]||[])[_]:e[r[_]+y];if(E==null)g="";else if(E.v!=null){p=!1,g=""+(u.rawNumbers&&E.t=="n"?E.v:Pa(E,null,u));for(var S=0,C=0;S!==g.length;++S)if((C=g.charCodeAt(S))===a||C===o||C===34||u.forceQuotes){g='"'+g.replace(Fy,'""')+'"';break}g=="ID"&&(g='"ID"')}else E.f!=null&&!E.F?(p=!1,g="="+E.f,g.indexOf(",")>=0&&(g='"'+g.replace(Fy,'""')+'"')):g="";h.push(g)}return u.blankrows===!1&&p?null:h.join(c)}function f_(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var a=rn(e["!ref"]),o=r.FS!==void 0?r.FS:",",c=o.charCodeAt(0),u=r.RS!==void 0?r.RS:`
`,p=u.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),g="",y=[];r.dense=Array.isArray(e);for(var _=r.skipHidden&&e["!cols"]||[],E=r.skipHidden&&e["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(y[S]=yn(S));for(var C=0,w=a.s.r;w<=a.e.r;++w)(E[w]||{}).hidden||(g=$P(e,a,w,y,c,p,o,r),g!=null&&(r.strip&&(g=g.replace(h,"")),(g||r.blankrows!==!1)&&n.push((C++?u:"")+g)));return delete r.dense,n.join("")}function JP(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=f_(e,t);return n}function XP(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var a=rn(e["!ref"]),o="",c=[],u,p=[],h=Array.isArray(e);for(u=a.s.c;u<=a.e.c;++u)c[u]=yn(u);for(var g=a.s.r;g<=a.e.r;++g)for(o=Fn(g),u=a.s.c;u<=a.e.c;++u)if(t=c[u]+o,n=h?(e[g]||[])[u]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}p[p.length]=t+"="+r}return p}function d_(e,t,n){var r=n||{},a=+!r.skipHeader,o=e||{},c=0,u=0;if(o&&r.origin!=null)if(typeof r.origin=="number")c=r.origin;else{var p=typeof r.origin=="string"?Wn(r.origin):r.origin;c=p.r,u=p.c}var h,g={s:{c:0,r:0},e:{c:u,r:c+t.length-1+a}};if(o["!ref"]){var y=rn(o["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),c==-1&&(c=y.e.r+1,g.e.r=c+t.length-1+a)}else c==-1&&(c=0,g.e.r=t.length-1+a);var _=r.header||[],E=0;t.forEach(function(C,w){da(C).forEach(function(M){(E=_.indexOf(M))==-1&&(_[E=_.length]=M);var k=C[M],b="z",U="",B=st({c:u+E,r:c+w+a});h=Jl(o,B),k&&typeof k=="object"&&!(k instanceof Date)?o[B]=k:(typeof k=="number"?b="n":typeof k=="boolean"?b="b":typeof k=="string"?b="s":k instanceof Date?(b="d",r.cellDates||(b="n",k=Qn(k)),U=r.dateNF||ot[14]):k===null&&r.nullError&&(b="e",k=0),h?(h.t=b,h.v=k,delete h.w,delete h.R,U&&(h.z=U)):o[B]=h={t:b,v:k},U&&(h.z=U))})}),g.e.c=Math.max(g.e.c,u+_.length-1);var S=Fn(c);if(a)for(E=0;E<_.length;++E)o[yn(E+u)+S]={t:"s",v:_[E]};return o["!ref"]=wt(g),o}function WP(e,t){return d_(null,e,t)}function Jl(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=Wn(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Jl(e,st(t)):Jl(e,st({r:t,c:n||0}))}function KP(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Wh(){return{SheetNames:[],Sheets:{}}}function Kh(e,t,n,r){var a=1;if(!n)for(;a<=65535&&e.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var c=o&&o[1]||n;for(++a;a<=65535&&e.SheetNames.indexOf(n=c+a)!=-1;++a);}if(L7(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function ZP(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=KP(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function QP(e,t){return e.z=t,e}function h_(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function e9(e,t,n){return h_(e,"#"+t,n)}function t9(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function n9(e,t,n,r){for(var a=typeof t!="string"?t:rn(t),o=typeof t=="string"?t:wt(t),c=a.s.r;c<=a.e.r;++c)for(var u=a.s.c;u<=a.e.c;++u){var p=Jl(e,c,u);p.t="n",p.F=o,delete p.v,c==a.s.r&&u==a.s.c&&(p.f=n,r&&(p.D=!0))}return e}var r9={encode_col:yn,encode_row:Fn,encode_cell:st,encode_range:wt,decode_col:Oh,decode_row:Lh,split_cell:m6,decode_cell:Wn,decode_range:_o,format_cell:Pa,sheet_add_aoa:x2,sheet_add_json:d_,sheet_add_dom:o_,aoa_to_sheet:Eo,json_to_sheet:WP,table_to_sheet:l_,table_to_book:yP,sheet_to_csv:f_,sheet_to_txt:JP,sheet_to_json:lh,sheet_to_html:vP,sheet_to_formulae:XP,sheet_to_row_object_array:lh,sheet_get_cell:Jl,book_new:Wh,book_append_sheet:Kh,book_set_sheet_visibility:ZP,cell_set_number_format:QP,cell_set_hyperlink:h_,cell_set_internal_link:e9,cell_add_comment:t9,sheet_set_array_formula:n9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const a9=({matrixData:e,onUpdate:t})=>{const n=(p,h)=>t({...e,headers:e.headers.map((g,y)=>y===p?h:g)}),r=(p,h,g)=>t({...e,rows:e.rows.map((y,_)=>_===p?y.map((E,S)=>S===h?g:E):y)}),a=()=>t({...e,rows:[...e.rows,Array(e.headers.length).fill("")]}),o=p=>t({...e,rows:e.rows.filter((h,g)=>g!==p)}),c=()=>{const p=` ${e.headers.length+1}`;t({headers:[...e.headers,p],rows:e.rows.map(h=>[...h,""])})},u=p=>{e.headers.length<=1||t({headers:e.headers.filter((h,g)=>g!==p),rows:e.rows.map(h=>h.filter((g,y)=>y!==p))})};return v.jsxs("div",{className:"overflow-x-auto p-1 bg-slate-50 rounded-md border",children:[v.jsxs("table",{className:"w-full text-xs border-collapse",children:[v.jsx("thead",{children:v.jsxs("tr",{className:"bg-slate-200",children:[e.headers.map((p,h)=>v.jsx("th",{className:"border border-slate-300 p-0 font-semibold text-slate-700",children:v.jsxs("div",{className:"flex items-center justify-between gap-1 px-1",children:[v.jsx("input",{type:"text",value:p,onChange:g=>n(h,g.target.value),className:"w-full bg-transparent outline-none text-center font-semibold text-slate-800"}),v.jsx("button",{onClick:()=>u(h),className:"text-red-500 hover:text-red-700 opacity-30 hover:opacity-100",title:"",children:v.jsx(Ia,{className:"w-3 h-3"})})]})},h)),v.jsx("th",{className:"border border-slate-300 p-1 w-10"})]})}),v.jsx("tbody",{children:e.rows.map((p,h)=>v.jsxs("tr",{children:[p.map((g,y)=>v.jsx("td",{className:"border border-slate-300 p-0",children:v.jsx("input",{type:"text",value:g,onChange:_=>r(h,y,_.target.value),className:"w-full bg-white text-slate-900 outline-none p-1 focus:bg-blue-50"})},y)),v.jsx("td",{className:"border border-slate-300 p-1 text-center",children:v.jsx("button",{onClick:()=>o(h),className:"text-red-500 hover:text-red-700",title:"",children:v.jsx(Ia,{className:"w-3 h-3"})})})]},h))})]}),v.jsxs("div",{className:"flex gap-2 mt-2",children:[v.jsxs("button",{onClick:a,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[v.jsx(Jd,{className:"w-3 h-3"}),""]}),v.jsxs("button",{onClick:c,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[v.jsx(Jd,{className:"w-3 h-3"}),""]})]})]})},Ly=e=>{const t=Math.cos(2*Math.PI*e),n=Math.sin(2*Math.PI*e);return[t,n]},i9=({data:e,title:t})=>{const n=e.reduce((c,u)=>c+u.value,0);if(n===0)return v.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"});let r=0;const a=["#4A90E2","#50E3C2","#F5A623","#F8E71C","#7ED321","#9013FE","#BD10E0","#4A4A4A"],o=e.map((c,u)=>{const p=c.value/n,[h,g]=Ly(r);r+=p;const[y,_]=Ly(r),E=p>.5?1:0;return{path:`M ${h} ${g} A 1 1 0 ${E} 1 ${y} ${_} L 0 0`,color:a[u%a.length],label:c.label,value:c.value}});return v.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-white p-2 border rounded-md",children:[v.jsx("h5",{className:"font-bold text-sm mb-2",children:t}),v.jsx("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-32 h-32 mb-2",children:o.map((c,u)=>v.jsx("path",{d:c.path,fill:c.color},u))}),v.jsx("div",{className:"text-[10px] space-y-0.5 w-full",children:o.map((c,u)=>v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:c.color}}),v.jsx("span",{children:c.label})]}),v.jsxs("span",{children:[c.value," (",(c.value/n*100).toFixed(1),"%)"]})]},u))})]})},s9=({data:e,title:t})=>{if(e.length<2)return v.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"Need at least 2 data points for a line chart."});const n=Math.max(...e.map(r=>r.value),0);return v.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[v.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:t}),v.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-40",children:[[0,.25,.5,.75,1].map(r=>v.jsx("line",{x1:"0",y1:50-r*45,x2:"100",y2:50-r*45,stroke:"#f0f0f0",strokeWidth:"0.5"},r)),v.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1",points:e.map((r,a)=>`${a/(e.length-1)*100},${50-r.value/n*45}`).join(" ")}),e.map((r,a)=>v.jsx("circle",{cx:`${a/(e.length-1)*100}`,cy:`${50-r.value/n*45}`,r:"1.5",fill:"#4a90e2"},a))]})]})},o9=({data:e,title:t})=>{const n=Math.max(...e.map(r=>r.value),0);return n===0?v.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"}):v.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[v.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:t}),v.jsx("div",{className:"space-y-1",children:e.map(r=>v.jsxs("div",{className:"flex items-center text-xs",children:[v.jsx("div",{className:"w-24 truncate pr-2 text-right text-slate-600",children:r.label}),v.jsx("div",{className:"flex-grow bg-slate-200 rounded-full h-4",children:v.jsx("div",{className:"bg-blue-500 h-4 rounded-full text-white text-right pr-1",style:{width:`${r.value/n*100}%`},children:v.jsx("span",{className:"text-[10px]",children:r.value})})})]},r.label))})]})},l9=({actionItem:e,onSave:t,onClose:n,generateUniqueId:r})=>{var M;const[a,o]=ge.useState(e.report||{notes:"",attachments:[],matrixData:null}),[c,u]=ge.useState("bar"),p=ge.useRef(null),h=ge.useRef(null),g=k=>{o(b=>({...b,...k}))},y=()=>{t({...e,report:a})},_=k=>{var F;const b=(F=k.target.files)==null?void 0:F[0];if(!b)return;const U=5,B=U*1024*1024;if(b.size>B){alert(`${U}MB`),k.target&&(k.target.value="");return}const X=new FileReader;X.onload=Y=>{var L;if(typeof((L=Y.target)==null?void 0:L.result)=="string"){const Q={id:r("attach"),name:b.name,type:b.type,dataUrl:Y.target.result};g({attachments:[...a.attachments||[],Q]})}else alert("")},X.onerror=()=>{alert("")},X.readAsDataURL(b),k.target&&(k.target.value="")},E=k=>{var b;g({attachments:(b=a.attachments)==null?void 0:b.filter(U=>U.id!==k)})},S=k=>{var B;const b=(B=k.target.files)==null?void 0:B[0];if(!b)return;const U=new FileReader;U.onload=X=>{var F;try{const Y=(F=X.target)==null?void 0:F.result,L=oh(Y,{type:"array"}),Q=L.SheetNames[0],te=L.Sheets[Q],ee=r9.sheet_to_json(te,{header:1});if(!Array.isArray(ee)||ee.length===0){alert("Excel"),k.target&&(k.target.value="");return}const _e=ee[0];if(!Array.isArray(_e)){alert("Excel"),k.target&&(k.target.value="");return}const De=_e.map(String),Te=ee.slice(1),re=[];for(const ce of Te)if(Array.isArray(ce)){const ne=Array(De.length).fill("");for(let j=0;j<De.length;j++)ne[j]=ce[j]!==null&&ce[j]!==void 0?String(ce[j]):"";re.push(ne)}g({matrixData:{headers:De,rows:re}})}catch(Y){console.error("Error parsing Excel file:",Y),alert(`Excel: ${Y instanceof Error?Y.message:"Unknown error"}`)}finally{k.target&&(k.target.value="")}},U.readAsArrayBuffer(b)},C=(((M=a.matrixData)==null?void 0:M.rows)||[]).map(k=>({label:k[0],value:parseFloat(k[1])||0})).filter(k=>k.label&&!isNaN(k.value)),w=()=>{if(!a.matrixData||C.length===0)return null;switch(c){case"line":return v.jsx(s9,{data:C,title:""});case"pie":return v.jsx(i9,{data:C,title:""});case"bar":default:return v.jsx(o9,{data:C,title:""})}};return v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[70]",children:v.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[v.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),v.jsx("p",{className:"text-sm text-slate-500",children:e.text})]}),v.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:v.jsx(xr,{className:"w-6 h-6 text-slate-500"})})]}),v.jsxs("div",{className:"flex-grow p-5 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-semibold text-slate-700",children:""}),v.jsx("textarea",{value:a.notes,onChange:k=>g({notes:k.target.value}),className:"w-full mt-1 p-2 border rounded-md h-32 bg-slate-50 focus:bg-white text-slate-800",placeholder:"..."})]}),v.jsxs("div",{children:[v.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center mb-2",children:["",v.jsx("button",{onClick:()=>{var k;return(k=p.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",children:v.jsx(ho,{className:"w-5 h-5"})}),v.jsx("input",{type:"file",ref:p,onChange:_,className:"hidden",multiple:!1})]}),v.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto border p-2 rounded-md bg-slate-50",children:(a.attachments||[]).map(k=>v.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-24",children:[v.jsx("a",{href:k.dataUrl,download:k.name,className:"block w-full h-full","aria-label":`Download ${k.name}`,children:k.type.startsWith("image/")?v.jsx("img",{src:k.dataUrl,alt:k.name,className:"w-full h-full object-cover"}):v.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-2 hover:bg-slate-200",children:v.jsx(ho,{className:"w-8 h-8 text-slate-500"})})}),v.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:v.jsx("p",{className:"text-white text-[10px] truncate",title:k.name,children:k.name})}),v.jsx("button",{onClick:()=>E(k.id),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:v.jsx(Ia,{className:"w-3 h-3"})})]},k.id))})]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center",children:["",v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:()=>{var k;return(k=h.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",title:"Excel",children:v.jsx(_T,{className:"w-5 h-5 text-green-600"})}),v.jsx("input",{type:"file",ref:h,onChange:S,className:"hidden",accept:".xlsx, .xls, .csv"}),a.matrixData&&C.length>0&&v.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-200 p-0.5",children:[v.jsx("button",{onClick:()=>u("bar"),className:`px-2 py-0.5 rounded-full text-xs ${c==="bar"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Bar"}),v.jsx("button",{onClick:()=>u("line"),className:`px-2 py-0.5 rounded-full text-xs ${c==="line"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Line"}),v.jsx("button",{onClick:()=>u("pie"),className:`px-2 py-0.5 rounded-full text-xs ${c==="pie"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Pie"})]}),v.jsx("button",{onClick:()=>g({matrixData:a.matrixData?null:{headers:["",""],rows:[["",""]]}}),className:"p-1 hover:bg-slate-200 rounded-full",title:a.matrixData?"":"",children:a.matrixData?v.jsx(Ia,{className:"w-5 h-5 text-red-500"}):v.jsx(_h,{className:"w-5 h-5"})})]})]}),a.matrixData?v.jsx(a9,{matrixData:a.matrixData,onUpdate:k=>g({matrixData:k})}):null,v.jsx("div",{className:"mt-4",children:w()})]})]}),v.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[v.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),v.jsx("button",{onClick:y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})},c9=({actionItems:e,subStepName:t,taskName:n,onClose:r})=>{const[a,o]=ge.useState(null),c=ge.useMemo(()=>{let g=[...e];return a!==null&&g.sort((y,_)=>{let E="",S="";switch(a.key){case"status":E=y.completed,S=_.completed;break;case"dueDate":E=y.dueDate||"9999-12-31",S=_.dueDate||"9999-12-31";break;case"completedDate":E=y.completedDate||"9999-12-31",S=_.completedDate||"9999-12-31";break;case"text":case"responsible":E=(y[a.key]||"").toLowerCase(),S=(_[a.key]||"").toLowerCase();break}return E<S?a.direction==="ascending"?-1:1:E>S?a.direction==="ascending"?1:-1:0}),g},[e,a]),u=g=>{let y="ascending";a&&a.key===g&&a.direction==="ascending"&&(y="descending"),o({key:g,direction:y})},p=g=>!a||a.key!==g?v.jsx(ts,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):a.direction==="ascending"?v.jsx(Bl,{className:"w-3 h-3 ml-1 text-blue-600"}):v.jsx(ts,{className:"w-3 h-3 ml-1 text-blue-600"}),h=({sortKey:g,label:y,className:_})=>v.jsx("th",{scope:"col",className:`p-0 ${_||""}`,children:v.jsxs("button",{onClick:()=>u(g),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[v.jsx("span",{children:y}),p(g)]})});return v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:v.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[v.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),v.jsxs("p",{className:"text-sm text-slate-500",children:[": ",n," / : ",t]})]}),v.jsx("button",{onClick:r,className:"p-1.5 rounded-full hover:bg-slate-100",children:v.jsx(xr,{className:"w-6 h-6 text-slate-500"})})]}),v.jsx("main",{className:"flex-grow p-4 overflow-auto",children:v.jsxs("table",{className:"w-full border-collapse text-sm",children:[v.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:v.jsxs("tr",{children:[v.jsx(h,{sortKey:"status",label:"",className:"w-28 border border-slate-300"}),v.jsx(h,{sortKey:"text",label:"",className:"w-2/5 border border-slate-300"}),v.jsx(h,{sortKey:"responsible",label:"",className:"w-40 border border-slate-300"}),v.jsx(h,{sortKey:"dueDate",label:"",className:"w-40 border border-slate-300"}),v.jsx(h,{sortKey:"completedDate",label:"",className:"w-40 border border-slate-300"})]})}),v.jsxs("tbody",{className:"bg-white",children:[c.map(g=>{var y;return v.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[v.jsx("td",{className:"p-2 border border-slate-300 align-top text-center",children:g.completed?v.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[v.jsx(xh,{className:"w-4 h-4 mr-1"}),""]}):v.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[v.jsx(vh,{className:"w-4 h-4 mr-1"}),""]})}),v.jsxs("td",{className:"p-2 border border-slate-300 align-top font-medium text-slate-800",children:[g.text,g.report&&Array.isArray(g.report.attachments)&&g.report.attachments.length>0&&v.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200 space-y-1",children:g.report.attachments.map(_=>v.jsxs("a",{href:_.dataUrl,target:"_blank",rel:"noopener noreferrer",download:_.name,className:"flex items-center gap-1.5 text-xs text-blue-600 hover:underline",children:[v.jsx(ho,{className:"w-3.5 h-3.5"}),v.jsx("span",{children:_.name})]},_.id))}),((y=g.report)==null?void 0:y.notes)&&v.jsx("p",{className:"text-xs text-slate-500 mt-1 pt-1 border-t border-slate-200 whitespace-pre-wrap",children:g.report.notes})]}),v.jsx("td",{className:"p-2 border border-slate-300 align-top",children:g.responsible||""}),v.jsx("td",{className:"p-2 border border-slate-300 align-top",children:g.dueDate||""}),v.jsx("td",{className:"p-2 border border-slate-300 align-top",children:g.completedDate||""})]},g.id)}),e.length===0&&v.jsx("tr",{children:v.jsx("td",{colSpan:5,className:"text-center py-10 text-slate-500",children:""})})]})]})}),v.jsx("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:v.jsx("button",{onClick:r,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})})]})})},u9=({task:e,isOpen:t,onClose:n,onReportGenerated:r})=>{const[a,o]=ge.useState(""),[c,u]=ge.useState(new Set),[p,h]=ge.useState(!1),[g,y]=ge.useState(null),_=ge.useMemo(()=>{var b,U,B,X;const k=[];return k.push({id:`task-data-${e.id}`,name:`: ${e.title}`,type:"Task Data",source:{name:`: ${e.title}`,type:"json",content:e}}),(U=(b=e.extendedDetails)==null?void 0:b.attachments)==null||U.forEach(F=>{k.push({id:F.id,name:`: ${F.name}`,type:"Attachment",source:{name:F.name,type:F.type.startsWith("image/")?"image":"text",content:F.dataUrl}})}),(X=(B=e.extendedDetails)==null?void 0:B.subSteps)==null||X.forEach(F=>{var Y;(Y=F.actionItems)==null||Y.forEach(L=>{var Q,te,ee;(Q=L.report)!=null&&Q.matrixData&&k.push({id:`matrix-${L.id}`,name:`: ${L.text} (${F.text})`,type:"Data Matrix",source:{name:`: ${L.text}`,type:"json",content:L.report.matrixData}}),(ee=(te=L.report)==null?void 0:te.attachments)==null||ee.forEach(_e=>{k.push({id:_e.id,name:`: ${_e.name} (${L.text})`,type:"Attachment",source:{name:_e.name,type:_e.type.startsWith("image/")?"image":"text",content:_e.dataUrl}})})})}),k},[e]),E=ge.useMemo(()=>_.find(k=>k.type==="Task Data"),[_]),S=ge.useMemo(()=>_.filter(k=>k.type!=="Task Data"),[_]);ge.useEffect(()=>{if(t){const k=new Set;E&&k.add(E.id),u(k)}},[t,E]);const C=k=>{const b=_.find(U=>U.id===k);(b==null?void 0:b.type)!=="Task Data"&&u(U=>{const B=new Set(U);return B.has(k)?B.delete(k):B.add(k),B})},w=async()=>{if(!a.trim()){y("");return}if(c.size===0){y("1");return}h(!0),y(null);try{const k=_.filter(U=>c.has(U.id)).map(U=>U.source),b=await xT(k,a);r(b)}catch(k){y(k instanceof Error?k.message:"")}finally{h(!1)}};if(!t)return null;const M=k=>{switch(k){case"Task Data":return v.jsx(Ul,{className:"w-5 h-5 text-blue-600"});case"Attachment":return v.jsx(ho,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return v.jsx(_h,{className:"w-5 h-5 text-purple-600"});default:return v.jsx(Ul,{className:"w-5 h-5 text-slate-500"})}};return v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:v.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[v.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-slate-200",children:[v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),v.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:v.jsx(xr,{className:"w-6 h-6 text-slate-500"})})]}),v.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[v.jsxs("div",{children:[v.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"1. "}),v.jsxs("div",{className:"mb-4",children:[v.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:":"}),v.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-slate-200",children:[v.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-4 h-4 accent-blue-600"}),E&&M(E.type),v.jsx("span",{className:"text-sm text-slate-800 font-medium truncate",title:E==null?void 0:E.name,children:E==null?void 0:E.name})]})]}),S.length>0&&v.jsxs(v.Fragment,{children:[v.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:" ():"}),v.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-80 overflow-y-auto space-y-2",children:S.map(k=>v.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-slate-100 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:c.has(k.id),onChange:()=>C(k.id),className:"w-4 h-4 accent-blue-600"}),M(k.type),v.jsx("span",{className:"text-sm text-slate-700 truncate",title:k.name,children:k.name})]},k.id))})]})]}),v.jsxs("div",{children:[v.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"2. "}),v.jsx("textarea",{value:a,onChange:k=>o(k.target.value),placeholder:"",rows:8,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),g&&v.jsx("div",{className:"mt-2",children:v.jsx(ef,{message:g})})]})]}),v.jsxs("footer",{className:"flex-shrink-0 p-5 bg-slate-100 border-t flex justify-end items-center gap-4",children:[v.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),v.jsxs("button",{onClick:w,disabled:p,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[p?v.jsx(Lr,{size:"sm",color:"border-white"}):v.jsx(es,{className:"w-5 h-5"}),v.jsx("span",{children:p?"...":""})]})]})]})})},kd=({value:e,onChange:t,placeholder:n})=>v.jsx("textarea",{value:e,onChange:r=>t(r.target.value),placeholder:n,rows:3,className:"w-full h-full text-sm bg-transparent outline-none p-2 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-blue-50 resize-none text-slate-800 placeholder-slate-400"}),f9=({isOpen:e,onClose:t,onSave:n,task:r,generateUniqueId:a})=>{var F;const[o,c]=ge.useState([]),[u,p]=ge.useState(!1),[h,g]=ge.useState(null),[y,_]=ge.useState({key:"status",direction:"ascending"});ge.useEffect(()=>{var Y;e&&c(((Y=r.extendedDetails)==null?void 0:Y.decisions)||[])},[e,(F=r.extendedDetails)==null?void 0:F.decisions]);const E=ge.useMemo(()=>{let Y=[...o];return y!==null&&Y.sort((L,Q)=>{let te="",ee="";switch(y.key){case"status":te=L.status==="undecided"?0:1,ee=Q.status==="undecided"?0:1;break;case"date":te=L.date||"9999-12-31",ee=Q.date||"9999-12-31";break;default:te=(L[y.key]||"").toLowerCase(),ee=(Q[y.key]||"").toLowerCase()}return te<ee?y.direction==="ascending"?-1:1:te>ee?y.direction==="ascending"?1:-1:0}),Y},[o,y]),S=Y=>{let L="ascending";y&&y.key===Y&&y.direction==="ascending"&&(L="descending"),_({key:Y,direction:L})},C=Y=>!y||y.key!==Y?v.jsx(ts,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):y.direction==="ascending"?v.jsx(Bl,{className:"w-3 h-3 ml-1 text-blue-600"}):v.jsx(ts,{className:"w-3 h-3 ml-1 text-blue-600"}),w=({sortKey:Y,label:L,className:Q})=>v.jsx("th",{className:`p-0 border border-slate-300 ${Q||""}`,children:v.jsxs("button",{onClick:()=>S(Y),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[v.jsx("span",{children:L}),C(Y)]})}),M=async()=>{p(!0),g(null);try{const L=(await SM(r,o)).map(Q=>Q.id==="NEW"?{...Q,id:a("dec_ai")}:Q);c(L)}catch(Y){g(Y instanceof Error?Y.message:"")}finally{p(!1)}},k=(Y,L)=>{c(Q=>Q.map(te=>te.id===Y?{...te,...L}:te))},b=(Y,L)=>{const Q=o.find(ee=>ee.id===Y);if(!Q)return;const te={status:L};L==="decided"&&!Q.date?te.date=new Date().toISOString().split("T")[0]:L==="undecided"&&(te.date=void 0),k(Y,te)},U=Y=>{c(L=>L.filter(Q=>Q.id!==Y))},B=()=>{const Y={id:a("dec_manual"),question:"",status:"undecided"};c(L=>[Y,...L])},X=()=>{n(o)};return e?v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[50]",children:v.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[v.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),v.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[v.jsxs("button",{onClick:M,disabled:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[u?v.jsx(Lr,{size:"sm",color:"border-white"}):v.jsx(es,{className:"w-5 h-5"}),v.jsx("span",{children:"AI"})]}),v.jsxs("button",{onClick:B,disabled:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300 disabled:bg-slate-400",children:[v.jsx(Iu,{className:"w-5 h-5"}),v.jsx("span",{children:""})]}),v.jsx("button",{onClick:t,className:"p-1.5 rounded-full hover:bg-slate-100",children:v.jsx(xr,{className:"w-6 h-6 text-slate-500"})})]})]}),h&&v.jsx("div",{className:"p-4",children:v.jsx(ef,{message:h})}),v.jsx("main",{className:"flex-grow p-4 overflow-auto",children:v.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[v.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:v.jsxs("tr",{children:[v.jsx(w,{sortKey:"status",label:"",className:"w-32"}),v.jsx(w,{sortKey:"question",label:" (Question)",className:"w-[25%]"}),v.jsx(w,{sortKey:"decision",label:" (Decision)",className:"w-[25%]"}),v.jsx(w,{sortKey:"reasoning",label:"/",className:"w-[25%]"}),v.jsx(w,{sortKey:"date",label:"",className:"w-36"}),v.jsx("th",{className:"p-2 border border-slate-300 w-16",children:""})]})}),v.jsxs("tbody",{children:[E.map(Y=>v.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[v.jsx("td",{className:"border border-slate-300 align-top p-2",children:v.jsxs("select",{value:Y.status,onChange:L=>b(Y.id,L.target.value),className:`w-full p-2 rounded-md font-semibold text-xs border ${Y.status==="decided"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:[v.jsx("option",{value:"undecided",children:""}),v.jsx("option",{value:"decided",children:""})]})}),v.jsx("td",{className:"border border-slate-300",children:v.jsx(kd,{value:Y.question||"",onChange:L=>k(Y.id,{question:L}),placeholder:""})}),v.jsx("td",{className:"border border-slate-300",children:v.jsx(kd,{value:Y.decision||"",onChange:L=>k(Y.id,{decision:L}),placeholder:"..."})}),v.jsx("td",{className:"border border-slate-300",children:v.jsx(kd,{value:Y.reasoning||"",onChange:L=>k(Y.id,{reasoning:L}),placeholder:"..."})}),v.jsx("td",{className:"border border-slate-300 align-top p-2",children:v.jsx("input",{type:"date",value:Y.date||"",onChange:L=>k(Y.id,{date:L.target.value}),className:"w-full bg-transparent border-b border-dotted border-slate-400 outline-none p-1 text-xs text-slate-600 focus:border-solid focus:border-blue-500 disabled:border-none disabled:bg-slate-100",disabled:Y.status==="undecided"})}),v.jsx("td",{className:"border border-slate-300 text-center align-middle",children:v.jsx("button",{onClick:()=>U(Y.id),className:"text-red-400 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",title:"",children:v.jsx(Ia,{className:"w-5 h-5"})})})]},Y.id)),o.length===0&&v.jsx("tr",{children:v.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-500 bg-white border border-slate-300",children:"AI"})})]})]})}),v.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:[v.jsx("button",{onClick:t,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:""}),v.jsx("button",{onClick:X,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})}):null},d9=({task:e,onClose:t,onUpdateTaskCoreInfo:n,onUpdateExtendedDetails:r,generateUniqueId:a,projectGoal:o,targetDate:c})=>{const[u,p]=ge.useState(e),[h,g]=ge.useState(e.extendedDetails||{subSteps:[],resources:"",responsible:"",notes:"",numericalTarget:void 0,dueDate:"",reportDeck:void 0,resourceMatrix:null,attachments:[],decisions:[],subStepCanvasSize:{width:1200,height:800}}),[y,_]=ge.useState(!1),[E,S]=ge.useState(null),[C,w]=ge.useState(!1),[M,k]=ge.useState([]),[b,U]=ge.useState(null),[B,X]=ge.useState(null),[F,Y]=ge.useState(!1),[L,Q]=ge.useState(!1),[te,ee]=ge.useState(null),[_e,De]=ge.useState(!1),[Te,re]=ge.useState(!1),[ce,ne]=ge.useState(!1),[j,N]=ge.useState(null),[W,D]=ge.useState({x:0,y:0}),J=ge.useRef(null),q=ge.useRef(null);ge.useEffect(()=>{p(e),g(e.extendedDetails||{subSteps:[],resources:"",responsible:"",notes:"",numericalTarget:void 0,dueDate:"",reportDeck:void 0,resourceMatrix:null,attachments:[],decisions:[],subStepCanvasSize:{width:1200,height:800}})},[e]);const G=()=>{n(u.id,{title:u.title,description:u.description,status:u.status}),r(u.id,h),t()},ie=be=>{g(Ge=>({...Ge,...be}))},ye=async()=>{_(!0),S(null);try{const be=await EM(u);k(be),w(!0)}catch(be){S(be instanceof Error?be.message:"")}finally{_(!1)}},Ae=({newSubSteps:be,newActionItems:Ge})=>{const Ce=[...h.subSteps];be.forEach(Be=>{const et={id:a("substep"),text:Be.title,notes:Be.description,status:ar.NOT_STARTED,position:{x:10,y:Ce.length*90+10},actionItems:[]};Ce.push(et)}),Ge.forEach(({targetSubStepId:Be,title:et})=>{const Oe=Ce.find(mt=>mt.id===Be);if(Oe){const mt={id:a("action"),text:et,completed:!1};Oe.actionItems=[...Oe.actionItems||[],mt]}}),ie({subSteps:Ce}),w(!1)},Me=()=>{const be={id:a("substep"),text:"",status:ar.NOT_STARTED,position:{x:10,y:h.subSteps.length*90+10},actionItems:[]};ie({subSteps:[...h.subSteps,be]})},Ee=(be,Ge)=>{const Ce=h.subSteps.map(Be=>Be.id===be?{...Be,...Ge}:Be);ie({subSteps:Ce})},Ze=be=>{const Ge=h.subSteps.filter(Ce=>Ce.id!==be);ie({subSteps:Ge})},K=be=>{const Ge={id:a("action"),text:"",completed:!1},Ce=h.subSteps.map(Be=>Be.id===be?{...Be,actionItems:[...Be.actionItems||[],Ge]}:Be);ie({subSteps:Ce})},ut=(be,Ge,Ce)=>{const Be=h.subSteps.map(et=>et.id===be?{...et,actionItems:(et.actionItems||[]).map(Oe=>Oe.id===Ge?{...Oe,...Ce}:Oe)}:et);ie({subSteps:Be})},We=(be,Ge)=>{const Ce=h.subSteps.map(Be=>Be.id===be?{...Be,actionItems:(Be.actionItems||[]).filter(et=>et.id!==Ge)}:Be);ie({subSteps:Ce})},ht=be=>{var Oe;const Ge=(Oe=be.target.files)==null?void 0:Oe[0];if(!Ge)return;const Ce=5,Be=Ce*1024*1024;if(Ge.size>Be){alert(`${Ce}MB`),be.target&&(be.target.value="");return}const et=new FileReader;et.onload=mt=>{var bn;if(typeof((bn=mt.target)==null?void 0:bn.result)=="string"){const Qr={id:a("attach"),name:Ge.name,type:Ge.type,dataUrl:mt.target.result};ie({attachments:[...h.attachments||[],Qr]})}else alert("")},et.onerror=()=>{alert("")},et.readAsDataURL(Ge),be.target&&(be.target.value="")},Ne=be=>{var Ge;ie({attachments:(Ge=h.attachments)==null?void 0:Ge.filter(Ce=>Ce.id!==be)})},xe=async()=>{if(h.reportDeck){Y(!0);return}Q(!0),ee(null);try{const be=await CM(u,o);ie({reportDeck:be}),Y(!0)}catch(be){ee(be instanceof Error?be.message:"")}finally{Q(!1)}},He=be=>{ie({reportDeck:be})},je=be=>{ie({reportDeck:be}),De(!1),Y(!0)},Mt=be=>{ie({decisions:be}),re(!1)},_t=(be,Ge)=>{var Be,et;if(!q.current)return;const Ce=q.current.getBoundingClientRect();N(be),D({x:Ge.clientX-Ce.left-(((Be=be.position)==null?void 0:Be.x)||0),y:Ge.clientY-Ce.top-(((et=be.position)==null?void 0:et.y)||0)})},Xt=be=>{if(!j||!q.current)return;const Ge=q.current.getBoundingClientRect(),Ce=Math.max(0,be.clientX-Ge.left-W.x),Be=Math.max(0,be.clientY-Ge.top-W.y);Ee(j.id,{position:{x:Ce,y:Be}})},an=()=>{N(null)},Qt=be=>{switch(be){case ar.COMPLETED:return"border-green-500";case ar.IN_PROGRESS:return"border-blue-500";default:return"border-slate-400"}},An=be=>{switch(be){case ar.COMPLETED:return"bg-green-50";case ar.IN_PROGRESS:return"bg-blue-50";default:return"bg-slate-50"}},Vt=h.subSteps.flatMap(be=>(be.actionItems||[]).map(Ge=>({...Ge,subStepName:be.text,taskName:u.title})));if(F&&h.reportDeck)return v.jsx(Eh,{tasks:[{...u,extendedDetails:h}],initialDeck:h.reportDeck,onSave:He,onClose:()=>Y(!1),projectGoal:o,targetDate:c,reportScope:"task",generateUniqueId:a});return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[50]",children:v.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-7xl h-[95vh] flex flex-col",children:[v.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("button",{onClick:()=>re(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[v.jsx(Xd,{className:"w-5 h-5"}),""]}),v.jsxs("button",{onClick:()=>De(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700",children:[v.jsx(es,{className:"w-5 h-5"}),""]}),v.jsxs("button",{onClick:xe,disabled:L,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-teal-600 rounded-md hover:bg-teal-700 disabled:bg-slate-400",children:[L?v.jsx(Lr,{size:"sm",color:"border-white"}):v.jsx(Th,{className:"w-5 h-5"}),h.reportDeck?"":""]}),v.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-slate-100",title:"",children:v.jsx(xr,{className:"w-6 h-6 text-slate-500"})})]})]}),v.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[v.jsx("div",{className:"w-1/3 p-5 border-r border-slate-200 overflow-y-auto",children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),v.jsx("input",{type:"text",value:u.title,onChange:be=>p(Ge=>({...Ge,title:be.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),v.jsx("textarea",{value:u.description,onChange:be=>p(Ge=>({...Ge,description:be.target.value})),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),v.jsx("textarea",{value:h.resources,onChange:be=>ie({resources:be.target.value}),rows:2,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),v.jsx("input",{type:"text",value:h.responsible,onChange:be=>ie({responsible:be.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),v.jsx("input",{type:"date",value:h.dueDate||"",onChange:be=>ie({dueDate:be.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),v.jsx("textarea",{value:h.notes,onChange:be=>ie({notes:be.target.value}),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:""})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700",children:""}),v.jsx("button",{onClick:()=>{var be;return(be=J.current)==null?void 0:be.click()},className:"text-blue-600 hover:text-blue-800 p-1 rounded-full hover:bg-blue-100",title:"",children:v.jsx(ho,{className:"w-5 h-5"})}),v.jsx("input",{type:"file",ref:J,onChange:ht,className:"hidden",multiple:!1})]}),v.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:(h.attachments||[]).map(be=>v.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-50 rounded-md",children:[v.jsx("a",{href:be.dataUrl,download:be.name,className:"text-sm text-blue-600 hover:underline truncate flex-grow",title:be.name,children:be.name}),v.jsx("button",{onClick:()=>Ne(be.id),className:"text-red-500 hover:text-red-700 ml-2",title:"",children:v.jsx(Ia,{className:"w-4 h-4"})})]},be.id))})]}),te&&v.jsx("div",{className:"text-red-600 text-sm bg-red-100 border border-red-400 p-2 rounded-md",children:te})]})}),v.jsxs("div",{className:"flex-grow flex flex-col",children:[v.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("h4",{className:"text-lg font-semibold text-slate-800",children:""}),v.jsx("button",{onClick:()=>ne(!ce),className:"p-1 text-slate-600 hover:text-slate-800",title:ce?"":"",children:ce?v.jsx(qM,{className:"w-5 h-5"}):v.jsx(jM,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("button",{onClick:ye,disabled:y,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[y?v.jsx(Lr,{size:"sm",color:"border-white"}):v.jsx(es,{className:"w-5 h-5"}),"AI"]}),v.jsxs("button",{onClick:Me,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700",children:[v.jsx(Iu,{className:"w-5 h-5"}),""]}),Vt.length>0&&v.jsxs("button",{onClick:()=>X({subStep:{id:"all",text:""},task:u}),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[v.jsx(Xd,{className:"w-5 h-5"}),""]})]})]}),E&&v.jsx("div",{className:"mx-4 mt-2 text-red-600 text-sm bg-red-100 border border-red-400 p-2 rounded-md",children:E}),v.jsx("div",{className:"flex-grow overflow-hidden",children:ce?v.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-[60] flex flex-col",children:[v.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-800 text-white",children:[v.jsx("h3",{className:"text-lg font-semibold",children:""}),v.jsx("button",{onClick:()=>ne(!1),className:"p-2 hover:bg-slate-700 rounded-md",children:v.jsx(xr,{className:"w-6 h-6"})})]}),v.jsx("div",{className:"flex-grow bg-slate-100 overflow-auto",children:Gt()})]}):v.jsx("div",{className:"h-full overflow-auto bg-slate-50",children:Gt()})})]})]}),v.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex justify-end space-x-3",children:[v.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),v.jsx("button",{onClick:G,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})}),C&&v.jsx(tD,{proposals:M,existingSubSteps:h.subSteps,onConfirm:Ae,onClose:()=>w(!1)}),b&&v.jsx(l9,{actionItem:b,onSave:be=>{const Ge=h.subSteps.find(Ce=>{var Be;return(Be=Ce.actionItems)==null?void 0:Be.some(et=>et.id===be.id)});Ge&&ut(Ge.id,be.id,be),U(null)},onClose:()=>U(null),generateUniqueId:a}),B&&v.jsx(c9,{actionItems:B.subStep.id==="all"?Vt:B.subStep.actionItems||[],subStepName:B.subStep.text,taskName:B.task.title,onClose:()=>X(null)}),_e&&v.jsx(u9,{task:{...u,extendedDetails:h},isOpen:_e,onClose:()=>De(!1),onReportGenerated:je}),Te&&v.jsx(f9,{isOpen:Te,onClose:()=>re(!1),onSave:Mt,task:{...u,extendedDetails:h},generateUniqueId:a})]});function Gt(){var be,Ge;return v.jsx("div",{ref:q,className:"relative w-full h-full min-h-[600px] p-4",style:{width:((be=h.subStepCanvasSize)==null?void 0:be.width)||1200,height:((Ge=h.subStepCanvasSize)==null?void 0:Ge.height)||800},onMouseMove:Xt,onMouseUp:an,children:h.subSteps.map(Ce=>{var Be,et;return v.jsxs("div",{className:`absolute bg-white rounded-lg shadow-md border-l-4 ${Qt(Ce.status)} ${An(Ce.status)} p-4 w-80 cursor-move`,style:{left:((Be=Ce.position)==null?void 0:Be.x)||0,top:((et=Ce.position)==null?void 0:et.y)||0},onMouseDown:Oe=>_t(Ce,Oe),children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("input",{type:"text",value:Ce.text,onChange:Oe=>Ee(Ce.id,{text:Oe.target.value}),className:"font-semibold text-slate-800 bg-transparent border-none outline-none flex-grow",onClick:Oe=>Oe.stopPropagation()}),v.jsx("button",{onClick:Oe=>{Oe.stopPropagation(),Ze(Ce.id)},className:"text-red-500 hover:text-red-700 ml-2",title:"",children:v.jsx(Ia,{className:"w-4 h-4"})})]}),v.jsxs("div",{className:"space-y-2 mb-3",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs font-medium text-slate-600",children:":"}),v.jsxs("select",{value:Ce.status||ar.NOT_STARTED,onChange:Oe=>Ee(Ce.id,{status:Oe.target.value}),className:"text-xs border border-slate-300 rounded px-2 py-1",onClick:Oe=>Oe.stopPropagation(),children:[v.jsx("option",{value:ar.NOT_STARTED,children:""}),v.jsx("option",{value:ar.IN_PROGRESS,children:""}),v.jsx("option",{value:ar.COMPLETED,children:""})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs font-medium text-slate-600",children:":"}),v.jsx("input",{type:"text",value:Ce.responsible||"",onChange:Oe=>Ee(Ce.id,{responsible:Oe.target.value}),className:"text-xs border border-slate-300 rounded px-2 py-1 flex-grow",placeholder:"",onClick:Oe=>Oe.stopPropagation()})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs font-medium text-slate-600",children:":"}),v.jsx("input",{type:"date",value:Ce.dueDate||"",onChange:Oe=>Ee(Ce.id,{dueDate:Oe.target.value}),className:"text-xs border border-slate-300 rounded px-2 py-1",onClick:Oe=>Oe.stopPropagation()})]})]}),v.jsxs("div",{className:"mb-3",children:[v.jsxs("div",{className:"flex items-center justify-between mb-1",children:[v.jsx("span",{className:"text-xs font-medium text-slate-600",children:""}),v.jsx("button",{onClick:Oe=>{Oe.stopPropagation(),K(Ce.id)},className:"text-blue-600 hover:text-blue-800",title:"",children:v.jsx(Iu,{className:"w-4 h-4"})})]}),v.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:(Ce.actionItems||[]).map(Oe=>v.jsxs("div",{className:"flex items-center gap-2 p-1 bg-slate-100 rounded text-xs",children:[v.jsx("input",{type:"checkbox",checked:Oe.completed,onChange:mt=>{mt.stopPropagation(),ut(Ce.id,Oe.id,{completed:mt.target.checked})},className:"w-3 h-3"}),v.jsx("input",{type:"text",value:Oe.text,onChange:mt=>ut(Ce.id,Oe.id,{text:mt.target.value}),className:"flex-grow bg-transparent border-none outline-none",onClick:mt=>mt.stopPropagation()}),v.jsx("input",{type:"text",value:Oe.responsible||"",onChange:mt=>ut(Ce.id,Oe.id,{responsible:mt.target.value}),className:"w-20 bg-transparent border border-slate-300 rounded px-1 py-0.5 text-xs",placeholder:"",onClick:mt=>mt.stopPropagation()}),v.jsx("button",{onClick:mt=>{mt.stopPropagation(),U(Oe)},className:"text-green-600 hover:text-green-800",title:"",children:v.jsx(FM,{className:"w-3 h-3"})}),v.jsx("button",{onClick:mt=>{mt.stopPropagation(),We(Ce.id,Oe.id)},className:"text-red-500 hover:text-red-700",title:"",children:v.jsx(Ia,{className:"w-3 h-3"})})]},Oe.id))})]}),v.jsx("textarea",{value:Ce.notes||"",onChange:Oe=>Ee(Ce.id,{notes:Oe.target.value}),className:"w-full text-xs border border-slate-300 rounded px-2 py-1 resize-none",rows:2,placeholder:"...",onClick:Oe=>Oe.stopPropagation()})]},Ce.id)})})}},h9=({onClose:e,onSubmit:t})=>{const[n,r]=ge.useState(""),[a,o]=ge.useState(""),[c,u]=ge.useState(""),p=h=>{if(h.preventDefault(),!n.trim()){u("");return}if(!a.trim()){u("");return}t({title:n,description:a}),u("")};return v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:v.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg",children:[v.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),v.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:v.jsx(xr,{className:"w-6 h-6"})})]}),v.jsxs("form",{onSubmit:p,children:[v.jsxs("div",{className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{htmlFor:"taskTitle",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),v.jsx("input",{type:"text",id:"taskTitle",value:n,onChange:h=>r(h.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:": "})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"taskDescription",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),v.jsx("textarea",{id:"taskDescription",value:a,onChange:h=>o(h.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:": "})]}),c&&v.jsx("p",{className:"text-sm text-red-600",children:c})]}),v.jsxs("footer",{className:"p-6 bg-slate-50 border-t border-slate-200 flex justify-end space-x-3 rounded-b-xl",children:[v.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),v.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""})]})]})]})})},m9=({onSetApiKey:e,error:t,isLoading:n})=>{const[r,a]=ge.useState(""),o=c=>{c.preventDefault(),e(r)};return v.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[v.jsxs("div",{className:"w-full max-w-md bg-white shadow-2xl rounded-xl p-8",children:[v.jsxs("div",{className:"text-center mb-8",children:[v.jsx(es,{className:"w-12 h-12 mx-auto text-blue-600 mb-4"}),v.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"AI Project Planner"}),v.jsx("p",{className:"text-slate-600 mt-2",children:"Google Gemini API"})]}),v.jsxs("form",{onSubmit:o,className:"space-y-6",children:[v.jsxs("div",{children:[v.jsxs("label",{htmlFor:"apiKey",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[v.jsx(CT,{className:"w-5 h-5 mr-2 text-slate-500"}),"Gemini API Key"]}),v.jsx("input",{id:"apiKey",type:"password",value:r,onChange:c=>a(c.target.value),placeholder:"API",className:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-800 placeholder-slate-400"})]}),t&&v.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:t}),v.jsx("button",{type:"submit",disabled:n||!r,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:n?v.jsx(Lr,{size:"sm"}):""})]}),v.jsxs("div",{className:"text-center mt-6",children:[v.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"API"}),v.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"API"})]})]}),v.jsx("footer",{className:"mt-8 text-center",children:v.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},vi={subSteps:[],resources:"",responsible:"",notes:"",numericalTarget:void 0,dueDate:"",reportDeck:void 0,resourceMatrix:null,attachments:[],decisions:[],subStepCanvasSize:{width:1200,height:800}},p9=()=>[{id:"apqp_1",title:"1: ",description:"/",status:Ct.NOT_STARTED,nextTaskIds:["apqp_2"]},{id:"apqp_2",title:"2: ",description:"DFMEA",status:Ct.NOT_STARTED,nextTaskIds:["apqp_3"]},{id:"apqp_3",title:"3: ",description:"PFMEA(MSA)",status:Ct.NOT_STARTED,nextTaskIds:["apqp_4"]},{id:"apqp_4",title:"4: ",description:"MSA(SPC)(PPAP)",status:Ct.NOT_STARTED,nextTaskIds:["apqp_5"]},{id:"apqp_5",title:"5: ",description:"",status:Ct.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...vi,...t.extendedDetails||{}}})),g9=()=>[{id:"change_1",title:"1. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:["change_2"]},{id:"change_2",title:"2. ",description:"(CCB)",status:Ct.NOT_STARTED,nextTaskIds:["change_3"]},{id:"change_3",title:"3. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:["change_4"]},{id:"change_4",title:"4. ",description:"FMEA",status:Ct.NOT_STARTED,nextTaskIds:["change_5"]},{id:"change_5",title:"5. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...vi,...t.extendedDetails||{}}})),x9=()=>[{id:"eval_1",title:"1. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:["eval_2"]},{id:"eval_2",title:"2.  ()",description:"",status:Ct.NOT_STARTED,nextTaskIds:["eval_3"]},{id:"eval_3",title:"3. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:["eval_4"]},{id:"eval_4",title:"4. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:["eval_5"]},{id:"eval_5",title:"5. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...vi,...t.extendedDetails||{}}})),v9=()=>[{id:"dmaic_1",title:"1:  (Define)",description:"",status:Ct.NOT_STARTED,nextTaskIds:["dmaic_2"]},{id:"dmaic_2",title:"2:  (Measure)",description:"KPI",status:Ct.NOT_STARTED,nextTaskIds:["dmaic_3"]},{id:"dmaic_3",title:"3:  (Analyze)",description:"",status:Ct.NOT_STARTED,nextTaskIds:["dmaic_4"]},{id:"dmaic_4",title:"4:  (Improve)",description:"",status:Ct.NOT_STARTED,nextTaskIds:["dmaic_5"]},{id:"dmaic_5",title:"5:  (Control)",description:"",status:Ct.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...vi,...t.extendedDetails||{}}})),y9=()=>[{id:"mod_1",title:"1. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:["mod_2"]},{id:"mod_2",title:"2. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:["mod_3"]},{id:"mod_3",title:"3. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:["mod_4"]},{id:"mod_4",title:"4. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:["mod_5"]},{id:"mod_5",title:"5. ",description:"",status:Ct.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...vi,...t.extendedDetails||{}}})),T9=()=>{const[e,t]=ge.useState(null),[n,r]=ge.useState(""),[a,o]=ge.useState(""),[c,u]=ge.useState([]),[p,h]=ge.useState(null),[g,y]=ge.useState(null),[_,E]=ge.useState(!1),[S,C]=ge.useState(null),[w,M]=ge.useState(Rr.INPUT_FORM),[k,b]=ge.useState(!1),[U,B]=ge.useState([]),[X,F]=ge.useState([]),[Y,L]=ge.useState(null);ge.useEffect(()=>{const Ne=sessionStorage.getItem("gemini-api-key");Ne&&ne(Ne)},[]);const Q=Ne=>{B(xe=>[...xe.slice(-10),Ne]),F([])},te=ge.useCallback((Ne="id")=>`${Ne}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,[]),ee=(Ne,xe)=>{const He=JSON.stringify(Ne,null,2),je=new Blob([He],{type:"application/json"}),Mt=URL.createObjectURL(je),_t=document.createElement("a");_t.href=Mt,_t.download=xe,document.body.appendChild(_t),_t.click(),document.body.removeChild(_t),URL.revokeObjectURL(Mt)},_e=Ne=>new Promise((xe,He)=>{const je=new FileReader;je.onload=Mt=>{var _t;try{typeof((_t=Mt.target)==null?void 0:_t.result)=="string"?xe(JSON.parse(Mt.target.result)):He(new Error("Failed to read file."))}catch(Xt){He(new Error(`Invalid JSON: ${Xt.message}`))}},je.onerror=()=>He(new Error("File read error.")),je.readAsText(Ne)}),De=ge.useCallback(Ne=>{if(Ne.length===0)return Ne;const xe=new Map(Ne.map(Ce=>[Ce.id,Ce])),He=new Map(Ne.map(Ce=>[Ce.id,0])),je=new Map;Ne.forEach(Ce=>{je.set(Ce.id,[]),(Ce.nextTaskIds||[]).forEach(Be=>{var et;xe.has(Be)&&(He.set(Be,(He.get(Be)||0)+1),(et=je.get(Ce.id))==null||et.push(Be))})});const Mt=Ne.filter(Ce=>(He.get(Ce.id)||0)===0).map(Ce=>Ce.id),_t=[];let Xt=0;const an=new Set;for(;Mt.length>0;){const Ce=Mt.length;_t[Xt]=[];for(let Be=0;Be<Ce;Be++){const et=Mt.shift();an.add(et),_t[Xt].push(et),(je.get(et)||[]).forEach(Oe=>{He.set(Oe,(He.get(Oe)||0)-1),(He.get(Oe)||0)===0&&Mt.push(Oe)})}Xt++}const Qt=Ne.filter(Ce=>!an.has(Ce.id));Qt.length>0&&_t.push(Qt.map(Ce=>Ce.id));const An=380,Vt=60,Gt=50,be=280,Ge=new Map;return _t.forEach((Ce,Be)=>{const et=Ce.length*be+(Ce.length-1)*Gt,Oe=Math.max(20,(500-et)/2);Ce.forEach((mt,bn)=>{Ge.set(mt,{x:Be*(An+Vt)+20,y:Oe+bn*(be+Gt)})})}),Ne.map((Ce,Be)=>({...Ce,position:Ge.get(Ce.id)||Ce.position||{x:20,y:20+Be*100}}))},[]),Te=Ne=>{Q(c),u(Ne)},re=()=>{if(U.length>0){const Ne=U[U.length-1];B(xe=>xe.slice(0,-1)),F(xe=>[c,...xe]),u(Ne)}},ce=()=>{if(X.length>0){const Ne=X[0];F(xe=>xe.slice(1)),B(xe=>[...xe,c]),u(Ne)}},ne=Ne=>{Ne.trim()&&(vv(Ne),sessionStorage.setItem("gemini-api-key",Ne),t(Ne),C(null))},j=()=>{sessionStorage.removeItem("gemini-api-key"),t(null),vv("")},N=()=>{r(""),o(""),u([]),y(null),L(null),M(Rr.INPUT_FORM),C(null),B([]),F([])},W=()=>{ee({projectGoal:n,targetDate:a,tasks:c,ganttData:g},"project-plan.json")},D=async Ne=>{try{const xe=await _e(Ne);if(xe.projectGoal&&xe.targetDate&&Array.isArray(xe.tasks))r(xe.projectGoal),o(xe.targetDate),u(xe.tasks.map(He=>({...He,extendedDetails:{...vi,...He.extendedDetails||{}}}))),y(xe.ganttData||null),L(null),M(Rr.PROJECT_FLOW),B([]),F([]);else throw new Error("Invalid project file format.")}catch(xe){const He=xe.message;C(He),He.toLowerCase().includes("api key")&&j()}},J=({title:Ne,description:xe})=>{const He={id:te("task"),title:Ne,description:xe,extendedDetails:vi,status:Ct.NOT_STARTED,position:{x:20,y:20}};Te(je=>De([...je,He])),b(!1)},q=Ne=>{Te(xe=>xe.filter(He=>He.id!==Ne).map(He=>({...He,nextTaskIds:(He.nextTaskIds||[]).filter(je=>je!==Ne)})))},G=(Ne,xe)=>{Te(He=>He.map(je=>je.id===Ne?{...je,status:xe}:je))},ie=(Ne,xe)=>{Te(He=>He.map(je=>je.id===Ne?{...je,nextTaskIds:xe}:je))},ye=(Ne,xe)=>{u(He=>He.map(je=>je.id===Ne?{...je,position:xe}:je))},Ae=(Ne,xe)=>{Te(He=>He.map(je=>je.id===Ne?{...je,...xe}:je))},Me=(Ne,xe)=>{Te(He=>He.map(je=>je.id===Ne?{...je,extendedDetails:xe}:je))},Ee=(Ne,xe,He)=>{let je=[];switch(Ne){case"process-design":je=p9();break;case"process-change":je=g9();break;case"new-product-eval":je=x9();break;case"improvement-project":je=v9();break;case"equipment-modification":je=y9();break}r(xe),o(He),u(De(je)),y(null),L(null),M(Rr.PROJECT_FLOW),B([]),F([]),C(null)},Ze=async(Ne,xe)=>{E(!0),C(null);try{r(Ne),o(xe);const He=await _M(Ne,xe),je=De(He.map(Mt=>({...Mt,extendedDetails:vi,status:Ct.NOT_STARTED})));u(je),y(null),L(null),M(Rr.PROJECT_FLOW),B([]),F([])}catch(He){const je=He.message;je.toLowerCase().includes("api key")&&j(),C(je)}finally{E(!1)}},K=Ne=>{h(Ne),M(Rr.TASK_DETAIL)},ut=()=>{h(null),M(Rr.PROJECT_FLOW)},We=Ne=>{L(Ne)},ht=()=>{if(!e)return v.jsx(m9,{onSetApiKey:ne,error:S});if(S)return v.jsxs("div",{className:"p-4",children:[v.jsx(ef,{message:S}),v.jsx("button",{onClick:()=>{C(null),e?M(Rr.INPUT_FORM):j()},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:""})]});switch(w){case Rr.PROJECT_FLOW:return v.jsx(eD,{tasks:c,projectGoal:n,targetDate:a,onSelectTask:K,onUpdateTaskExtendedDetails:()=>{},onUpdateTaskPosition:ye,onStartNewProject:N,onExportProject:W,onAddTask:()=>b(!0),onRemoveTask:q,onUpdateTaskStatus:G,onImportSingleTask:()=>{},onAutoLayout:()=>Te(Ne=>De([...Ne])),onUndo:re,canUndo:U.length>0,onRedo:ce,canRedo:X.length>0,generateUniqueId:te,onUpdateTaskConnections:ie,ganttData:g,setGanttData:y,onCustomReportGenerated:We,onClearApiKey:j});case Rr.TASK_DETAIL:return p&&v.jsx(d9,{task:p,onClose:ut,onUpdateTaskCoreInfo:Ae,onUpdateExtendedDetails:Me,generateUniqueId:te,projectGoal:n,targetDate:a});case Rr.INPUT_FORM:default:return v.jsx(YM,{onSubmit:Ze,isLoading:_,onImportProject:D,onLoadTemplate:Ee,initialGoal:n,initialDate:a})}};return v.jsxs("div",{className:"h-full w-full",children:[ht(),k&&v.jsx(h9,{onClose:()=>b(!1),onSubmit:J}),Y&&v.jsx(Eh,{tasks:c,initialDeck:Y,onSave:Ne=>L(Ne),onClose:()=>L(null),projectGoal:n,targetDate:a,reportScope:"project",generateUniqueId:te})]})},m_=document.getElementById("root");if(!m_)throw new Error("Could not find root element to mount to");const _9=MS.createRoot(m_);_9.render(v.jsx(so.StrictMode,{children:v.jsx(T9,{})}));
